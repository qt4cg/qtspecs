<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2025/">2025</a>, <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="closed-1296"><h2>Issue #1296 closed<span class="toot-id"> #closed-1296</span></h2><div class="pubdate">17 Mar at 09:47:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1296">https://github.com/qt4cg/qtspecs/pull/1296</a></div><p>982 Rewrite of scan-left and scan-right</p></div>
<div class="toot" id="created-1883"><h2>Pull request #1883 created<span class="toot-id"> #created-1883</span></h2><div class="pubdate">16 Mar at 18:19:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1883">https://github.com/qt4cg/qtspecs/pull/1883</a></div><details><summary>882 Replace fn:chain by fn:compose</summary><div class="markup"><p>Drops the existing fn:chain function and replaces it with a new fn:compose function.</p>
<p>This combines two separate changes:</p>
<p>(a) whereas fn:chain applies a sequence of functions to an input, fn:compose returns a composite function that can be used repeatedly with different inputs.</p>
<p>(b) the fn:compose function is restricted to arity-1 functions, which leads to a much simpler specification that still handles the vast majority of practical use cases.</p>
<p>In particular, note that if the sequence of functions to be applied is statically known, then it can always be written out explicitly; the real use case for this function is when the sequence of functions is constructed dynamically. And in this situation, fn:chain in its current form can easily fail because of problems with the arity of the functions included in the chain.</p>
</div></details></div>
<div class="toot" id="closed-1865"><h2>Issue #1865 closed<span class="toot-id"> #closed-1865</span></h2><div class="pubdate">16 Mar at 17:13:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><p>Callback functions, position argument: consistency</p></div>
<div class="toot" id="created-1882"><h2>Pull request #1882 created<span class="toot-id"> #created-1882</span></h2><div class="pubdate">16 Mar at 00:09:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1882">https://github.com/qt4cg/qtspecs/pull/1882</a></div><details><summary>982 Editorial rewrite of scan-left and scan-right</summary><div class="markup"><p>This is intended to be purely an editorial rewrite, it does not change the functionality.</p>
<p>Replaces #1296.</p>
<p>Addresses #982, but we still need to add corresponding functions for arrays.</p>
</div></details></div>
<div class="toot" id="created-1881"><h2>Issue #1881 created<span class="toot-id"> #created-1881</span></h2><div class="pubdate">15 Mar at 08:28:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1881">https://github.com/qt4cg/qtspecs/issues/1881</a></div><details><summary>fn:function-identity for maps and arrays</summary><div class="markup"><p>The data model spec says that function identity is not defined for maps and arrays.</p>
<p>The specification of fn:function-identity() fails to mention this fact.</p>
</div></details></div>
<div class="toot" id="created-1880"><h2>Pull request #1880 created<span class="toot-id"> #created-1880</span></h2><div class="pubdate">15 Mar at 01:16:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1880">https://github.com/qt4cg/qtspecs/pull/1880</a></div><details><summary>Editorial revision of fn:function-identity</summary><div class="markup"><p>Tidies up the text and adds examples</p>
</div></details></div>
<div class="toot" id="created-1879"><h2>Pull request #1879 created<span class="toot-id"> #created-1879</span></h2><div class="pubdate">14 Mar at 15:50:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1879">https://github.com/qt4cg/qtspecs/pull/1879</a></div><details><summary>1857, 1860: Add more options to parse-xml</summary><div class="markup"><p>Add options to control entity expansion and XInclude processing.</p>
<p>Fix #1857
Fix #1860</p>
</div></details></div>
<div class="toot" id="created-1878"><h2>Pull request #1878 created<span class="toot-id"> #created-1878</span></h2><div class="pubdate">14 Mar at 14:58:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1878">https://github.com/qt4cg/qtspecs/pull/1878</a></div><details><summary>1851 Make ?variety optional; explain namespace-sensitive</summary><div class="markup"><p>Fix #1851</p>
<p>Allow ?variety to be absent e.g. for xs:anySimpleType</p>
<p>Define namespace-sensitive by an xtermref to the definition in the XP/XQ spec.</p>
</div></details></div>
<div class="toot" id="created-1877"><h2>Pull request #1877 created<span class="toot-id"> #created-1877</span></h2><div class="pubdate">14 Mar at 14:38:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1877">https://github.com/qt4cg/qtspecs/pull/1877</a></div><details><summary>1866 Disambiguate TypeSpecifier syntax</summary><div class="markup"><p>Fix #1866</p>
</div></details></div>
<div class="toot" id="created-1876"><h2>Issue #1876 created<span class="toot-id"> #created-1876</span></h2><div class="pubdate">14 Mar at 13:10:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1876">https://github.com/qt4cg/qtspecs/issues/1876</a></div><details><summary>`fn:replace`:  Combine $replacement and $action parameters</summary><div class="markup"><p>We could combine the competing <code>$replacement</code> and <code>$action</code> parameters:</p>
<pre><code class="language-xquery">replace(
  'this is a test',
  '(\w)(\w+)?',
  fn($s, $g) { upper-case($g[1]) || lower-case($g[2]) }
)
</code></pre>
<p>Original comment: https://github.com/qt4cg/qtspecs/issues/1863#issuecomment-2711149296</p>
</div></details></div>
<div class="toot" id="created-1875"><h2>Pull request #1875 created<span class="toot-id"> #created-1875</span></h2><div class="pubdate">14 Mar at 11:27:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1875">https://github.com/qt4cg/qtspecs/pull/1875</a></div><details><summary>1861 Params passed automatically through next-match</summary><div class="markup"><p>Fix #1861</p>
</div></details></div>
<div class="toot" id="created-1874"><h2>Pull request #1874 created<span class="toot-id"> #created-1874</span></h2><div class="pubdate">14 Mar at 10:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1874">https://github.com/qt4cg/qtspecs/pull/1874</a></div><details><summary>1862 Coercing to a record type changes map order</summary><div class="markup"><p>Fix #1862</p>
</div></details></div>
<div class="toot" id="created-1873"><h2>Pull request #1873 created<span class="toot-id"> #created-1873</span></h2><div class="pubdate">14 Mar at 09:55:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1873">https://github.com/qt4cg/qtspecs/pull/1873</a></div><details><summary>1869 duplicate values</summary><div class="markup"><p>Fix #1869</p>
</div></details></div>
<div class="toot" id="created-1872"><h2>Issue #1872 created<span class="toot-id"> #created-1872</span></h2><div class="pubdate">13 Mar at 11:31:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1872">https://github.com/qt4cg/qtspecs/issues/1872</a></div><details><summary>Arrays: members → values?</summary><div class="markup"><p>I am pretty sure the first reaction will be DONT!, but for the sake of consistency it seems important enough for me to bring this up:</p>
<p>Could we rename array “members” to “values”?</p>
<p>Some advantages that I would see:</p>
<ul>
<li>We could treat arrays and maps more similarly.</li>
<li>We already have a <code>values</code> lookup key specifier for arrays.</li>
<li>No 3.1 array function contains the string “member”, so we will not introduce any backward inconsistencies.</li>
<li>All 4.0 features that use this string could be safely renamed.</li>
</ul>
<p>Of course the term “values” is a very common one, but we have to decided to stick with “map values” – and arrays and maps are very similar.</p>
<p>Finally, I noticed that also the term “member” has different meanings in the spec and is not exclusively used for arrays (e.g. in the rules for <code>fn:innermost</code>, <code>fn:format-integer</code> or for members of union types).</p>
</div></details></div>
<div class="toot" id="closed-1338"><h2>Issue #1338 closed<span class="toot-id"> #closed-1338</span></h2><div class="pubdate">13 Mar at 10:40:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1338">https://github.com/qt4cg/qtspecs/issues/1338</a></div><p>Arrays and maps: Members, entries, values, contents, pairs, …</p></div>
<div class="toot" id="created-1871"><h2>Issue #1871 created<span class="toot-id"> #created-1871</span></h2><div class="pubdate">13 Mar at 10:39:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1871">https://github.com/qt4cg/qtspecs/issues/1871</a></div><details><summary>Arrays and maps: consistency</summary><div class="markup"><h3>Suggestions (based on #1338, related: #1868)</h3>
<ol>
<li>In symmetry with the <code>pairs</code> lookup specifier, we should add <code>array:pairs</code> and an inverse <code>array:of-pairs</code> function.</li>
<li>In symmetry with the <code>values</code> lookup specifier, we should add <code>array:values</code> and <code>map:values</code> functions, to retrieve the values of maps and the members of arrays in a sequence of arrays.</li>
<li>In return, <code>array:members</code> and <code>array:of-members</code> seem redundant, and we should drop them.</li>
<li>In analogy with the <code>keys</code> specifier and <code>map:keys</code>, we should add <code>array:keys</code> (which returns a dense integer range).</li>
</ol>
<h3>Background</h3>
<p>With version 4.0, we are adding a lot of promising and powerful new map and array features. This is a big step forward, compared to the obvious limitations of 3.1.</p>
<p>Some aspects of the 3.1 design have made it difficult (or impossible) to fully adjust array and maps, but (in my opinion) the old overall concept was impressively consistent – and it is definitely a big challenge to achieve a 4.0 design that is not too fragmented.</p>
<p>To me, this becomes particularly evident in the case of arrays. The following example sums up the items of all members of an array. For the cumbersome 3.1 solution…</p>
<pre><code class="language-xquery">for $pos in 1 to array:size($array)
return sum($array($pos))
</code></pre>
<p>…we now have several (roughly?) equivalent options to do this:</p>
<ol>
<li><code>for member $m in $array return sum($m)</code></li>
<li><code>array:members($array) ! sum(?value)</code></li>
<li><code>$array?pairs::* ! sum(?value)</code></li>
<li><code>$array?values::* ! sum(.)</code></li>
</ol>
<p>The examples above imply that:</p>
<ul>
<li>for 1., an <em>array member</em> is a sequence;</li>
<li>for 2., an <em>array member</em> is a map;</li>
<li>for 3., an <em>array</em> has pairs (but there is no <code>array:pairs</code>);</li>
<li>for 4., an <em>array</em> has values (but there is no <code>array:values</code>).</li>
</ul>
</div></details></div>
<div class="toot" id="created-1870"><h2>Issue #1870 created<span class="toot-id"> #created-1870</span></h2><div class="pubdate">12 Mar at 22:19:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1870">https://github.com/qt4cg/qtspecs/issues/1870</a></div><details><summary>Rename $zero keyword of fold-left and fold-right</summary><div class="markup"><p>I find the name $zero for this parameter unhelpful and confusing.</p>
<p>I suggest <code>$accum</code>, short for "accumulator" or "accumulated result".</p>
</div></details></div>
<div class="toot" id="created-1869"><h2>Issue #1869 created<span class="toot-id"> #created-1869</span></h2><div class="pubdate">12 Mar at 18:44:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1869">https://github.com/qt4cg/qtspecs/issues/1869</a></div><details><summary>`fn:duplicate-values`: Order of results</summary><div class="markup"><p>With https://github.com/qt4cg/qtspecs/pull/987, a rule was added to <code>fn:duplicate-values</code>:</p>
<blockquote>
<p>For any set of values that compare equal, the one that is returned is the one that appears first in $values.</p>
</blockquote>
<p>I think we should adapt the behavior to return the duplicates in the order they appear, not the original values:</p>
<ul>
<li>A common use case for this function is to find the first duplicate in a list.</li>
<li>If we return the original values in the correct order, we need to parse the full sequence before we can know which will be the first result. A worst-case example:</li>
</ul>
<pre><code class="language-xquery">(0x7FFFFFFFFFFFFFFF, 1, 1 to 0x7FFFFFFFFFFFFFFF)
=&gt; duplicate-values()
=&gt; head()
</code></pre>
</div></details></div>
<div class="toot" id="created-1868"><h2>Issue #1868 created<span class="toot-id"> #created-1868</span></h2><div class="pubdate">12 Mar at 18:19:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1868">https://github.com/qt4cg/qtspecs/issues/1868</a></div><details><summary>array:members() to include index position</summary><div class="markup"><p>Currently <code>array:members(["a", "b"])</code> returns</p>
<pre><code>{'value': "a"},
{'value': "b"}
</code></pre>
<p>I suggest that it should instead return</p>
<pre><code>{'key': 1, 'value': "a"},
{'key': 2, 'value': "b"}
</code></pre>
<p>The extra information is useful for any operation that wants to take account of positions as well as values. For example, rearranging an array into multiple columns. Using the names "key" and "value" also means that the data is suitable for converting an array to a map by means of <code>map:of-pairs</code>.</p>
<p>The function array:of-members() should change to accept <code>record('value', *)</code> (making the record type extensible) so that the key part is ignored if present.</p>
</div></details></div>
<div class="toot" id="created-1867"><h2>Pull request #1867 created<span class="toot-id"> #created-1867</span></h2><div class="pubdate">12 Mar at 18:02:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1867">https://github.com/qt4cg/qtspecs/pull/1867</a></div><details><summary>1341 Drop position from fold callbacks</summary><div class="markup"><p>Following up on issue 1341, we decided to drop the position argument from the 4 fold functions.</p>
<p>Most of the changes in this PR are dealing with the collateral damage - changes to "formal equivalents" of other functions that previously relied on fold-left having the position available to the callback function.</p>
</div></details></div>
<div class="toot" id="created-1866"><h2>Issue #1866 created<span class="toot-id"> #created-1866</span></h2><div class="pubdate">12 Mar at 08:15:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1866">https://github.com/qt4cg/qtspecs/issues/1866</a></div><details><summary>Ambiguities introduced by #1864</summary><div class="markup"><p>The grammar check done by <a href="https://github.com/GuntherRademacher/rex-parser-generator/tree/main/docs/sample-grammars/XQuery-40">RExification of XQuery and XPath 4.0 Grammars</a> has detected a bunch of LALR(2) conflicts caused by the recent addition of <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-TypeSpecifier"><code>TypeSpecifier</code></a> to the <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-KeySpecifier"><code>KeySpecifier</code></a> production.</p>
<p>In fact these are ambiguities between following being used as a <code>QName</code> (via <code>EQName</code>, <code>TypeName</code>), or as a keyword:</p>
<ul>
<li><code>array</code></li>
<li><code>attribute</code></li>
<li><code>comment</code></li>
<li><code>document-node</code></li>
<li><code>element</code></li>
<li><code>empty-sequence</code></li>
<li><code>enum</code></li>
<li><code>fn</code></li>
<li><code>function</code></li>
<li><code>item</code></li>
<li><code>map</code></li>
<li><code>namespace-node</code></li>
<li><code>node</code></li>
<li><code>processing-instruction</code></li>
<li><code>record</code></li>
<li><code>schema-attribute</code></li>
<li><code>schema-element</code></li>
<li><code>text</code></li>
</ul>
<p>E.g. <code>element</code> in</p>
<pre><code>$A?~element()
</code></pre>
<p>can be parsed as an element test, <code>element()</code>, or as a type name <code>element</code> followed by a <code>PositionalArgumentList</code>. This is similar to what the "reserved-function-names" constraint covers, but that does not apply here because there is no function name involved.</p>
<p>The <code>SequenceType</code> in <code>TypeSpecifier</code>, enclosed in extra parenthese, does not present a problem, so my proposal is to drop <code>ItemType</code> from <code>TypeSpecifier</code> and rewrite the production to</p>
<pre><code>TypeSpecifier
         ::= '~' '(' SequenceType ')' 
</code></pre>
</div></details></div>
<div class="toot" id="created-1865"><h2>Issue #1865 created<span class="toot-id"> #created-1865</span></h2><div class="pubdate">11 Mar at 20:37:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><details><summary>Callback functions, position argument: consistency</summary><div class="markup"><ul>
<li>In https://github.com/qt4cg/qtspecs/pull/1735#issuecomment-2715090198, it was decided to remove the position argument from <code>fn:fold-left</code> and <code>fn:fold-right</code>. → #1867</li>
<li>As maps are ordered now, we should add the position argument to iterative map functions (e.g., <code>map:for-each</code>; basically all functions for which equivalent sequence and array functions exist).</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1227"><h2>Issue #1227 closed<span class="toot-id"> #closed-1227</span></h2><div class="pubdate">11 Mar at 17:41:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1227">https://github.com/qt4cg/qtspecs/pull/1227</a></div><p>150 PR resubmission for fn ranks</p></div>
<div class="toot" id="closed-1456"><h2>Issue #1456 closed<span class="toot-id"> #closed-1456</span></h2><div class="pubdate">11 Mar at 17:04:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1456">https://github.com/qt4cg/qtspecs/issues/1456</a></div><p>Filtering by type in lookup expressions</p></div>
<div class="toot" id="closed-1864"><h2>Issue #1864 closed<span class="toot-id"> #closed-1864</span></h2><div class="pubdate">11 Mar at 17:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="closed-1740"><h2>Issue #1740 closed<span class="toot-id"> #closed-1740</span></h2><div class="pubdate">11 Mar at 17:02:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1740">https://github.com/qt4cg/qtspecs/pull/1740</a></div><p>1725b Further elaboration of duplicates handling in maps</p></div>
<div class="toot" id="closed-1735"><h2>Issue #1735 closed<span class="toot-id"> #closed-1735</span></h2><div class="pubdate">11 Mar at 17:02:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><p>1341 Drop $position callback from many functions</p></div>
<div class="toot" id="closed-1794"><h2>Issue #1794 closed<span class="toot-id"> #closed-1794</span></h2><div class="pubdate">11 Mar at 15:16:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1794">https://github.com/qt4cg/qtspecs/issues/1794</a></div><p>Lookup: select all except</p></div>
<div class="toot" id="closed-1778"><h2>Issue #1778 closed<span class="toot-id"> #closed-1778</span></h2><div class="pubdate">10 Mar at 16:22:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1778">https://github.com/qt4cg/qtspecs/pull/1778</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="created-1864"><h2>Pull request #1864 created<span class="toot-id"> #created-1864</span></h2><div class="pubdate">10 Mar at 16:21:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><details><summary>1456 Lookup expressions filtered by type</summary><div class="markup"><p>Fix #1456</p>
<p>Technically identical to PR #1778, but reworked because it had become impossible to resolve the merge conflicts.</p>
</div></details></div></div><p>See 3778
            more statuses in yearly archives.</p></article></main></body></html>
<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2025/">2025</a>, <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="closed-1836"><h2>Issue #1836 closed<span class="toot-id"> #closed-1836</span></h2><div class="pubdate">02 Mar at 19:12:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1836">https://github.com/qt4cg/qtspecs/issues/1836</a></div><p>unparsed-text-lines() - line endings</p></div>
<div class="toot" id="created-1855"><h2>Pull request #1855 created<span class="toot-id"> #created-1855</span></h2><div class="pubdate">02 Mar at 19:06:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1855">https://github.com/qt4cg/qtspecs/pull/1855</a></div><details><summary>1771 Add option for deep-equal to consider map order</summary><div class="markup"><p>Adds an option for deep-equal to treat order of entries in a map as significant.</p>
<p>Fix #1771</p>
</div></details></div>
<div class="toot" id="created-1854"><h2>Issue #1854 created<span class="toot-id"> #created-1854</span></h2><div class="pubdate">28 Feb at 11:37:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1854">https://github.com/qt4cg/qtspecs/issues/1854</a></div><details><summary>Can someone direct me to the motivating use case of objects?</summary><div class="markup"><p>There's a LOT of conversations about "this" and methods and really quite complex syntax, but (despite writing OO software for about 30+ years), I cant think of a motivating use case in the context of XSLT/XQuery.</p>
<ul>
<li>in imperative languages with mutable state...yes</li>
<li>in very large code bases requiring some abstraction/encapsulation - well maybe...there are probably easier ways to do this without 'objects'.</li>
</ul>
<p>this is the sort of canonical example people use (to illustrate simple technical points)</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': fn(){?x * ?y}}</p>
</blockquote>
<p>but actually I would write</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': 10 * 7}</p>
</blockquote>
<p>(and similarly write a data constructor for the record in that manner)</p>
<p>i.e.</p>
<blockquote>
<p>fn($x,$y){'x': $x, 'y': $y, 'area': $x * $y}</p>
</blockquote>
<p>I'm not sure at the moment its worth the effort.</p>
</div></details></div>
<div class="toot" id="created-1853"><h2>Pull request #1853 created<span class="toot-id"> #created-1853</span></h2><div class="pubdate">27 Feb at 10:38:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1853">https://github.com/qt4cg/qtspecs/pull/1853</a></div><details><summary>1845 Revised design of methods to use . rather than $this</summary><div class="markup"><p>Proposal is that in methods, the containing map should be bound to the context item rather than to the special variable $this, so fields of that map are referenced as <code>?x</code> rather than <code>$this?x</code>.</p>
</div></details></div>
<div class="toot" id="created-1852"><h2>Issue #1852 created<span class="toot-id"> #created-1852</span></h2><div class="pubdate">27 Feb at 08:56:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1852">https://github.com/qt4cg/qtspecs/issues/1852</a></div><details><summary>fn:values-except: Return atomic values that occur in A but not in B</summary><div class="markup"><p><code>fn:distinct-values</code> can be used to perform a <code>union</code> on atomic values:</p>
<pre><code class="language-xquery">(: returns 1 to 5 :)
let $one := 1 to 4, $two := 2 to 5
return distinct-values(($one, $two))
</code></pre>
<p>A (roughly) equivalent alternative is <code>$one[. = $two]</code>.</p>
<p><code>fn:duplicate-values</code> can be used for <code>intersect</code>:</p>
<pre><code class="language-xquery">(: returns 2 to 4 :)
let $one := 1 to 4, $two := 2 to 5
return duplicate-values(($one, $two))
</code></pre>
<p>I think we should add an equivalent for <code>except</code> (it requires 2 arguments instead of 1):</p>
<pre><code class="language-xquery">fn:values-except(
  $values     as xs:anyAtomicType*,
  $exclude    as xs:anyAtomicType*,
  $collation  as xs:string?         := fn:default-collation()
) as xs:anyAtomicType*
</code></pre>
<p>An example:</p>
<pre><code class="language-xquery">(: returns 1 :)
let $one := 1 to 4, $two := 2 to 5
return values-except($one, $two)
</code></pre>
<p>In principle, this function can also be written as <code>$one[not(. = $two)]</code>, but a dedicated function will be easier to understand for users and easier to optimize for processors.</p>
</div></details></div>
<div class="toot" id="closed-1247"><h2>Issue #1247 closed<span class="toot-id"> #closed-1247</span></h2><div class="pubdate">26 Feb at 23:55:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1247">https://github.com/qt4cg/qtspecs/issues/1247</a></div><p>`??type(T)` in lookup expressions - shortcuts</p></div>
<div class="toot" id="created-1851"><h2>Issue #1851 created<span class="toot-id"> #created-1851</span></h2><div class="pubdate">26 Feb at 15:42:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1851">https://github.com/qt4cg/qtspecs/issues/1851</a></div><details><summary>Questions on `fn:atomic-type-annotation`</summary><div class="markup"><p>These questions came up while working on <code>fn:atomic-type-annotation</code>:</p>
<ul>
<li>what is the <code>variety</code> of <code>xs:anySimpleType</code>?</li>
<li>should not <code>constructor</code> be absent in an <code>fn:schema-type-record</code> describing <code>xs:QName</code>?</li>
</ul>
<p>Here are the detailed observations:</p>
<h3><code>fn:schema-type-record?variety</code></h3>
<p>Consider the following query:</p>
<pre><code class="language-xquery">  (
    &lt;x&gt;42&lt;/x&gt;
    =&gt; fn:atomic-type-annotation()
  )
  ?base-type()
  ?base-type()
  ?variety
</code></pre>
<p>My interpretation is as follows:</p>
<ul>
<li>the <code>x</code> element node is atomized to a value of type <code>xs:untypedAtomic</code>,</li>
<li>so <code>fn:atomic-type-annotation</code> returns the information for <code>xs:untypedAtomic</code>,</li>
<li>the base type of that is <code>xs:anyAtomicType</code>,</li>
<li>the base type of that is <code>xs:anySimpleType</code>,</li>
<li>per <a href="https://www.w3.org/TR/xmlschema11-1/#sec-anySimpleType">XML schema 1.1, 3.16.7.1 xs:anySimpleType</a>, the <code>{variety}</code> of <code>xs:anySimpleType</code> is absent,</li>
<li>so <code>variety</code> should be absent in an <code>fn:schema-type-record</code> describing <code>xs:anySimpleType</code>,</li>
<li>the result thus should be an empty sequence.</li>
</ul>
<p>According to the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#schema-type-record">current spec</a>, <code>variety</code> must always be present with a value of type <code>enum("atomic", "list", "union", "empty", "simple", "element-only", "mixed")</code>, but also correspond to the <code>{variety}</code> of the simple type in the XSD component model.</p>
<p>Should not <code>variety</code> be optional, and omitted for <code>xs:anySimpleType</code>?</p>
<h3><code>fn:schema-type-record?constructor</code></h3>
<p>The spec says this about <code>constructor</code>:</p>
<blockquote>
<p>The field is absent for complex types and for the abstract types xs:anyAtomicType, xs:anySimpleType, and xs:NOTATION. It is also absent for all namespace-sensitive types, that is, types derived from xs:QName or xs:NOTATION.</p>
</blockquote>
<p>The formulation does not include <code>xs:QName</code>, but should not its constructor be absent for the same reasons as for the types derived from it?</p>
</div></details></div>
<div class="toot" id="created-1850"><h2>Pull request #1850 created<span class="toot-id"> #created-1850</span></h2><div class="pubdate">26 Feb at 12:36:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1850">https://github.com/qt4cg/qtspecs/pull/1850</a></div><details><summary>Actions from meeting 111</summary><div class="markup"><p>[ ] QT4CG-111-01: MK to review the editorial comments on PR #1837 and then merge the PR.</p>
<p>Done (along with a couple of other minor corrections noted in passing)</p>
<p>[ ] QT4CG-111-02: MK to fix the typo $in as xs:double+ and 1.3. 1.4 that middle “.” should be a “,”</p>
<p>Already done before the PR was merged</p>
<p>[ ] QT4CG-111-03: MK to add a %method example that uses the arrow syntax.</p>
<p>Done (though the example isn't especially convincing).</p>
<p>Also added another couple of examples and notes in passing.</p>
</div></details></div>
<div class="toot" id="created-1849"><h2>Pull request #1849 created<span class="toot-id"> #created-1849</span></h2><div class="pubdate">26 Feb at 09:57:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1849">https://github.com/qt4cg/qtspecs/pull/1849</a></div><p>Reduce the indentation in the ToC</p></div>
<div class="toot" id="created-1848"><h2>Issue #1848 created<span class="toot-id"> #created-1848</span></h2><div class="pubdate">26 Feb at 08:31:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1848">https://github.com/qt4cg/qtspecs/issues/1848</a></div><p>Define regular expressions using XSD 1.1 as baseline</p></div>
<div class="toot" id="closed-1800"><h2>Issue #1800 closed<span class="toot-id"> #closed-1800</span></h2><div class="pubdate">25 Feb at 21:17:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1800">https://github.com/qt4cg/qtspecs/issues/1800</a></div><p>The `=?&gt;` lookup arrow expression operator is weird, difficult to use, difficult to understand, difficult to read and unnatural</p></div>
<div class="toot" id="closed-1817"><h2>Issue #1817 closed<span class="toot-id"> #closed-1817</span></h2><div class="pubdate">25 Feb at 21:17:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1817">https://github.com/qt4cg/qtspecs/pull/1817</a></div><p>1800 Methods</p></div>
<div class="toot" id="closed-1843"><h2>Issue #1843 closed<span class="toot-id"> #closed-1843</span></h2><div class="pubdate">25 Feb at 18:20:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1843">https://github.com/qt4cg/qtspecs/issues/1843</a></div><p>XQFO: TOC texts</p></div>
<div class="toot" id="created-1847"><h2>Issue #1847 created<span class="toot-id"> #created-1847</span></h2><div class="pubdate">25 Feb at 18:14:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1847">https://github.com/qt4cg/qtspecs/issues/1847</a></div><details><summary>%method functions: explicit self reference?</summary><div class="markup"><p>This is a discussion issue; I am torn and would be interested in feedback:</p>
<p>With the just added <code>%method</code> annotation, basically two things happen:</p>
<ol>
<li>An implicit <code>$this</code> parameter is preprended to the remaining parameters of a function.</li>
<li>The current map will be bound to the first parameter by the lookup operator.</li>
</ol>
<p>The inner workings of the example in the spec were not entierly obvious in today’s meeting…</p>
<pre><code class="language-xquery">let $area := %method fn() {$this?x * $this?y}                     
return $area({ 'x': 3, 'y': 4 })
</code></pre>
<p>…and I am wondering if we are not more flexible by making the self-referencing parameter explicit. This way, it would be up to the user to decide how the parameter is called…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn($self) { $self?value + 1 } }
return $number?inc()
</code></pre>
<p>…the focus function syntax could be used alternatively…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn { ?value + 1 } }
return $number?inc()
</code></pre>
<p>…and it would allow for a stricter typing (<code>$this as map(*)</code> is not very specific), and thus for better error reporting:</p>
<pre><code class="language-xquery">declare record coord(
  x as xs:double,
  y as xs:double,
  product := %method fn($coord as coord) { $coord?x * $coord?y }
);
coord(3, 4)?product()
</code></pre>
<p>Obviously, it would cause new issues:</p>
<ul>
<li><code>%method fn() {}</code> would need to be made illegal</li>
<li>The type of the first argument would need to be <code>map(*)</code> or a subtype of it.</li>
<li>Users may be led to write…</li>
</ul>
<pre><code class="language-xquery">let $map := { 'fn': %method fn($a, $b) { $a * $b } }
return $map?fn(2, 3)
</code></pre>
<p>On the other hand, the existence of the <code>%method</code> annotation should indicate that this function type differs from others.</p>
<p>If we stick with the invisible <code>$this</code> parameter, I wonder what <code>function-arity(%method fn() {})</code> is supposed to return?</p>
</div></details></div>
<div class="toot" id="created-1846"><h2>Issue #1846 created<span class="toot-id"> #created-1846</span></h2><div class="pubdate">25 Feb at 17:48:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1846">https://github.com/qt4cg/qtspecs/issues/1846</a></div><details><summary>%method functions, dynamic function calls</summary><div class="markup"><p>With the #1817, the <code>%method</code> annotation was introduced for functions. It is interpreted by the lookup operator:</p>
<pre><code class="language-xquery">let $number := { 'value': -3, 'abs': %method fn() { abs($this?value) } }
return $number?abs()
</code></pre>
<p>I think we should extend this mechanism to dynamic function calls, as many people use the constructs interchangeably:</p>
<pre><code class="language-xquery">return $number('abs')()
</code></pre>
<p>I agree that the binding mechanism should not apply for <code>map:get</code> or any other map functions and iterations.</p>
</div></details></div>
<div class="toot" id="closed-1830"><h2>Issue #1830 closed<span class="toot-id"> #closed-1830</span></h2><div class="pubdate">25 Feb at 17:32:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1830">https://github.com/qt4cg/qtspecs/pull/1830</a></div><p>1829 Reintroduce restrictions on RHS of `=&gt;`</p></div>
<div class="toot" id="closed-1815"><h2>Issue #1815 closed<span class="toot-id"> #closed-1815</span></h2><div class="pubdate">25 Feb at 17:29:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1815">https://github.com/qt4cg/qtspecs/issues/1815</a></div><p>Function annotations on function items</p></div>
<div class="toot" id="closed-1828"><h2>Issue #1828 closed<span class="toot-id"> #closed-1828</span></h2><div class="pubdate">25 Feb at 17:29:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1828">https://github.com/qt4cg/qtspecs/pull/1828</a></div><p>1815 Add more detail on annotations of function items</p></div>
<div class="toot" id="closed-1834"><h2>Issue #1834 closed<span class="toot-id"> #closed-1834</span></h2><div class="pubdate">25 Feb at 17:27:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1834">https://github.com/qt4cg/qtspecs/issues/1834</a></div><p>json-lines - refinement</p></div>
<div class="toot" id="closed-1837"><h2>Issue #1837 closed<span class="toot-id"> #closed-1837</span></h2><div class="pubdate">25 Feb at 17:27:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1837">https://github.com/qt4cg/qtspecs/pull/1837</a></div><p>1834 Additional clarification on JSON lines</p></div>
<div class="toot" id="closed-583"><h2>Issue #583 closed<span class="toot-id"> #closed-583</span></h2><div class="pubdate">25 Feb at 17:24:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/583">https://github.com/qt4cg/qtspecs/issues/583</a></div><p>(array|map):replace → *:substitute or *:change</p></div>
<div class="toot" id="closed-1833"><h2>Issue #1833 closed<span class="toot-id"> #closed-1833</span></h2><div class="pubdate">25 Feb at 17:24:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1833">https://github.com/qt4cg/qtspecs/pull/1833</a></div><p>583 Drop map:replace and array:replace</p></div>
<div class="toot" id="closed-1816"><h2>Issue #1816 closed<span class="toot-id"> #closed-1816</span></h2><div class="pubdate">25 Feb at 17:21:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1816">https://github.com/qt4cg/qtspecs/issues/1816</a></div><p>Programmatic partial application</p></div>
<div class="toot" id="closed-1825"><h2>Issue #1825 closed<span class="toot-id"> #closed-1825</span></h2><div class="pubdate">25 Feb at 17:21:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1825">https://github.com/qt4cg/qtspecs/pull/1825</a></div><p>1816 New function fn:partial-apply</p></div>
<div class="toot" id="closed-1818"><h2>Issue #1818 closed<span class="toot-id"> #closed-1818</span></h2><div class="pubdate">25 Feb at 17:18:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1818">https://github.com/qt4cg/qtspecs/issues/1818</a></div><p>Grammar problem introduced by #1802</p></div>
<div class="toot" id="closed-1826"><h2>Issue #1826 closed<span class="toot-id"> #closed-1826</span></h2><div class="pubdate">25 Feb at 17:18:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1826">https://github.com/qt4cg/qtspecs/pull/1826</a></div><p>Fix grammar bug #1818</p></div>
<div class="toot" id="closed-1823"><h2>Issue #1823 closed<span class="toot-id"> #closed-1823</span></h2><div class="pubdate">25 Feb at 17:15:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1823">https://github.com/qt4cg/qtspecs/issues/1823</a></div><p>Clearer top-level section headings in F+O</p></div>
<div class="toot" id="closed-1824"><h2>Issue #1824 closed<span class="toot-id"> #closed-1824</span></h2><div class="pubdate">25 Feb at 17:15:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1824">https://github.com/qt4cg/qtspecs/pull/1824</a></div><p>1823 Revise top-level headings in F+O spec</p></div>
<div class="toot" id="created-1845"><h2>Issue #1845 created<span class="toot-id"> #created-1845</span></h2><div class="pubdate">25 Feb at 17:14:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1845">https://github.com/qt4cg/qtspecs/issues/1845</a></div><details><summary>Should we add additional syntactic sugar for use with %method functions?</summary><div class="markup"><p>During <a href="https://qt4cg.org/meeting/minutes/2025/02-25.html">meeting 111</a>, DN was arguing for additional syntactic sugar when his connection to the call ended abruptly. This issue is to make sure we come back to those discussions.</p>
<p>Specifically, should we allow <code>^x</code> as an abbreviation for <code>$this?x</code> ?</p>
</div></details></div>
<div class="toot" id="closed-1813"><h2>Issue #1813 closed<span class="toot-id"> #closed-1813</span></h2><div class="pubdate">25 Feb at 17:12:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1813">https://github.com/qt4cg/qtspecs/issues/1813</a></div><p>Reorganise top-level sections in XDM</p></div></div><p>See 3724
            more statuses in yearly archives.</p></article></main></body></html>
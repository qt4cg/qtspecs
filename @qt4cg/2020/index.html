<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2020</title></head><body><main><article><h1>@qt4cg statuses in 2020</h1><p>This page displays status
              updates
              about the QT4 CG project from 2020.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="created-41"><h2>Issue #41 created<span class="toot-id"> #created-41</span></h2><div class="pubdate">30 Dec at 10:41:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/41">https://github.com/qt4cg/qtspecs/issues/41</a></div><details><summary>[XQuery] The TypeswitchExpr and CaseClause symbols have repeated VarNames</summary><div class="markup"><p>The TypeswitchExpr symbol has changed as follows:</p>
<pre><code>-TypeswitchExpr ::= "typeswitch" "(" Expr ")" CaseClause+ "default" ("$" VarName)? "return" ExprSingle
+TypeswitchExpr ::= "typeswitch" "(" Expr ")" CaseClause+ "default" ("$" VarName)? "$" VarName "return" ExprSingle
</code></pre>
<p>The CaseClause symbol has changed as follows:</p>
<pre><code>-CaseClause ::= "case" ("$" VarName "as")? SequenceTypeUnion "return" ExprSingle
+CaseClause ::= "case" ("$" VarName "as")? "$" VarName "as" SequenceTypeUnion "return" ExprSingle
</code></pre>
<p>That is, both of these have a repeated <code>"$" VarName ...</code> section from the previous optional section.</p>
<p>Is this an effect of removing the references to the older specifications from the grammar?</p>
</div></details></div>
<div class="toot" id="created-40"><h2>Issue #40 created<span class="toot-id"> #created-40</span></h2><div class="pubdate">29 Dec at 12:19:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/40">https://github.com/qt4cg/qtspecs/issues/40</a></div><details><summary>[XPath] [XQuery] The modified SingleType EBNF symbol is redundant.</summary><div class="markup"><p>The <code>SingleType</code> definition has changed as follows:</p>
<pre><code>-SingleType ::= SimpleTypeName "?"?
+SingleType ::= (SimpleTypeName | LocalUnionType) "?"? 	
</code></pre>
<p>However, <code>SimpleTypeName</code> has also changed:</p>
<pre><code>-SimpleTypeName ::= TypeName
+SimpleTypeName ::= TypeName | LocalUnionType 	
</code></pre>
<p>Therefore, the change to <code>SingleType</code> is not needed.</p>
</div></details></div>
<div class="toot" id="created-39"><h2>Issue #39 created<span class="toot-id"> #created-39</span></h2><div class="pubdate">29 Dec at 11:20:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/39">https://github.com/qt4cg/qtspecs/issues/39</a></div><details><summary>URILiteral is defined in the EBNF grammar but not used</summary><div class="markup"><p>Comparing the WithExpr grammar, XPath has:</p>
<pre><code>[10] NamespaceDeclaration ::= QName  "="  StringLiteral
</code></pre>
<p>whereas XQuery has:</p>
<pre><code>[44] NamespaceDeclaration ::= QName  "="  URILiteral
</code></pre>
<p>Therefore, it looks like the intention is to use URILiteral in the XPath EBNF grammar for <code>NamespaceDeclaration</code> as well.</p>
</div></details></div>
<div class="toot" id="created-38"><h2>Pull request #38 created<span class="toot-id"> #created-38</span></h2><div class="pubdate">28 Dec at 15:30:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/38">https://github.com/qt4cg/qtspecs/pull/38</a></div><details><summary>Create a schema-for-xslt40.xsd file.</summary><div class="markup"><p>This uses schema-for-xslt30.xsd as the basis for adding the new elements and attributes in the current XSLT 4.0 draft.</p>
</div></details></div>
<div class="toot" id="created-37"><h2>Issue #37 created<span class="toot-id"> #created-37</span></h2><div class="pubdate">21 Dec at 12:03:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/37">https://github.com/qt4cg/qtspecs/issues/37</a></div><details><summary>Support sequence, array, and map destructuring declarations</summary><div class="markup"><p>Given a function that returns a sequence, array, or map of a fixed length or structure, it would be useful to extract those values in a destructuring declaration like can be done in other languages (such as JavaScript, Kotlin, C++, and Python). For example:</p>
<pre><code>let $(sin, cos) := sincos(math:pi()) (: sequence :)
let $[x, y, z] := camera-angle() (: array :)
let ${r, i} := complex(1, 2) (: map :)
</code></pre>
<p>These would be equivalent to:</p>
<pre><code>let $ret := sincos(math:pi()), $sin := $ret[1], $cos := $ret[2] (: sequence :)
let $ret := camera-angle(), $x := $ret?(1), $y := $ret?(2), $z := $ret?(3) (: array :)
let $ret := complex(1 ,2), $r := $ret?r, $i := $ret?i (: map :)
</code></pre>
<p>It should be possible to define the type of a component and/or the whole construct:</p>
<pre><code>let $(sin as xs:float, cos) as xs:float* := sincos(math:pi()) (: sequence :)
</code></pre>
<p>For maps, it would also be useful to rename the components, such as:</p>
<pre><code>let ${re := r, im as xs:double := i} := complex(1, 2) (: map :)
</code></pre>
<p>It should also be possible to capture any left-over items in the sequence/array/map, for example:</p>
<pre><code>let $(headings, rows) := load-csv("test.csv")
</code></pre>
<p>A destructuring declaration should be usable anywhere a variable binding can be defined.</p>
<p>It should not be an error to use the same variable name twice. This supports conventions such as using <code>_</code> for unused values. For example:</p>
<pre><code>let $[_, y, _] := camera-angle()
</code></pre>
</div></details></div>
<div class="toot" id="created-36"><h2>Issue #36 created<span class="toot-id"> #created-36</span></h2><div class="pubdate">21 Dec at 11:31:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/36">https://github.com/qt4cg/qtspecs/issues/36</a></div><details><summary>fn:function-annotations (Allow support for user-defined annotations)</summary><div class="markup"><h3>Requirements/Use Cases</h3>
<ol>
<li>It should be possible for a library or application written in XQuery to define, access, and use custom annotations without relying on vendor extensions.</li>
<li>It should be possible for a processor or editor/IDE to check and verify user-defined annotation usage (can an annotation be used multiple times; what argument values/types are valid) to provide better validation for custom annotations.</li>
<li>It should be possible to access the details of the annotations on a function (name, argument values) so tools like xqDoc can read and format annotations without using vendor extensions.</li>
</ol>
<h3>Annotation Declarations</h3>
<ol>
<li>An annotation declaration is a function declared using the <code>%annotation</code> annotation.</li>
<li>Annotation parameters must be a SequenceType that has an ItemType which is either a) a subtype of <code>union(xs:string, xs:double, xs:float, xs:decimal)*</code>, or b) <code>item()</code> (to denote any permitted literal value). <strong>Note:</strong> This is because annotation values are restricted to literal values. <strong>Note:</strong> It is therefore possible to use an EnumerationType to define a set of allowed string values (e.g. "yes" and "no").</li>
<li>If a function annotation name matches an annotation declaration in the statically-known functions using the function name resolver, it is verified using the same rules for static function calls; if there are no matching annotation declarations, then no error is issued, although an implementation may choose to issue a warning.</li>
</ol>
<h3>Annotation Tests</h3>
<ol>
<li>A new AnnotationTest (<code>annotation(...)</code>) SequenceType is provided with the same structure and semantics as a FunctionTest.</li>
<li>AnnotationTest parameters must be a SequenceType that has an ItemType which is either a) a subtype of <code>union(xs:string, xs:double, xs:float, xs:decimal)*</code>, or b) <code>item()</code> (to denote any permitted literal value). <strong>Note:</strong> This is because annotation values are restricted to literal values. <strong>Note:</strong> It is therefore possible to use an EnumerationType to define a set of allowed string values (e.g. "yes" and "no").</li>
</ol>
<h3>fn:annotations</h3>
<blockquote>
<p><code>fn:annotations($f as function(*)) as annotation(*)*</code></p>
</blockquote>
<p>Returns all the annotations on the function.</p>
<p>The <code>annotation</code> signature will match the signature of the annotation, so <code>%a(1, 2)</code> will have the <code>annotation(xs:integer, xs:integer)</code> annotation type.</p>
<p>If a function has multiple annotations with the same signature (e.g. <code>%values(1) %count(2)</code>) then two annotations will be returned with the same signature, referring to the different annotations.</p>
<h3>fn:annotation</h3>
<blockquote>
<p><code>fn:annotation($f as function(*), $name as xs:QName) as annotation(*)*</code></p>
</blockquote>
<p>Returns all the annotations on the function with the name <code>$name</code>.</p>
<p>The <code>annotation</code> signature will match the signature of the annotation, so <code>%a(1, 2)</code> will have the <code>annotation(xs:integer, xs:integer)</code> annotation type.</p>
<p>If a function has multiple annotations with the same name and signature (e.g. <code>%values(1) %values(2)</code>) then two annotations will be returned with the same signature, referring to the different annotations.</p>
<h3>fn:annotation-name</h3>
<blockquote>
<p><code>fn:annotation-name($annotation as annotation(*)) as xs:QName</code></p>
</blockquote>
<p>Returns the name of the annotation.</p>
<h3>fn:annotation-arguments</h3>
<blockquote>
<p><code>fn:annotation-arguments($annotation as annotation(*)) as array(*)</code></p>
</blockquote>
<p>Returns the arguments passed to the associated annotation.</p>
</div></details></div>
<div class="toot" id="created-35"><h2>Issue #35 created<span class="toot-id"> #created-35</span></h2><div class="pubdate">21 Dec at 01:08:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/35">https://github.com/qt4cg/qtspecs/issues/35</a></div><details><summary>[FO]The `union ( | )`, `itersect`, `except`  and `combine (,)` operators are not mentioned in the F &amp; O. Have not the best categorization in the XPath spec.</summary><div class="markup"><ol>
<li>
<p>Searching the F &amp; O document for the <code>union </code> ( <code>|</code> ), <code>intersect </code> and <code>except</code> operators finds 0 occurrences. Neither can <code>,</code> be found, and of course, it is unsearchable.</p>
</li>
<li>
<p>In the XPath spec these are described in section "4.7.3 Combining Node Sequences". The word node-set is not mentioned at all and this is misleading, because the <code>union </code> ( <code>|</code> ), <code>intersect </code> and <code>except</code> operators are in fact set-operators, or at least set-generating operators.</p>
</li>
</ol>
<p>Thanks,
Dimitre</p>
</div></details></div>
<div class="toot" id="created-34"><h2>Issue #34 created<span class="toot-id"> #created-34</span></h2><div class="pubdate">19 Dec at 23:54:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/34">https://github.com/qt4cg/qtspecs/issues/34</a></div><details><summary>Proposal to introduce the set datatype in XPath 4</summary><div class="markup"><p><strong>It is high time</strong> that we come up with a <strong>set</strong> type in XPath. We actually have to deal all the time with sets (not just node-sets, but sets of any-type values), and it is painful to read in the spec how two maps are compared for equality when explaing <code>fn:deep-equal()</code>:</p>
<p>"<em>If $i1 and $i2 are both Â·mapsÂ·, the result is true if and only if all the following conditions apply:</em></p>
<p><em>Both maps have the same number of entries.</em></p>
<p><em>For every entry in the first map, there is an entry in the second map that:</em></p>
<p><em>has the Â·same keyÂ· (note that the collation is not used when comparing keys), and</em></p>
<p><em>has the same associated value (compared using the fn:deep-equal function, under the collation supplied in the original call to fn:deep-equal).</em>"</p>
<p>When if we had the set type the above would simply say:</p>
<p>"<em>If $i1 and $i2 are both Â·mapsÂ·, the result is true if and only if the sets of their keys are equal, and the corresponding values for each key in the two maps are deep-equal.</em>"</p>
<p><strong>I propose that starting with XPath 4.0</strong> we introduce the <strong>set</strong> type and define set equality, the union ( <strong>|</strong> ), intersection (<strong>intersect</strong>) and set difference (<strong>except</strong>) not only for node-sets but for sets of any-typed values.</p>
<p>Then we can have a function: <strong><code>to-set($collection as item()*) as set</code></strong>, which would produce a set (of the distinct values) of any collection-typed argument supplied to it: sequence(its distinct values) , map (a set of its entries), array (a set of its members).</p>
<p>This makes <code>fn:distinct-values()</code> almost unnecessary.</p>
<p>We will no longer have to explain in a "Remarks" section that the result of a function is "unordered" or that its order is "implementation-defined" -- just by making this function return a <strong>set</strong>.</p>
<p>How can almost all major programming languages (not even speaking of SQL), such as C#, Python and Java have a set data type / interface, but even in XPath version 4 we still have to describe it in a free language narrative?</p>
<p>Thanks,
Dimitre</p>
</div></details></div>
<div class="toot" id="created-33"><h2>Issue #33 created<span class="toot-id"> #created-33</span></h2><div class="pubdate">18 Dec at 20:16:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/33">https://github.com/qt4cg/qtspecs/issues/33</a></div><details><summary>json parsing number type option</summary><div class="markup"><p>Sometimes people put very large numbers in a JSON file, if they are parsed as double, the numbers are corrupted. Or they become confused when <code>1000000</code> from the input becomes <code>1e6</code> in the output. Finally parsing a double is slower  than parsing an integer.</p>
<p>There could be an additional option for parse-json/json-doc  <code>number-type</code> with possible values:</p>
<ul>
<li><code>double</code>: Parse all numbers as <code>xs:double</code></li>
<li><code>decimal</code>: Parse all numbers as <code>xs:decimal</code></li>
<li><code>string</code>: Return numbers as <code>xs:string</code> (so <code>1e6</code> stays <code>"1e6"</code> and <code>1000000</code> stays <code>"1000000"</code>)</li>
<li><code>auto</code>: Parse numbers containing <code>e</code> as <code>xs:double</code>, numbers containing <code>.</code> as <code>xs:decimal</code>, and numbers containing neither as <code>xs:integer</code></li>
</ul>
</div></details></div>
<div class="toot" id="created-32"><h2>Issue #32 created<span class="toot-id"> #created-32</span></h2><div class="pubdate">18 Dec at 16:28:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/32">https://github.com/qt4cg/qtspecs/issues/32</a></div><details><summary>try/catch: New variable for all error information</summary><div class="markup"><p>Within the scope of a catch clause, some variables are implicitly declared. However, itâ€™s more than tedious to forward all this information to another function:</p>
<pre><code class="language-xquery">try {
  'oh' + 'dear'
} catch * {
  handle-error($err:code, $err:description, $err:line-number, $err:column-number, ...)
}
</code></pre>
<p>What about binding all data to an additional <code>$err:map</code> variable?</p>
<pre><code class="language-xquery">map {
  'code': $err:code,
  'value': $err:value,
  'description': $err:description,
  'line-number': $err:line-number,
  'column-number': $err:column-number,
  'additional': $err:additional
}
</code></pre>
<p>The code could then be shortened to:</p>
<pre><code class="language-xquery">try {
  'oh' + 'yes'
} catch * {
  handle-error($err:map)
}
</code></pre>
</div></details></div>
<div class="toot" id="created-31"><h2>Issue #31 created<span class="toot-id"> #created-31</span></h2><div class="pubdate">18 Dec at 12:53:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/31">https://github.com/qt4cg/qtspecs/issues/31</a></div><details><summary>Extend FLWOR expressions to maps</summary><div class="markup"><p>With the addition of the <code>for member</code> syntax for arrays, it is possible to use a ForExpr/FLWORExpr to enumerate the contents of sequences and arrays, but not maps. In order to be consistent and symmetric across these types, the <code>for member</code> syntax should be extended to support maps by enumerating the key/value entries of the map.</p>
<p>Given a map of type <code>map(K, V)</code> the member RecordTest would be <code>record(key as K, value as V)</code>. Given a map of type <code>map(*)</code>, the member RecordTest would be <code>record(key, value)</code>.</p>
<p>This would allow a user to write expressions like:</p>
<pre><code>for member $entry in $map
return element { $entry?key } { $entry?value }
</code></pre>
<p><strong>NOTE:</strong> With the addition of the <code>array:values</code> and <code>map:entries</code> functions in issue #29, it is possible to avoid the need of the <code>for member</code> syntax for arrays and maps, but may be worth keeping for people who prefer the wordy style of the XPath/XQuery syntax.</p>
</div></details></div>
<div class="toot" id="created-30"><h2>Issue #30 created<span class="toot-id"> #created-30</span></h2><div class="pubdate">18 Dec at 12:28:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/30">https://github.com/qt4cg/qtspecs/issues/30</a></div><details><summary>Improve the discoverability and parseability of the mathematical operator symbols</summary><div class="markup"><p>In order to keep the XPath and XQuery languages parseable without the need of a pre-processing step, the operators should be integrated into the grammar, such as in:</p>
<pre><code>[29] UnionExpr ::= IntersectExceptExpr ( ("union" |  "|" | "âˆª") IntersectExceptExpr )*
</code></pre>
<p>To make them more easily discoverable to someone reading the specification, the behaviour of the Unicode aliases should be included the description in the text related to that section. For example:</p>
<blockquote>
<p>The union, |, and âˆª operators are equivalent. They take two node sequences as operands and return a sequence containing all the nodes that occur in either of the operands.</p>
</blockquote>
<p><strong>NOTE:</strong> With the introduction of the <code>LocalUnionType</code>, a pre-processing step would need to map <code>âˆª</code> to <code>|</code> in order to avoid <code>âˆª(xs:string, xs:integer)</code> being valid. -- This would then mean that things like the <code>CatchErrorList</code> would then be able to use <code>âˆª</code>, as in <code>try {} catch err:FOER0001 âˆª err:FOER0002 {}</code>.</p>
</div></details></div>
<div class="toot" id="created-29"><h2>Issue #29 created<span class="toot-id"> #created-29</span></h2><div class="pubdate">18 Dec at 11:51:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/29">https://github.com/qt4cg/qtspecs/issues/29</a></div><details><summary>array:values (resolved: map:values, map:entries)</summary><div class="markup"><p><strong>EDIT:</strong> Revised and aligned with the recently added and proposed map and array functions (#314, #357):</p>
<p>The suggested functions are based on the observations that:</p>
<ul>
<li>users who prefer readable function names tend to reject <code>?*</code> as handy shortcut;</li>
<li>functions are often more flexible and better composable than FLWOR enhancements (but of course both could be added).</li>
</ul>
<h2>array:values</h2>
<h3>Summary</h3>
<p>Returns all members of an array as a sequence. Equivalent to <code>$array?*</code>, but better composable and easier to read (especially for newcomers), and known from other programming languages.</p>
<h3>Signature</h3>
<pre><code class="language-xquery">array:values($array as array(*)) as item()*
</code></pre>
<h3>Example</h3>
<pre><code class="language-xquery">(: Query :)
let $array := [ (), 2, [ 3, 4 ] ]
return array:values($array)

(: Result :)
2
[ 3, 4 ]
</code></pre>
<h2>map:values</h2>
<h3>Summary</h3>
<p>Returns all values of a map as a sequence. Complementary to <code>map:keys</code>, and equivalent to <code>$map?*</code>, but better composable and easier to read (especially for newcomers), and known from other programming languages.</p>
<h3>Signature</h3>
<pre><code class="language-xquery">map:values($map as map(*)) as item()*
</code></pre>
<h3>Example</h3>
<pre><code class="language-xquery">(: Query :)
let $map := map { 'a': (), 'b': 2, 'c': [ 3, 4 ] }
return map:values($map)

(: Result :)
2
[ 3, 4 ]
</code></pre>
<h2>map:entries</h2>
<p>See #357 on composing and decomposing <em>Key-Value Records</em>.</p>
<h3>Summary</h3>
<p>Returns each entry of a map as a singleton map. Equivalent to <code>map:for-each($map, map:entry#2)</code>.</p>
<h3>Signature</h3>
<pre><code class="language-xquery">map:entries($map as map(*)) as map(*)*
</code></pre>
<h3>Example</h3>
<pre><code class="language-xquery">(: Query :)
let $map := map { 'a': (), 'b': 2, 'c': [ 3, 4 ] }
for $entry in map:entries($map)
return element { map:keys($entry) } { string-join(map:values($entry)) }

(: Result :)
&lt;a/&gt;
&lt;b&gt;2&lt;/b&gt;
&lt;c&gt;34&lt;/c&gt;
</code></pre>
<h2>array:members</h2>
<p>See #314.</p>
</div></details></div>
<div class="toot" id="created-28"><h2>Pull request #28 created<span class="toot-id"> #created-28</span></h2><div class="pubdate">17 Dec at 19:49:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/28">https://github.com/qt4cg/qtspecs/pull/28</a></div><details><summary>[XPath] Support multiple clauses in ForExpr and LetExpr.</summary><div class="markup"><p>This implements the proposal in issue #22 to support multiple clauses in XPath ForExpr and LetExpr, with both the grammar and specification text changes.</p>
</div></details></div>
<div class="toot" id="created-27"><h2>Pull request #27 created<span class="toot-id"> #created-27</span></h2><div class="pubdate">17 Dec at 17:49:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/27">https://github.com/qt4cg/qtspecs/pull/27</a></div><details><summary>Fix references to ArgumentPlaceholder in the specifications.</summary><div class="markup"><p>This fixes issue #24.</p>
</div></details></div>
<div class="toot" id="created-26"><h2>Issue #26 created<span class="toot-id"> #created-26</span></h2><div class="pubdate">17 Dec at 15:48:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/26">https://github.com/qt4cg/qtspecs/issues/26</a></div><details><summary>[XPath]A value in the last row (for "sequence-variadic" functions) of the table "Number of Arguments allowed in a Function Call" is incorrect</summary><div class="markup"><p>In another issue ( #25 ) it was already discussed that the proposed "sequence-variadic" functions have definite problems.</p>
<p><strong>This issue is about the incorrect value in the MaxK column of the "sequence-variadic" (last) row of the table titled "Number of Arguments allowed in a Function Call", which is in the section "<a href="https://qt4cg.org/branch/master/xquery-40/xpath-40-diff.html#id-static-functions">4.4.1 Static Functions</a></strong>".</p>
<p>As published, the value of the 7th (last, for the MaxK column) item in this row is 0.</p>
<p>In fact all of the required positional arguments can be entered as keyword arguments in a function call (there is no reason why this cannot/shouldn't be done).</p>
<p>Thus, the value for MaxK (the maximum number of keyword arguments) must be R, (the current value of 0 is wrong).</p>
<p><strong>Proposed corrective action</strong>:</p>
<ol>
<li>Replace "sequence-variadic" with "array-variadic", which avoids the problems of "sequence-variadic" (as discussed in #25 )</li>
<li>In the row for "array-variadic" of the table, specify R as the value for the column MaxK</li>
</ol>
</div></details></div>
<div class="toot" id="created-25"><h2>Issue #25 created<span class="toot-id"> #created-25</span></h2><div class="pubdate">17 Dec at 05:13:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/25">https://github.com/qt4cg/qtspecs/issues/25</a></div><details><summary>[XPath] `%variadic("sequence")` does not allow specifying some argument values in the variadic sequence, and in one case even not the variadic sequence itself</summary><div class="markup"><p><strong>The current specification for sequence variadic functions (at: https://qt4cg.org/branch/master/xquery-40/xpath-40-diff.html#id-static-functions) has the following issues</strong>:</p>
<ol>
<li>An empty sequence cannot be specified into the sequence of variadic arguments</li>
<li>Even the last (sequence) argument that is supposed to contain the variadic arguments "disappears" when no variadic argument is specified on the function call</li>
</ol>
<p>This results in difficulties to describe, explain and implement such sequence-variadic functions, and in inability to provide any argument value (like the empty sequence) within the last, sequence argument.</p>
<p><strong>Proposed improvement</strong>, which doesn't have the above problems:</p>
<p>Use <strong><em>array-variadic</em></strong> functions instead of sequence-variadic:</p>
<p><code>%variadic("array")</code> indicates that the function is <em>array-variadic</em>. An <em>array-variadic</em> function declares one or more parameters, of which the last must be an array. If the declaration includes N parameters, then a call on the function may supply N-1 or more arguments. However, the effective call always consists of N arguments, the first N-1 of which are the values for the positional parameters of the function, and the Nth argument is an array that contains all provided variadic arguments.</p>
<p>Why an <em>array-variadic</em> function doesn't have the problems 1 and 2 above?</p>
<ol>
<li>An empty sequence can be specified in the last argument, for example: [1, (), 2]. For example:
<code>myFun($posArg1, $posArg2, ..., $posArgN_minus_1, [1, (), 2])</code></li>
<li>When no variadic arguments are supplied, the last argument of the effective function call is still supplied -- it is the empty array. For example:  <code>myFun($posArg1, $posArg2, ..., $posArgN_minus_1, [])</code></li>
</ol>
</div></details></div>
<div class="toot" id="created-24"><h2>Issue #24 created<span class="toot-id"> #created-24</span></h2><div class="pubdate">17 Dec at 00:23:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/24">https://github.com/qt4cg/qtspecs/issues/24</a></div><details><summary>[XPath] [XQuery] The unknown ArgumentPlaceHolder EBNF symbol is referred to in several places</summary><div class="markup"><p>The references to <code>ArgumentPlaceHolder</code> should have a lower case <code>h</code> to match the EBNF symbol name <code>ArgumentPlaceholder</code> in the grammar.</p>
<p>Kind regards,
Reece</p>
</div></details></div>
<div class="toot" id="created-23"><h2>Issue #23 created<span class="toot-id"> #created-23</span></h2><div class="pubdate">17 Dec at 00:04:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/23">https://github.com/qt4cg/qtspecs/issues/23</a></div><details><summary>Extending element and attribute tests to NameTest unions</summary><div class="markup"><p>In the XPath and XQuery drafts the element and attribute tests have been extended to support any NameTest, meaning they now support all wildcard forms, which is great.</p>
<p>It is possible to write a path expression that takes a union of different paths -- such as <code>html//(ol|ul)</code> -- however it is not possible to define a precise type that accepts that path expression in variables, parameters, or return types, so if a user does specify a type some type information is lost during the static analysis phase.</p>
<p>As such, I propose renaming <code>CatchErrorList</code> to <code>NameTestUnion</code> and making <code>ElementTest</code> and <code>AttributeTest</code> accept a <code>NameTestUnion</code>:</p>
<pre><code>[86] CatchClause ::= "catch" NameTestUnion EnclosedExpr
[87] NameTestUnion ::= NameTest ("|" NameTest)*
[212] AttributeTest ::= "attribute" "(" (NameTestUnion ("," TypeName)?)? ")"
[215] ElementTest ::= "element" "(" (NameTestUnion ("," TypeName "?"?)?)? ")"
</code></pre>
<p>Kind regards,
Reece</p>
</div></details></div>
<div class="toot" id="created-22"><h2>Issue #22 created<span class="toot-id"> #created-22</span></h2><div class="pubdate">17 Dec at 00:01:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/22">https://github.com/qt4cg/qtspecs/issues/22</a></div><details><summary>[XPath] Allowing multiple let clauses in LetExpr and for clauses in ForExpr</summary><div class="markup"><p>Currently, it is possible to have multiple <code>SimpleLetBinding</code>s in a <code>SimpleLetClause</code>, but not have multiple <code>SimpleLetClause</code>s in a <code>LetExpr</code>. The same applies for <code>ForExpr</code>.</p>
<p>I propose that this should be possible. In other words, make the following changes to the XPath 4.0 grammar:</p>
<pre><code>[12] ForExpr ::= SimpleForClause SimpleForClause* "return" ExprSingle
[15] LetExpr ::= SimpleLetClause SimpleLetClause* "return" ExprSingle
</code></pre>
<p>This way, a user can write the following in XPath 4.0:</p>
<pre><code>let $x := 1.0
let $y := 2.0
return $x + $y
</code></pre>
<p>in addition to the following in XPath 3.1 and earlier:</p>
<pre><code>let $x := 1.0, $y := 2.0
return $x + $y
</code></pre>
<p>Note that this does not add any new capability to XPath (in particular, for and let clauses cannot be mixed like in XQuery) as a user can define multiple let or for clauses, it just provides them with an alternative way of expressing that like they can do in XQuery (where it is common to use a series of let clauses instead of let bindings for multiple local variables).</p>
<p>Kind regards,
Reece</p>
</div></details></div>
<div class="toot" id="created-21"><h2>Issue #21 created<span class="toot-id"> #created-21</span></h2><div class="pubdate">16 Dec at 23:59:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/21">https://github.com/qt4cg/qtspecs/issues/21</a></div><details><summary>New reserved function names</summary><div class="markup"><p>In section A.3 (Reserved Function Names) of the XPath 4.0 and XQuery 4.0 draft specifications, the tuple and union keywords have been added.</p>
<p>I don't think these (or more accurately, the keywords for the new item type constructs) are needed, as they cannot currently be used in places where functions can. Only KindTests can appear as path expressions, and the only other reserved names should be for other types of expression (if, switch, typeswitch, etc.).</p>
<p>From a similar reasoning, the following keywords should be able to be removed from the list as they are also only ItemTypes/SequenceTypes:</p>
<ol>
<li>array</li>
<li>empty-sequence</li>
<li>map</li>
</ol>
<p>Kind regards,
Reece</p>
</div></details></div>
<div class="toot" id="created-20"><h2>Issue #20 created<span class="toot-id"> #created-20</span></h2><div class="pubdate">16 Dec at 23:56:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/20">https://github.com/qt4cg/qtspecs/issues/20</a></div><details><summary>Highlight EBNF grammar differences in the diff versions of the specs</summary><div class="markup"><p>The diff versions of the specs highlight what has changed in the wording of the specifications, which is useful, but don't highlight the differences in the EBNF grammar. This makes it harder for implements and tool vendors to work out what has changed in the grammar to then know what changes need to be made to the lexer and parser in order to support the new constructs.</p>
</div></details></div>
<div class="toot" id="created-19"><h2>Issue #19 created<span class="toot-id"> #created-19</span></h2><div class="pubdate">14 Dec at 18:04:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/19">https://github.com/qt4cg/qtspecs/issues/19</a></div><details><summary>[xslt] annotation-prefixes</summary><div class="markup"><p>By analogy with Schema  annotations, i'd like to see an annotation-prefixes attribute on xsl:stylesheet/transform containing a space-separated list of NCName namespace prefixes that are associated with annotations; the XSLT processor would discard these elements (including children) during compilation. Here's a rough go at some text.</p>
<p>The purpose is to be able to include annotations at any level where elements are allowed - for example, inside an xl:variable  or template or function body. Annotations might include XTest unit tests, Schmatron rules, human-readable documentation, CSS styles, or more, and could be used by other operations than the XSLT transformation: for  example, by processing the XSLT source itself with XSLT.</p>
<p>It should be possible for the same element to be both an extension element and an annotation, but the behaviour is implementation-dependent in this case (for example, an API might allow an extension to access content or convert the annotation elements to something else on compilation).</p>
<p>XSLT instructions occurring inside annotation elements are ignored along with other content, except for xsl:fallback instructions (and their contents) if the prefix was also declared as an extension prefix and no matching extension was found. Similarly, extension attributes are discarded. The fallback behaviour might be used to support an XSLT-based implementation, for example by reading the XSLT source and processing embedded Schematron tests.</p>
<p>Attributes of annotation elements are not considered to be attribute value templates and content is not considered to be text value templates - that is, { and } are not special. However, an annotation element or attribute backed by an extension could perform such processing if an implementation supported it.  The behaviour of shadow annotation attributes and xsl:use-when is implementation defined, but expressions contained in them must be processed as elsewhere.</p>
</div></details></div>
<div class="toot" id="created-18"><h2>Issue #18 created<span class="toot-id"> #created-18</span></h2><div class="pubdate">11 Dec at 10:05:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/18">https://github.com/qt4cg/qtspecs/issues/18</a></div><details><summary>[DM31] Function types do not form a hierarchy</summary><div class="markup"><p>Section Â§2.8.1 in the XDM specification states "The space of all possible function signatures forms a hierarchy of function types. "</p>
<p>This is clearly incorrect. It's a directed acyclic graph. (It's not even a lattice, because there is no minimum or maximum - there is no function signature that is a supertype of all others, nor is there one that is a subtype of all others). (I think there is one lattice for each possible arity.)</p>
</div></details></div>
<div class="toot" id="created-17"><h2>Issue #17 created<span class="toot-id"> #created-17</span></h2><div class="pubdate">10 Dec at 09:44:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/17">https://github.com/qt4cg/qtspecs/issues/17</a></div><details><summary>readme</summary><div class="markup"><p>The readme needs an update</p>
<p>Link to the 4.0 html spec files rather than the 3.1 spec</p>
</div></details></div>
<div class="toot" id="closed-16"><h2>Issue #16 closed<span class="toot-id"> #closed-16</span></h2><div class="pubdate">09 Dec at 09:36:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/16">https://github.com/qt4cg/qtspecs/pull/16</a></div><p>More build fixes</p></div>
<div class="toot" id="created-16"><h2>Pull request #16 created<span class="toot-id"> #created-16</span></h2><div class="pubdate">09 Dec at 09:35:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/16">https://github.com/qt4cg/qtspecs/pull/16</a></div><details><summary>More build fixes</summary><div class="markup"><p>More ðŸ¤¦</p>
</div></details></div>
<div class="toot" id="closed-15"><h2>Issue #15 closed<span class="toot-id"> #closed-15</span></h2><div class="pubdate">09 Dec at 08:49:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/15">https://github.com/qt4cg/qtspecs/pull/15</a></div><p>Fix errors in stylesheet execution</p></div>
<div class="toot" id="created-15"><h2>Pull request #15 created<span class="toot-id"> #created-15</span></h2><div class="pubdate">09 Dec at 08:49:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/15">https://github.com/qt4cg/qtspecs/pull/15</a></div><details><summary>Fix errors in stylesheet execution</summary><div class="markup"><p>ðŸ¤¦</p>
</div></details></div>
<div class="toot" id="closed-14"><h2>Issue #14 closed<span class="toot-id"> #closed-14</span></h2><div class="pubdate">07 Dec at 10:25:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/14">https://github.com/qt4cg/qtspecs/pull/14</a></div><p>Refactor build scripts to avoid out-of-memory errors</p></div>
<div class="toot" id="created-14"><h2>Pull request #14 created<span class="toot-id"> #created-14</span></h2><div class="pubdate">07 Dec at 10:25:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/14">https://github.com/qt4cg/qtspecs/pull/14</a></div><p>Refactor build scripts to avoid out-of-memory errors</p></div>
<div class="toot" id="closed-13"><h2>Issue #13 closed<span class="toot-id"> #closed-13</span></h2><div class="pubdate">04 Dec at 17:16:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/13">https://github.com/qt4cg/qtspecs/pull/13</a></div><p>Cleanup some build errors</p></div>
<div class="toot" id="created-13"><h2>Pull request #13 created<span class="toot-id"> #created-13</span></h2><div class="pubdate">04 Dec at 17:16:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/13">https://github.com/qt4cg/qtspecs/pull/13</a></div><details><summary>Cleanup some build errors</summary><div class="markup"><p>I think this PR fixes the build errors. (CircleCI is having issues at the moment, and I know that master is currently broken, so I'm just going to merge this and hope!)</p>
</div></details></div>
<div class="toot" id="closed-11"><h2>Issue #11 closed<span class="toot-id"> #closed-11</span></h2><div class="pubdate">04 Dec at 17:00:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/11">https://github.com/qt4cg/qtspecs/pull/11</a></div><p>Cleanup build artifacts and remove a few more specs</p></div>
<div class="toot" id="closed-12"><h2>Issue #12 closed<span class="toot-id"> #closed-12</span></h2><div class="pubdate">04 Dec at 13:46:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/12">https://github.com/qt4cg/qtspecs/pull/12</a></div><p>Fix typo in spec reference</p></div>
<div class="toot" id="created-12"><h2>Pull request #12 created<span class="toot-id"> #created-12</span></h2><div class="pubdate">04 Dec at 13:46:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/12">https://github.com/qt4cg/qtspecs/pull/12</a></div><details><summary>Fix typo in spec reference</summary><div class="markup"><p>Spec identifiers are case sensitive.</p>
</div></details></div>
<div class="toot" id="created-11"><h2>Pull request #11 created<span class="toot-id"> #created-11</span></h2><div class="pubdate">04 Dec at 12:53:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/11">https://github.com/qt4cg/qtspecs/pull/11</a></div><details><summary>Cleanup build artifacts and remove a few more specs</summary><div class="markup"><ul>
<li>Delete rafts of build artifacts (all the html and build directoies)</li>
<li>Remove a few more specs we're unlikely to edit</li>
<li>Make sure the builds work even if the html and build directories are initially missing</li>
</ul>
</div></details></div>
<div class="toot" id="created-10"><h2>Issue #10 created<span class="toot-id"> #created-10</span></h2><div class="pubdate">03 Dec at 18:25:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/10">https://github.com/qt4cg/qtspecs/issues/10</a></div><details><summary>[FO] fn:filter with a function returning empty sequence</summary><div class="markup"><p>filter has signature:</p>
<pre><code>fn:filter($seq as item()*, $f as function(item()) as xs:boolean) as item()*
</code></pre>
<p>It could easily be changed to:</p>
<pre><code>fn:filter($seq as item()*, $f as function(item()) as xs:boolean?) as item()*
</code></pre>
<p>with <code>()</code> meaning <code>false()</code>.</p>
<p>Then it could be used with a map to pick elements from the seq. E.g.</p>
<pre><code>filter(1 to 10, map {3: true(), 4: true()}) 
</code></pre>
<p>~&gt; (3, 4)</p>
<pre><code>filter(("a", "b", "b", "c", "d"), map {"b": true(), "d": true()}) 
</code></pre>
<p>~&gt; ("b", "b", "d")</p>
<p>Same for array:filter</p>
</div></details></div>
<div class="toot" id="closed-9"><h2>Issue #9 closed<span class="toot-id"> #closed-9</span></h2><div class="pubdate">03 Dec at 12:48:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/9">https://github.com/qt4cg/qtspecs/pull/9</a></div><p>Build fixes</p></div>
<div class="toot" id="created-9"><h2>Pull request #9 created<span class="toot-id"> #created-9</span></h2><div class="pubdate">03 Dec at 12:48:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/9">https://github.com/qt4cg/qtspecs/pull/9</a></div><details><summary>Build fixes</summary><div class="markup"><p>This PR fixes the publication date, cleans up a few other details, and makes the generated index more robust. It also publishes all of the new specs.</p>
</div></details></div>
<div class="toot" id="closed-8"><h2>Issue #8 closed<span class="toot-id"> #closed-8</span></h2><div class="pubdate">03 Dec at 05:30:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/8">https://github.com/qt4cg/qtspecs/pull/8</a></div><p>Updated CI config and automatically publish changes</p></div>
<div class="toot" id="created-8"><h2>Pull request #8 created<span class="toot-id"> #created-8</span></h2><div class="pubdate">03 Dec at 05:29:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/8">https://github.com/qt4cg/qtspecs/pull/8</a></div><p>Updated CI config and automatically publish changes</p></div>
<div class="toot" id="closed-7"><h2>Issue #7 closed<span class="toot-id"> #closed-7</span></h2><div class="pubdate">02 Dec at 14:16:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/7">https://github.com/qt4cg/qtspecs/pull/7</a></div><p>Enable automatic builds at CircleCI</p></div>
<div class="toot" id="created-7"><h2>Pull request #7 created<span class="toot-id"> #created-7</span></h2><div class="pubdate">02 Dec at 14:15:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/7">https://github.com/qt4cg/qtspecs/pull/7</a></div><details><summary>Enable automatic builds at CircleCI</summary><div class="markup"><p>Just more infrastructure work.</p>
</div></details></div>
<div class="toot" id="closed-6"><h2>Issue #6 closed<span class="toot-id"> #closed-6</span></h2><div class="pubdate">02 Dec at 12:50:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/6">https://github.com/qt4cg/qtspecs/pull/6</a></div><p>Build improvements</p></div>
<div class="toot" id="created-6"><h2>Pull request #6 created<span class="toot-id"> #created-6</span></h2><div class="pubdate">02 Dec at 12:06:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/6">https://github.com/qt4cg/qtspecs/pull/6</a></div><details><summary>Build improvements</summary><div class="markup"><ol>
<li>Remove old specs</li>
<li>Refactor a few ant tasks so that they will work in gradle</li>
<li>Fix a few markup errors</li>
<li>Add a top-level gradle build that publishes the specs</li>
</ol>
<p>More work will be needed to automate publication, but this is a start.</p>
</div></details></div>
<div class="toot" id="created-5"><h2>Issue #5 created<span class="toot-id"> #created-5</span></h2><div class="pubdate">30 Nov at 21:10:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/5">https://github.com/qt4cg/qtspecs/issues/5</a></div><details><summary>[FO] The math:atan2 notes incorrectly defines its behaviour.</summary><div class="markup"><p>When <code>$y</code> is positive and <code>$x</code> is negative, the notes define this to be equal to <code>Ï€ - atan($y div $x)</code> when it should be <code>atan($y div $x) + Ï€</code>.</p>
<p>When <code>$y</code> is negative and <code>$x</code> is positive, the notes don't define the value. It is the same as the first case, when <code>$y</code> is positive and <code>$x</code> is positive, so the first case should be "If $y is positive or negative, and ...".</p>
<p>When <code>$y</code> is negative and <code>$x</code> is negative, the notes don't define the value. The value is equivalent to <code>atan($y div $x) - Ï€</code>.</p>
</div></details></div>
<div class="toot" id="created-4"><h2>Issue #4 created<span class="toot-id"> #created-4</span></h2><div class="pubdate">30 Nov at 20:39:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/4">https://github.com/qt4cg/qtspecs/issues/4</a></div><details><summary>[XPath] [XQuery] Better names for ThinArrowTarget and FatArrowTarget</summary><div class="markup"><p>The <code>ThinArrowTarget</code> and <code>FatArrowTarget</code> EBNF symbols do not follow the convention in the XPath and XQuery specifications of describing the semantics of the symbols, but instead describe how they are written.</p>
<p>I propose the following names:</p>
<ol>
<li><code>CurryingArrowTarget</code> instead of <code>FatArrowTarget</code> -- This is because the LHS is being curried into the function, making the function call it applies to take one less parameter. Other possible names would be <code>SimpleArrowTarget</code> or <code>UnaryArrowTarget</code>.</li>
<li><code>MappingArrowTarget</code> instead of <code>ThinArrowTarget</code> -- This is because both variants make use of the simple map operator.</li>
</ol>
</div></details></div>
<div class="toot" id="created-3"><h2>Issue #3 created<span class="toot-id"> #created-3</span></h2><div class="pubdate">30 Nov at 16:57:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/3">https://github.com/qt4cg/qtspecs/issues/3</a></div><details><summary>Allow tokens in xsl:mode/@name</summary><div class="markup"><p>A minor request:</p>
<p>I find I often want to re-use the same behaviours across modes, or use related modes across similar content.</p>
<p>In the <code>xsl:template</code> and <code>xsl:apply-templates</code>, we can use a space separated list of mode names: it would be convenient if I could do the same thing in <code>xsl:mode</code> instructions.</p>
</div></details></div>
<div class="toot" id="created-2"><h2>Issue #2 created<span class="toot-id"> #created-2</span></h2><div class="pubdate">30 Nov at 16:47:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2">https://github.com/qt4cg/qtspecs/issues/2</a></div><details><summary>[FO] fn:intersperse</summary><div class="markup"><p>A simple proposal, for a change:</p>
<p>A new function would be handsome to insert separators in a sequence. Equivalent functions exist in other languages; in Haskell and Dart, they are called <code>intersperse</code>:</p>
<h3>Summary</h3>
<p>Inserts the defined separator between the items of a sequence and returns the resulting sequence.</p>
<h3>Signature</h3>
<pre><code class="language-xquery">fn:intersperse($values as item()*, $separator as item()*) as item()*
</code></pre>
<h3>Example</h3>
<pre><code class="language-xquery">let $div :=
  &lt;div&gt;
    &lt;span&gt;one&lt;/span&gt;
    &lt;span&gt;two&lt;/span&gt;
    &lt;span&gt;three&lt;/span&gt;
  &lt;/div&gt;
return fn:intersperse($div/span, ',')
</code></pre>
</div></details></div>
<div class="toot" id="created-1"><h2>Issue #1 created<span class="toot-id"> #created-1</span></h2><div class="pubdate">28 Nov at 00:10:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1">https://github.com/qt4cg/qtspecs/issues/1</a></div><details><summary>[FO] Conversion between xs:QName and Q{uri}local format</summary><div class="markup"><p>It would be good to have functions to convert from <code>Q{uri}local</code> format to <code>xs:QName</code> (perhaps with the option of supplying a prefix), and the reverse, generating <code>Q{uri}local</code> from an xs:QName.</p>
<p>I don't think we can extend the <code>xs:QName</code> constructor function to do this, because that has to remain consistent with XSD and (sadly) we can't change the lexical space in XSD.</p>
<p>So I would suggest a single-argument form of <code>fn:QName</code> that accepts either <code>local</code> or <code>Q{}local</code> or <code>Q{uri}local</code>. But this doesn't allow a prefix to be added. An alternative would be fn:EQName#1 accepting <code>local</code> or <code>Q{}local</code> or <code>Q{uri}local</code>, with an optional second argument to supply a prefix.</p>
<p>For the reverse, perhaps <code>fn:EQName-from-QName#1</code>? But the terminology here is a bit loose: in the grammar, EQName covers various formats of which URIQualifiedName is one. But <code>fn:URIQualifiedName-from-QName</code> is a bit of a mouthful.</p>
</div></details></div></div></article></main></body></html>
<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2025</title></head><body><main><article><h1>@qt4cg statuses in 2025</h1><p>This page displays status
              updates
              about the QT4 CG project from 2025.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="agenda-09-23"><h2>QT4 CG meeting 135 draft agenda<span class="toot-id"> #agenda-09-23</span></h2><div class="pubdate">22 Sep at 09:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/09-23">https://qt4cg.org/meeting/agenda/2025/09-23</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-2197"><h2>Issue #2197 closed<span class="toot-id"> #closed-2197</span></h2><div class="pubdate">22 Sep at 09:11:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2197">https://github.com/qt4cg/qtspecs/issues/2197</a></div><p>Generated tests no longer escape variables in test elements</p></div>
<div class="toot" id="closed-2199"><h2>Issue #2199 closed<span class="toot-id"> #closed-2199</span></h2><div class="pubdate">22 Sep at 09:11:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2199">https://github.com/qt4cg/qtspecs/pull/2199</a></div><p>2197 Fix test generation stylesheet</p></div>
<div class="toot" id="created-2202"><h2>Pull request #2202 created<span class="toot-id"> #created-2202</span></h2><div class="pubdate">21 Sep at 10:48:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2202">https://github.com/qt4cg/qtspecs/pull/2202</a></div><details><summary>New rules for schema-attribute and schema-element subtyping</summary><div class="markup"><p>Fix #2201</p>
</div></details></div>
<div class="toot" id="created-2201"><h2>Issue #2201 created<span class="toot-id"> #created-2201</span></h2><div class="pubdate">21 Sep at 09:31:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2201">https://github.com/qt4cg/qtspecs/issues/2201</a></div><details><summary>Subtyping: schema-element(X) and schema-attribute(X)</summary><div class="markup"><p>According to the specs, in both 3.1 and 4.0, <code>schema-attribute(X)</code> is not a subtype of <code>attribute()</code>, and <code>schema-element(X)</code> is not a subtype of <code>element()</code>. This seems intuitively wrong. The set of nodes matched by <code>schema-attribute(X)</code> is clearly a subset of those matched by <code>attribute()</code></p>
<p>(The issue arises because it seems Saxon has always treated <code>schema-attribute(X)</code> as being a subtype of <code>attribute()</code>, but in response to a rather complicated bug I rewrote the code to follow the spec more closely, and wrote new tests in the misc-Subtyping family to check conformance more closely: this has caused various optimizations to break.)</p>
<p>Although it's intuitive that <code>schema-attribute(X)</code> should be a subtype of <code>attribute()</code>, the exact rules (especially for elements) require careful thought, taking into account substitution groups and nillability.</p>
</div></details></div>
<div class="toot" id="created-2200"><h2>Pull request #2200 created<span class="toot-id"> #created-2200</span></h2><div class="pubdate">16 Sep at 23:56:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2200">https://github.com/qt4cg/qtspecs/pull/2200</a></div><details><summary>657 Allow user-defined functions in no namespace</summary><div class="markup"><ol>
<li>User functions declared in XQuery or XSLT can be in no namespace</li>
<li>Unprefixed function names used in static function calls and user function references are resolved first against no-namespace functions with matching local name (and arity), and secondly against functions in the default function namespace, which will normally be the <code>fn</code> namespace.</li>
</ol>
</div></details></div>
<div class="toot" id="closed-2125"><h2>Issue #2125 closed<span class="toot-id"> #closed-2125</span></h2><div class="pubdate">16 Sep at 22:51:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2125">https://github.com/qt4cg/qtspecs/issues/2125</a></div><p>csv-to-xml() - untestable results</p></div>
<div class="toot" id="created-2199"><h2>Pull request #2199 created<span class="toot-id"> #created-2199</span></h2><div class="pubdate">16 Sep at 22:17:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2199">https://github.com/qt4cg/qtspecs/pull/2199</a></div><details><summary>2197 Fix test generation stylesheet</summary><div class="markup"><p>Fix #2197</p>
</div></details></div>
<div class="toot" id="created-2198"><h2>Issue #2198 created<span class="toot-id"> #created-2198</span></h2><div class="pubdate">16 Sep at 20:45:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2198">https://github.com/qt4cg/qtspecs/issues/2198</a></div><details><summary>Serialization parameter: `conditional-cdata`</summary><div class="markup"><p>As discussed on Slack, a serialization parameter would be helpful to only create CDATA sections when the string value in question would need to be escaped.</p>
</div></details></div>
<div class="toot" id="created-2197"><h2>Issue #2197 created<span class="toot-id"> #created-2197</span></h2><div class="pubdate">16 Sep at 20:33:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2197">https://github.com/qt4cg/qtspecs/issues/2197</a></div><details><summary>Generated tests no longer escape variables in test elements</summary><div class="markup"><p>Probably related to PR #2192, generated tests in app-spec-examples are not using CDATA sections. See for example</p>
<pre><code>&lt;test-case name="fo-test-fn-type-of-002"&gt;
      &lt;description&gt;Test case for fn:type-of&lt;/description&gt;
      &lt;created by="Michael Kay using generate-qt3-test-set.xsl" on="2025-09-16"/&gt;
      &lt;environment ref="global"/&gt;
      &lt;dependency type="spec" value="XQ40+" satisfied="true"/&gt;
      &lt;test&gt;
          let $e := 
          &lt;doc&gt;
  &lt;p id="alpha" xml:id="beta"&gt;One&lt;/p&gt;
  &lt;p id="gamma" xmlns="http://example.com/ns"&gt;Two&lt;/p&gt;
  &lt;ex:p id="delta" xmlns:ex="http://example.com/ns"&gt;Three&lt;/ex:p&gt;
  &lt;?pi 3.14159?&gt;
&lt;/doc&gt; 
           return  type-of($e//*)
      &lt;/test&gt;
      &lt;result&gt;
         &lt;assert-deep-eq&gt;"element()+"&lt;/assert-deep-eq&gt;
      &lt;/result&gt;
   &lt;/test-case&gt;
</code></pre>
<p>The content of the <code>&lt;test&gt;</code> element should be wrapped in a CDATA section.</p>
</div></details></div>
<div class="toot" id="created-2196"><h2>Issue #2196 created<span class="toot-id"> #created-2196</span></h2><div class="pubdate">16 Sep at 19:52:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2196">https://github.com/qt4cg/qtspecs/issues/2196</a></div><details><summary>XQST0070 - inconsistencies</summary><div class="markup"><p>The description of XQST0070 in XQuery §5.13 is:</p>
<blockquote>
<p>The namespace prefix specified in a namespace declaration must not be xml or xmlns [[err:XQST0070]. The namespace URI specified in a namespace declaration must not be http://www.w3.org/XML/1998/namespace or http://www.w3.org/2000/xmlns/ [[err:XQST0070].</p>
</blockquote>
<p>This is subtly different from the description in Appendix E:</p>
<blockquote>
<p>A [static error] is raised if one of the predefined prefixes xml or xmlns appears in a namespace declaration or a default namespace declaration, or if any of the following conditions is statically detected in any expression or declaration:</p>
<ul>
<li>The prefix xml is bound to some namespace URI other than http://www.w3.org/XML/1998/namespace.</li>
<li>A prefix other than xml is bound to the namespace URI http://www.w3.org/XML/1998/namespace.</li>
<li>The prefix xmlns is bound to any namespace URI.</li>
<li>A prefix other than xmlns is bound to the namespace URI http://www.w3.org/2000/xmlns/</li>
</ul>
</blockquote>
<p>The descriptions should be aligned. The rules for the new XPath namespace declaration should also be aligned.</p>
<p>There is also some nonsense, for example it isn't possible to define the prefix xml or xmlns (or any other prefix) in a default namespace declaration.</p>
</div></details></div>
<div class="toot" id="minutes—09-16"><h2>QT4 CG meeting 134 draft minutes<span class="toot-id"> #minutes—09-16</span></h2><div class="pubdate">16 Sep at 16:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/09-16">https://qt4cg.org/meeting/minutes/2025/09-16</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-2195"><h2>Issue #2195 created<span class="toot-id"> #created-2195</span></h2><div class="pubdate">16 Sep at 17:27:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2195">https://github.com/qt4cg/qtspecs/issues/2195</a></div><details><summary>Editorial notes (incremental)</summary><div class="markup"><p>Adopted from #2075:</p>
<blockquote>
<ul>
<li>
<p>The »Summary of Changes« sections contain outdated information that refer to the presentation of the specs. Maybe we don’t really need them:</p>
<ul>
<li>Use the arrows to browse significant changes since the 3.1 version of this specification.</li>
<li>Sections with significant changes are marked Δ in the table of contents. New functions introduced in this version are marked ➕ in the table of contents.</li>
</ul>
</li>
</ul>
<p>The text needs to be updated: We don’t have “arrows” anymore, and neither Δ nor ➕.</p>
</blockquote>
<p>…and…</p>
<blockquote>
<p>(Some?) links to the binary functions in EXPath Binary Spec are invalid. Example:</p>
<ul>
<li><a href="https://qt4cg.org/specifications/EXPath/binary-40/Overview.html#func-bin-pack-integer">bin:pack-integer</a></li>
</ul>
<p>For example:</p>
<p>See also the functions <a href="https://qt4cg.org/specifications/EXPath/binary-40/Overview.html#func-bin-pack-integer">bin:pack-integer</a>, <a href="https://qt4cg.org/specifications/EXPath/binary-40/Overview.html#func-bin-unpack-integer">bin:unpack-integer</a>, and <a href="https://qt4cg.org/specifications/EXPath/binary-40/Overview.html#func-bin-unpack-unsigned-integer">bin:unpack-unsigned-integer</a> defined in this specification.</p>
<p>…as well as in F <a href="https://qt4cg.org/specifications/expath-binary-40/Overview.html#back-compatibility">Compatibility with Previous Versions</a> (Non-Normative)</p>
</blockquote>
</div></details></div>
<div class="toot" id="closed-2075"><h2>Issue #2075 closed<span class="toot-id"> #closed-2075</span></h2><div class="pubdate">16 Sep at 16:44:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2075">https://github.com/qt4cg/qtspecs/issues/2075</a></div><p>Editorial notes (incremental)</p></div>
<div class="toot" id="closed-2191"><h2>Issue #2191 closed<span class="toot-id"> #closed-2191</span></h2><div class="pubdate">16 Sep at 16:44:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2191">https://github.com/qt4cg/qtspecs/pull/2191</a></div><p>2075 Editorial Omnibus</p></div>
<div class="toot" id="closed-2180"><h2>Issue #2180 closed<span class="toot-id"> #closed-2180</span></h2><div class="pubdate">16 Sep at 16:22:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2180">https://github.com/qt4cg/qtspecs/issues/2180</a></div><p>Clarify `$array/attribute(id)` vs `$array/type(attribute(id))`</p></div>
<div class="toot" id="closed-2189"><h2>Issue #2189 closed<span class="toot-id"> #closed-2189</span></h2><div class="pubdate">16 Sep at 16:22:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2189">https://github.com/qt4cg/qtspecs/pull/2189</a></div><p>2180 Clarify paths mixing XNodes and JNodes</p></div>
<div class="toot" id="closed-2179"><h2>Issue #2179 closed<span class="toot-id"> #closed-2179</span></h2><div class="pubdate">16 Sep at 16:19:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2179">https://github.com/qt4cg/qtspecs/issues/2179</a></div><p>Namespace declarations in XPath</p></div>
<div class="toot" id="closed-2181"><h2>Issue #2181 closed<span class="toot-id"> #closed-2181</span></h2><div class="pubdate">16 Sep at 16:19:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2181">https://github.com/qt4cg/qtspecs/pull/2181</a></div><p>2179 Add namespace declarations to XPath grammar</p></div>
<div class="toot" id="closed-2178"><h2>Issue #2178 closed<span class="toot-id"> #closed-2178</span></h2><div class="pubdate">16 Sep at 16:16:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2178">https://github.com/qt4cg/qtspecs/issues/2178</a></div><p>XQuery predeclared namespaces</p></div>
<div class="toot" id="closed-2182"><h2>Issue #2182 closed<span class="toot-id"> #closed-2182</span></h2><div class="pubdate">16 Sep at 16:16:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2182">https://github.com/qt4cg/qtspecs/pull/2182</a></div><p>2178 Define predeclared namespaces for XQuery</p></div>
<div class="toot" id="closed-2187"><h2>Issue #2187 closed<span class="toot-id"> #closed-2187</span></h2><div class="pubdate">16 Sep at 16:12:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2187">https://github.com/qt4cg/qtspecs/issues/2187</a></div><p>Coercion to enum()</p></div>
<div class="toot" id="closed-2188"><h2>Issue #2188 closed<span class="toot-id"> #closed-2188</span></h2><div class="pubdate">16 Sep at 16:12:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2188">https://github.com/qt4cg/qtspecs/pull/2188</a></div><p>2187 Add coercion rule for enumeration types</p></div>
<div class="toot" id="closed-2163"><h2>Issue #2163 closed<span class="toot-id"> #closed-2163</span></h2><div class="pubdate">16 Sep at 16:08:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2163">https://github.com/qt4cg/qtspecs/issues/2163</a></div><p>Method calls: `?&gt;` or` =?&gt;`</p></div>
<div class="toot" id="closed-2171"><h2>Issue #2171 closed<span class="toot-id"> #closed-2171</span></h2><div class="pubdate">16 Sep at 16:08:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2171">https://github.com/qt4cg/qtspecs/pull/2171</a></div><p>2163 Change ?&gt; symbol to =?&gt;</p></div>
<div class="toot" id="closed-670"><h2>Issue #670 closed<span class="toot-id"> #closed-670</span></h2><div class="pubdate">16 Sep at 16:08:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/670">https://github.com/qt4cg/qtspecs/issues/670</a></div><p>The trouble with XPath’s fn:fold-right. A fix and Proposal for fn:fold-lazy</p></div>
<div class="toot" id="closed-1868"><h2>Issue #1868 closed<span class="toot-id"> #closed-1868</span></h2><div class="pubdate">16 Sep at 16:07:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1868">https://github.com/qt4cg/qtspecs/issues/1868</a></div><p>array:members() to include index position</p></div>
<div class="toot" id="closed-1912"><h2>Issue #1912 closed<span class="toot-id"> #closed-1912</span></h2><div class="pubdate">16 Sep at 16:07:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1912">https://github.com/qt4cg/qtspecs/issues/1912</a></div><p>Error handling: `fn:throw`</p></div>
<div class="toot" id="closed-2034"><h2>Issue #2034 closed<span class="toot-id"> #closed-2034</span></h2><div class="pubdate">16 Sep at 16:07:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2034">https://github.com/qt4cg/qtspecs/issues/2034</a></div><p>fn:parse-xml, fn:doc: `safe` option</p></div>
<div class="toot" id="closed-2161"><h2>Issue #2161 closed<span class="toot-id"> #closed-2161</span></h2><div class="pubdate">16 Sep at 16:07:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2161">https://github.com/qt4cg/qtspecs/issues/2161</a></div><p>Drop other non-ASCII operators (×, ÷)</p></div>
<div class="toot" id="closed-576"><h2>Issue #576 closed<span class="toot-id"> #closed-576</span></h2><div class="pubdate">16 Sep at 16:07:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/576">https://github.com/qt4cg/qtspecs/issues/576</a></div><p>JSON serialization: INF/NaN, function items</p></div>
<div class="toot" id="closed-158"><h2>Issue #158 closed<span class="toot-id"> #closed-158</span></h2><div class="pubdate">16 Sep at 16:07:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/158">https://github.com/qt4cg/qtspecs/issues/158</a></div><p>Support optional parameters on dynamic functions</p></div>
<div class="toot" id="closed-105"><h2>Issue #105 closed<span class="toot-id"> #closed-105</span></h2><div class="pubdate">16 Sep at 16:07:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/105">https://github.com/qt4cg/qtspecs/issues/105</a></div><p>Maps with Infinite Number of Keys: Total Maps and Decorated maps</p></div>
<div class="toot" id="closed-2173"><h2>Issue #2173 closed<span class="toot-id"> #closed-2173</span></h2><div class="pubdate">16 Sep at 16:06:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2173">https://github.com/qt4cg/qtspecs/issues/2173</a></div><p>Incorrect Cardinality on MethodAnnotation reference</p></div>
<div class="toot" id="closed-2174"><h2>Issue #2174 closed<span class="toot-id"> #closed-2174</span></h2><div class="pubdate">16 Sep at 16:06:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2174">https://github.com/qt4cg/qtspecs/pull/2174</a></div><p>2173 Drop method annotations from XPath grammar</p></div>
<div class="toot" id="agenda-09-16"><h2>QT4 CG meeting 134 draft agenda<span class="toot-id"> #agenda-09-16</span></h2><div class="pubdate">15 Sep at 12:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/09-16">https://qt4cg.org/meeting/agenda/2025/09-16</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2194"><h2>Issue #2194 created<span class="toot-id"> #created-2194</span></h2><div class="pubdate">15 Sep at 07:52:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2194">https://github.com/qt4cg/qtspecs/issues/2194</a></div><details><summary>fn:transform sandbox=yes option</summary><div class="markup"><p>I propose an option sandbox=yes for fn:transform, with the effect that the executed stylesheet has no means of accessing or updating external information other than via the fn:transform parameters and result value.</p>
<p>This is to provide an effective and portable way of executing untrusted code.</p>
<p>There are various ways one might specify it: the simplest would be just to state the intent (as in the sentence above) and leave implementations to work out the detail.</p>
<p>An API might also allow transformations to be executed in a sandbox, but that of course is outside our control.</p>
</div></details></div>
<div class="toot" id="created-2193"><h2>Issue #2193 created<span class="toot-id"> #created-2193</span></h2><div class="pubdate">15 Sep at 06:58:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2193">https://github.com/qt4cg/qtspecs/issues/2193</a></div><details><summary>fn:parse-xml, fn:doc: Drop security options</summary><div class="markup"><p>Related: #2034, #1270.</p>
<p>I propose to drop the <code>allow-external-entities</code> and <code>entity-expansion-limit</code> options. They reflect only some of various existing limits that XML parsers provide.</p>
<p>Instead, it seems more reasonable to define such limits globally. It remains to be shown whether we find an implementation-oblivious approach for this.</p>
</div></details></div>
<div class="toot" id="closed-2192"><h2>Issue #2192 closed<span class="toot-id"> #closed-2192</span></h2><div class="pubdate">13 Sep at 09:40:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2192">https://github.com/qt4cg/qtspecs/pull/2192</a></div><p>Upgrade build system to use Saxon 12.9</p></div>
<div class="toot" id="created-2192"><h2>Pull request #2192 created<span class="toot-id"> #created-2192</span></h2><div class="pubdate">13 Sep at 09:40:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2192">https://github.com/qt4cg/qtspecs/pull/2192</a></div><details><summary>Upgrade build system to use Saxon 12.9</summary><div class="markup"><p>I skimmed all the specs and nothing looks wrong; I'm going to go ahead and merge this but please report any problems you find that you think might be related.,</p>
</div></details></div>
<div class="toot" id="created-2191"><h2>Pull request #2191 created<span class="toot-id"> #created-2191</span></h2><div class="pubdate">09 Sep at 19:32:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2191">https://github.com/qt4cg/qtspecs/pull/2191</a></div><details><summary>2075 Editorial Omnibus</summary><div class="markup"><p>Fix #2075</p>
</div></details></div>
<div class="toot" id="created-2190"><h2>Issue #2190 created<span class="toot-id"> #created-2190</span></h2><div class="pubdate">09 Sep at 14:08:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2190">https://github.com/qt4cg/qtspecs/issues/2190</a></div><details><summary>parse-csv() from binary: what encoding?</summary><div class="markup"><p>We have extended <code>parse-csv()</code> -- and introduced <code>csv-doc()</code> -- with the ability to read binary input. But we don't provide any way to specify an encoding, and we give no rules for inferring an encoding if none is specified.</p>
</div></details></div>
<div class="toot" id="created-2189"><h2>Pull request #2189 created<span class="toot-id"> #created-2189</span></h2><div class="pubdate">09 Sep at 11:01:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2189">https://github.com/qt4cg/qtspecs/pull/2189</a></div><details><summary>2180 Clarify paths mixing XNodes and JNodes</summary><div class="markup"><p>Fix #2180</p>
</div></details></div>
<div class="toot" id="created-2188"><h2>Pull request #2188 created<span class="toot-id"> #created-2188</span></h2><div class="pubdate">09 Sep at 08:13:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2188">https://github.com/qt4cg/qtspecs/pull/2188</a></div><details><summary>2187 Add coercion rule for enumeration types</summary><div class="markup"><p>Fix #2187</p>
</div></details></div>
<div class="toot" id="created-2187"><h2>Issue #2187 created<span class="toot-id"> #created-2187</span></h2><div class="pubdate">08 Sep at 16:32:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2187">https://github.com/qt4cg/qtspecs/issues/2187</a></div><details><summary>Coercion to enum()</summary><div class="markup"><p>XQuery §3.2.6 states:</p>
<blockquote>
<p>By contrast, xs:untypedAtomic("red") instance of enum("red", "green", "blue") returns false; but the [coercion rules] ensure that where a variable or function declaration specifies an enumeration type as the required type, an xs:untypedAtomic or xs:anyURI value equal to one of the enumerated values will be accepted.</p>
</blockquote>
<p>However, looking at the coercion rules, this appears not to be the case.</p>
<p>It seems intuitive that an untypedAtomic value should match an enumeration type (otherwise if the required type is <code>enum("yes", "no")</code>, supplying an attribute whose value is "yes" will fail). And since we generally treat string, untypedAtomic, and anyURI as a single family for equality comparison, it makes sense to accept anyURI as well.</p>
<p>Test case DynamicFunctionCall-136 applies.</p>
</div></details></div>
<div class="toot" id="created-2186"><h2>Issue #2186 created<span class="toot-id"> #created-2186</span></h2><div class="pubdate">08 Sep at 13:57:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2186">https://github.com/qt4cg/qtspecs/issues/2186</a></div><details><summary>Adaptive serialization of JNodes</summary><div class="markup"><p>I would like to propose a change here so that instead of only outputting the <code>content</code> property of the JNode, we also output the <code>selector</code> property (if present).</p>
</div></details></div>
<div class="toot" id="created-2185"><h2>Issue #2185 created<span class="toot-id"> #created-2185</span></h2><div class="pubdate">07 Sep at 14:42:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2185">https://github.com/qt4cg/qtspecs/issues/2185</a></div><details><summary>Request for an `fn:xproc` function</summary><div class="markup"><p>I would like to see consideration given to adding an <code>fn:xproc</code> function please. We have an <code>fn:invisible-xml</code>, so why not an <code>fn:xproc</code>?</p>
<p>I think a potential function signature could look like:</p>
<p><code>fn:xproc($xproc as document-node(element(p:declare-step), $options as map(xs:string, item()+))</code> as map(xs:string, item()*)`</p>
<p>Map keys/values for <code>$options</code> could be something like:</p>
<ul>
<li>"input": Map { "name": "some-name", Map { "type": "some-type", "value": item()* }}</li>
<li>"option": Map {"name": "some-name", Map { "type": "some-type", "value": item()* }}</li>
</ul>
<p>Implementers are free to add additional key/value options to the <code>$options</code> map.</p>
<p>The result of the transformation is returned as a map. There is one entry in the map for the default output port, and one for each secondary output port. The key is an xs:string value. The key for the default output port is the string "default" otherwise. The key for secondary output ports, is the name of the port.</p>
</div></details></div>
<div class="toot" id="closed-2183"><h2>Issue #2183 closed<span class="toot-id"> #closed-2183</span></h2><div class="pubdate">06 Sep at 19:02:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2183">https://github.com/qt4cg/qtspecs/issues/2183</a></div><p>Formatting of specref and xspecref</p></div>
<div class="toot" id="closed-2184"><h2>Issue #2184 closed<span class="toot-id"> #closed-2184</span></h2><div class="pubdate">05 Sep at 12:09:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2184">https://github.com/qt4cg/qtspecs/pull/2184</a></div><p>2183 Improve rendition of cross-spec references</p></div>
<div class="toot" id="created-2184"><h2>Pull request #2184 created<span class="toot-id"> #created-2184</span></h2><div class="pubdate">05 Sep at 12:01:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2184">https://github.com/qt4cg/qtspecs/pull/2184</a></div><details><summary>2183 Improve rendition of cross-spec references</summary><div class="markup"><p>This PR:</p>
<ul>
<li>Changes the rendition of xspecref elements to use the form <code>[XPath 4.0] section [3.2.2 Heading]</code></li>
<li>Standardises the form of bibref references to other specs (e.g. <code>[XPath 4.0]</code>) across the various specifications</li>
<li>Updates a number of references that were out of date (e.g. XDM 3.0 -&gt; XDM 4.0)</li>
<li>Tidies up a few individual cases where the references were inappropriate or incorrect</li>
</ul>
<p>Note: contains stylesheet changes</p>
</div></details></div>
<div class="toot" id="created-2183"><h2>Issue #2183 created<span class="toot-id"> #created-2183</span></h2><div class="pubdate">05 Sep at 09:11:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2183">https://github.com/qt4cg/qtspecs/issues/2183</a></div><details><summary>Formatting of specref and xspecref</summary><div class="markup"><p>The following paragraph contains a <code>specref</code> and an <code>xspecref</code> (rendition approximated):</p>
<blockquote>
<p>The complete grammar for patterns is listed in <strong>E Pattern Syntax Summary</strong>. It uses the notation defined in <strong>Section A.1.1 Notation<sup>XP</sup></strong>.</p>
</blockquote>
<p>There's no particular reason why the prefix "Section" is used in one case and not the other.</p>
<p>At the same time, I think the superscript notation doesn't make it clear enough that the reference is to a different spec. I suggest that we render this as</p>
<p>... the notation defined in [XPath] section [A.1.1 Notation] ...</p>
<p>where [XPath] is a clickable bibref to the spec in question, and [A.1.1 Notation] is a clickable link to the the relevant section of that spec. And perhaps "section" should be "appendix" where appropriate.</p>
<p>I would propose to retain the suffix notation for xtermref and xnt.</p>
</div></details></div>
<div class="toot" id="created-2182"><h2>Pull request #2182 created<span class="toot-id"> #created-2182</span></h2><div class="pubdate">04 Sep at 22:31:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2182">https://github.com/qt4cg/qtspecs/pull/2182</a></div><details><summary>2178 Define predeclared namespaces for XQuery</summary><div class="markup"><p>Fix #2178</p>
</div></details></div>
<div class="toot" id="created-2181"><h2>Pull request #2181 created<span class="toot-id"> #created-2181</span></h2><div class="pubdate">04 Sep at 20:10:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2181">https://github.com/qt4cg/qtspecs/pull/2181</a></div><details><summary>2179 Add namespace declarations to XPath grammar</summary><div class="markup"><p>Fix #2179</p>
</div></details></div>
<div class="toot" id="created-2180"><h2>Issue #2180 created<span class="toot-id"> #created-2180</span></h2><div class="pubdate">04 Sep at 15:08:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2180">https://github.com/qt4cg/qtspecs/issues/2180</a></div><details><summary>Clarify `$array/attribute(id)` vs `$array/type(attribute(id))`</summary><div class="markup"><p>I am creating test JAxes-326 which does</p>
<pre><code>         let $xml := parse-xml("&lt;doc&gt;&lt;p id='a17'/&gt;&lt;p id='a18'/&gt;&lt;/doc&gt;")
         let $array := [$xml//p[@id='a17'], $xml//@id[.='a18']]
         return $array/type(attribute(id)) =&gt; string()
</code></pre>
<p>That is, it constructs an array whose members are element or attribute nodes</p>
<p>I think that if we write <code>$array/attribute(id)</code> then the following rule kicks into play:</p>
<blockquote>
<p>If the axis name is omitted from an [axis step], the default axis is child, with two exceptions: (1) if the [NodeTest] in an axis step contains an [AttributeTest] or [SchemaAttributeTest] then the default axis is attribute;</p>
</blockquote>
<p>That is, this is equivalent to <code>$array/attribute::id</code>, and the attribute axis from a JNode is always empty.</p>
<p>Whereas if we write</p>
<p><code>$array/type(attribute(id))</code></p>
<p>then the default axis is child, we are selecting the members of the array whose type is attribute(id), so the query returns "a18".</p>
<p>A note to clarify this case, and perhaps more generally to clarify how path expressions that mix JNodes and XNodes work, would be helpful.</p>
<p>§4.6.4.5 says</p>
<blockquote>
<p>For the most commonly encountered types, this syntax can be abbreviated: for example node(), text(), array(*), and record(x, y) can be written directly without the enclosing type(...).</p>
</blockquote>
<p>and this perhaps needs expanding to explain that for attribute(), and perhaps also for other XNode tests, this equivalence might not apply.</p>
</div></details></div>
<div class="toot" id="created-2179"><h2>Issue #2179 created<span class="toot-id"> #created-2179</span></h2><div class="pubdate">04 Sep at 09:21:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2179">https://github.com/qt4cg/qtspecs/issues/2179</a></div><details><summary>Namespace declarations in XPath</summary><div class="markup"><p>I think we've had this issue before but I'd like to reopen it.</p>
<p>It should be possible for an XPath expression to declare namespace prefixes rather than relying on the host language.</p>
<p>I propose that we use syntax compatible with XQuery.</p>
<pre><code>XPathExpr := (NamespaceDecl ';')* Expr

NamespaceDecl := "declare" "namespace" NCName "=" URILiteral
</code></pre>
</div></details></div>
<div class="toot" id="created-2178"><h2>Issue #2178 created<span class="toot-id"> #created-2178</span></h2><div class="pubdate">30 Aug at 17:56:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2178">https://github.com/qt4cg/qtspecs/issues/2178</a></div><details><summary>XQuery predeclared namespaces</summary><div class="markup"><p>XQuery §5.13 says:</p>
<blockquote>
<p>XQuery has several predeclared namespace prefixes, which are listed in [2.1.4 Namespaces and QNames]</p>
</blockquote>
<p>However §2.1.4 says only:</p>
<blockquote>
<p>This document uses the following namespace prefixes to represent the namespace URIs with which they are listed. Although these prefixes are used within this specification to refer to the corresponding namespaces, not all of these bindings will necessarily be present in the static context of every expression, and authors are free to use different prefixes for these namespaces, or to bind these prefixes to different namespaces.</p>
</blockquote>
<p>§2.2.1 says "Some namespaces are predefined;" without saying which.</p>
<p>§B.1 says that the "default initial value" for in-scope-namespaces contains the prefixes fn, xml, xs, xsi, local ("if not overridden or augmented by the implementation")</p>
<p>Test case <code>annotation-assertion-40-07</code> assumes that the namespace prefix xq is necessarily predeclared, but I cannot see any justification for this in the spec.</p>
</div></details></div>
<div class="toot" id="created-2177"><h2>Issue #2177 created<span class="toot-id"> #created-2177</span></h2><div class="pubdate">29 Aug at 18:46:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2177">https://github.com/qt4cg/qtspecs/issues/2177</a></div><details><summary>F+O: improve cross-referencing between functions</summary><div class="markup"><p>Cross-referencing between functions in the F+O spec is somewhat haphazard. For example, the spec of distinct-values refers normatively to the spec of deep-equal, yet there is no hyperlink.</p>
</div></details></div>
<div class="toot" id="created-2176"><h2>Pull request #2176 created<span class="toot-id"> #created-2176</span></h2><div class="pubdate">22 Aug at 22:52:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2176">https://github.com/qt4cg/qtspecs/pull/2176</a></div><details><summary>2130 encore: precedes-or-is, follows-or-is</summary><div class="markup"><p>In #2130 we introduced <code>is-not</code>, which is the union of <code>precedes</code> and <code>follows</code>. This PR follows that lead by creating two new operators, one for the union of <code>precedes</code> with <code>is</code> and the other for the union of <code>follows</code> with <code>is</code>.</p>
<p>I realize this modification provides only a convenience and not new utility, so if it is deemed unnecessary by the CG, that's okay.</p>
<p>I have opted for <code>precedes-or-is</code> and not <code>is-or-precedes</code> on analogy with <code>ancestor-or-self::*</code>.</p>
</div></details></div>
<div class="toot" id="created-2175"><h2>Pull request #2175 created<span class="toot-id"> #created-2175</span></h2><div class="pubdate">21 Aug at 17:36:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2175">https://github.com/qt4cg/qtspecs/pull/2175</a></div><details><summary>2093 Rearrange the order and grouping of functions</summary><div class="markup"><p>Hopefully the arrangement is now a bit more logical.</p>
<p>Fix #2093</p>
</div></details></div>
<div class="toot" id="created-2174"><h2>Pull request #2174 created<span class="toot-id"> #created-2174</span></h2><div class="pubdate">21 Aug at 16:26:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2174">https://github.com/qt4cg/qtspecs/pull/2174</a></div><details><summary>2173 Drop method annotations from XPath grammar</summary><div class="markup"><p>The MethodAnnotation construct should have been dropped from the XPath grammar when we changed the mechanism for methods.</p>
<p>Fix #2173</p>
</div></details></div>
<div class="toot" id="closed-1340"><h2>Issue #1340 closed<span class="toot-id"> #closed-1340</span></h2><div class="pubdate">21 Aug at 16:16:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1340">https://github.com/qt4cg/qtspecs/issues/1340</a></div><p>Namespace nodes and the namespace axis</p></div>
<div class="toot" id="created-2173"><h2>Issue #2173 created<span class="toot-id"> #created-2173</span></h2><div class="pubdate">21 Aug at 13:11:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2173">https://github.com/qt4cg/qtspecs/issues/2173</a></div><details><summary>Incorrect Cardinality on MethodAnnotation reference</summary><div class="markup"><p>In the current EBNF:</p>
<pre><code>InlineFunctionExpr 	::= 	MethodAnnotation* ("function" | "fn") FunctionSignature? FunctionBody 
...
MethodAnnotation 	::= 	"%method"
</code></pre>
<p>which implies <code>method% method% method% fn{}</code> would be valid, but perhaps a little senseless. Should the reference perhaps be <code>MethodAnnotation?</code>  ?</p>
</div></details></div>
<div class="toot" id="created-2171"><h2>Pull request #2171 created<span class="toot-id"> #created-2171</span></h2><div class="pubdate">20 Aug at 10:46:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2171">https://github.com/qt4cg/qtspecs/pull/2171</a></div><details><summary>2163 Change ?&gt; symbol to =?&gt;</summary><div class="markup"><p>Fix #2163</p>
</div></details></div>
<div class="toot" id="closed-2112"><h2>Issue #2112 closed<span class="toot-id"> #closed-2112</span></h2><div class="pubdate">20 Aug at 10:32:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2112">https://github.com/qt4cg/qtspecs/issues/2112</a></div><p>JNodes: get()</p></div>
<div class="toot" id="closed-2116"><h2>Issue #2116 closed<span class="toot-id"> #closed-2116</span></h2><div class="pubdate">20 Aug at 10:32:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2116">https://github.com/qt4cg/qtspecs/pull/2116</a></div><p>2112 Refine/revise the rules for get() in node tests</p></div>
<div class="toot" id="closed-2167"><h2>Issue #2167 closed<span class="toot-id"> #closed-2167</span></h2><div class="pubdate">20 Aug at 10:17:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2167">https://github.com/qt4cg/qtspecs/pull/2167</a></div><p>2166 Reinstate lost text for lookup expressions</p></div>
<div class="toot" id="closed-2166"><h2>Issue #2166 closed<span class="toot-id"> #closed-2166</span></h2><div class="pubdate">20 Aug at 10:17:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2166">https://github.com/qt4cg/qtspecs/issues/2166</a></div><p>Lookup expressions: we have deleted too much text</p></div>
<div class="toot" id="closed-2126"><h2>Issue #2126 closed<span class="toot-id"> #closed-2126</span></h2><div class="pubdate">19 Aug at 22:38:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2126">https://github.com/qt4cg/qtspecs/issues/2126</a></div><p>Absolute path expressions with JTrees</p></div>
<div class="toot" id="minutes—08-19"><h2>QT4 CG meeting 133 draft minutes<span class="toot-id"> #minutes—08-19</span></h2><div class="pubdate">19 Aug at 16:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/08-19">https://qt4cg.org/meeting/minutes/2025/08-19</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2139"><h2>Issue #2139 closed<span class="toot-id"> #closed-2139</span></h2><div class="pubdate">19 Aug at 15:56:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2139">https://github.com/qt4cg/qtspecs/issues/2139</a></div><p>Binary comparisons</p></div>
<div class="toot" id="closed-2168"><h2>Issue #2168 closed<span class="toot-id"> #closed-2168</span></h2><div class="pubdate">19 Aug at 15:56:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2168">https://github.com/qt4cg/qtspecs/pull/2168</a></div><p>2139 Make hexBinary and base64Binary fully comparable</p></div>
<div class="toot" id="closed-2162"><h2>Issue #2162 closed<span class="toot-id"> #closed-2162</span></h2><div class="pubdate">19 Aug at 15:55:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2162">https://github.com/qt4cg/qtspecs/pull/2162</a></div><p>QT4CG-132-04 Expand the rectangle?area example</p></div>
<div class="toot" id="closed-2143"><h2>Issue #2143 closed<span class="toot-id"> #closed-2143</span></h2><div class="pubdate">19 Aug at 15:48:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2143">https://github.com/qt4cg/qtspecs/issues/2143</a></div><p>JNodes and Methods</p></div>
<div class="toot" id="closed-1714"><h2>Issue #1714 closed<span class="toot-id"> #closed-1714</span></h2><div class="pubdate">19 Aug at 15:48:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1714">https://github.com/qt4cg/qtspecs/issues/1714</a></div><p>sibling:: axis. Action Item QT4CG-097-03</p></div>
<div class="toot" id="closed-350"><h2>Issue #350 closed<span class="toot-id"> #closed-350</span></h2><div class="pubdate">19 Aug at 15:47:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/350">https://github.com/qt4cg/qtspecs/issues/350</a></div><p>CompPath (Composite-objects path) Expressions</p></div>
<div class="toot" id="closed-119"><h2>Issue #119 closed<span class="toot-id"> #closed-119</span></h2><div class="pubdate">19 Aug at 15:47:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/119">https://github.com/qt4cg/qtspecs/issues/119</a></div><p>Allow a map's key value to be any sequence</p></div>
<div class="toot" id="closed-106"><h2>Issue #106 closed<span class="toot-id"> #closed-106</span></h2><div class="pubdate">19 Aug at 15:47:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/106">https://github.com/qt4cg/qtspecs/issues/106</a></div><p>Decorators' support</p></div>
<div class="toot" id="closed-34"><h2>Issue #34 closed<span class="toot-id"> #closed-34</span></h2><div class="pubdate">19 Aug at 15:47:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/34">https://github.com/qt4cg/qtspecs/issues/34</a></div><p>Proposal to introduce the set datatype in XPath 4</p></div>
<div class="toot" id="closed-2164"><h2>Issue #2164 closed<span class="toot-id"> #closed-2164</span></h2><div class="pubdate">19 Aug at 15:45:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2164">https://github.com/qt4cg/qtspecs/pull/2164</a></div><p>Fix return type in `fn:parse-csv` signature</p></div>
<div class="toot" id="closed-2072"><h2>Issue #2072 closed<span class="toot-id"> #closed-2072</span></h2><div class="pubdate">19 Aug at 15:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2072">https://github.com/qt4cg/qtspecs/issues/2072</a></div><p>JNodes: accessing properties</p></div>
<div class="toot" id="closed-2170"><h2>Issue #2170 closed<span class="toot-id"> #closed-2170</span></h2><div class="pubdate">18 Aug at 15:46:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2170">https://github.com/qt4cg/qtspecs/issues/2170</a></div><p>The current "?&gt;" method call operator is ugly, difficult to read, difficult to find and understand. We have much better alternatives.</p></div>
<div class="toot" id="created-2170"><h2>Issue #2170 created<span class="toot-id"> #created-2170</span></h2><div class="pubdate">18 Aug at 15:17:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2170">https://github.com/qt4cg/qtspecs/issues/2170</a></div><details><summary>The current "?&gt;" method call operator is ugly, difficult to read, difficult to find and understand. We have much better alternatives.</summary><div class="markup"><p>The current "<strong><em>?&gt;</em></strong>" method call operator is ugly, difficult to read, difficult to find and understand. We have much better alternatives.</p>
<p>One obvious big improvement is to have  <strong><em><code>==&gt;</code></em></strong> .</p>
<p>This is:</p>
<ol>
<li>Readable.</li>
<li>Distinctly distinguishable.</li>
<li>Understandable and intuitive for anyone who has used an OOP language (C++, C#, Java)</li>
<li>Expresses the similarity with the <strong><em><code>=&gt;</code></em></strong> operator. The same way <strong><em><code>=&gt;</code></em></strong> provide the LHS item as the first argument of the RHS function, the similar, and extended, in appearance  <strong><em><code>==&gt;</code></em></strong> provides the LHS map/object as an implicit argument to the RHS method.</li>
<li>Because of 1, 2, 3, and 4 above, very little additional learning and understanding effort is required from the XPath user.</li>
</ol>
<p><strong>Proposed action</strong>: Replace the ugly, difficult to read, difficult to find and understand operator "<strong><em>?&gt;</em></strong>" with <strong><em><code>==&gt;</code></em></strong> .</p>
</div></details></div>
<div class="toot" id="agenda-08-19"><h2>QT4 CG meeting 133 draft agenda<span class="toot-id"> #agenda-08-19</span></h2><div class="pubdate">18 Aug at 10:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/08-19">https://qt4cg.org/meeting/agenda/2025/08-19</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1938"><h2>Issue #1938 closed<span class="toot-id"> #closed-1938</span></h2><div class="pubdate">16 Aug at 18:10:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1938">https://github.com/qt4cg/qtspecs/issues/1938</a></div><p>Invoking coerced methods</p></div>
<div class="toot" id="created-2169"><h2>Issue #2169 created<span class="toot-id"> #created-2169</span></h2><div class="pubdate">16 Aug at 17:34:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2169">https://github.com/qt4cg/qtspecs/issues/2169</a></div><details><summary>Longest-token rule incorrectly produces `StringInterpolation` delimiter</summary><div class="markup"><p><code>StringInterpolation</code> currently defines a two-character token, curly right brace + backtick, to follow <code>Expr</code> as a terminator:</p>
<pre><code>StringInterpolation ::= "`{" Expr? "}`"
</code></pre>
<p>On other occasions, <code>Expr</code> is followed by a single right curly brace:</p>
<pre><code>EnclosedExpr ::= "{" Expr? "}"
</code></pre>
<p>The following applies to tokenization (the "longest-token" rule):</p>
<blockquote>
<p>If the current position is not the end of the input, then return the longest literal terminal or variable terminal that can be matched starting at the current position, regardless whether this terminal is valid at this point in the grammar.”</p>
</blockquote>
<p>My concern is that input like</p>
<pre><code class="language-xquery">&lt;a&gt;{42}`&lt;/a&gt;
</code></pre>
<p>is going to be mis-tokenized under the longest-token rule: after <code>42</code>, the next (longest) token is the two-character <code>StringInterpolation</code> terminator, which however is not a valid terminator of the <code>EnclosedExpr</code> serving as <code>CommonContent</code> of the direct element constructor.</p>
<p><strong>Proposed fix</strong></p>
<p>My proposal is to replace the two-character tokens that introduce and terminate <code>StringInterpolation</code> with single backticks around an <code>EnclosedExpr</code> with no intervening whitespace:</p>
<pre><code>StringInterpolation ::= "`" EnclosedExpr "`"   /* ws: explicit */
</code></pre>
<p>This replaces both of the two-character delimiters of <code>StringInterpolation</code>, while still describing the intended language, but without causing the longest-token rule to produce a token that cannot be handled afterwards.</p>
</div></details></div>
<div class="toot" id="closed-1736"><h2>Issue #1736 closed<span class="toot-id"> #closed-1736</span></h2><div class="pubdate">15 Aug at 08:52:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1736">https://github.com/qt4cg/qtspecs/issues/1736</a></div><p>Add option retain-order=false when constructing maps</p></div>
<div class="toot" id="created-2168"><h2>Pull request #2168 created<span class="toot-id"> #created-2168</span></h2><div class="pubdate">14 Aug at 19:33:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2168">https://github.com/qt4cg/qtspecs/pull/2168</a></div><details><summary>2139 Make hexBinary and base64Binary fully comparable</summary><div class="markup"><p>Fix #2139</p>
<p>hexBinary and base64Binary become mutually comparable under all comparison operators: which may affect backward compatibility.</p>
</div></details></div>
<div class="toot" id="created-2167"><h2>Pull request #2167 created<span class="toot-id"> #created-2167</span></h2><div class="pubdate">14 Aug at 17:59:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2167">https://github.com/qt4cg/qtspecs/pull/2167</a></div><details><summary>2166 Reinstate lost text for lookup expressions</summary><div class="markup"><p>Fix #2166</p>
</div></details></div>
<div class="toot" id="created-2166"><h2>Issue #2166 created<span class="toot-id"> #created-2166</span></h2><div class="pubdate">14 Aug at 09:40:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2166">https://github.com/qt4cg/qtspecs/issues/2166</a></div><details><summary>Lookup expressions: we have deleted too much text</summary><div class="markup"><p>In reverting many of the features previously added to lookup expressions (for example deep lookup and lookup modifiers) we seem to have accidentally lost text that actually defines what the different key specifiers mean; we're left with lots of examples but no actual specification.</p>
<p>I was reading to see what the current spec says about array bound checking: it appears to say nothing.</p>
</div></details></div>
<div class="toot" id="created-2165"><h2>Issue #2165 created<span class="toot-id"> #created-2165</span></h2><div class="pubdate">14 Aug at 08:58:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2165">https://github.com/qt4cg/qtspecs/issues/2165</a></div><details><summary>Treat expression: inconsistencies, questionable uses</summary><div class="markup"><p>Related: Michael’s observation in https://github.com/qt4cg/qtspecs/issues/2163#issuecomment-3185618064.</p>
<p>The current spec says for <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-treat">treat</a>:</p>
<blockquote>
<p>XPath 4.0 provides an expression called treat that can be used to modify the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-static-type">static type</a> of its operand.</p>
</blockquote>
<p>It further mentions the static analysis phase, which has been removed from the specs; maybe we should remove these references.</p>
<p>There are hardly any uses of the expression in the current spec. One is for <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-absolute-path-expressions">Absolute Path Expressions</a>:</p>
<blockquote>
<p>An expression of the form <code>/PP</code> (that is, a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-path-expression">path expression</a> with a leading <code>/</code>) is treated as an abbreviation for the expression <code>self::gnode()/(fn:root(.) treat as (document-node()|jnode())/PP</code>.</p>
</blockquote>
<p>The use seems confusing, as in many cases <code>self::gnode()</code> can only be evaluated at runtime. Maybe we could rewrite it to a variant that coerces the node? It would generally be easier for optimizers to rewrite paths when there is no need to differentiate between treat and coercion (and I have never seen code that catches <code>XPDY0050</code>).</p>
<p>Indeed I think it would be helpful to have a <code>coerce to</code> expression, even if people will rarely use it explicitly. It would allow us to remove all remaining uses of <code>treat as</code> (except, of course, for the expression itself), and we could simplify various examples that use variable declarations only for coercing values.</p>
</div></details></div>
<div class="toot" id="created-2164"><h2>Pull request #2164 created<span class="toot-id"> #created-2164</span></h2><div class="pubdate">13 Aug at 13:51:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2164">https://github.com/qt4cg/qtspecs/pull/2164</a></div><details><summary>Fix return type in `fn:parse-csv` signature</summary><div class="markup"><p>In f2e1f48, <code>fn:parse-csv</code> was changed to return an empty sequence, when its first argument is an empty sequence. This is however not reflected in the function's return type, which is here changed to <code>parsed-csv-structure-record?</code>.</p>
</div></details></div>
<div class="toot" id="created-2163"><h2>Issue #2163 created<span class="toot-id"> #created-2163</span></h2><div class="pubdate">12 Aug at 21:45:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2163">https://github.com/qt4cg/qtspecs/issues/2163</a></div><details><summary>Method calls: `?&gt;` or` =?&gt;`</summary><div class="markup"><p>I propose using <code>=?&gt;</code> for method calls rather than <code>?&gt;</code></p>
<p>(a) I lilke the association with <code>=&gt;</code> to call a function item with an implicit first argument; <code>=?&gt;</code> combines selection of an item from a map (<code>?</code>) with function invocation (<code>=&gt;</code>)</p>
<p>(b) <code>?&gt;</code>, while technically unambiguous, smells strongly of XML processing instructions</p>
</div></details></div>
<div class="toot" id="closed-2100"><h2>Issue #2100 closed<span class="toot-id"> #closed-2100</span></h2><div class="pubdate">12 Aug at 21:32:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2100">https://github.com/qt4cg/qtspecs/issues/2100</a></div><p>JNodes: functions</p></div>
<div class="toot" id="closed-2149"><h2>Issue #2149 closed<span class="toot-id"> #closed-2149</span></h2><div class="pubdate">12 Aug at 21:32:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2149">https://github.com/qt4cg/qtspecs/pull/2149</a></div><p>2100 Make innermost, outermost, has-children, path apply to JNodes</p></div>
<div class="toot" id="created-2162"><h2>Pull request #2162 created<span class="toot-id"> #created-2162</span></h2><div class="pubdate">12 Aug at 20:54:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2162">https://github.com/qt4cg/qtspecs/pull/2162</a></div><details><summary>QT4CG-132-04 Expand the rectangle?area example</summary><div class="markup"><p>Expands the explanation of the example of method chaining</p>
</div></details></div>
<div class="toot" id="minutes—08-12"><h2>QT4 CG meeting 132 draft minutes<span class="toot-id"> #minutes—08-12</span></h2><div class="pubdate">12 Aug at 16:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/08-12">https://qt4cg.org/meeting/minutes/2025/08-12</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2132"><h2>Issue #2132 closed<span class="toot-id"> #closed-2132</span></h2><div class="pubdate">12 Aug at 16:16:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2132">https://github.com/qt4cg/qtspecs/issues/2132</a></div><p>Error handling in and/or expressions</p></div>
<div class="toot" id="closed-2133"><h2>Issue #2133 closed<span class="toot-id"> #closed-2133</span></h2><div class="pubdate">12 Aug at 16:16:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2133">https://github.com/qt4cg/qtspecs/pull/2133</a></div><p>2132 error handling in logical expressions</p></div>
<div class="toot" id="closed-1996"><h2>Issue #1996 closed<span class="toot-id"> #closed-1996</span></h2><div class="pubdate">12 Aug at 16:14:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1996">https://github.com/qt4cg/qtspecs/issues/1996</a></div><p>Lookups, KeySpecifier: add NumericLiteral and ContextValueRef?</p></div>
<div class="toot" id="closed-2134"><h2>Issue #2134 closed<span class="toot-id"> #closed-2134</span></h2><div class="pubdate">12 Aug at 16:14:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2134">https://github.com/qt4cg/qtspecs/pull/2134</a></div><p>1996 Lookups, KeySpecifier: Literal, ContextValueRef</p></div>
<div class="toot" id="closed-2147"><h2>Issue #2147 closed<span class="toot-id"> #closed-2147</span></h2><div class="pubdate">12 Aug at 16:12:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2147">https://github.com/qt4cg/qtspecs/pull/2147</a></div><p>2143 Redesign of method calls</p></div>
<div class="toot" id="closed-2152"><h2>Issue #2152 closed<span class="toot-id"> #closed-2152</span></h2><div class="pubdate">12 Aug at 16:08:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2152">https://github.com/qt4cg/qtspecs/issues/2152</a></div><p>"x" is not an instance of enum("x")</p></div>
<div class="toot" id="closed-2154"><h2>Issue #2154 closed<span class="toot-id"> #closed-2154</span></h2><div class="pubdate">12 Aug at 16:08:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2154">https://github.com/qt4cg/qtspecs/pull/2154</a></div><p>2152 Revise rules for enumeration types</p></div>
<div class="toot" id="closed-2156"><h2>Issue #2156 closed<span class="toot-id"> #closed-2156</span></h2><div class="pubdate">12 Aug at 16:06:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2156">https://github.com/qt4cg/qtspecs/pull/2156</a></div><p>2092 Drop map:pair, map:of-pairs, map-pairs</p></div>
<div class="toot" id="closed-2135"><h2>Issue #2135 closed<span class="toot-id"> #closed-2135</span></h2><div class="pubdate">12 Aug at 16:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2135">https://github.com/qt4cg/qtspecs/pull/2135</a></div><p>QT4CG-131-01/02 Expand on example as actioned</p></div>
<div class="toot" id="closed-2136"><h2>Issue #2136 closed<span class="toot-id"> #closed-2136</span></h2><div class="pubdate">12 Aug at 16:02:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2136">https://github.com/qt4cg/qtspecs/issues/2136</a></div><p>Drop full-width angle brackets</p></div>
<div class="toot" id="closed-2137"><h2>Issue #2137 closed<span class="toot-id"> #closed-2137</span></h2><div class="pubdate">12 Aug at 16:02:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2137">https://github.com/qt4cg/qtspecs/pull/2137</a></div><p>2136 Drop full-width &lt; and &gt; symbols</p></div>
<div class="toot" id="closed-2141"><h2>Issue #2141 closed<span class="toot-id"> #closed-2141</span></h2><div class="pubdate">12 Aug at 15:59:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2141">https://github.com/qt4cg/qtspecs/pull/2141</a></div><p>Remove nested paragraphs</p></div>
<div class="toot" id="closed-2145"><h2>Issue #2145 closed<span class="toot-id"> #closed-2145</span></h2><div class="pubdate">12 Aug at 15:57:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2145">https://github.com/qt4cg/qtspecs/pull/2145</a></div><p>Allow implicit whitespace in StringInterpolation</p></div>
<div class="toot" id="closed-2146"><h2>Issue #2146 closed<span class="toot-id"> #closed-2146</span></h2><div class="pubdate">12 Aug at 15:56:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2146">https://github.com/qt4cg/qtspecs/pull/2146</a></div><p>Require at least one character in StringTemplateFixedPart</p></div>
<div class="toot" id="closed-1062"><h2>Issue #1062 closed<span class="toot-id"> #closed-1062</span></h2><div class="pubdate">12 Aug at 15:55:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1062">https://github.com/qt4cg/qtspecs/pull/1062</a></div><p>150bis revised proposal for fn:ranks</p></div>
<div class="toot" id="closed-150"><h2>Issue #150 closed<span class="toot-id"> #closed-150</span></h2><div class="pubdate">12 Aug at 15:55:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/150">https://github.com/qt4cg/qtspecs/issues/150</a></div><p>fn:ranks: Produce all ranks in applying a function on the items of a sequence</p></div>
<div class="toot" id="closed-714"><h2>Issue #714 closed<span class="toot-id"> #closed-714</span></h2><div class="pubdate">12 Aug at 15:55:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/714">https://github.com/qt4cg/qtspecs/issues/714</a></div><p>Function annotations in XSLT</p></div>
<div class="toot" id="closed-1698"><h2>Issue #1698 closed<span class="toot-id"> #closed-1698</span></h2><div class="pubdate">12 Aug at 15:55:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1698">https://github.com/qt4cg/qtspecs/issues/1698</a></div><p>Allow select attribute for xsl:call-template instruction</p></div>
<div class="toot" id="closed-1852"><h2>Issue #1852 closed<span class="toot-id"> #closed-1852</span></h2><div class="pubdate">12 Aug at 15:55:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1852">https://github.com/qt4cg/qtspecs/issues/1852</a></div><p>fn:values-except: Return atomic values that occur in A but not in B</p></div>
<div class="toot" id="closed-2157"><h2>Issue #2157 closed<span class="toot-id"> #closed-2157</span></h2><div class="pubdate">12 Aug at 15:53:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2157">https://github.com/qt4cg/qtspecs/issues/2157</a></div><p>Unicode collation algorithm references</p></div>
<div class="toot" id="closed-2158"><h2>Issue #2158 closed<span class="toot-id"> #closed-2158</span></h2><div class="pubdate">12 Aug at 15:53:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2158">https://github.com/qt4cg/qtspecs/pull/2158</a></div><p>2157 Editorial updates to F+O §5.5 (Unicode collations)</p></div>
<div class="toot" id="created-2161"><h2>Issue #2161 created<span class="toot-id"> #created-2161</span></h2><div class="pubdate">12 Aug at 15:35:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2161">https://github.com/qt4cg/qtspecs/issues/2161</a></div><details><summary>Drop other non-ASCII operators (×, ÷)</summary><div class="markup"><p>Adopted from https://github.com/qt4cg/qtspecs/issues/2136#issuecomment-3135426200:</p>
<p>The feedback for <code>U+00D7</code> (MULTIPLICATION SIGN, ×) and <code>U+00F7</code> (DIVISION SIGN, ÷) that we got so far was not very positive either, so I  would suggest dropping also those operators; they offer no real added value.</p>
</div></details></div>
<div class="toot" id="created-2160"><h2>Pull request #2160 created<span class="toot-id"> #created-2160</span></h2><div class="pubdate">12 Aug at 14:59:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2160">https://github.com/qt4cg/qtspecs/pull/2160</a></div><details><summary>2073 data model changes for JNodes and Sequences</summary><div class="markup"><p>This is a first draft of a PR, giving the data model changes only, for a change to the JNode model affecting maps and arrays with sequence-valued entries. A sequence of length 2 or more now has children representing the items in the sequence. Although there is still an asymmetry between sequences of length 1 and longer sequences, it is more manageable than i the previous model.</p>
</div></details></div>
<div class="toot" id="agenda-08-12"><h2>QT4 CG meeting 132 draft agenda<span class="toot-id"> #agenda-08-12</span></h2><div class="pubdate">11 Aug at 12:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/08-12">https://qt4cg.org/meeting/agenda/2025/08-12</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2159"><h2>Issue #2159 created<span class="toot-id"> #created-2159</span></h2><div class="pubdate">10 Aug at 05:16:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2159">https://github.com/qt4cg/qtspecs/issues/2159</a></div><details><summary>JNodes: Learning from JSONiq?</summary><div class="markup"><p>For those who have not stumbled upon JSONiq yet, I am adding some introductory links:</p>
<ul>
<li>https://www.jsoniq.org/docs/JSONiq-usecases/html-single/</li>
<li>https://www.jsoniq.org/docs/Introduction_to_JSONiq/html/</li>
<li>https://www.jsoniq.org/docs/JSONiqExtensionToXQuery/html-single/index.html</li>
</ul>
<p>JSONiq has been designed as a query and update language for JSON data. Its first versions were based on XQuery. Due to its similarities, it may give us some good inspirations for traversing and modifying JNodes.</p>
<p><a href="https://www.rumbledb.org/">RumbleDB</a> is a current implementation maintained by Ghislain Fourny (@ghislainfourny).</p>
</div></details></div>
<div class="toot" id="created-2158"><h2>Pull request #2158 created<span class="toot-id"> #created-2158</span></h2><div class="pubdate">09 Aug at 11:29:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2158">https://github.com/qt4cg/qtspecs/pull/2158</a></div><details><summary>2157 Editorial updates to F+O §5.5 (Unicode collations)</summary><div class="markup"><p>Fix #2157</p>
</div></details></div>
<div class="toot" id="created-2157"><h2>Issue #2157 created<span class="toot-id"> #created-2157</span></h2><div class="pubdate">09 Aug at 10:18:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2157">https://github.com/qt4cg/qtspecs/issues/2157</a></div><details><summary>Unicode collation algorithm references</summary><div class="markup"><p>In the F&amp;O reference to UTS#10 we say incorrectly that: The current version is 9.0.0, dated 2016-05-18.</p>
<p>Similarly for UTS#35 we say incorrectly: The current version is 29, dated 2016-03-15.</p>
<p>In §5.5, functions based on substring matching, we say</p>
<p>"In the definitions below, we refer to the terms match and minimal match as defined in definitions DS2 and DS4 of [[UTS #10]]."</p>
<p>It's not made clear what "the definitions below" is referring to: the terms "match" and "minimal match" are actually used in the rules of the individual functions.</p>
<p>The parenthetical sentence <code>(“collation unit” is equivalent to "collation element" as defined in [[UTS #10]])</code> is not very elegantly expressed.</p>
</div></details></div>
<div class="toot" id="created-2156"><h2>Pull request #2156 created<span class="toot-id"> #created-2156</span></h2><div class="pubdate">08 Aug at 21:35:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2156">https://github.com/qt4cg/qtspecs/pull/2156</a></div><details><summary>2092 Drop map:pair, map:of-pairs, map-pairs</summary><div class="markup"><p>Addresses part of issue #2092.</p>
<p>While the function family <code>map:pair</code>, <code>map:of-pairs</code>, and <code>map:pairs</code> can be handy, they are not necessary, especially now that we have JNodes. They are also very easily user-written:</p>
<p><code>map:pair =&gt; {'key': $key, 'value': $value}</code></p>
<p><code>map:of-pairs =&gt; map:build($pairs, fn{?key}, fn{?value})</code></p>
<p><code>map:pairs =&gt; map:for-each($map, fn($k, $v){  {'key': $k, 'value': $v })</code></p>
<p>On the grounds that we should avoid providing multiple ways of solving the same problem, I propose dropping these three functions.</p>
<p>Note: in some ways I would have preferred to drop the alternative trio map:entry, map:entries, and map:merge; but two of these are present in the 3.1 specification.</p>
</div></details></div>
<div class="toot" id="closed-2021"><h2>Issue #2021 closed<span class="toot-id"> #closed-2021</span></h2><div class="pubdate">08 Aug at 18:31:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2021">https://github.com/qt4cg/qtspecs/issues/2021</a></div><p>XSLT: Move "Patterns" section into "Template Rules"</p></div>
<div class="toot" id="closed-2078"><h2>Issue #2078 closed<span class="toot-id"> #closed-2078</span></h2><div class="pubdate">08 Aug at 01:28:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2078">https://github.com/qt4cg/qtspecs/issues/2078</a></div><p>2031/2025 JNodes: inconsistency in data model taxonomy, definitions</p></div>
<div class="toot" id="created-2155"><h2>Pull request #2155 created<span class="toot-id"> #created-2155</span></h2><div class="pubdate">07 Aug at 12:02:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2155">https://github.com/qt4cg/qtspecs/pull/2155</a></div><details><summary>2150 Define patterns for JNodes</summary><div class="markup"><p>Fix #2150
Fix #2010</p>
</div></details></div>
<div class="toot" id="closed-2151"><h2>Issue #2151 closed<span class="toot-id"> #closed-2151</span></h2><div class="pubdate">07 Aug at 09:06:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2151">https://github.com/qt4cg/qtspecs/pull/2151</a></div><p>2021 Move the section on Patterns to a more logical place in the spec</p></div>
<div class="toot" id="closed-2153"><h2>Issue #2153 closed<span class="toot-id"> #closed-2153</span></h2><div class="pubdate">07 Aug at 08:27:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2153">https://github.com/qt4cg/qtspecs/issues/2153</a></div><p>Remove limitations from `enum` type</p></div>
<div class="toot" id="created-2154"><h2>Pull request #2154 created<span class="toot-id"> #created-2154</span></h2><div class="pubdate">07 Aug at 08:25:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2154">https://github.com/qt4cg/qtspecs/pull/2154</a></div><details><summary>2152 Revise rules for enumeration types</summary><div class="markup"><p>Fix #2152</p>
<p>Revises the rules for enumeration types: they are now structural subtypes of <code>xs:string</code> rather than nominative subtypes. The main effect is that <code>"x" instance of enum("x")</code> is now true. The change is motivated by use cases involving XSLT pattern matching, where strict "instance of" matching is required, with no coercion.</p>
</div></details></div>
<div class="toot" id="created-2153"><h2>Issue #2153 created<span class="toot-id"> #created-2153</span></h2><div class="pubdate">06 Aug at 18:53:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2153">https://github.com/qt4cg/qtspecs/issues/2153</a></div><details><summary>Remove limitations from `enum` type</summary><div class="markup"><blockquote>
<p>"Tolkein" isn't an actual instance of enum("Tolkein"), it's only coercible to that type, and when types are used in paths it has to be an actual instance. I think we need to fix that.</p>
</blockquote>
<p><em>Originally posted by @michaelhkay in <a href="https://github.com/qt4cg/qtspecs/issues/2150#issuecomment-3160717989">#2150</a></em></p>
<p>It seems strange that there is no way to create a value that is an instance of a <em>singleton enumeration type</em>. Only casting (and  annotation, which is a kind of casting too) is available.</p>
<p>On the other hand:</p>
<pre><code class="language-xquery">let $x as enum("foo") := "foo"
return ( ()
  , $x instance of enum("foo")
  , $x instance of xs:string
  , atomic-equal($x, "foo")
)
(: true(), true(), true() :)
</code></pre>
<p>This means that <code>"foo"</code> <strong>should</strong> be an instance of <code>enum("foo")</code>, and then <code>enum("foo")</code> is a subtype of <code>xs:string</code>.</p>
<p>And the following is unclear (from <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-enumeration-types">3.2.6 Enumeration Types</a>):</p>
<ul>
<li>
<blockquote>
<p>It follows from these rules that an atomic item will only satisfy an <code>instance of</code> test if it has the correct type annotation, and this typically requires an explicit cast. So the expression <code>"red" instance of enum("red", "green", "blue")</code> returns <code>false</code>, while <code>"red" cast as enum("red") instance of enum("red", "green", "blue")</code> returns <code>true</code>.</p>
</blockquote>
</li>
</ul>
<p>Probably, a more narrow reason is that a singleton enumeration type is an "anonymous atomic type derived from <code>xs:string</code> <em>by restriction</em> using an enumeration facet" that permits only one value.  Yes, this makes type checking for an enum more complex, but seems not more complex than casting.</p>
<p>Anyway, is it possible to make any instance of <code>xs:string</code> also an instance of the corresponding singleton enumeration type?  (that is, essentially make it so that this casting happens "hidden", if required).</p>
</div></details></div>
<div class="toot" id="created-2152"><h2>Issue #2152 created<span class="toot-id"> #created-2152</span></h2><div class="pubdate">06 Aug at 15:55:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2152">https://github.com/qt4cg/qtspecs/issues/2152</a></div><details><summary>"x" is not an instance of enum("x")</summary><div class="markup"><p>The usefulness of enum() types is limited by the fact that the string "x" is not actually an instance of <code>enum("x")</code>, it is only coercible to that type. This means that in contexts where strict type matching is required (for example, in XSLT patterns), either (a) you can't use enum() the way you would like, or (b) you use it and fail to understand why it fails.</p>
</div></details></div>
<div class="toot" id="created-2151"><h2>Pull request #2151 created<span class="toot-id"> #created-2151</span></h2><div class="pubdate">06 Aug at 11:04:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2151">https://github.com/qt4cg/qtspecs/pull/2151</a></div><details><summary>2021 Move the section on Patterns to a more logical place in the spec</summary><div class="markup"><p>This PR simply moves the section on Patterns to a more logical place in the XSLT specification. Unless anyone objects, I will merge the PR without waiting for group approval, so that I can use the result as a baseline for further work on patterns and templates, hopefully giving a better diff baseline.</p>
</div></details></div>
<div class="toot" id="closed-1776"><h2>Issue #1776 closed<span class="toot-id"> #closed-1776</span></h2><div class="pubdate">06 Aug at 08:27:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1776">https://github.com/qt4cg/qtspecs/issues/1776</a></div><p>Using `?` and `??` in XSLT patterns</p></div>
<div class="toot" id="created-2150"><h2>Issue #2150 created<span class="toot-id"> #created-2150</span></h2><div class="pubdate">06 Aug at 08:26:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2150">https://github.com/qt4cg/qtspecs/issues/2150</a></div><details><summary>XSLT Patterns to match JNodes</summary><div class="markup"><p>Supersedes #1776.</p>
<p>Part of the motivation for introducing JNodes was to make rule-based recursive-descent transformation of JSON structures much easier. This issue addresses part of that capability, namely defining patterns that match JNodes (and perhaps improving the patterns that match maps and arrays).</p>
<p>In general I think the patterns that match JNodes should be distinct from the patterns that match XNodes; although we have unified path expressions so that a/b can select either an XNode or a JNode, I think there would be too much scope for confusion if match="a/b" were able to match a JNode as well as an XNode.</p>
<p>My first idea would be to allow the syntax <code>match="jnode(a)"</code> for a template rule that matches JNodes having a selector property of "a", similarly <code>jnode(a/b)</code>, <code>jnode(a//b)</code>, <code>jnode(a/*/b)</code>, <code>jnode(a[x="c"])</code> with semantics defined in much the same way.</p>
<p>But there's a question how this relates to type patterns. With type patterns, we can already do <code>match="type(jnode(record(Author, Title, *)))"</code> which matches a JNode whose content is of type <code>record(Author, Title, *)</code>. Where syntactically possible we allow type patterns to be abbreviated, so this would become <code>match="jnode(record(Author, Title, *))"</code> which conflicts with the above.</p>
<p>An analogy with <code>element(N, T)</code> might suggest <code>match="jnode(K, V)"</code> where K constrains the selector property of the JNode, and V constrains its content property. So we might have <code>match="jnode(books, array(record(Author, Title, *)))"</code> to match a JNode whose selector is "books" and whose content is of type  <code>array(record(Author, Title, *))</code>.</p>
<p>At the same time, while matching maps by a type such as <code>match="record(Author, Title, *))"</code> works well, I find that this is often accompatied by a predicate so it becomes <code>match="record(Author, Title, *))[Author='Tolkein']"</code>. It would be nice to express this more concisely and readably perhaps as <code>match="record(Author[.='Tolkein'], Title, *))"</code></p>
</div></details></div>
<div class="toot" id="closed-115"><h2>Issue #115 closed<span class="toot-id"> #closed-115</span></h2><div class="pubdate">06 Aug at 07:52:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/115">https://github.com/qt4cg/qtspecs/issues/115</a></div><p>Lookup operator on arrays of maps</p></div>
<div class="toot" id="created-2149"><h2>Pull request #2149 created<span class="toot-id"> #created-2149</span></h2><div class="pubdate">05 Aug at 11:52:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2149">https://github.com/qt4cg/qtspecs/pull/2149</a></div><details><summary>2100 Make innermost, outermost, has-children, path apply to JNodes</summary><div class="markup"><p>Fix #2100</p>
</div></details></div>
<div class="toot" id="created-2148"><h2>Issue #2148 created<span class="toot-id"> #created-2148</span></h2><div class="pubdate">05 Aug at 09:21:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2148">https://github.com/qt4cg/qtspecs/issues/2148</a></div><details><summary>fn:base-uri: Raise errors?</summary><div class="markup"><p>The (rather old) test case <a href="https://github.com/qt4cg/qt4tests/blob/cf7c1ed9990279dbaf2297b8fe252a3ca4a3c0ad/fn/base-uri.xml#L799-L811"><code>K2-BaseURIFunc-29</code></a> indicates that invalid URIs may result in an error:</p>
<pre><code class="language-xml">&lt;test-case name="K2-BaseURIFunc-29"&gt;
  &lt;description&gt; Use an URI in an xml:base element that is a valid URI, but an invalid HTTP URL. 
    Since implementations aren't required to validate specific schemes but allowed to, 
    this may either raise an error or return the URI. 
  &lt;/description&gt;
  &lt;created by="Frans Englich" on="2007-11-26"/&gt;
  &lt;dependency type="spec" value="XQ10+"/&gt;
  &lt;test&gt;&lt;![CDATA[let $i := fn:base-uri(&lt;anElement xml:base="http:\\example.com\\examples"&gt;Element content&lt;/anElement&gt;) 
    return $i eq "http:\\example.com\\examples" or empty($i)]]&gt;&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-true/&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
</code></pre>
<p>I raise this issue in the qtspecs repository as I wondered whether we should clarify how invalid URIs are to be handled by <code>fn:base-uri</code>.</p>
<p>If it’s the test that is misleading, I will be glad to correct the comment, or add an error code.</p>
</div></details></div>
<div class="toot" id="created-2147"><h2>Pull request #2147 created<span class="toot-id"> #created-2147</span></h2><div class="pubdate">05 Aug at 08:49:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2147">https://github.com/qt4cg/qtspecs/pull/2147</a></div><details><summary>2143 Redesign of method calls</summary><div class="markup"><p>Although issue #2143 envisaged redefining method calls in terms of JNodes, this PR takes a different approach.</p>
<p>The "magic" performed by the lookup operator when the entry in a map is annotated %method is dropped. Instead we have a new operator <code>?&gt;</code> which is essentially defined as a macro: in simple cases <code>$map ?&gt; method (X)</code> is defined to be essentially an abbreviation for <code>($map ? method)($map, X)</code>.</p>
<p>I have used the operator <code>?&gt;</code> suggested by Christian, but in some ways I prefer the operator we had originally, <code>=?&gt;</code>, because (a) there is a stronger analogy with <code>=&gt;</code>, and (b) <code>?&gt;</code> brings up images of XML syntax for processing instructions.</p>
</div></details></div>
<div class="toot" id="created-2146"><h2>Pull request #2146 created<span class="toot-id"> #created-2146</span></h2><div class="pubdate">04 Aug at 19:01:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2146">https://github.com/qt4cg/qtspecs/pull/2146</a></div><details><summary>Require at least one character in StringTemplateFixedPart</summary><div class="markup"><p>The grammar rules for <code>StringTemplate</code> are as follows:</p>
<pre><code>StringTemplate              ::=  "`" (StringTemplateFixedPart | StringTemplateVariablePart)* "`"
                                                                                      /* ws: explicit */
StringTemplateFixedPart     ::=  ((Char - ('{' | '}' | '`')) | "{{" | "}}" | "``")*
                                                                                      /* ws: explicit */
StringTemplateVariablePart  ::=  EnclosedExpr
                                                                                      /* ws: explicit */
</code></pre>
<p>But <code>StringTemplateFixedPart</code> should not be allowed as a zero-length token, because this is causing an ambiguity: the input <code>``</code> currently can be parsed as any of</p>
<pre><code class="language-xml">&lt;StringTemplate&gt;`&lt;StringTemplateFixedPart/&gt;`&lt;/StringTemplate&gt;
</code></pre>
<pre><code class="language-xml">&lt;StringTemplate&gt;`&lt;StringTemplateFixedPart/&gt;&lt;StringTemplateFixedPart/&gt;`&lt;/StringTemplate&gt;
</code></pre>
<pre><code class="language-xml">&lt;StringTemplate&gt;`&lt;StringTemplateFixedPart/&gt;&lt;StringTemplateFixedPart/&gt;&lt;StringTemplateFixedPart/&gt;`&lt;/StringTemplate&gt;
</code></pre>
<p>and so on.</p>
<p>In order to ensure an unambiguous result, <code>StringTemplateFixedPart</code> should be required to consist of at least one character. Also the <code>/* ws: explicit */</code> on <code>StringTemplateVariablePart</code> is superfluous. The grammar rules thus should be changed to:</p>
<pre><code class="language-xml">StringTemplate              ::=  "`" (StringTemplateFixedPart | StringTemplateVariablePart)* "`"
                                                                                      /* ws: explicit */
StringTemplateFixedPart     ::=  ((Char - ('{' | '}' | '`')) | "{{" | "}}" | "``")+
                                                                                      /* ws: explicit */
StringTemplateVariablePart  ::=  EnclosedExpr
</code></pre>
</div></details></div>
<div class="toot" id="created-2145"><h2>Pull request #2145 created<span class="toot-id"> #created-2145</span></h2><div class="pubdate">03 Aug at 19:22:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2145">https://github.com/qt4cg/qtspecs/pull/2145</a></div><details><summary>Allow implicit whitespace in StringInterpolation</summary><div class="markup"><p>Production <code>StringInterpolation</code> currently does not allow implicit whitespace:</p>
<pre><code>StringInterpolation ::= "`{"  Expr?  "}`"
                                                                         /* ws: explicit */
</code></pre>
<p>But this is likely not intended - all examples in the spec do have whitespace adjacent to the braces.</p>
<p>This change thus removes <code> /* ws: explicit */</code> in order to allow implicit whitespace.</p>
</div></details></div>
<div class="toot" id="created-2143"><h2>Issue #2143 created<span class="toot-id"> #created-2143</span></h2><div class="pubdate">03 Aug at 07:05:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2143">https://github.com/qt4cg/qtspecs/issues/2143</a></div><details><summary>JNodes and Methods</summary><div class="markup"><p>I propose changing the mechanism for invoking methods to take advantage of JNodes.</p>
<p>Instead of the current magic rule for the "?" operator, we move the magic to the rules for dynamic function calls: in a dynamic function call F(X, Y), if the value of F is a JNode J whose content property is a function item annotated with %method, then the function body is executed with the parent of J (that is, the containing map or array) as the context value. It seems much cleaner semantics to make this a rule for dynamic function calls rather than for map lookup.</p>
<p>The downside is that the call syntax now would become <code>($rectangle/area)()</code> rather than <code>$rectangle?area()</code>. Unfortunately <code>$rectangle/area()</code> parses as <code>$rectangle/(area())</code>. So we might want to invent some better syntax.</p>
</div></details></div>
<div class="toot" id="closed-2142"><h2>Issue #2142 closed<span class="toot-id"> #closed-2142</span></h2><div class="pubdate">01 Aug at 12:56:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2142">https://github.com/qt4cg/qtspecs/pull/2142</a></div><p>Markup fixes in the HTML output</p></div>
<div class="toot" id="created-2142"><h2>Pull request #2142 created<span class="toot-id"> #created-2142</span></h2><div class="pubdate">01 Aug at 12:56:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2142">https://github.com/qt4cg/qtspecs/pull/2142</a></div><details><summary>Markup fixes in the HTML output</summary><div class="markup"><ol>
<li>Moved all the processor comments to the end; this avoids having a comment before <code>&lt;!DOCTYPE HTML&gt;</code> which is frowned upon because ... reasons</li>
<li>The XSLT stylesheet was adding links for sections, but so was the main stylesheet, so they were coming out nested.</li>
<li>Don't attempt to link to functions or elements inside titles. (This also results in nested links)</li>
<li>Attempt to "unwrap" <code>&lt;p&gt;</code> elements around things that can't be inside a <code>&lt;p&gt;</code>, like various sorts of lists. It's a bit ugly, but it makes for much cleaner HTML.</li>
</ol>
<p>I'm just going to merge this because there's no practical way to see the consequences in the PR.</p>
<p>Apologies in advance that this will introduce some spurious diffs. I think those will go away after the build finishes and after you've rebased your PRs on the new stylesheets.</p>
</div></details></div>
<div class="toot" id="created-2141"><h2>Pull request #2141 created<span class="toot-id"> #created-2141</span></h2><div class="pubdate">01 Aug at 11:27:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2141">https://github.com/qt4cg/qtspecs/pull/2141</a></div><details><summary>Remove nested paragraphs</summary><div class="markup"><p>I have no idea why the DTD allows <code>&lt;p&gt;</code> inside <code>&lt;p&gt;</code> but I assume this is a markup error and not intentional.</p>
</div></details></div>
<div class="toot" id="closed-2140"><h2>Issue #2140 closed<span class="toot-id"> #closed-2140</span></h2><div class="pubdate">01 Aug at 11:25:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2140">https://github.com/qt4cg/qtspecs/pull/2140</a></div><p>Restore diffs</p></div>
<div class="toot" id="created-2140"><h2>Pull request #2140 created<span class="toot-id"> #created-2140</span></h2><div class="pubdate">01 Aug at 11:24:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2140">https://github.com/qt4cg/qtspecs/pull/2140</a></div><details><summary>Restore diffs</summary><div class="markup"><p>With great appreciation to the fine folks at DeltaXignia!</p>
</div></details></div>
<div class="toot" id="closed-2138"><h2>Issue #2138 closed<span class="toot-id"> #closed-2138</span></h2><div class="pubdate">31 Jul at 17:39:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2138">https://github.com/qt4cg/qtspecs/issues/2138</a></div><p>NodeTest `type(X|Y)`: double parentheses needed</p></div>
<div class="toot" id="created-2139"><h2>Issue #2139 created<span class="toot-id"> #created-2139</span></h2><div class="pubdate">31 Jul at 10:42:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2139">https://github.com/qt4cg/qtspecs/issues/2139</a></div><details><summary>Binary comparisons</summary><div class="markup"><p>It seems confusing to me that <code>deep-equal</code> &amp; <code>atomic-equal</code> return different results than <code>eq</code> for binary types:</p>
<pre><code class="language-xquery">let $hex := xs:hexBinary(''), $base64 := xs:base64Binary('')
return (
  (: false :) deep-equal($hex, $base64),
  (: false :) atomic-equal($hex, $base64),
  (: true  :) $hex eq $base64
)
</code></pre>
<p>The rules say:</p>
<h4><code>fn:deep-equal</code></h4>
<blockquote>
<p>If both <code>$i1</code> and <code>$i2</code> are instances of <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, <code>$i1</code> eq <code>$i2</code> returns <code>true</code>.</p>
</blockquote>
<p>This can be interpreted in two ways, but it seems to mean that <code>$i1</code> and <code>$i2</code> need to have the same type?</p>
<h4><code>fn:atomic-equal</code></h4>
<blockquote>
<p>One of the following conditions is true:
<code>$value1</code> and <code>$value2</code> are both instances of <code>xs:hexBinary</code>.
<code>$value1</code> and <code>$value2</code> are both instances of <code>xs:base64Binary</code>.</p>
</blockquote>
<h4><code>op:binary-equal</code></h4>
<blockquote>
<pre><code>op:binary-equal(
  $value1	as (xs:hexBinary | xs:base64Binary),	
  $value2	as (xs:hexBinary | xs:base64Binary)	
) as xs:boolean
</code></pre>
<p>The function returns <code>true</code> if <code>$value1</code> and <code>$value2</code> are of the same length, measured in binary octets, and contain the same octets in the same order. Otherwise, it returns <code>false</code>.</p>
</blockquote>
<p>As <code>atomic-equal(xs:double(3), xs:float(3))</code> returns <code>true</code>, I would also expect <code>true</code> for binary items with the same contents.</p>
<p>Related (for numbers): #986</p>
</div></details></div>
<div class="toot" id="created-2138"><h2>Issue #2138 created<span class="toot-id"> #created-2138</span></h2><div class="pubdate">30 Jul at 22:11:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2138">https://github.com/qt4cg/qtspecs/issues/2138</a></div><details><summary>NodeTest `type(X|Y)`: double parentheses needed</summary><div class="markup"><p>It is not currently possible to write a NodeTest as (for example) <code>child::type(xs:string | xs:integer)</code>. As a consequence of the way the grammar is defined, two pairs of parentheses are needed: <code>child::type((xs:string | xs:integer))</code></p>
<p>It would be easy enough to fix this usability glitch.</p>
</div></details></div>
<div class="toot" id="created-2137"><h2>Pull request #2137 created<span class="toot-id"> #created-2137</span></h2><div class="pubdate">30 Jul at 07:29:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2137">https://github.com/qt4cg/qtspecs/pull/2137</a></div><details><summary>2136 Drop full-width &lt; and &gt; symbols</summary><div class="markup"><p>Fix #2136</p>
</div></details></div>
<div class="toot" id="created-2136"><h2>Issue #2136 created<span class="toot-id"> #created-2136</span></h2><div class="pubdate">30 Jul at 06:58:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2136">https://github.com/qt4cg/qtspecs/issues/2136</a></div><details><summary>Drop full-width angle brackets</summary><div class="markup"><p>The option of using full-width angle brackets doesn't seem to have attracted great enthusiasm, and now that we have the <code>precedes</code> and <code>follows</code> operators, I suggest we drop them. Nearly all cases of plain <code>&lt;</code> and <code>&lt;=</code> can be replaced with <code>lt</code> and <code>le</code>.</p>
<p>One of the problems with using non-ASCII characters is not just that it's hard to type them, it's also quite hard to recognise them by their appearance. There are so many characters that look a bit like less-than and greater-than symbols.</p>
</div></details></div>
<div class="toot" id="created-2135"><h2>Pull request #2135 created<span class="toot-id"> #created-2135</span></h2><div class="pubdate">29 Jul at 17:45:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2135">https://github.com/qt4cg/qtspecs/pull/2135</a></div><details><summary>QT4CG-131-01/02 Expand on example as actioned</summary><div class="markup"><p>Expands on the let binding example</p>
</div></details></div>
<div class="toot" id="minutes—07-29"><h2>QT4 CG meeting 131 draft minutes<span class="toot-id"> #minutes—07-29</span></h2><div class="pubdate">29 Jul at 16:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/07-29">https://qt4cg.org/meeting/minutes/2025/07-29</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2130"><h2>Issue #2130 closed<span class="toot-id"> #closed-2130</span></h2><div class="pubdate">29 Jul at 16:23:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2130">https://github.com/qt4cg/qtspecs/pull/2130</a></div><p>Proposed new operator keywords: precedes, follows</p></div>
<div class="toot" id="closed-2080"><h2>Issue #2080 closed<span class="toot-id"> #closed-2080</span></h2><div class="pubdate">29 Jul at 16:20:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2080">https://github.com/qt4cg/qtspecs/issues/2080</a></div><p>Destructuring let clauses: Bind remaining values</p></div>
<div class="toot" id="closed-2119"><h2>Issue #2119 closed<span class="toot-id"> #closed-2119</span></h2><div class="pubdate">29 Jul at 16:20:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2119">https://github.com/qt4cg/qtspecs/pull/2119</a></div><p>2080 allow let $($head, $tail)</p></div>
<div class="toot" id="closed-2087"><h2>Issue #2087 closed<span class="toot-id"> #closed-2087</span></h2><div class="pubdate">29 Jul at 16:17:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2087">https://github.com/qt4cg/qtspecs/issues/2087</a></div><p>Adaptive serialization: JNodes</p></div>
<div class="toot" id="closed-2114"><h2>Issue #2114 closed<span class="toot-id"> #closed-2114</span></h2><div class="pubdate">29 Jul at 16:17:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2114">https://github.com/qt4cg/qtspecs/pull/2114</a></div><p>2087 Change adaptive serialization of JNodes</p></div>
<div class="toot" id="closed-2084"><h2>Issue #2084 closed<span class="toot-id"> #closed-2084</span></h2><div class="pubdate">29 Jul at 16:14:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2084">https://github.com/qt4cg/qtspecs/issues/2084</a></div><p>Steps when the context value contains multiple nodes</p></div>
<div class="toot" id="closed-2115"><h2>Issue #2115 closed<span class="toot-id"> #closed-2115</span></h2><div class="pubdate">29 Jul at 16:14:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2115">https://github.com/qt4cg/qtspecs/pull/2115</a></div><p>2084 - document order of axis steps when context value is a sequence</p></div>
<div class="toot" id="closed-2082"><h2>Issue #2082 closed<span class="toot-id"> #closed-2082</span></h2><div class="pubdate">29 Jul at 16:12:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2082">https://github.com/qt4cg/qtspecs/issues/2082</a></div><p>parse-html options parameter conventions</p></div>
<div class="toot" id="closed-2117"><h2>Issue #2117 closed<span class="toot-id"> #closed-2117</span></h2><div class="pubdate">29 Jul at 16:12:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2117">https://github.com/qt4cg/qtspecs/pull/2117</a></div><p>2082 parse-html options</p></div>
<div class="toot" id="closed-2099"><h2>Issue #2099 closed<span class="toot-id"> #closed-2099</span></h2><div class="pubdate">29 Jul at 16:09:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2099">https://github.com/qt4cg/qtspecs/issues/2099</a></div><p>Choosing names for the jnode function and the jnode type</p></div>
<div class="toot" id="closed-2129"><h2>Issue #2129 closed<span class="toot-id"> #closed-2129</span></h2><div class="pubdate">29 Jul at 16:09:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2129">https://github.com/qt4cg/qtspecs/pull/2129</a></div><p>2099 Rename fn:jnode and jnode-type</p></div>
<div class="toot" id="closed-2086"><h2>Issue #2086 closed<span class="toot-id"> #closed-2086</span></h2><div class="pubdate">29 Jul at 16:09:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2086">https://github.com/qt4cg/qtspecs/issues/2086</a></div><p>Can the ¶value property of a JNode be (or contain) a JNode?</p></div>
<div class="toot" id="closed-1978"><h2>Issue #1978 closed<span class="toot-id"> #closed-1978</span></h2><div class="pubdate">29 Jul at 16:09:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1978">https://github.com/qt4cg/qtspecs/issues/1978</a></div><p>Function `map:build` does not allow expressing the dependency of a value on its key. Some simple types of maps cannot be built.</p></div>
<div class="toot" id="closed-1946"><h2>Issue #1946 closed<span class="toot-id"> #closed-1946</span></h2><div class="pubdate">29 Jul at 16:09:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1946">https://github.com/qt4cg/qtspecs/issues/1946</a></div><p>We need examples of a record with an entry that is a %method and invoking this method with the result it must produce</p></div>
<div class="toot" id="closed-1514"><h2>Issue #1514 closed<span class="toot-id"> #closed-1514</span></h2><div class="pubdate">29 Jul at 16:08:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1514">https://github.com/qt4cg/qtspecs/issues/1514</a></div><p>Editorial: optional position argument in function signature for for-each and other HOF </p></div>
<div class="toot" id="closed-1175"><h2>Issue #1175 closed<span class="toot-id"> #closed-1175</span></h2><div class="pubdate">29 Jul at 16:08:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1175">https://github.com/qt4cg/qtspecs/issues/1175</a></div><p>XPath: Optional parameters in the definition of an inline function</p></div>
<div class="toot" id="closed-2102"><h2>Issue #2102 closed<span class="toot-id"> #closed-2102</span></h2><div class="pubdate">29 Jul at 16:06:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2102">https://github.com/qt4cg/qtspecs/issues/2102</a></div><p>Type diagrams: drop/add parentheses</p></div>
<div class="toot" id="closed-2113"><h2>Issue #2113 closed<span class="toot-id"> #closed-2113</span></h2><div class="pubdate">29 Jul at 16:06:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2113">https://github.com/qt4cg/qtspecs/pull/2113</a></div><p>2102 Make type labels in diagram consistent</p></div>
<div class="toot" id="created-2134"><h2>Pull request #2134 created<span class="toot-id"> #created-2134</span></h2><div class="pubdate">29 Jul at 06:35:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2134">https://github.com/qt4cg/qtspecs/pull/2134</a></div><details><summary>1996 Lookups, KeySpecifier: Literal, ContextValueRef</summary><div class="markup"><p>Revised; closes #1996</p>
</div></details></div>
<div class="toot" id="closed-2063"><h2>Issue #2063 closed<span class="toot-id"> #closed-2063</span></h2><div class="pubdate">29 Jul at 06:30:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2063">https://github.com/qt4cg/qtspecs/pull/2063</a></div><p>1996 Lookups, KeySpecifier: Literal, ContextValueRef</p></div>
<div class="toot" id="created-2133"><h2>Pull request #2133 created<span class="toot-id"> #created-2133</span></h2><div class="pubdate">28 Jul at 22:10:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2133">https://github.com/qt4cg/qtspecs/pull/2133</a></div><details><summary>2132 error handling in logical expressions</summary><div class="markup"><p>Note: depends on #2115 because of terminology changes.</p>
<p>Fix #2132</p>
</div></details></div>
<div class="toot" id="created-2132"><h2>Issue #2132 created<span class="toot-id"> #created-2132</span></h2><div class="pubdate">28 Jul at 19:49:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2132">https://github.com/qt4cg/qtspecs/issues/2132</a></div><details><summary>Error handling in and/or expressions</summary><div class="markup"><p>In §2.4.5 we introduced the concept of guarded expressions, and included the rules</p>
<ul>
<li>In an and expression, the second operand is guarded by the value of the first operand being true.</li>
<li>In an or expression, the second operand is guarded by the value of the first operand being false.</li>
</ul>
<p>This change is not mentioned in 4.11 Logical Expressions. For example, this still says</p>
<blockquote>
<p>The order in which the operands of a logical expression are evaluated is [implementation-dependent]</p>
</blockquote>
<p>and the truth tables in 4.11 are unchanged from 3.1.</p>
<p>(We have also introduced defined terms "and expression" and "or expression", and should use them here).</p>
<p>My understanding of the new rule for guarded expressions is that with (A and B), if A is false then the result is false even if B raises an error; this is not what the truth table says.</p>
</div></details></div>
<div class="toot" id="closed-2131"><h2>Issue #2131 closed<span class="toot-id"> #closed-2131</span></h2><div class="pubdate">28 Jul at 18:53:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2131">https://github.com/qt4cg/qtspecs/issues/2131</a></div><p>XSLT `xsl:for-each-group` `split-when` variables</p></div>
<div class="toot" id="agenda-07-29"><h2>QT4 CG meeting 131 draft agenda<span class="toot-id"> #agenda-07-29</span></h2><div class="pubdate">28 Jul at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/07-29">https://qt4cg.org/meeting/agenda/2025/07-29</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2131"><h2>Issue #2131 created<span class="toot-id"> #created-2131</span></h2><div class="pubdate">28 Jul at 10:28:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2131">https://github.com/qt4cg/qtspecs/issues/2131</a></div><details><summary>XSLT `xsl:for-each-group` `split-when` variables</summary><div class="markup"><p>Currently the spec <a href="https://qt4cg.org/specifications/xslt-40/Overview.html#xsl-for-each-group">says</a>:</p>
<blockquote>
<p>The expression is supplied with two variables: <code>$group</code> is set to the contents of the current group being constructed, and <code>$next</code> is the next item in the population.</p>
</blockquote>
<p>1. Do these supplied variables shadow the user-defined variable of the same name?  (probably they should, but it is not mentioned)
For example:</p>
<pre><code class="language-xslt">  &lt;xsl:variable name="group" select="(1,2,3)"/&gt;  
  &lt;xsl:for-each-group select="$input" split-when=" $next = $group "&gt; ... &lt;/xsl:for-each-group&gt;
</code></pre>
<p>Maybe these variables should be in the <code>fn:</code> namespace?</p>
<p>2. To access the <strong>current grouping key</strong> and <strong>current group</strong> the functions <code>fn:current-grouping-key</code> and <code>fn:current-group</code> are used. What is the rationale of introducing <em>variables</em> instead of <em>functions</em> to access the group and item in <code>split-when</code>?</p>
</div></details></div>
<div class="toot" id="closed-2066"><h2>Issue #2066 closed<span class="toot-id"> #closed-2066</span></h2><div class="pubdate">28 Jul at 09:25:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2066">https://github.com/qt4cg/qtspecs/issues/2066</a></div><p>Cells in the F&amp;O signature blocks should be vertically aligned to the top</p></div>
<div class="toot" id="closed-2122"><h2>Issue #2122 closed<span class="toot-id"> #closed-2122</span></h2><div class="pubdate">28 Jul at 09:25:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2122">https://github.com/qt4cg/qtspecs/pull/2122</a></div><p>2066 CSS changes for function prototypes</p></div>
<div class="toot" id="created-2130"><h2>Pull request #2130 created<span class="toot-id"> #created-2130</span></h2><div class="pubdate">28 Jul at 05:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2130">https://github.com/qt4cg/qtspecs/pull/2130</a></div><details><summary>Proposed new operator keywords: precedes, follows</summary><div class="markup"><p>The operators <code>&lt;&lt;</code> and <code>&gt;&gt;</code>, in my opinion, are poorly known, and challenging for developers working in XSLT. Many punctuation-based operators have aliases in ordinary-language quasi-equivalents, but <code>&lt;&lt;</code> and <code>&gt;&gt;</code> lack any ordinary verbal equivalents, and break this principle.</p>
<p>The attached proposal offers to make <code>precedes</code> a keyword equivalent to <code>&lt;&lt;</code> and <code>follows</code> a keyword equivalent to <code>&gt;&gt;</code>. This means that <code>//title[. &amp;lt;&amp;lt; following-sibling::isbn[1]]</code> can now be expressed as <code>//title[. precedes following-sibling::isbn[1]]</code></p>
</div></details></div>
<div class="toot" id="created-2129"><h2>Pull request #2129 created<span class="toot-id"> #created-2129</span></h2><div class="pubdate">26 Jul at 10:44:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2129">https://github.com/qt4cg/qtspecs/pull/2129</a></div><details><summary>2099 Rename fn:jnode and jnode-type</summary><div class="markup"><p>Renames the function <code>fn:jnode</code> as <code>fn:jtree</code>, and the item type <code>jnode-type()</code> as <code>jnode()</code></p>
<p>Fix #2099</p>
</div></details></div>
<div class="toot" id="created-2128"><h2>Issue #2128 created<span class="toot-id"> #created-2128</span></h2><div class="pubdate">25 Jul at 15:49:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2128">https://github.com/qt4cg/qtspecs/issues/2128</a></div><details><summary>JNodes and XSLT Streaming</summary><div class="markup"><p>In principle, there's no reason why JTrees shouldn't be streamable. However, it's an immense amount of work both for the specification and for an implementation, so I intend to rule it out.</p>
<p>That then leaves the question about deciding streamability in the case of constructs that could be processing JNodes.</p>
<p>I think we might be able to define a rule something like: "if a template rule (etc.) is declared with streamable="yes", this amounts to a declaration that it will only be used to process XNodes, even if without this declaration it would also be capable of processing JNodes."</p>
<p>The details depend on other aspects of how we define template rule processing and pattern matching for JNodes. At present I'm inclined to say that the pattern syntax for matching JNodes should be distinct from that for matching XNodes, so that a template can only match one or the other, never both.</p>
</div></details></div>
<div class="toot" id="created-2127"><h2>Issue #2127 created<span class="toot-id"> #created-2127</span></h2><div class="pubdate">25 Jul at 09:31:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2127">https://github.com/qt4cg/qtspecs/issues/2127</a></div><details><summary>JNodes: Include atomic items</summary><div class="markup"><p>With the introduction of JNodes, it feels like a natural step to enhance the processing of documents, collections and databases to JSON data. Currently, the roots of JNodes are restricted to maps and arrays. We should generalize them and include support for atomic items. The Background:</p>
<p>JSON data types are not restricted to maps (objects) and arrays, they can also be strings, numbers and booleans. As a consequence, a <code>json-doc('input.json')</code> call may also return atomic types. When iterating over JSON input, we should ensure that there is no need for additional type checks to ensure that code does not fail:</p>
<pre><code class="language-xquery">for $i in 1 to 10
for $doc in json-doc($i || '.json')
(: where $doc instance of (map(*)|array(*)) :)
return $doc/a/b/c
</code></pre>
<p>I assume it would be no substantial change to open <code>$json/step</code> for types other than nodes, maps and arrays. The only tricky special case is <code>null</code>, but it is converted to an empty sequence, why <code>json-doc('document-with-single-null-value.json')/a/b/c</code> already succeeds.</p>
<p>To address any concerns that JNodes do not make sense for standalone atomic items: There is a certain analogy to XML text nodes, which can also be created without serving any immediate purpose, but are helpful and necessary for mapping the entire XML data model.</p>
</div></details></div>
<div class="toot" id="created-2126"><h2>Issue #2126 created<span class="toot-id"> #created-2126</span></h2><div class="pubdate">25 Jul at 07:16:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2126">https://github.com/qt4cg/qtspecs/issues/2126</a></div><details><summary>Absolute path expressions with JTrees</summary><div class="markup"><p>I'm thinking there may be a case for disallowing or restricting the use of absolute path expressions over JTrees.</p>
<p>Firstly, there's a strong likelihood that users are only dimly aware of where the root of the tree actually is. They are likely to imagine, if they parse a json text, that the root of the tree will be the root of that text. But in fact the root is wherever they started path navigation from, which may be different. It's likely to be particularly confusing if you move out of JNode space into map/array territory and then back again. Requiring an explicit call on root(), or on ancestor::*[last()], might mean that users think more carefully about it. This makes it clearer that the root is not some kind of absolute fixed point, it is simply "the place where you started your current journey".</p>
<p>Certainly, I don't think we should allow <code>/x</code> to implicitly construct a JNode wrapping the context item: the '/' here is redundant and means the user almost certainly doesn't understand what they are doing.</p>
<p>Another consideration is that if we restrict leading <code>/</code> to work only with XTrees, then we reinstate a lot of static type checking capability that we have currently lost.</p>
</div></details></div>
<div class="toot" id="created-2125"><h2>Issue #2125 created<span class="toot-id"> #created-2125</span></h2><div class="pubdate">24 Jul at 10:32:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2125">https://github.com/qt4cg/qtspecs/issues/2125</a></div><details><summary>csv-to-xml() - untestable results</summary><div class="markup"><p>The machinery for generating test cases from spec examples is failing in the case of the <code>csv-to-xml()</code> tests.</p>
<p>The test generator produces an expected result assertion of</p>
<p><code>&lt;assert-xml ignore-prefixes="false"&gt;&lt;![CDATA[&lt;substitute-for-unparseable-result-xml xmlns="http://www.w3.org/2010/09/qt-fots-catalog"/&gt;]]&gt;&lt;/assert-xml&gt;</code></p>
<p>The same problem occurs with some fn:analyze-string tests.</p>
<p>The failure basically means that parse-xml() on the expected test results has failed. (Stylesheet generate-qt3-test-set.xsl line 122).</p>
<p>I think that the problem is that the build is running Saxon in schema-aware mode, and this applies to all XML parsing including the parse-xml() function, so we're getting a schema validation failure where we really don't want to be validating in the first place.</p>
<p>Unfortunately we can't selectively switch parse-xml() validation off unless we move to a later (and not yet stable) Saxon version, and rewriting the whole stylesheet to not be schema-aware would be painful.</p>
</div></details></div>
<div class="toot" id="created-2124"><h2>Pull request #2124 created<span class="toot-id"> #created-2124</span></h2><div class="pubdate">24 Jul at 08:24:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2124">https://github.com/qt4cg/qtspecs/pull/2124</a></div><details><summary>573 Functions to Construct Trees</summary><div class="markup"><p>A first cut at providing a functional approach to XNode and XTree construction.</p>
<p>At this stage I'm interested in comments on the general approach, not the fine detail (some of which, e.g. namespace inheritance, still needs work.)</p>
</div></details></div>
<div class="toot" id="created-2123"><h2>Pull request #2123 created<span class="toot-id"> #created-2123</span></h2><div class="pubdate">24 Jul at 03:23:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2123">https://github.com/qt4cg/qtspecs/pull/2123</a></div><details><summary>2051: XSLT group by cluster</summary><div class="markup"><p>Companion PR to #2051 .</p>
<p>I have opted for only two examples, hoping they catalyze the imagination of what is possible. Comments welcome.</p>
</div></details></div>
<div class="toot" id="created-2122"><h2>Pull request #2122 created<span class="toot-id"> #created-2122</span></h2><div class="pubdate">23 Jul at 21:35:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2122">https://github.com/qt4cg/qtspecs/pull/2122</a></div><details><summary>2066 CSS changes for function prototypes</summary><div class="markup"><p>Fix #2066</p>
</div></details></div>
<div class="toot" id="closed-2121"><h2>Issue #2121 closed<span class="toot-id"> #closed-2121</span></h2><div class="pubdate">23 Jul at 21:32:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2121">https://github.com/qt4cg/qtspecs/pull/2121</a></div><p>2066 fo signature table format</p></div>
<div class="toot" id="created-2121"><h2>Pull request #2121 created<span class="toot-id"> #created-2121</span></h2><div class="pubdate">23 Jul at 21:31:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2121">https://github.com/qt4cg/qtspecs/pull/2121</a></div><details><summary>2066 fo signature table format</summary><div class="markup"><p>CSS changes to improve alignment of complex signatures, e.g. fn:round</p>
<p>Fix #2066</p>
</div></details></div>
<div class="toot" id="closed-1774"><h2>Issue #1774 closed<span class="toot-id"> #closed-1774</span></h2><div class="pubdate">23 Jul at 20:25:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1774">https://github.com/qt4cg/qtspecs/issues/1774</a></div><p>Nomenclature: relabelling</p></div>
<div class="toot" id="closed-1775"><h2>Issue #1775 closed<span class="toot-id"> #closed-1775</span></h2><div class="pubdate">23 Jul at 20:18:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1775">https://github.com/qt4cg/qtspecs/issues/1775</a></div><p>Navigation in JSON trees</p></div>
<div class="toot" id="created-2120"><h2>Pull request #2120 created<span class="toot-id"> #created-2120</span></h2><div class="pubdate">23 Jul at 10:14:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2120">https://github.com/qt4cg/qtspecs/pull/2120</a></div><details><summary>2007 Revised design for xsl:array</summary><div class="markup"><p>Revised design for <code>xsl:array</code> based on usage experience.</p>
<p>Fix #2007</p>
</div></details></div>
<div class="toot" id="closed-2118"><h2>Issue #2118 closed<span class="toot-id"> #closed-2118</span></h2><div class="pubdate">23 Jul at 06:23:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2118">https://github.com/qt4cg/qtspecs/pull/2118</a></div><p>2080 Tweak the rules for destructuring variable bindings</p></div>
<div class="toot" id="created-2119"><h2>Pull request #2119 created<span class="toot-id"> #created-2119</span></h2><div class="pubdate">23 Jul at 06:20:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2119">https://github.com/qt4cg/qtspecs/pull/2119</a></div><details><summary>2080 allow let $($head, $tail)</summary><div class="markup"><p>Fix #2080</p>
<p>With <code>let $($x, $y, $z)</code>, $z bids to the rest of the sequence.</p>
<p>With <code>let $[$a, $b, $c]</code>, FOAR0001 is raised if the array is too short.</p>
<p>Note, XPath and XQuery should be reviewed separately as the source text for let expressions is different.</p>
</div></details></div>
<div class="toot" id="created-2118"><h2>Pull request #2118 created<span class="toot-id"> #created-2118</span></h2><div class="pubdate">22 Jul at 23:01:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2118">https://github.com/qt4cg/qtspecs/pull/2118</a></div><details><summary>2080 Tweak the rules for destructuring variable bindings</summary><div class="markup"><ol>
<li>When binding to a sequence, the last variable binds to the rest of the sequence.</li>
<li>When binding to an array, an FOAR0001 occurs if there are more variables than array members.</li>
</ol>
<p>Fix #2080.</p>
</div></details></div>
<div class="toot" id="created-2117"><h2>Pull request #2117 created<span class="toot-id"> #created-2117</span></h2><div class="pubdate">22 Jul at 22:34:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2117">https://github.com/qt4cg/qtspecs/pull/2117</a></div><details><summary>2082 parse-html options</summary><div class="markup"><ol>
<li>Use non-optional types such as xs:boolean for options parameters</li>
<li>Use regular error codes for bad options</li>
<li>Drop error code relating to the discontinued method option.</li>
</ol>
<p>Fix #2082</p>
</div></details></div>
<div class="toot" id="created-2116"><h2>Pull request #2116 created<span class="toot-id"> #created-2116</span></h2><div class="pubdate">22 Jul at 21:04:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2116">https://github.com/qt4cg/qtspecs/pull/2116</a></div><details><summary>2112 Refine/revise the rules for get() in node tests</summary><div class="markup"><p>Proposed revision of the rules for get() in node tests.</p>
<p>Mainly editorial clarification; but also changes the rules for the focus - the expression is now evaluated with absent focus to ensure an error in preference to unexpected results.</p>
<p>Fix #2112</p>
</div></details></div>
<div class="toot" id="created-2115"><h2>Pull request #2115 created<span class="toot-id"> #created-2115</span></h2><div class="pubdate">22 Jul at 19:06:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2115">https://github.com/qt4cg/qtspecs/pull/2115</a></div><details><summary>2084 - document order of axis steps when context value is a sequence</summary><div class="markup"><p>Clarifies that the results are in document order and deduplicated.</p>
<p>Fix #2084</p>
</div></details></div>
<div class="toot" id="created-2114"><h2>Pull request #2114 created<span class="toot-id"> #created-2114</span></h2><div class="pubdate">22 Jul at 17:36:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2114">https://github.com/qt4cg/qtspecs/pull/2114</a></div><details><summary>2087 Change adaptive serialization of JNodes</summary><div class="markup"><p>Fix #2087</p>
</div></details></div>
<div class="toot" id="created-2113"><h2>Pull request #2113 created<span class="toot-id"> #created-2113</span></h2><div class="pubdate">22 Jul at 17:23:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2113">https://github.com/qt4cg/qtspecs/pull/2113</a></div><details><summary>2102 Make type labels in diagram consistent</summary><div class="markup"><p>Fix #2102</p>
<p>Drops the parentheses in map(<em>), array(</em>), function(*)</p>
</div></details></div>
<div class="toot" id="minutes—07-22"><h2>QT4 CG meeting 130 draft minutes<span class="toot-id"> #minutes—07-22</span></h2><div class="pubdate">22 Jul at 16:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/07-22">https://qt4cg.org/meeting/minutes/2025/07-22</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2036"><h2>Issue #2036 closed<span class="toot-id"> #closed-2036</span></h2><div class="pubdate">22 Jul at 16:13:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2036">https://github.com/qt4cg/qtspecs/issues/2036</a></div><p>Streamability of xsl:map instruction</p></div>
<div class="toot" id="closed-2037"><h2>Issue #2037 closed<span class="toot-id"> #closed-2037</span></h2><div class="pubdate">22 Jul at 16:13:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2037">https://github.com/qt4cg/qtspecs/pull/2037</a></div><p>2036 Add rule for streamability of xsl:map</p></div>
<div class="toot" id="closed-2104"><h2>Issue #2104 closed<span class="toot-id"> #closed-2104</span></h2><div class="pubdate">22 Jul at 16:11:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2104">https://github.com/qt4cg/qtspecs/issues/2104</a></div><p>JNodes: unwrapping</p></div>
<div class="toot" id="closed-2111"><h2>Issue #2111 closed<span class="toot-id"> #closed-2111</span></h2><div class="pubdate">22 Jul at 16:10:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2111">https://github.com/qt4cg/qtspecs/pull/2111</a></div><p>2104 Point out places where jnode-content is called implicitly</p></div>
<div class="toot" id="closed-2098"><h2>Issue #2098 closed<span class="toot-id"> #closed-2098</span></h2><div class="pubdate">22 Jul at 16:07:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2098">https://github.com/qt4cg/qtspecs/issues/2098</a></div><p>JNodes: combining node sequences</p></div>
<div class="toot" id="closed-2110"><h2>Issue #2110 closed<span class="toot-id"> #closed-2110</span></h2><div class="pubdate">22 Jul at 16:07:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2110">https://github.com/qt4cg/qtspecs/pull/2110</a></div><p>2098 Clarify when jnode() is called implicitly</p></div>
<div class="toot" id="closed-2103"><h2>Issue #2103 closed<span class="toot-id"> #closed-2103</span></h2><div class="pubdate">22 Jul at 16:04:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2103">https://github.com/qt4cg/qtspecs/issues/2103</a></div><p>JNodes functions: 0-arity variant</p></div>
<div class="toot" id="closed-2109"><h2>Issue #2109 closed<span class="toot-id"> #closed-2109</span></h2><div class="pubdate">22 Jul at 16:04:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2109">https://github.com/qt4cg/qtspecs/pull/2109</a></div><p>2103 Allow operand of JNode accessors to be omitted or empty</p></div>
<div class="toot" id="closed-2107"><h2>Issue #2107 closed<span class="toot-id"> #closed-2107</span></h2><div class="pubdate">22 Jul at 16:01:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2107">https://github.com/qt4cg/qtspecs/pull/2107</a></div><p>QT4CG-129-01: Actions from review of PR2094</p></div>
<div class="toot" id="closed-2108"><h2>Issue #2108 closed<span class="toot-id"> #closed-2108</span></h2><div class="pubdate">22 Jul at 15:58:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2108">https://github.com/qt4cg/qtspecs/pull/2108</a></div><p>QT4CG-123-01 Add example of library module using methods</p></div>
<div class="toot" id="closed-2106"><h2>Issue #2106 closed<span class="toot-id"> #closed-2106</span></h2><div class="pubdate">22 Jul at 15:55:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2106">https://github.com/qt4cg/qtspecs/pull/2106</a></div><p>Add note on the impossibility of cyclic instances</p></div>
<div class="toot" id="closed-2105"><h2>Issue #2105 closed<span class="toot-id"> #closed-2105</span></h2><div class="pubdate">22 Jul at 15:52:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2105">https://github.com/qt4cg/qtspecs/pull/2105</a></div><p>Fix type of `fn:schema-type-record` field `constructor`</p></div>
<div class="toot" id="closed-2097"><h2>Issue #2097 closed<span class="toot-id"> #closed-2097</span></h2><div class="pubdate">22 Jul at 15:51:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2097">https://github.com/qt4cg/qtspecs/issues/2097</a></div><p>`jnode` as a subtype of `node`</p></div>
<div class="toot" id="closed-2089"><h2>Issue #2089 closed<span class="toot-id"> #closed-2089</span></h2><div class="pubdate">22 Jul at 15:51:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2089">https://github.com/qt4cg/qtspecs/issues/2089</a></div><p>JNode properties: Presentation</p></div>
<div class="toot" id="created-2112"><h2>Issue #2112 created<span class="toot-id"> #created-2112</span></h2><div class="pubdate">22 Jul at 13:46:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2112">https://github.com/qt4cg/qtspecs/issues/2112</a></div><details><summary>JNodes: get()</summary><div class="markup"><p>The documentation for <code>get()</code> says for XNodes…</p>
<blockquote>
<p>A selector can also take the form <code>get(Expr)</code>. The contained expression <em>Expr</em> is evaluated with the focus of the containing axis step (so its value is independent of the specific XNode being tested). The result of the expression after atomization must be a sequence of zero or more <code>xs:QName</code> values (otherwise a type error [<a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#ERRXPTY0004">err:XPTY0004</a>] is raised). An XNode satisfies the selector if its node kind is the principal node kind of the axis and its node name is among the values returned by the selector expression.</p>
</blockquote>
<p>…and for JNodes…</p>
<blockquote>
<p>If the selector takes the form <code>get(Expr)</code>, then the contained expression <em>Expr</em> is evaluated with the focus of the containing axis step (so its value is independent of the specific JNode being tested). A JNode satisfies the selector if its <strong>·selector·</strong> property is equal to one or more of the values returned by the selector expression, under the rules of the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-atomic-equal">fn:atomic-equal</a> function.</p>
</blockquote>
<p>Nitpicking:</p>
<ul>
<li>With the existing rule for JNodes, I assume that no match would be returned for <code>EXPR := [ 'a', 'b' ]</code>. I would thus propose to atomize EXPR first and compare it afterwards (see below).</li>
<li>“A JNode satisfies the selector if [the value of] its <strong>·selector·</strong> property”</li>
</ul>
<p>Next, I would like us to unify the rules for XNodes and JNodes. The rationale (besides “simpler rules are simpler to explain”):</p>
<ol>
<li>XPath is well-known for being forgiving. Maybe we can maintain that tradition for name tests, by tolerating input other than QNames.</li>
<li>By using identical rules for JNodes and XNodes, it will be easier to process input that mixed XNodes and JNodes. An example:</li>
</ol>
<pre><code class="language-xquery">(&lt;xml&gt;ignored&lt;/xml&gt;, { 1: 'one' }, [ 'one' ])/get(1)
</code></pre>
<p>I would propose to simplify the joint rules to the following XPath expression:</p>
<pre><code class="language-xquery">some(
  data(EXPR),
  atomic-equal(?, if(. instance of node()) then node-name() else jnode-selector())
)
</code></pre>
<p>Finally, I assume that the focus information can be utilized in the get expression, right? Is it correct to assume that all of the following expressions will return <code>&lt;a2/&gt;</code>?</p>
<pre><code>let $xml := &lt;xml&gt;&lt;a3/&gt;&lt;a2/&gt;&lt;a1/&gt;&lt;/xml&gt;
let $name := #a2
return (
  $xml/get(#a2),
  $xml/get($name),
  $xml/get(node-name()[. = $name])
  $xml/get(xs:QName('a' || position())),
  $xml/get(if(position() = 2) { $name } ),
  $xml/get(xs:QName(`a{ last() - 1 }`))
)
</code></pre>
</div></details></div>
<div class="toot" id="agenda-07-22"><h2>QT4 CG meeting 130 draft agenda<span class="toot-id"> #agenda-07-22</span></h2><div class="pubdate">21 Jul at 10:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/07-22">https://qt4cg.org/meeting/agenda/2025/07-22</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1786"><h2>Issue #1786 closed<span class="toot-id"> #closed-1786</span></h2><div class="pubdate">17 Jul at 22:27:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1786">https://github.com/qt4cg/qtspecs/issues/1786</a></div><p>A case study for XSLT transformation of JSON: the transpiler</p></div>
<div class="toot" id="closed-2025"><h2>Issue #2025 closed<span class="toot-id"> #closed-2025</span></h2><div class="pubdate">17 Jul at 22:25:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2025">https://github.com/qt4cg/qtspecs/issues/2025</a></div><p>Combine the concepts of pins/labels and modified lookups</p></div>
<div class="toot" id="created-2111"><h2>Pull request #2111 created<span class="toot-id"> #created-2111</span></h2><div class="pubdate">17 Jul at 22:09:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2111">https://github.com/qt4cg/qtspecs/pull/2111</a></div><details><summary>2104 Point out places where jnode-content is called implicitly</summary><div class="markup"><p>Fix #2095</p>
<p>This PR is purely editorial: it adds notes and examples showing where jnode-content() is (or is not) called implicitly.</p>
</div></details></div>
<div class="toot" id="created-2110"><h2>Pull request #2110 created<span class="toot-id"> #created-2110</span></h2><div class="pubdate">17 Jul at 21:08:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2110">https://github.com/qt4cg/qtspecs/pull/2110</a></div><details><summary>2098 Clarify when jnode() is called implicitly</summary><div class="markup"><p>Fix #2098</p>
</div></details></div>
<div class="toot" id="created-2109"><h2>Pull request #2109 created<span class="toot-id"> #created-2109</span></h2><div class="pubdate">17 Jul at 20:38:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2109">https://github.com/qt4cg/qtspecs/pull/2109</a></div><details><summary>2103 Allow operand of JNode accessors to be omitted or empty</summary><div class="markup"><p>Fix #2103</p>
</div></details></div>
<div class="toot" id="created-2108"><h2>Pull request #2108 created<span class="toot-id"> #created-2108</span></h2><div class="pubdate">17 Jul at 08:32:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2108">https://github.com/qt4cg/qtspecs/pull/2108</a></div><p>QT4CG-123-01 Add example of library module using methods</p></div>
<div class="toot" id="created-2107"><h2>Pull request #2107 created<span class="toot-id"> #created-2107</span></h2><div class="pubdate">17 Jul at 07:50:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2107">https://github.com/qt4cg/qtspecs/pull/2107</a></div><p>QT4CG-129-01: Actions from review of PR2094</p></div>
<div class="toot" id="created-2106"><h2>Pull request #2106 created<span class="toot-id"> #created-2106</span></h2><div class="pubdate">15 Jul at 21:44:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2106">https://github.com/qt4cg/qtspecs/pull/2106</a></div><details><summary>Add note on the impossibility of cyclic instances</summary><div class="markup"><p>Responding to an action at today's meeting, this adds a note to the effect that although types can contain cyclic references, instances can not.</p>
</div></details></div>
<div class="toot" id="minutes—07-15"><h2>QT4 CG meeting 129 draft minutes<span class="toot-id"> #minutes—07-15</span></h2><div class="pubdate">15 Jul at 16:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/07-15">https://qt4cg.org/meeting/minutes/2025/07-15</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-2105"><h2>Pull request #2105 created<span class="toot-id"> #created-2105</span></h2><div class="pubdate">15 Jul at 17:16:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2105">https://github.com/qt4cg/qtspecs/pull/2105</a></div><details><summary>Fix type of `fn:schema-type-record` field `constructor`</summary><div class="markup"><p>The <code>constructor</code> of <code>fn:schema-type-record</code> <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#schema-type-record">is currently shown</a> with a type of</p>
<pre><code class="language-xquery">fn(xs:anyAtomicType?) as xs:anyAtomicType?
</code></pre>
<p>However this does not cover list type constructors, returning multiple occurrences. It should thus be</p>
<pre><code class="language-xquery">fn(xs:anyAtomicType?) as xs:anyAtomicType*
</code></pre>
<p>A test exists that requires this: <a href="https://github.com/qt4cg/qt4tests/blob/79fd5cec8a8b15f9cad3f3d09045946f5bcab931/fn/schema-type.xml#L99-L116"><code>schema-type-005</code></a></p>
</div></details></div>
<div class="toot" id="created-2104"><h2>Issue #2104 created<span class="toot-id"> #created-2104</span></h2><div class="pubdate">15 Jul at 17:16:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2104">https://github.com/qt4cg/qtspecs/issues/2104</a></div><details><summary>JNodes: unwrapping</summary><div class="markup"><p>Related (but not identical to) https://github.com/qt4cg/qtspecs/issues/2095:</p>
<hr>
<p>As Michael indicated in https://github.com/qt4cg/qtspecs/issues/2095#issuecomment-3069173742, the implicit unwrapping of accessed/iterated JNode results may already be defined in the current spec, but it may need to be further clarified. Examples:</p>
<pre><code class="language-xquery">let $jnode := { 'array': [ 1, 2 ] }/array
return (
  (: FLWOR expressions :)
  for member $m in $jnode return $m,
  (: Functions :)
  array:size($jnode),
  (: Lookups :)
  $jnode?1
)
</code></pre>
</div></details></div>
<div class="toot" id="closed-2054"><h2>Issue #2054 closed<span class="toot-id"> #closed-2054</span></h2><div class="pubdate">15 Jul at 17:08:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2054">https://github.com/qt4cg/qtspecs/issues/2054</a></div><p>JPath expression</p></div>
<div class="toot" id="created-2103"><h2>Issue #2103 created<span class="toot-id"> #created-2103</span></h2><div class="pubdate">15 Jul at 16:48:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2103">https://github.com/qt4cg/qtspecs/issues/2103</a></div><details><summary>JNodes functions: 0-arity variant</summary><div class="markup"><p>Similar to <code>fn:name</code> and other <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#accessors">accessor functions</a>, the new JNode functions (<code>fn:node-content</code>, <code>fn:node-position</code>, <code>fn:node-selector</code>)  should be gifted with a 0-arity variant.</p>
</div></details></div>
<div class="toot" id="created-2102"><h2>Issue #2102 created<span class="toot-id"> #created-2102</span></h2><div class="pubdate">15 Jul at 16:38:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2102">https://github.com/qt4cg/qtspecs/issues/2102</a></div><details><summary>Type diagrams: drop/add parentheses</summary><div class="markup"><p>The current presentation of the data types is inconsistent (https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#types-hierarchy):</p>
<img width="200" src="https://github.com/user-attachments/assets/a6d7aaa6-398e-4f2d-a1e2-65b4d9c020fe">
<p>It includes <code>GNode</code>, <code>XNode</code>, and <code>JNode</code>, <code>attribute</code>, <code>document</code> etc. (without parentheses), but <code>function(*)</code>, <code>array(*)</code> and <code>map(*)</code>. Shouldn’t we remove the parentheses from <code>function(*)</code> etc., or add them to the other types?</p>
<p>Or maybe we should even change <code>function(*)</code> to Function, etc.</p>
<p>Labels | Types
-- | --
GNode | <code>gnode()</code>
XNode | <code>node()</code>
JNode | <code>jnode()</code>
attribute | <code>attribute()</code>, <code>attribute(*)</code>, <code>attribute(a)</code>, …
document | <code>document-node()</code>, <code>document-node(*)</code>, …
function(<em>) | <code>function(*)</code>, <code>function(xs:int) as xs:int</code>, …
array(</em>) | <code>array(*)</code>, <code>array(xs:int)</code>, …
map(*) | <code>map(*)</code>, <code>map(xs:int, xs:int)</code>, …</p>
</div></details></div>
<div class="toot" id="closed-2011"><h2>Issue #2011 closed<span class="toot-id"> #closed-2011</span></h2><div class="pubdate">15 Jul at 16:27:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2011">https://github.com/qt4cg/qtspecs/pull/2011</a></div><p>675(part): Add XSLT static typing rules for new kinds of XPath expression</p></div>
<div class="toot" id="closed-2038"><h2>Issue #2038 closed<span class="toot-id"> #closed-2038</span></h2><div class="pubdate">15 Jul at 16:24:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2038">https://github.com/qt4cg/qtspecs/issues/2038</a></div><p>Drop dependency of fn:apply-templates on the default mode</p></div>
<div class="toot" id="closed-2043"><h2>Issue #2043 closed<span class="toot-id"> #closed-2043</span></h2><div class="pubdate">15 Jul at 16:24:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2043">https://github.com/qt4cg/qtspecs/pull/2043</a></div><p>2038 Tweak the rules for fn:apply-templates references to modes</p></div>
<div class="toot" id="created-2101"><h2>Issue #2101 created<span class="toot-id"> #created-2101</span></h2><div class="pubdate">15 Jul at 16:21:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2101">https://github.com/qt4cg/qtspecs/issues/2101</a></div><details><summary>Named record types: drop constructors, complete list</summary><div class="markup"><p>The spec defines various built-in named record types (https://qt4cg.org/specifications/xpath-functions-40/Overview.html#id-built-in-named-record-types):</p>
<pre><code class="language-xquery">key-value-pair
load-xquery-module-record
parsed-csv-structure-record
random-number-generator-record
schema-type-record
uri-structure-record
</code></pre>
<p>Suggestions:</p>
<ol>
<li>The spec says in https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-named-record-types:</li>
</ol>
<blockquote>
<p>Named record types implicitly create a constructor function that can be used to create instances of the record type.</p>
</blockquote>
<p>I would propose excluding the constructors for built-in types. It will save us a lot of bulky code in the implementations, for functions that will hardly be used, as they all refer to return types of existing functions. Ironically, the only exception might be <code>key-value-pair</code>, but it is redundant anyway (we already have <code>map:pair</code>… unless it is dropped, together with the record type, by #2092).</p>
<ol start="2">
<li>A type is missing for the result of <code>fn:divide-decimals</code>, and we should suffix <code>key-value-pair</code> with <code>-record</code> (provided we will keep it in the spec).</li>
</ol>
</div></details></div>
<div class="toot" id="closed-2014"><h2>Issue #2014 closed<span class="toot-id"> #closed-2014</span></h2><div class="pubdate">15 Jul at 16:19:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2014">https://github.com/qt4cg/qtspecs/pull/2014</a></div><p>QT4CG-122-01 Add notes, examples, and rationale for xsl:select</p></div>
<div class="toot" id="closed-2003"><h2>Issue #2003 closed<span class="toot-id"> #closed-2003</span></h2><div class="pubdate">15 Jul at 16:17:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2003">https://github.com/qt4cg/qtspecs/issues/2003</a></div><p>Conditional entries in map constructors</p></div>
<div class="toot" id="closed-2094"><h2>Issue #2094 closed<span class="toot-id"> #closed-2094</span></h2><div class="pubdate">15 Jul at 16:17:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2094">https://github.com/qt4cg/qtspecs/pull/2094</a></div><p>2003 Generalize Map Constructors</p></div>
<div class="toot" id="closed-2083"><h2>Issue #2083 closed<span class="toot-id"> #closed-2083</span></h2><div class="pubdate">15 Jul at 16:13:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2083">https://github.com/qt4cg/qtspecs/pull/2083</a></div><p>2054 Generalized Path Expressions</p></div>
<div class="toot" id="closed-2031"><h2>Issue #2031 closed<span class="toot-id"> #closed-2031</span></h2><div class="pubdate">15 Jul at 16:03:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2031">https://github.com/qt4cg/qtspecs/pull/2031</a></div><p>2025 JNodes</p></div>
<div class="toot" id="closed-1307"><h2>Issue #1307 closed<span class="toot-id"> #closed-1307</span></h2><div class="pubdate">15 Jul at 16:02:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1307">https://github.com/qt4cg/qtspecs/issues/1307</a></div><p>For symmetry, add functions array:scan-left and array:scan-right</p></div>
<div class="toot" id="closed-2057"><h2>Issue #2057 closed<span class="toot-id"> #closed-2057</span></h2><div class="pubdate">15 Jul at 16:02:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2057">https://github.com/qt4cg/qtspecs/issues/2057</a></div><p>Steps: variable element names</p></div>
<div class="toot" id="closed-2035"><h2>Issue #2035 closed<span class="toot-id"> #closed-2035</span></h2><div class="pubdate">15 Jul at 16:02:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2035">https://github.com/qt4cg/qtspecs/issues/2035</a></div><p>Recursive record types: unrealistic example in XPath spec</p></div>
<div class="toot" id="closed-2096"><h2>Issue #2096 closed<span class="toot-id"> #closed-2096</span></h2><div class="pubdate">15 Jul at 16:02:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2096">https://github.com/qt4cg/qtspecs/pull/2096</a></div><p>2035 Drop unworkable example of recursive record types</p></div>
<div class="toot" id="created-2100"><h2>Issue #2100 created<span class="toot-id"> #created-2100</span></h2><div class="pubdate">15 Jul at 15:55:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2100">https://github.com/qt4cg/qtspecs/issues/2100</a></div><details><summary>JNodes: functions</summary><div class="markup"><p>With #2083, some XQFO functions was generalized for JNodes:</p>
<pre><code>fn:distinct-ordered-nodes
fn:generate-id
fn:root
fn:siblings
fn:transitive-closure
</code></pre>
<p>Others are still pending (to be completed):</p>
<pre><code>fn:has-children
fn:innermost
fn:outermost
fn:path
</code></pre>
<p>We should…</p>
<ol>
<li>analyze the rules of the existing functions (for example, what happens if both XNodes and JNodes are used in <code>fn:transitive-closure</code>?)</li>
<li>add more functions.</li>
</ol>
</div></details></div>
<div class="toot" id="created-2099"><h2>Issue #2099 created<span class="toot-id"> #created-2099</span></h2><div class="pubdate">15 Jul at 12:31:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2099">https://github.com/qt4cg/qtspecs/issues/2099</a></div><details><summary>Choosing names for the jnode function and the jnode type</summary><div class="markup"><p>As a late-breaking change to PR #2083, the item type syntax for matching JNodes has been changed to <code>jnode-type()</code>, to avoid a clash with the name of the function <code>fn:jnode</code>.</p>
<p>We might prefer to resolve this clash in a different way.</p>
</div></details></div>
<div class="toot" id="created-2098"><h2>Issue #2098 created<span class="toot-id"> #created-2098</span></h2><div class="pubdate">15 Jul at 11:24:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2098">https://github.com/qt4cg/qtspecs/issues/2098</a></div><details><summary>JNodes: combining node sequences</summary><div class="markup"><p>Internal questions and feedback on the <code>union</code> operator, triggered by the JNodes proposal:</p>
<ol>
<li>Will <code>{ 1: 2 } union { 3: 4 }</code> be allowed, or will it be <code>{ 1: 2 }/. union { 3: 4 }/.</code> ?</li>
<li>Combining maps and arrays: one might expect <code>{ 1: 2 } union { 3: 4 }</code> to result in <code>{ 1: 2, 3: 4 }</code>.</li>
<li>If <code>union</code> et al. are enhanced anyway, couldn’t they be generalized for sequences? <code>(1, 2) union 3</code> → <code>(1, 2, 3)</code>.</li>
</ol>
<p>…which I answered as follows:</p>
<ol>
<li>I guess no; the conversion to JNodes is needed.</li>
<li>…a good reason why we should not implicitly coerce maps/arrays to JNodes.</li>
<li>For atomic-only sequences, it could be equivalent to <code>fn:distinct-values((A, B))</code>. For heterogenous sequences, it gets tricky: How should <code>&lt;a&gt;1&lt;/a&gt; union 1e0</code> be combined? Similar to how functions like <code>fn:min</code> are defined, it could be the first item that determines how the remaining input is combined (but the operation would not be commutative anymore; <code>A union B</code> might yield different results than <code>B union A</code>).</li>
</ol>
</div></details></div>
<div class="toot" id="agenda-07-15"><h2>QT4 CG meeting 129 draft agenda<span class="toot-id"> #agenda-07-15</span></h2><div class="pubdate">14 Jul at 12:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/07-15">https://qt4cg.org/meeting/agenda/2025/07-15</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-366"><h2>Issue #366 closed<span class="toot-id"> #closed-366</span></h2><div class="pubdate">14 Jul at 06:41:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/366">https://github.com/qt4cg/qtspecs/issues/366</a></div><p>Support xsl:use-package with xsl:package-location</p></div>
<div class="toot" id="created-2097"><h2>Issue #2097 created<span class="toot-id"> #created-2097</span></h2><div class="pubdate">13 Jul at 10:31:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2097">https://github.com/qt4cg/qtspecs/issues/2097</a></div><details><summary>`jnode` as a subtype of `node`</summary><div class="markup"><p>It seems that introduce <code>jnode</code> by extending <code>node</code> is more consistent than introducing <code>jnode</code> as a data type that is a sibling to <code>node</code>.</p>
<p>I would like to hear comments about pros and cons of this approach.</p>
<p>@ruv <a href="https://github.com/qt4cg/qtspecs/pull/2083#issuecomment-3056148707">wrote</a>:</p>
<blockquote>
<blockquote>
<p>I wonder what if <code>jnode</code> was a subtype of <code>node</code></p>
</blockquote>
</blockquote>
<p>@michaelhkay <a href="https://github.com/qt4cg/qtspecs/pull/2083#issuecomment-3062732836">wrote</a>:</p>
<blockquote>
<p>Then all operations on node would become available for jnode, including many that obviously don't make sense, for example getting the in-scope namespaces, applying schema validation, etc etc.</p>
</blockquote>
<p>This does not seem to be a problem. There are many features that make sense for one node kind (or type) and don't make sense for other.</p>
<p>For example,</p>
<ul>
<li><code>fn:name()</code> does not make sense for <code>document-node()</code>, <code>comment()</code>, <code>text()</code> (but applies to them and return the empty string);</li>
<li><code>fn:in-scope-prefixes()</code> applies to only a node that is an <code>element()</code>.</li>
<li>the constructor <code>document { }</code> does not accept an attribute node.</li>
</ul>
<p>Thus, nodes that are a subtype of jnode can have their own restrictions.</p>
<h3><code>jnode</code> as subtype of <code>node</code></h3>
<p>There can be four direct subtypes of <code>jnode</code>:</p>
<ul>
<li><code>map-node</code></li>
<li><code>array-node</code></li>
<li><code>map-entry</code></li>
<li><code>array-member</code> (or maybe let's call it <code>array-entry</code>)</li>
</ul>
<p>So, <code>jnode</code> is a union of them: <code>jnode = map-node | array-node | map-entry | array-entry</code>.</p>
<p>Nodes of the type <code>map-node</code> and <code>array-node</code> are similar to <code>document-node</code>. Their parent is <strong>always</strong> <code>()</code>.</p>
<p>The child axis of a <code>jnode</code> can contains <strong>only</strong> nodes of the type <code>map-entry | array-entry</code>.</p>
<p>An advantage of this approach is that there is no need to introduce XNode and GNode, and corresponding confusion, like say that <code>node()</code> matches XNode, but not GNode (in the general case).</p>
<p>This probably also allows us to specify XSLT for jnodes more seamlessly.</p>
</div></details></div>
<div class="toot" id="created-2096"><h2>Pull request #2096 created<span class="toot-id"> #created-2096</span></h2><div class="pubdate">13 Jul at 10:07:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2096">https://github.com/qt4cg/qtspecs/pull/2096</a></div><details><summary>2035 Drop unworkable example of recursive record types</summary><div class="markup"><p>Fix #2035</p>
</div></details></div>
<div class="toot" id="created-2095"><h2>Issue #2095 created<span class="toot-id"> #created-2095</span></h2><div class="pubdate">13 Jul at 09:37:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2095">https://github.com/qt4cg/qtspecs/issues/2095</a></div><details><summary>JNodes: result processing</summary><div class="markup"><p>By playing around with the new JNodes syntax, I noticed that the somewhat bulky function <code>fn:jnode-content</code> needs to be used a lot to process the result of a path traversal, basically every time when coercion is not possible or does not make sense (iterations, any operation based on <code>item()*</code>).</p>
<p>An example:</p>
<pre><code class="language-xquery">{ 'Catania': { 'nomi': ('Alfredo', 'Andrea') } }
</code></pre>
<ol>
<li>Count the number of persons in Catania:</li>
</ol>
<pre><code class="language-xquery">./Catania/nomi =&gt; jnode-content() =&gt; count()
</code></pre>
<ol start="2">
<li>List all persons in upper case:</li>
</ol>
<pre><code class="language-xquery">for $nome in .//nomi =&gt; jnode-content()
return upper-case($nome)
</code></pre>
<p>To prevent users from selectively resorting to the shorter lookup syntax…</p>
<pre><code class="language-xquery">.?Catania?nomi =&gt; count()

for $nome in .?Catania?*?nomi
return upper-case($nome)
</code></pre>
<p>…we could include another pseudo-function that returns the content/value instead of a JNode:</p>
<pre><code class="language-xquery">./Catania/content(nomi) =&gt; count()

for $nome in .//content(nomi) 
return upper-case($nome)
</code></pre>
<p>One drawback would be that this would violate the current principle that the righthand side is only a filter.</p>
</div></details></div>
<div class="toot" id="created-2094"><h2>Pull request #2094 created<span class="toot-id"> #created-2094</span></h2><div class="pubdate">13 Jul at 08:40:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2094">https://github.com/qt4cg/qtspecs/pull/2094</a></div><details><summary>2003 Generalize Map Constructors</summary><div class="markup"><p>Allows conditional and repeated entries in a map constructor.</p>
<p>Fix #2003</p>
</div></details></div>
<div class="toot" id="created-2093"><h2>Issue #2093 created<span class="toot-id"> #created-2093</span></h2><div class="pubdate">12 Jul at 09:07:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2093">https://github.com/qt4cg/qtspecs/issues/2093</a></div><details><summary>XQFO: structuring</summary><div class="markup"><p>The way the XQFO functions are structured is becoming increasingly arbitrary. Examples:</p>
<ul>
<li>Processing sequences: <code>fn:doc</code></li>
<li>Processing nodes: <code>fn:string</code></li>
<li>Processing QNames: <code>fn:in-scope-prefixes</code></li>
<li>Parsing and serializing: <code>fn:xsd-validator</code></li>
</ul>
<p>For at least 10% of the functions, it will be difficult to find a good categorization (categorization is a challenging topic in itself), but maybe we can improve the status quo.</p>
<p>We can certainly tackle this at a later stage; this issue is only about reminding us of the task.</p>
</div></details></div>
<div class="toot" id="closed-1715"><h2>Issue #1715 closed<span class="toot-id"> #closed-1715</span></h2><div class="pubdate">11 Jul at 21:45:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1715">https://github.com/qt4cg/qtspecs/issues/1715</a></div><p>Array Lookups: partial removal of out-of-bounds checks</p></div>
<div class="toot" id="closed-1995"><h2>Issue #1995 closed<span class="toot-id"> #closed-1995</span></h2><div class="pubdate">11 Jul at 21:42:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1995">https://github.com/qt4cg/qtspecs/issues/1995</a></div><p>Consistency: array lookups</p></div>
<div class="toot" id="closed-1872"><h2>Issue #1872 closed<span class="toot-id"> #closed-1872</span></h2><div class="pubdate">11 Jul at 21:42:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1872">https://github.com/qt4cg/qtspecs/issues/1872</a></div><p>Arrays: members → values / entries?</p></div>
<div class="toot" id="closed-1871"><h2>Issue #1871 closed<span class="toot-id"> #closed-1871</span></h2><div class="pubdate">11 Jul at 21:38:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1871">https://github.com/qt4cg/qtspecs/issues/1871</a></div><p>Arrays and maps: consistency</p></div>
<div class="toot" id="created-2092"><h2>Issue #2092 created<span class="toot-id"> #created-2092</span></h2><div class="pubdate">11 Jul at 20:34:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2092">https://github.com/qt4cg/qtspecs/issues/2092</a></div><details><summary>Drop map:pair, map:of-pairs, map:pairs, array:members, array:of-members</summary><div class="markup"><p>I propose dropping the three functions <code>map:pair</code>, <code>map:of-pairs</code>, <code>map:pairs</code>, together with the built-in record type <code>fn:key-value-pair</code>.</p>
<p>With the introduction of JNodes, I think these are redundant.</p>
<ul>
<li>In place of <code>map:pairs($map)</code>, use <code>$map/*</code>.</li>
<li>In place of <code>map:pair($key, $value)</code>, use <code>{$key : $value}/*</code></li>
<li>In place of <code>map:of-pairs</code>, use <code>map:build($jnodes, jnode-selector#1, jnode-content#1)</code></li>
</ul>
<p>I'm proposing to keep the map:entry, map:entries, and map:merge trio which also do much the same thing.</p>
<p>Similarly, I propose dropping <code>array:members</code> and <code>array:of-members</code>, and "value records":</p>
<ul>
<li>In place of <code>array:members($array)</code>, use <code>$array/*</code></li>
<li>In place of <code>array:of-members</code>, use <code>array:build($jnodes, jnode-content#1)</code></li>
</ul>
<p>(Alternatively: keep the functions but define them to return and consume JNodes, rather than key-value and value records.)</p>
</div></details></div>
<div class="toot" id="closed-2046"><h2>Issue #2046 closed<span class="toot-id"> #closed-2046</span></h2><div class="pubdate">11 Jul at 15:29:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2046">https://github.com/qt4cg/qtspecs/issues/2046</a></div><p>Promote ".." to a primary expression</p></div>
<div class="toot" id="closed-2076"><h2>Issue #2076 closed<span class="toot-id"> #closed-2076</span></h2><div class="pubdate">11 Jul at 14:18:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2076">https://github.com/qt4cg/qtspecs/issues/2076</a></div><p>TOC: Interaction</p></div>
<div class="toot" id="closed-2091"><h2>Issue #2091 closed<span class="toot-id"> #closed-2091</span></h2><div class="pubdate">11 Jul at 14:18:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2091">https://github.com/qt4cg/qtspecs/pull/2091</a></div><p>ToC changes per issue #2076</p></div>
<div class="toot" id="created-2091"><h2>Pull request #2091 created<span class="toot-id"> #created-2091</span></h2><div class="pubdate">11 Jul at 14:18:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2091">https://github.com/qt4cg/qtspecs/pull/2091</a></div><details><summary>ToC changes per issue #2076</summary><div class="markup"><p>Fix #2076</p>
<p>Hopefully this is an improvement!</p>
</div></details></div>
<div class="toot" id="closed-2090"><h2>Issue #2090 closed<span class="toot-id"> #closed-2090</span></h2><div class="pubdate">11 Jul at 07:12:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2090">https://github.com/qt4cg/qtspecs/issues/2090</a></div><p>What does it mean to send an `encoding` serialization parameter to `fn:serialize`?</p></div>
<div class="toot" id="created-2090"><h2>Issue #2090 created<span class="toot-id"> #created-2090</span></h2><div class="pubdate">10 Jul at 16:35:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2090">https://github.com/qt4cg/qtspecs/issues/2090</a></div><details><summary>What does it mean to send an `encoding` serialization parameter to `fn:serialize`?</summary><div class="markup"><p>We say that <code>fn:serialize()</code> returns a string, so I'd expect it to be UTF-8 (or UTF-16, or whatever the implementation's common character set is for strings). I don't see any mention of the meaning of encoding.</p>
</div></details></div>
<div class="toot" id="created-2089"><h2>Issue #2089 created<span class="toot-id"> #created-2089</span></h2><div class="pubdate">09 Jul at 11:46:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2089">https://github.com/qt4cg/qtspecs/issues/2089</a></div><details><summary>JNode properties: Presentation</summary><div class="markup"><p>Maybe the presentation of XNode and JNode properties could be aligned.</p>
<p>The XDM uses square brackets for XML node properties:</p>
<blockquote>
<p>Document node properties are derived from the infoset as follows:</p>
<p><strong>base-uri</strong>
&nbsp;&nbsp;&nbsp;&nbsp;The value of the <strong>[base URI]</strong> property, if available, […]</p>
</blockquote>
<p>…and the character ¶ for JNode properties:</p>
<blockquote>
<p>JNode has the following properties:
&nbsp;&nbsp;&nbsp;&nbsp;<strong>¶parent</strong>: a JNode […]</p>
</blockquote>
<p>Would it make sense to always use ¶ or square brackets, or are the kind of properties we talk about too different in order to be aligned? In the latter case, we may need to clarify this in the spec, or add some words on (possibly non-existing) GNode properties.</p>
</div></details></div>
<div class="toot" id="created-2088"><h2>Issue #2088 created<span class="toot-id"> #created-2088</span></h2><div class="pubdate">09 Jul at 11:24:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2088">https://github.com/qt4cg/qtspecs/issues/2088</a></div><details><summary>File Module: Feedback, Observations</summary><div class="markup"><h4>1. “Regular files” (QT4CG-128-01)</h4>
<p>Add POSIX reference.</p>
<h4>2. Permissions (QT4CG-128-02)</h4>
<p>All functions should be checked with regard to permission handling. Due to the variety of file systems and the programming languages that operate on them, it may turn out that <code>file:not-found</code> and <code>file:io-error</code> is all we can offer.</p>
<h4>3. <code>file:is-absolute</code></h4>
<p>The rule says: “A path is absolute if it does not need to be combined with other path information, such as the current directory, to locate a file.”</p>
<p>Thus, <code>file:is-absolute('/')</code> must <strong>not</strong> return true on Windows systems, as the drive letter is missing.</p>
<p>Other rules of the spec that refer to absolute file paths should reflect this.</p>
<h4>4. <code>file:resolve-path</code></h4>
<p>Additionally, Rule 1 “If <code>$path</code> is an absolute path, it is returned unchanged.” contradicts the final sentence, which states that a separator must be added to directory paths:</p>
<p>…to be continued.</p>
</div></details></div>
<div class="toot" id="created-2087"><h2>Issue #2087 created<span class="toot-id"> #created-2087</span></h2><div class="pubdate">09 Jul at 08:24:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2087">https://github.com/qt4cg/qtspecs/issues/2087</a></div><details><summary>Adaptive serialization: JNodes</summary><div class="markup"><p>The (proposed) spec currently says (for the adaptive output method)</p>
<p>A JNode is serialized by serializing its ¶value property.</p>
<p>I propose changing the output to</p>
<p><code>JNode(k:v)</code></p>
<p>where k is the serialization of the selector property and v is the serialization of the value property.</p>
<p>The rule for the JSON output method remains the same.</p>
<p>The reason for the change is so that people can see when a query returns a JNode as distinct from returning its value.</p>
</div></details></div>
<div class="toot" id="created-2086"><h2>Issue #2086 created<span class="toot-id"> #created-2086</span></h2><div class="pubdate">08 Jul at 20:10:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2086">https://github.com/qt4cg/qtspecs/issues/2086</a></div><details><summary>Can the ¶value property of a JNode be (or contain) a JNode?</summary><div class="markup"><p>The data model allows the ¶value property of a JNode be (or contain) a JNode. But can it actually happen, and if so, what are the consequences?</p>
<p>I think it can happen. Although fn:JNode can't be applied directly to a JNode, it is possible to construct a map or array in which the entries/members are (or contain) JNodes. We can then wrap such an array or map in a JNode using the fn:JNode function, and the child axis applied to this containing array will return JNodes that have JNodes as their ¶value properties.</p>
<p>While the results may be confusing, I don't think they are harmful (and someone may find an imaginative way of making use of such a structure). For the time being therefore, I propose to allow it, perhaps with an explanatory note to point out any dangers.</p>
<p>Should atomization of a JNode unwrap multiple layers? We currently say that if a JNode J has a ¶value V, then the atomization of J is the atomization of V. I see no particular reason to change that rule, but again, it's an edge case we might draw attention to.</p>
</div></details></div>
<div class="toot" id="minutes—07-08"><h2>QT4 CG meeting 128 draft minutes<span class="toot-id"> #minutes—07-08</span></h2><div class="pubdate">08 Jul at 16:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/07-08">https://qt4cg.org/meeting/minutes/2025/07-08</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2085"><h2>Issue #2085 closed<span class="toot-id"> #closed-2085</span></h2><div class="pubdate">08 Jul at 16:24:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2085">https://github.com/qt4cg/qtspecs/pull/2085</a></div><p>Fix markup errors in the EXPath file: specification</p></div>
<div class="toot" id="created-2085"><h2>Pull request #2085 created<span class="toot-id"> #created-2085</span></h2><div class="pubdate">08 Jul at 16:24:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2085">https://github.com/qt4cg/qtspecs/pull/2085</a></div><details><summary>Fix markup errors in the EXPath file: specification</summary><div class="markup"><p>The FOS schema does not allow an fos:example containing an fos:test to omit the fos:result element. I’ve inserted</p>
<pre><code>&lt;fos:result&gt;���&lt;/fos:result&gt;
</code></pre>
<p>as a placeholder to mark the problem. I also had to move some of the fos:errors sections to a different location.</p>
<p>@ChristianGruen apologies for just pushing these in. I wanted to get the specs building again.</p>
</div></details></div>
<div class="toot" id="closed-2070"><h2>Issue #2070 closed<span class="toot-id"> #closed-2070</span></h2><div class="pubdate">08 Jul at 16:01:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2070">https://github.com/qt4cg/qtspecs/pull/2070</a></div><p>Map build patch</p></div>
<div class="toot" id="closed-2016"><h2>Issue #2016 closed<span class="toot-id"> #closed-2016</span></h2><div class="pubdate">08 Jul at 16:00:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2016">https://github.com/qt4cg/qtspecs/issues/2016</a></div><p>File Module: Incorporate changes</p></div>
<div class="toot" id="closed-2077"><h2>Issue #2077 closed<span class="toot-id"> #closed-2077</span></h2><div class="pubdate">08 Jul at 16:00:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2077">https://github.com/qt4cg/qtspecs/pull/2077</a></div><p>2016 File Module: Incorporate changes</p></div>
<div class="toot" id="agenda-07-08"><h2>QT4 CG meeting 128 draft agenda<span class="toot-id"> #agenda-07-08</span></h2><div class="pubdate">07 Jul at 12:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/07-08">https://qt4cg.org/meeting/agenda/2025/07-08</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2084"><h2>Issue #2084 created<span class="toot-id"> #created-2084</span></h2><div class="pubdate">05 Jul at 17:30:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2084">https://github.com/qt4cg/qtspecs/issues/2084</a></div><details><summary>Steps when the context value contains multiple nodes</summary><div class="markup"><p>We have two conflicting statements in the spec.</p>
<p>§4.6.4 says: "The step expression S is equivalent to ./S. Thus, if the context value is a sequence containing multiple nodes, the semantics of a step expression are equivalent to a path expression in which the step is always applied to a single node."</p>
<p>§4.6.5 says: "When the context value for evaluation of a step includes multiple nodes, the step is evaluated separately for each of those nodes, and the results are combined without reordering."</p>
<p>I'm not sure which is intended: does S means<code>. / S</code>, or <code>. ! S</code>?</p>
</div></details></div>
<div class="toot" id="created-2083"><h2>Pull request #2083 created<span class="toot-id"> #created-2083</span></h2><div class="pubdate">05 Jul at 12:09:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2083">https://github.com/qt4cg/qtspecs/pull/2083</a></div><details><summary>2054 Generalized Path Expressions</summary><div class="markup"><p>This proposal (which has the JNodes proposal as its baseline) is a first cut at defining generalised steps and path expressions that handle both XNodes and JNodes in a uniform way.</p>
<p>The proposal adds functionality to path expressions (using "/") but does not yet remove the corresponding functionality from lookup expressions (using "?") - that will follow in a subsequent draft.</p>
<p>The changes are largely confined to XPath section §4.6.</p>
<p>Obviously there is much scope to add notes and examples. There is also a need to reorganise sections so concepts are introduced before they are referenced.</p>
</div></details></div>
<div class="toot" id="created-2082"><h2>Issue #2082 created<span class="toot-id"> #created-2082</span></h2><div class="pubdate">04 Jul at 16:43:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2082">https://github.com/qt4cg/qtspecs/issues/2082</a></div><details><summary>parse-html options parameter conventions</summary><div class="markup"><p>In most functions, the options parameters have types such as <code>xs:boolean</code> and <code>xs:string</code>. But in <code>parse-html</code>, they are <code>xs:boolean?</code> and <code>xs:string?</code></p>
</div></details></div>
<div class="toot" id="closed-2081"><h2>Issue #2081 closed<span class="toot-id"> #closed-2081</span></h2><div class="pubdate">03 Jul at 21:23:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2081">https://github.com/qt4cg/qtspecs/issues/2081</a></div><p>Destructuring let combined with for clause</p></div>
<div class="toot" id="created-2081"><h2>Issue #2081 created<span class="toot-id"> #created-2081</span></h2><div class="pubdate">03 Jul at 20:29:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2081">https://github.com/qt4cg/qtspecs/issues/2081</a></div><details><summary>Destructuring let combined with for clause</summary><div class="markup"><p>We may need to look at expressions of the following kind…</p>
<pre><code class="language-xquery">let $($a, $b) := (1 to 6) ! string()
for $i in 1 to 3
return ($a, $b, $i)
</code></pre>
<p>…which currently yield an exception:</p>
<pre><code>Improper use? Potential bug? Your feedback is welcome:
Contact: basex-talk@mailman.uni-konstanz.de
Version: BaseX 12.1 beta
Java: Eclipse Adoptium, 17.0.14
OS: Windows 11, amd64
java.lang.ArrayIndexOutOfBoundsException: Index -1 out of bounds for length 32
	at org.basex.query.var.QueryStack.set(QueryStack.java:124)
	at org.basex.query.QueryContext.set(QueryContext.java:577)
	at org.basex.query.expr.gflwor.Let$LetEval.next(Let.java:147)
	at org.basex.query.expr.gflwor.GFLWOR$1.next(GFLWOR.java:79)
	at org.basex.query.scope.MainModule$1.next(MainModule.java:65)
	at org.basex.query.QueryContext.next(QueryContext.java:395)
	at org.basex.query.QueryContext.lambda$6(QueryContext.java:629)
	at org.basex.query.QueryContext.run(QueryContext.java:770)
	at org.basex.query.QueryContext.cache(QueryContext.java:609)
</code></pre>
</div></details></div>
<div class="toot" id="created-2080"><h2>Issue #2080 created<span class="toot-id"> #created-2080</span></h2><div class="pubdate">03 Jul at 20:24:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2080">https://github.com/qt4cg/qtspecs/issues/2080</a></div><details><summary>Destructuring let clauses: Bind remaining values</summary><div class="markup"><p>With the new LetSequenceBinding, LetArrayBinding and LetMapBinding clauses, single items of an evaluated expression can be partially bound:</p>
<pre><code class="language-xquery">let $($a, $b) := (1, 2, 3)
let $[$a $b, $c] := [ 1, 2, 3 ]
let ${$a, $b} := { 'a': 1, 'b': 2, 'c': 3 }
</code></pre>
<p>It would be helpful to be able to also bind all remaining items, for example with the three-dot syntax. If we allow this syntax for maps, the result could be a submap with all entries except for the ones that were bound by previous bindings:</p>
<pre><code class="language-xquery">(: $first: 1, $remaining: (2, 3) :)
let $($first, $remaining...) := (1, 2, 3)

(: $first: 1, $remaining: (2, 3) :)
let $[$first, $remaining...] := [ 1, 2, 3 ]

(: $a: 1, $remaining: { 'b': 2, 'c': 3 } :)
let ${$a, $remaining...} := { 'a': 1, 'b': 2, 'c': 3 }
</code></pre>
</div></details></div>
<div class="toot" id="created-2079"><h2>Issue #2079 created<span class="toot-id"> #created-2079</span></h2><div class="pubdate">03 Jul at 12:18:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2079">https://github.com/qt4cg/qtspecs/issues/2079</a></div><details><summary>Extend EQName with optional prefix</summary><div class="markup"><p>A QName has three components, prefix, uri, and local, and it's sometimes useful to be able to specify all three.</p>
<p>I suggest extending the definition of EQName to allow the format Q{uri}prefix:local, where the optional prefix is documentary only, but is present in the resulting QName value.</p>
<p>There may be a need to look at places where EQNames are used and to describe the consequences of using this format.</p>
</div></details></div>
<div class="toot" id="created-2078"><h2>Issue #2078 created<span class="toot-id"> #created-2078</span></h2><div class="pubdate">03 Jul at 03:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2078">https://github.com/qt4cg/qtspecs/issues/2078</a></div><details><summary>2031/2025 JNodes: inconsistency in data model taxonomy, definitions</summary><div class="markup"><p>Per chair request, I'm raising an issue on PR #2031 (on issue #2025), even though it has not been adopted by the CG.</p>
<p>I strongly support the JNodes proposal. But in its current state, I have concerns about the fundamentals. If I am right, or only partly right, adjustments will have cascading effects.</p>
<p>I realize that throughout the specs we use the "Definition" rubric loosely, but, for&nbsp;the points I raise below, I would ask that we at least aspire to a more robust definition of "definition." I draw on the classic Aristotelian model, where a good definition should specify the definiendum's genus ("definiendum" = "the thing&nbsp;to be defined"), then supply only those predicates needed to distinguish the definiendum from other species of that genus. The classic example is the definition of "human being" as a "rational animal." The animal is the genus, and the adjective "rational" delimits human beings from non-human being animals. No need to get hung up on details -- that's the gist of the what&nbsp;informs my comments below.</p>
<p>The PR proposes the new top-level structure:</p>
<ul>
<li>GNode
<ul>
<li>XNode</li>
<li>JNode</li>
</ul>
</li>
</ul>
<p>The first term is defined:&nbsp;</p>
<blockquote>
<p>[Definition: The term generic node or GNode is a collective term for XNodes (more commonly called simply nodes) representing the parts of an XML document, and JNodes, often used to represent the parts of a JSON document.]</p>
</blockquote>
<p>This definition attempts to define things outside the scope of the definiendum. It is presented here as a kind of abstract umbrella category for more specific things. Not a big deal; we carry on:</p>
<blockquote>
<p>[Definition: An XNode, more commonly referred to simply as a node, represents a construct found in an XML document. There are seven kinds: document nodes, element nodes, attribute nodes, text nodes, comment nodes, processing instruction nodes, and namespace nodes]
[Definition: A JNode represents an encapsulation of a value in a tree of maps and arrays, such as might be obtained by parsing a JSON document. XDM maps and arrays, however, are more general than those found in JSON.]</p>
</blockquote>
<p>Each of these two definitions says not what the definiendum is, but rather what it does ("represents": like a member of parliament represents constituents? -- confusing). It also includes buffer words that introduce intermediaries between the definiendum and the thing you would think most immediate to it: "construct," "found," "encapsulation," "value."</p>
<p>More difficult is the fact that, like GNode, an XNode is an abstract category and not a thing in itself. But a JNode, we learn later, is not an abstract category, but an actual thing,&nbsp;with properties. So at the top level of the taxonomy, we have an inconsistency, between abstract categories that have no instantiation, versus those that do, and the two are put in parataxis.</p>
<p>The definition of JNode is not well formulated. It restricts itself to "a value in a tree of maps and arrays" but not to maps and arrays themselves. Does the quoted phrase mean a map entry or an array member? Or the value within said entry or member?&nbsp;</p>
<p>Slight tangent: in the specs' definition of "value," the term is not really defined, but simply said to be synonymous with "sequence." But in practice the word substitution doesn't work. More often, the specs use "value" in a more restricted, common-sense meaning, to describe a two-term relationship. A thing "owns" a value and some datum inhabits the role of that thing's value. X has value Y. Y is value of X. We run into problems with the ambiguous word "value." Currently a JNode encapsulates a value (see above). But it also has the property (we learn later) of value. So the value has a value?</p>
<p>The JNode definition is sharpened, not in the data model, where it should be, but in the opening sentence of XSLT section 20: "A JNode is a wrapper around a map or array, or around a value that appears within the content of a map or array." This raises the question, what is a wrapper? And content? But it also raises the question about the relationship between JNode and map and between JNode and array, and the juxtaposition of JNode with XNode accentuates the difference. We would never say that an XNode is a wrapper around an element, an attribute, etc. The inconsistency is of a piece with the confusion I've pointed out above concerning the taxonomy of the data model.</p>
<p>Before I propose a solution, I need to probe a similar problem that already exists in the specs:</p>
<blockquote>
<p>[Definition: A <strong>function</strong> is an item that can be <strong>called</strong>. ]</p>
</blockquote>
<p>The word "called" is set in boldface, as if it is a technical&nbsp;term defined elsewhere. It is not, and is rarely used in the specs. What is it for something to be callable? Non-callable? To my mind, we do not have a proper definition of "function," and it is fair game for adjustment. As we have done. In 4.0 we have promoted the function and its proper parts into the topmost level of the data model taxonomy (with adjustments to a few definitions).</p>
<blockquote>
<p>[Definition: An array item (also called simply an array) is a function item that represents an array.]</p>
</blockquote>
<p>This suffers from the same flaws as GNode and XNode ("represents"), and is tautologous. In the version 3.1 definition of "map" we had the same problem, but the version 4.0 definition at least avoids the tautology.</p>
<p>So, to sum, we have definitions that aren't, inconsistency in our data model taxonomy, and a variety of other problems.</p>
<h3>A different approach</h3>
<p>We all intuit that the new taxonomy GNode - (XNode | JNode) is meaningful, useful, and important. Arrays and maps really are trees as much as they are functions.</p>
<p>Let all three terms GNode, XNode, and JNode be defined as abstract categories.</p>
<p>Just as XNode is subdivided into specific xnodes, let JNode subdivide into four specific jnodes:</p>
<ol>
<li>map</li>
<li>map entry</li>
<li>array</li>
<li>array member</li>
</ol>
<p>Adopt the same approach we do for xnodes, and define each of the four on its own terms. Define map - map entry and array - array member along lines similar to the approach adopted in 6.6 to define element - attribute (quite analogous!). We have wrestled over having to have both sequence and selector properties. But with this new&nbsp;approach, we are&nbsp;not stuck. Only map and array jnodes&nbsp;require a sequence property. Map entry and array member jnodes&nbsp;require only the selector property, not the sequence.</p>
<p>This approach is extensible. Suppose we have a proposal for a new JNode. It's a blork, and every blork has one or more cheegs, each one of which has one or more drazers. We simply define three more JNodes: blork, cheeg, drazer. We make sure that the properties for each are suited to what they are individually (the same way we do for the 7 types of XNodes).</p>
<p>One more step, the most controversial: drop Map Items and Array Items from the Function Items category. Yes, there is a fundamental way in which maps and arrays behave like (non-map/array) functions, but there are also equally fundamental ways in which maps and arrays behave like XNodes. If we do not need to define maps and arrays subordinate to XNodes/nodes, then why should we define them subordinate to functions? JNodes have dual citizenship.</p>
<p>An alternative taxonomy is to drop the concept of GNode altogether, and let there be four kinds of item:&nbsp;</p>
<ul>
<li>item&nbsp;
<ul>
<li>anyAtomicType&nbsp;</li>
<li>XNode&nbsp;
<ul>
<li>attribute&nbsp;</li>
<li>document&nbsp;</li>
<li>element&nbsp;</li>
<li>text&nbsp;</li>
<li>comment&nbsp;</li>
<li>processing-instruction&nbsp;</li>
<li>namespace&nbsp;</li>
</ul>
</li>
<li>JNode/JFunction&nbsp;
<ul>
<li>map&nbsp;</li>
<li>map entry&nbsp;</li>
<li>array&nbsp;</li>
<li>array member&nbsp;</li>
</ul>
</li>
<li>function(*)</li>
</ul>
</li>
</ul>
</div></details></div>
<div class="toot" id="created-2077"><h2>Pull request #2077 created<span class="toot-id"> #created-2077</span></h2><div class="pubdate">02 Jul at 11:00:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2077">https://github.com/qt4cg/qtspecs/pull/2077</a></div><details><summary>2016 File Module: Incorporate changes</summary><div class="markup"><p>Includes general refactorings.</p>
<p>Closes #2016</p>
</div></details></div>
<div class="toot" id="created-2076"><h2>Issue #2076 created<span class="toot-id"> #created-2076</span></h2><div class="pubdate">02 Jul at 08:59:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2076">https://github.com/qt4cg/qtspecs/issues/2076</a></div><details><summary>TOC: Interaction</summary><div class="markup"><p>Based on user feedback that I got, it seems that the solution to expand/collapse a sub-TOC could be more intuitive.</p>
<p>@ndw Would it be possible to remove the rightmost arrow icon, and to simply expand the subentries when a TOC entry is clicked? This would also decrease the number of icons, and it would remove the current, somewhat confusing behavior that a TOC entry is also expanded/collapsed when the empty area to the right of the arrow is clicked.</p>
<p>We could keep the arrow on top level to be able to expand/collapse all entries.</p>
</div></details></div>
<div class="toot" id="created-2075"><h2>Issue #2075 created<span class="toot-id"> #created-2075</span></h2><div class="pubdate">02 Jul at 08:50:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2075">https://github.com/qt4cg/qtspecs/issues/2075</a></div><details><summary>Editorial notes (incremental)</summary><div class="markup"><ul>
<li>The »Summary of Changes« sections contain outdated information that refer to the presentation of the specs. Maybe we don’t really need them:
<ul>
<li>Use the arrows to browse significant changes since the 3.1 version of this specification.</li>
<li>Sections with significant changes are marked Δ in the table of contents. New functions introduced in this version are marked ➕ in the table of contents.</li>
</ul>
</li>
</ul>
<p>…to be continued.</p>
<p><strong>NO ACTION</strong></p>
</div></details></div>
<div class="toot" id="closed-2074"><h2>Issue #2074 closed<span class="toot-id"> #closed-2074</span></h2><div class="pubdate">02 Jul at 08:13:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2074">https://github.com/qt4cg/qtspecs/issues/2074</a></div><p>JPath operator</p></div>
<div class="toot" id="created-2074"><h2>Issue #2074 created<span class="toot-id"> #created-2074</span></h2><div class="pubdate">02 Jul at 08:05:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2074">https://github.com/qt4cg/qtspecs/issues/2074</a></div><details><summary>JPath operator</summary><div class="markup"><p>Christian (I'm not sure where....) has proposed using an operator other than <code>?</code>, for example <code>?/</code>, for paths involving JNodes.</p>
<p>This would eliminate some of the non-orthogonalities introduced in the interests of backwards compatibility. For example, the result could always be in document order with duplicates eliminated (which is not currently true for <code>A?B</code>). <code>A?/B</code> could then be truly synonymous with <code>A?/child::B</code>, with no ifs and buts. The result would always be a sequence of JNodes, they would only be unwrapped if used in a context (such as arithmetic) where coercion forces the unwrapping.</p>
<p>This might (perhaps?) also enable a tidier syntax for filtering by type: the current syntax <code>A?~[sequenceType]</code> is rather clunky.</p>
</div></details></div>
<div class="toot" id="created-2073"><h2>Issue #2073 created<span class="toot-id"> #created-2073</span></h2><div class="pubdate">02 Jul at 07:47:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2073">https://github.com/qt4cg/qtspecs/issues/2073</a></div><details><summary>JNodes and Sequences</summary><div class="markup"><p>The JNode model as currently proposed doesn't handle sequences very elegantly: specifically maps and arrays whose entries/members contain values of more than one item.</p>
<p>Also (but separate) handling of empty maps, arrays, and sequences isn't ideal.</p>
<p>Consider the map <code>{"a": 1, "b": [2], "c": (3, 4), "d": ([5], [6]), "e": (7, [8]), "f": []}</code></p>
<p>Applying <code>child::*</code> to this map gives you six JNodes, as you would expect, with selector properties "a", "b", "c", "d", "e", "f". After that, things get complicated.</p>
<ul>
<li>
<p>The JNode <code>child::a</code> has a value of <code>1</code>, and no children.</p>
</li>
<li>
<p>The JNode <code>child::b</code> has a value of <code>[2]</code>, and has one child, with selector=1, value=2, position=1</p>
</li>
<li>
<p>The JNode <code>child::c</code> has a value of (3,4), and no children.</p>
</li>
<li>
<p>The JNode <code>child::d</code> has a value of <code>([5], [6])</code>, and has two children. The first child has selector=1,  position=1, value=5; the second has selector=1, position=2, value=6. Each of these two children itself has one child.</p>
</li>
<li>
<p>The JNode <code>child::e</code> has a value of <code>(7, [8])</code>, and has one child. The child has selector=1,  position=2, value=8.</p>
</li>
<li>
<p>The JNode <code>child::f</code> has a value of <code>[]</code> and no children.</p>
</li>
</ul>
<p>There is logic to this, but it isn't easy to explain. I don't at the moment have any clear ideas for improving matters, but raise the issue in the hope that we can come up with ideas.</p>
</div></details></div>
<div class="toot" id="closed-835"><h2>Issue #835 closed<span class="toot-id"> #closed-835</span></h2><div class="pubdate">02 Jul at 06:23:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/835">https://github.com/qt4cg/qtspecs/issues/835</a></div><p>Review names of record types</p></div>
<div class="toot" id="closed-2040"><h2>Issue #2040 closed<span class="toot-id"> #closed-2040</span></h2><div class="pubdate">02 Jul at 05:53:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2040">https://github.com/qt4cg/qtspecs/issues/2040</a></div><p>XQuery context value declaration</p></div>
<div class="toot" id="closed-2050"><h2>Issue #2050 closed<span class="toot-id"> #closed-2050</span></h2><div class="pubdate">02 Jul at 05:53:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2050">https://github.com/qt4cg/qtspecs/pull/2050</a></div><p>2040 Fix context value declaration issues</p></div>
<div class="toot" id="minutes—07-01"><h2>QT4 CG meeting 127 draft minutes<span class="toot-id"> #minutes—07-01</span></h2><div class="pubdate">01 Jul at 16:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/07-01">https://qt4cg.org/meeting/minutes/2025/07-01</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-2072"><h2>Issue #2072 created<span class="toot-id"> #created-2072</span></h2><div class="pubdate">01 Jul at 16:27:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2072">https://github.com/qt4cg/qtspecs/issues/2072</a></div><details><summary>JNodes: accessing properties</summary><div class="markup"><p>If we decided to introduce a custom JPath expression for JNodes (see #2054), we could possibly use the classic lookup operator to access the properties of JNodes:</p>
<p>For example, the expression…</p>
<pre><code class="language-xquery">let $data := { 'name': 'Achab' }
return $data/name
</code></pre>
<p>…would result in a JNode…</p>
<pre><code>JNode(
  value     := 'Achab'
  parent    := JNode($data)
  selector  := 'name'
  position  := 1
)
</code></pre>
<p>…and we could use <code>$name?selector</code> to retrieve the selector. This way, we could possibly go without the specific functions <code>fn:JNode-content</code>, <code>fn:JNode-selector</code> and <code>fn:JNode-position</code>.</p>
<p>In principle, the classic lookup operator could be further extended to access properties of XNodes.</p>
</div></details></div>
<div class="toot" id="closed-967"><h2>Issue #967 closed<span class="toot-id"> #closed-967</span></h2><div class="pubdate">01 Jul at 15:09:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/967">https://github.com/qt4cg/qtspecs/issues/967</a></div><p>XPath Appendix I: Comparisons</p></div>
<div class="toot" id="closed-1021"><h2>Issue #1021 closed<span class="toot-id"> #closed-1021</span></h2><div class="pubdate">01 Jul at 15:09:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1021">https://github.com/qt4cg/qtspecs/issues/1021</a></div><p>Extend `fn:doc`, `fn:collection` and `fn:uri-collection` with options maps</p></div>
<div class="toot" id="closed-1583"><h2>Issue #1583 closed<span class="toot-id"> #closed-1583</span></h2><div class="pubdate">01 Jul at 15:09:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1583">https://github.com/qt4cg/qtspecs/issues/1583</a></div><p>JSON: Parsing and serializing numbers, often undesired E notation</p></div>
<div class="toot" id="closed-1903"><h2>Issue #1903 closed<span class="toot-id"> #closed-1903</span></h2><div class="pubdate">01 Jul at 15:09:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1903">https://github.com/qt4cg/qtspecs/issues/1903</a></div><p>`fn:scan-left`, `fn:scan-right`: missing steps</p></div>
<div class="toot" id="closed-1283"><h2>Issue #1283 closed<span class="toot-id"> #closed-1283</span></h2><div class="pubdate">01 Jul at 11:12:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1283">https://github.com/qt4cg/qtspecs/pull/1283</a></div><p>77b Update expressions</p></div>
<div class="toot" id="created-2071"><h2>Pull request #2071 created<span class="toot-id"> #created-2071</span></h2><div class="pubdate">01 Jul at 11:11:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2071">https://github.com/qt4cg/qtspecs/pull/2071</a></div><details><summary>77c deep update</summary><div class="markup"><p>Proposes a new fn:update function that can handle both JNodes and XNodes.</p>
<p>(this is a branch on a branch, so I don't know how well the diff'ing will work; but look in F&amp;O for the fn:update function)</p>
</div></details></div>
<div class="toot" id="created-2070"><h2>Pull request #2070 created<span class="toot-id"> #created-2070</span></h2><div class="pubdate">30 Jun at 20:04:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2070">https://github.com/qt4cg/qtspecs/pull/2070</a></div><details><summary>Map build patch</summary><div class="markup"><p>Small edits to <code>map:build</code></p>
<ul>
<li>fix parameter name</li>
<li>remove surplus blank lines</li>
<li>add example with multiple keys returned by key function (a map of sequences)</li>
</ul>
</div></details></div>
<div class="toot" id="agenda-07-01"><h2>QT4 CG meeting 127 draft agenda<span class="toot-id"> #agenda-07-01</span></h2><div class="pubdate">30 Jun at 10:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/07-01">https://qt4cg.org/meeting/agenda/2025/07-01</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-2068"><h2>Issue #2068 closed<span class="toot-id"> #closed-2068</span></h2><div class="pubdate">25 Jun at 12:53:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2068">https://github.com/qt4cg/qtspecs/issues/2068</a></div><p>Editorial notes</p></div>
<div class="toot" id="closed-2069"><h2>Issue #2069 closed<span class="toot-id"> #closed-2069</span></h2><div class="pubdate">25 Jun at 12:53:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2069">https://github.com/qt4cg/qtspecs/pull/2069</a></div><p>1970, 2068 Editorial notes</p></div>
<div class="toot" id="created-2069"><h2>Pull request #2069 created<span class="toot-id"> #created-2069</span></h2><div class="pubdate">25 Jun at 11:58:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2069">https://github.com/qt4cg/qtspecs/pull/2069</a></div><details><summary>1970, 2068 Editorial notes</summary><div class="markup"><p>#1970, Closes #2068.</p>
<p>As this PR includes changes that should have been part of #1970 (and minor other fixes), I will immediately merge the PR. If someone objects, I will be happy to revert the change.</p>
</div></details></div>
<div class="toot" id="created-2068"><h2>Issue #2068 created<span class="toot-id"> #created-2068</span></h2><div class="pubdate">25 Jun at 11:16:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2068">https://github.com/qt4cg/qtspecs/issues/2068</a></div><details><summary>Editorial notes</summary><div class="markup"><ul>
<li>#2017: Key should also be mandatory for <code>array:sort-by</code></li>
</ul>
<p>…to be continued.</p>
</div></details></div>
<div class="toot" id="closed-2059"><h2>Issue #2059 closed<span class="toot-id"> #closed-2059</span></h2><div class="pubdate">24 Jun at 16:21:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2059">https://github.com/qt4cg/qtspecs/issues/2059</a></div><p>Literal QNames: Adaptive serialization</p></div>
<div class="toot" id="closed-2060"><h2>Issue #2060 closed<span class="toot-id"> #closed-2060</span></h2><div class="pubdate">24 Jun at 16:21:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2060">https://github.com/qt4cg/qtspecs/pull/2060</a></div><p>2059 Literal QNames: Adaptive serialization</p></div>
<div class="toot" id="closed-2017"><h2>Issue #2017 closed<span class="toot-id"> #closed-2017</span></h2><div class="pubdate">24 Jun at 16:19:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2017">https://github.com/qt4cg/qtspecs/issues/2017</a></div><p>`fn:sort-by`: Observations</p></div>
<div class="toot" id="closed-2062"><h2>Issue #2062 closed<span class="toot-id"> #closed-2062</span></h2><div class="pubdate">24 Jun at 16:19:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2062">https://github.com/qt4cg/qtspecs/pull/2062</a></div><p>2017 fn:sort-by: Observations</p></div>
<div class="toot" id="closed-1970"><h2>Issue #1970 closed<span class="toot-id"> #closed-1970</span></h2><div class="pubdate">24 Jun at 16:18:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1970">https://github.com/qt4cg/qtspecs/issues/1970</a></div><p>Editorial notes</p></div>
<div class="toot" id="closed-2065"><h2>Issue #2065 closed<span class="toot-id"> #closed-2065</span></h2><div class="pubdate">24 Jun at 16:18:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2065">https://github.com/qt4cg/qtspecs/pull/2065</a></div><p>1970 Editorial notes</p></div>
<div class="toot" id="closed-2056"><h2>Issue #2056 closed<span class="toot-id"> #closed-2056</span></h2><div class="pubdate">24 Jun at 16:16:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2056">https://github.com/qt4cg/qtspecs/issues/2056</a></div><p>Implicit Whitespace in `MarkedNCName` and `QNameLiteral`</p></div>
<div class="toot" id="closed-2064"><h2>Issue #2064 closed<span class="toot-id"> #closed-2064</span></h2><div class="pubdate">24 Jun at 16:16:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2064">https://github.com/qt4cg/qtspecs/pull/2064</a></div><p>2056 Implicit Whitespace in MarkedNCName and QNameLiteral</p></div>
<div class="toot" id="closed-2058"><h2>Issue #2058 closed<span class="toot-id"> #closed-2058</span></h2><div class="pubdate">24 Jun at 16:13:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2058">https://github.com/qt4cg/qtspecs/issues/2058</a></div><p>Literal QNames: Annotations</p></div>
<div class="toot" id="closed-2061"><h2>Issue #2061 closed<span class="toot-id"> #closed-2061</span></h2><div class="pubdate">24 Jun at 16:13:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2061">https://github.com/qt4cg/qtspecs/pull/2061</a></div><p>2058 Literal QNames: Annotations</p></div>
<div class="toot" id="closed-2067"><h2>Issue #2067 closed<span class="toot-id"> #closed-2067</span></h2><div class="pubdate">24 Jun at 16:12:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2067">https://github.com/qt4cg/qtspecs/pull/2067</a></div><p>Fix 'TODO' entries in the function catalog from PR 2013</p></div>
<div class="toot" id="created-2067"><h2>Pull request #2067 created<span class="toot-id"> #created-2067</span></h2><div class="pubdate">24 Jun at 16:12:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2067">https://github.com/qt4cg/qtspecs/pull/2067</a></div><p>Fix 'TODO' entries in the function catalog from PR 2013</p></div>
<div class="toot" id="closed-2009"><h2>Issue #2009 closed<span class="toot-id"> #closed-2009</span></h2><div class="pubdate">24 Jun at 16:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2009">https://github.com/qt4cg/qtspecs/issues/2009</a></div><p>xsl:variable implicit document nodes</p></div>
<div class="toot" id="closed-2015"><h2>Issue #2015 closed<span class="toot-id"> #closed-2015</span></h2><div class="pubdate">24 Jun at 16:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2015">https://github.com/qt4cg/qtspecs/pull/2015</a></div><p>2009 Avoid constructing document node when it makes no sense</p></div>
<div class="toot" id="closed-2045"><h2>Issue #2045 closed<span class="toot-id"> #closed-2045</span></h2><div class="pubdate">24 Jun at 16:04:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2045">https://github.com/qt4cg/qtspecs/issues/2045</a></div><p>Functions taking "." as default argument, when "." is empty</p></div>
<div class="toot" id="closed-2049"><h2>Issue #2049 closed<span class="toot-id"> #closed-2049</span></h2><div class="pubdate">24 Jun at 16:04:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2049">https://github.com/qt4cg/qtspecs/pull/2049</a></div><p>2045 Context value can be an empty sequence</p></div>
<div class="toot" id="closed-748"><h2>Issue #748 closed<span class="toot-id"> #closed-748</span></h2><div class="pubdate">24 Jun at 16:02:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/748">https://github.com/qt4cg/qtspecs/issues/748</a></div><p>Parse functions: consistency</p></div>
<div class="toot" id="closed-2013"><h2>Issue #2013 closed<span class="toot-id"> #closed-2013</span></h2><div class="pubdate">24 Jun at 16:02:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2013">https://github.com/qt4cg/qtspecs/pull/2013</a></div><p>748 Parse functions: consistency</p></div>
<div class="toot" id="closed-1942"><h2>Issue #1942 closed<span class="toot-id"> #closed-1942</span></h2><div class="pubdate">24 Jun at 15:58:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1942">https://github.com/qt4cg/qtspecs/pull/1942</a></div><p>37 Support sequence, array, and map destructuring declarations</p></div>
<div class="toot" id="closed-37"><h2>Issue #37 closed<span class="toot-id"> #closed-37</span></h2><div class="pubdate">24 Jun at 15:57:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/37">https://github.com/qt4cg/qtspecs/issues/37</a></div><p>Support sequence, array, and map destructuring declarations</p></div>
<div class="toot" id="closed-2055"><h2>Issue #2055 closed<span class="toot-id"> #closed-2055</span></h2><div class="pubdate">24 Jun at 15:57:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2055">https://github.com/qt4cg/qtspecs/pull/2055</a></div><p>37 Sequence, Array, and Map destructuring</p></div>
<div class="toot" id="created-2066"><h2>Issue #2066 created<span class="toot-id"> #created-2066</span></h2><div class="pubdate">24 Jun at 15:41:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2066">https://github.com/qt4cg/qtspecs/issues/2066</a></div><details><summary>Cells in the F&amp;O signature blocks should be vertically aligned to the top</summary><div class="markup"><p>If a function parameter type (e.g. in map:build) has a long type that wraps to multiple lines the parameter name and default are center aligned. A similar issue will happen with the type if the default value wraps.</p>
<p>Setting vertical align to top will fix this.</p>
</div></details></div>
<div class="toot" id="created-2065"><h2>Pull request #2065 created<span class="toot-id"> #created-2065</span></h2><div class="pubdate">24 Jun at 11:39:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2065">https://github.com/qt4cg/qtspecs/pull/2065</a></div><details><summary>1970 Editorial notes</summary><div class="markup"><p>Closes #1970</p>
<p>Editorial. The only controversial change may be to rename the second parameter of <code>map:build</code> from <code>$keys</code> to <code>$key</code>.</p>
</div></details></div>
<div class="toot" id="created-2064"><h2>Pull request #2064 created<span class="toot-id"> #created-2064</span></h2><div class="pubdate">24 Jun at 11:17:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2064">https://github.com/qt4cg/qtspecs/pull/2064</a></div><details><summary>2056 Implicit Whitespace in MarkedNCName and QNameLiteral</summary><div class="markup"><p>Closes #2056</p>
</div></details></div>
<div class="toot" id="closed-2002"><h2>Issue #2002 closed<span class="toot-id"> #closed-2002</span></h2><div class="pubdate">24 Jun at 11:10:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2002">https://github.com/qt4cg/qtspecs/issues/2002</a></div><p>Adaptive serialization: QNames</p></div>
<div class="toot" id="created-2063"><h2>Pull request #2063 created<span class="toot-id"> #created-2063</span></h2><div class="pubdate">24 Jun at 11:08:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2063">https://github.com/qt4cg/qtspecs/pull/2063</a></div><details><summary>1996 Lookups, KeySpecifier: Literal, ContextValueRef</summary><div class="markup"><p>Closes #1996</p>
</div></details></div>
<div class="toot" id="created-2062"><h2>Pull request #2062 created<span class="toot-id"> #created-2062</span></h2><div class="pubdate">24 Jun at 10:51:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2062">https://github.com/qt4cg/qtspecs/pull/2062</a></div><details><summary>2017 fn:sort-by: Observations</summary><div class="markup"><p>Closes #2017</p>
</div></details></div>
<div class="toot" id="closed-850"><h2>Issue #850 closed<span class="toot-id"> #closed-850</span></h2><div class="pubdate">24 Jun at 10:22:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/850">https://github.com/qt4cg/qtspecs/issues/850</a></div><p>fn:parse-html: Finalization</p></div>
<div class="toot" id="created-2061"><h2>Pull request #2061 created<span class="toot-id"> #created-2061</span></h2><div class="pubdate">24 Jun at 09:59:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2061">https://github.com/qt4cg/qtspecs/pull/2061</a></div><details><summary>2058 Literal QNames: Annotations</summary><div class="markup"><p>Closes #2058</p>
</div></details></div>
<div class="toot" id="created-2060"><h2>Pull request #2060 created<span class="toot-id"> #created-2060</span></h2><div class="pubdate">23 Jun at 14:35:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2060">https://github.com/qt4cg/qtspecs/pull/2060</a></div><details><summary>2059 Literal QNames: Adaptive serialization</summary><div class="markup"><p>Closes #2059</p>
</div></details></div>
<div class="toot" id="agenda-06-24"><h2>QT4 CG meeting 126 draft agenda<span class="toot-id"> #agenda-06-24</span></h2><div class="pubdate">23 Jun at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/06-24">https://qt4cg.org/meeting/agenda/2025/06-24</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2059"><h2>Issue #2059 created<span class="toot-id"> #created-2059</span></h2><div class="pubdate">23 Jun at 10:02:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2059">https://github.com/qt4cg/qtspecs/issues/2059</a></div><details><summary>Literal QNames: Adaptive serialization</summary><div class="markup"><p>QNames that are output with the <code>adaptive</code> serialization method could be prefixed with a <code>#</code> character:</p>
<pre><code class="language-xquery">serialize((#a, #xml:a), { 'method': 'adaptive' })

(: Result :)
#Q{}a
#Q{http://www.w3.org/XML/1998/namespace}a
</code></pre>
</div></details></div>
<div class="toot" id="created-2058"><h2>Issue #2058 created<span class="toot-id"> #created-2058</span></h2><div class="pubdate">22 Jun at 16:38:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2058">https://github.com/qt4cg/qtspecs/issues/2058</a></div><details><summary>Literal QNames: Annotations</summary><div class="markup"><p>The literal QName syntax could be useful for annotations:</p>
<pre><code class="language-xquery">(: Current RESTXQ syntax :)
%rest:query-param('search', '{$search}')
(: Alternative new syntax :)
%rest:query-param('search', #search)
</code></pre>
<p>To remove the current exotic status of literal QNames, we could allow the syntax at some more places, like:</p>
<ul>
<li>Catch clauses: <code>catch #err:XPTY0004 { ... }</code></li>
<li>Element/attribute tests: <code>element(#a:b)</code></li>
</ul>
</div></details></div>
<div class="toot" id="created-2057"><h2>Issue #2057 created<span class="toot-id"> #created-2057</span></h2><div class="pubdate">22 Jun at 10:30:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2057">https://github.com/qt4cg/qtspecs/issues/2057</a></div><details><summary>Steps: variable element names</summary><div class="markup"><p>With lookups, it is simple to use dynamic keys:</p>
<pre><code class="language-xquery">$map?$name
</code></pre>
<p>An equivalent solution is missing for path expressions. The current approach is to check the name with a predicate:</p>
<pre><code class="language-xquery">$node/*[node-name() = $name]
</code></pre>
<p>We could provide a more compare concise syntax by extending element tests (and, similarly, attribute tests):</p>
<pre><code class="language-xquery">$node/element($name)
</code></pre>
<p>The new literal QName syntax simplifies things further:</p>
<pre><code class="language-xquery">for $name in (#h1, #h2, #h3)
return $node/element($name)
</code></pre>
</div></details></div>
<div class="toot" id="created-2056"><h2>Issue #2056 created<span class="toot-id"> #created-2056</span></h2><div class="pubdate">18 Jun at 13:52:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2056">https://github.com/qt4cg/qtspecs/issues/2056</a></div><details><summary>Implicit Whitespace in `MarkedNCName` and `QNameLiteral`</summary><div class="markup"><p>The REx-generated XQuery parser has failed to raise the expected syntax error for test case <a href="https://github.com/qt4cg/qt4tests/blob/44f7691e986b39f81effea9686f7035d5ee99f6b/prod/CompNamespaceConstructor.xml#L711"><code>nscons-046</code></a>.</p>
<p>This is caused by REx' unability to precisely handle differing whitespace allowances of multiple viable parsing alternatives. In the actual case,</p>
<pre><code class="language-xquery">&lt;foo&gt;{namespace # ...
</code></pre>
<p>there are two possible interpretations for <code>namespace</code> <code>#</code> that still need to be distinguished:</p>
<ul>
<li>a <code>NamedFunctionRef</code> refering to some arity of a function named <code>namespace</code>,</li>
<li>a <code>CompNamespaceConstructor</code> using a <code>MarkedNCName</code>.</li>
</ul>
<p>Now the problem is that the former allows implicit whitespace to follow, while the latter does not. A REx parser accepts whitespace here and thus fails the test case.</p>
<p>While this is REx' problem, and can be worked around by creating multiple <code>#</code> tokens with different lexical lookahead, it would be nicer to avoid this situation. This would possibly also simplify the work for other parsers.</p>
<p>May I ask to allow implicit whitespace in both the <code>MarkedNCName</code> and <code>QNameLiteral</code> productions? This would be in line with variable declarations and references, which also allow implicit whitespace between <code>$</code> and <code>EQName</code>.</p>
</div></details></div>
<div class="toot" id="created-2055"><h2>Pull request #2055 created<span class="toot-id"> #created-2055</span></h2><div class="pubdate">17 Jun at 20:11:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2055">https://github.com/qt4cg/qtspecs/pull/2055</a></div><details><summary>37 Sequence, Array, and Map destructuring</summary><div class="markup"><p>Redrafting of PR 1942, after discussion, and extension to XQuery</p>
<p>Fix #37
Supersedes #1942</p>
<p>This PR implements the decisions of today's discussion to the best of my understanding. I don't think further discussion is needed, but it does merit careful checking.</p>
</div></details></div>
<div class="toot" id="minutes—06-17"><h2>QT4 CG meeting 125 draft minutes<span class="toot-id"> #minutes—06-17</span></h2><div class="pubdate">17 Jun at 16:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/06-17">https://qt4cg.org/meeting/minutes/2025/06-17</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1888"><h2>Issue #1888 closed<span class="toot-id"> #closed-1888</span></h2><div class="pubdate">17 Jun at 16:20:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1888">https://github.com/qt4cg/qtspecs/pull/1888</a></div><p>366 xsl:package-location</p></div>
<div class="toot" id="closed-2029"><h2>Issue #2029 closed<span class="toot-id"> #closed-2029</span></h2><div class="pubdate">17 Jun at 16:18:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2029">https://github.com/qt4cg/qtspecs/issues/2029</a></div><p>fn:xsd-validator - more explanation needed</p></div>
<div class="toot" id="closed-2030"><h2>Issue #2030 closed<span class="toot-id"> #closed-2030</span></h2><div class="pubdate">17 Jun at 16:18:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2030">https://github.com/qt4cg/qtspecs/pull/2030</a></div><p>2029 xsd validator notes and examples</p></div>
<div class="toot" id="closed-2041"><h2>Issue #2041 closed<span class="toot-id"> #closed-2041</span></h2><div class="pubdate">17 Jun at 16:11:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2041">https://github.com/qt4cg/qtspecs/issues/2041</a></div><p>Incorrect example of xsl:namespace-alias</p></div>
<div class="toot" id="closed-2042"><h2>Issue #2042 closed<span class="toot-id"> #closed-2042</span></h2><div class="pubdate">17 Jun at 16:11:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2042">https://github.com/qt4cg/qtspecs/pull/2042</a></div><p>2041 Correction to xsl:namespace-alias example</p></div>
<div class="toot" id="closed-1127"><h2>Issue #1127 closed<span class="toot-id"> #closed-1127</span></h2><div class="pubdate">17 Jun at 16:11:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1127">https://github.com/qt4cg/qtspecs/issues/1127</a></div><p>Binary resources</p></div>
<div class="toot" id="closed-2044"><h2>Issue #2044 closed<span class="toot-id"> #closed-2044</span></h2><div class="pubdate">17 Jun at 16:07:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2044">https://github.com/qt4cg/qtspecs/pull/2044</a></div><p>Hide `MarkedNCName` from XPath spec</p></div>
<div class="toot" id="created-2054"><h2>Issue #2054 created<span class="toot-id"> #created-2054</span></h2><div class="pubdate">16 Jun at 18:21:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2054">https://github.com/qt4cg/qtspecs/issues/2054</a></div><details><summary>JPath expression</summary><div class="markup"><p><strong>Edit:</strong> <code>?/</code> is preferred over <code>\</code>; see comments.</p>
<hr>
<p>I feel that there is one aspect about the exciting new <a href="https://qt4cg.org/dashboard/#pr-2031">JNode proposal</a> that may develop into a permanent crutch. It is the lack of symmetry between simple lookups and lookups with axes:</p>
<pre><code class="language-xquery">a?b
a?child::b
</code></pre>
<p>This particularly strikes me as this inconsistency does not exist in XPath.</p>
<p>What about the idea to keep XPath 3.1 lookups unchanged and simple – for the vast number of use cases that do not require navigation – and to introduce a new “JPath expression” instead that will exclusively produce JNodes?</p>
<p>The JStep separator that I would recommend for it is the backslash character <code>\</code>. It bears even more resemblance to the XPath step separator than the often questioned question mark. By using a new syntax, I believe we would have much more freedom in designing a clean solution for navigating maps and arrays that is more consistent as well as more similar to classical node paths.</p>
<p>Some syntactical examples:</p>
<pre><code class="language-xquery">let $countries := {
  'Japan': {
    'cities': [ { 'Fukuoka': { 'population': 1600000 } } ]
  }
}
return (
  $countries\*,
  $countries\\cities
  $countries\Japan\cities[.\\population &gt; 1000]\..,
  $countries\\*[.\ancestor::Japan]
)
</code></pre>
<p>Among other advantages that I see, the traversal of arrays of maps would also be less controversial (#115).</p>
</div></details></div>
<div class="toot" id="agenda-06-17"><h2>QT4 CG meeting 125 draft agenda<span class="toot-id"> #agenda-06-17</span></h2><div class="pubdate">16 Jun at 12:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/06-17">https://qt4cg.org/meeting/agenda/2025/06-17</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2053"><h2>Issue #2053 created<span class="toot-id"> #created-2053</span></h2><div class="pubdate">16 Jun at 12:43:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2053">https://github.com/qt4cg/qtspecs/issues/2053</a></div><details><summary>Add fn:collection-available</summary><div class="markup"><p>Since the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-collection">fn:collection</a> function can raise errors, perhaps it should have a corresponding function to check if the collection is available?</p>
<p>For reference, see the other *-available functions:</p>
<ul>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-collation-available">collation-available</a></li>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-doc-available">doc-available</a></li>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-unparsed-text-available">unparsed-text-available</a></li>
</ul>
<p>Also, eXist has an implementation-specific <code>xmldb:collection-available</code> function: https://exist-db.org/exist/apps/fundocs/index.html?q=xmldb:collection-available. It's typically used to determine if a collection already exists before creating or deleting it.</p>
<p>A proposed signature, based on those linked above, could be:</p>
<pre><code>fn:collection-available( $source as xs:string? := () ) as xs:boolean
</code></pre>
</div></details></div>
<div class="toot" id="created-2052"><h2>Issue #2052 created<span class="toot-id"> #created-2052</span></h2><div class="pubdate">16 Jun at 06:18:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2052">https://github.com/qt4cg/qtspecs/issues/2052</a></div><details><summary>fn:collation-available: $usage</summary><div class="markup"><p>The function <code>fn:collation-available</code> defines a <code>$usage</code> parameter, but few information is given on how to interpret the collation URI to return the correct result. In addition, there are no test cases.</p>
<p>Do we believe that the additional parameter offers enough advantages, or should we simplify the function?</p>
</div></details></div>
<div class="toot" id="created-2051"><h2>Issue #2051 created<span class="toot-id"> #created-2051</span></h2><div class="pubdate">14 Jun at 01:37:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2051">https://github.com/qt4cg/qtspecs/issues/2051</a></div><details><summary>XSLT group by cluster</summary><div class="markup"><p>I propose an enhancement of <code>xsl:for-each-group</code> to support clustering.</p>
<p>To start off with a simple use case, suppose one has the following population, <code>&lt;xsl:variable name="ages" as="xs:integer*" select="5, 24, 9, 5, 6, 8, 36, 38, 28"/&gt;</code> and one wishes to cluster the figures like so, in four groups: <code>(5, 5, 6, 8, 9)</code>, <code>(24)</code>, <code>(28)</code>, <code>(36, 38)</code>.</p>
<p>One is tempted to create an <code>&lt;xsl:for-each-group&gt;</code> with <code>group-by="((. - 1) to (. + 1))"</code>. But this does not work. If <code>@composite</code> is absent or is <code>no</code>, eighteen groups are created. If <code>@composite</code> is <code>yes</code>, eight groups are created. In both cases, the results are not significantly close to the desired output.</p>
<p>I propose a new <code>@group-by-cluster</code>. The following code</p>
<pre><code>&lt;xsl:for-each-group select="$ages" group-by-cluster="((. - 1) to (. + 1))"&gt;
    &lt;xsl:sort select="current-grouping-key()"/&gt;
    &lt;group key="{current-grouping-key()}" count="{count(current-group())}"&gt;
        &lt;xsl:copy-of select="current-group()"/&gt;
    &lt;/group&gt;
&lt;/xsl:for-each-group&gt; 
</code></pre>
<p>would produce this</p>
<pre><code>   &lt;group key="4 5 6 7 8 9 10" count="2"&gt;5 5 6 8 9&lt;/group&gt;
   &lt;group key="23 24 25" count="1"&gt;24&lt;/group&gt;
   &lt;group key="27 28 29" count="1"&gt;28&lt;/group&gt;
   &lt;group key="35 36 37 38 39" count="1"&gt;36 38&lt;/group&gt;
</code></pre>
<p>There are numerous use cases for the proposed new feature. Here are a few:</p>
<ul>
<li>Clustering map or spatial coordinates</li>
<li>Grouping disparate rectangles from OCR output</li>
<li>Reconciling triples in linked open data (RDF) that use different IRIs synonymously</li>
<li>Detecting typologies within in large corpora of documents that have periodically repetitive formulaic paragraphs.</li>
<li>Discovering networks of connected things, e.g., networks of email correspondence or publication citations
&nbsp;
Currently, the clustering I describe above is feasible in XSLT, but it requires creative strategies, usually a combination of preprocessing and the creation of specialized helper functions to recursively iterate over multiple grouping keys to create group numbers. These are challenging to write and debug, and one loses identity in a preprocessed copy of the original.</li>
</ul>
<p>By putting clustering into a <code>@group-by-cluster</code> construct, users benefit not only from convenience but also from performance, as a processor might bring novel strategies for clustering.</p>
<p>The <code>current-grouping-key()</code> for a group would consist of a sequence of all members' grouping keys, duplicates removed. No two groups would have any overlap in their grouping key sequences. (That's the definition of a cluster.)</p>
<p><code>@group-by-cluster</code> would have effect only if its value actually produced a sequence of length greater than one, and if <code>@composite</code> is no. (Should a user should be warned if <code>@composite</code> is yes?)</p>
</div></details></div>
<div class="toot" id="created-2050"><h2>Pull request #2050 created<span class="toot-id"> #created-2050</span></h2><div class="pubdate">13 Jun at 22:51:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2050">https://github.com/qt4cg/qtspecs/pull/2050</a></div><details><summary>2040 Fix context value declaration issues</summary><div class="markup"><p>Fix #2040</p>
</div></details></div>
<div class="toot" id="created-2049"><h2>Pull request #2049 created<span class="toot-id"> #created-2049</span></h2><div class="pubdate">13 Jun at 16:45:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2049">https://github.com/qt4cg/qtspecs/pull/2049</a></div><details><summary>2045 Context value can be an empty sequence</summary><div class="markup"><p>For functions like name(), local-name() etc with <code>as="node()? default="."</code> in the signature, allow the context value to be an empty sequence.</p>
<p>Fix #2045</p>
</div></details></div>
<div class="toot" id="created-2048"><h2>Issue #2048 created<span class="toot-id"> #created-2048</span></h2><div class="pubdate">13 Jun at 16:12:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2048">https://github.com/qt4cg/qtspecs/issues/2048</a></div><details><summary>Untrusted execution, and security more generally</summary><div class="markup"><p>Discussion of untrusted execution (that is, a Processor executing code from an untrusted source), and security in general, is present in the spec, but spread out and not really connected.</p>
<p>Untrusted execution seems to me to be one of the biggest security issues for XSLT/XQuery and XPath in general, and I think it’s important to make the distinction between untrusted execution where an untrusted stylesheet or query is executed (perhaps via Saxon’s <code>XsltCompiler.compile()</code>), and when a trusted stylesheet or query causes untrusted code to be executed, as with <code>fn:parse-xml()</code>, <code>fn:doc()</code>, <code>fn:transform()</code> and <code>&lt;xsl:evaluate&gt;</code>.</p>
<p>The proposals in #2034 address one case, but have no effect on the other, and that raises the question of what would happen if an untrusted (unsafe) stylesheet executed <code>fn:doc()</code> with <code>safe = true</code>.</p>
<p>I would like to see the specs address the security implications of untrusted execution more explicitly, and to provide clearer guidance for implementation authors around both completely untrusted code, and trusted code which executes untrusted code.</p>
<p>I think that could take the form of:</p>
<ul>
<li>Annotation of all functions that have potentially problematic external effects (primarily file / resource access).</li>
<li>Clear expectations for implementors about what (and how) security restrictions should be configurable.</li>
<li>Consistent Error codes for security-related exceptions</li>
<li>Consistent security-related options for functions which can cause untrusted source parsing or code execution.</li>
<li>A additional security section in the spec under section 2 (Concepts / Basics) in the XSLT/XQuery/XPath specs, and section 1 of XPFO, which collects the overview and points to what to look for in the rest of the spec.</li>
</ul>
</div></details></div>
<div class="toot" id="created-2047"><h2>Issue #2047 created<span class="toot-id"> #created-2047</span></h2><div class="pubdate">13 Jun at 16:11:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2047">https://github.com/qt4cg/qtspecs/issues/2047</a></div><details><summary>external resource-accessing functions, available resources, and error codes</summary><div class="markup"><p>While looking at a problem in an implementation of a vendor function that read data from an external resource I was looking through the spec to see what was said about external resources and untrusted execution contexts (for example a processor executing XSLT or XPath provided by a user).</p>
<p>The spec makes mention of ‘available documents’, ‘available text resources’, ‘available binary resources’, ‘available collections’, and ‘available URI collections’.</p>
<p>The documentation for <code>fn:doc()</code>, <code>fn:collection()</code>, and <code>fn:uri-collection()</code> mention an error (<code>err:FODC0002</code>) to be raised if the URI requested is not in the relevant ‘available X’  (although there is some disagreement about what the ‘X’ should be - we have ‘available node collections’ and ‘available resource collections’ mentioned in the function docs). <code>fn:unparsed-text()</code> and <code>fn:unparsed-binary()</code> do not.</p>
<p>I think the documented behaviour of <code>fn:unparsed-text()</code> and <code>fn:unparsed-binary()</code> should be brought into line with the others.</p>
</div></details></div>
<div class="toot" id="created-2046"><h2>Issue #2046 created<span class="toot-id"> #created-2046</span></h2><div class="pubdate">13 Jun at 10:19:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2046">https://github.com/qt4cg/qtspecs/issues/2046</a></div><details><summary>Promote ".." to a primary expression</summary><div class="markup"><p>I propose promoting ".." to be a primary expression (rather than an abbreviated step), and (assuming the JNodes proposal is accepted) allowing it to work on JNodes as well as XNodes.</p>
<p>Ignoring JNodes for now, I don't think the change would make any observable difference to the language syntax or semantics. It changes the way that a predicate is interpreted : <code>..[P]</code> becomes a regular filter expression and is no longer subject to the special rules for predicates within steps; but the only difference is how position() is interpreted, and since <code>..</code> can only return a singleton, this makes no difference.</p>
<p>For JNodes it means we will be able to write expressions such as <code>$my-map??x[..?y = 3]</code> rather than <code>$my-map??x[?parent::*?y = 3]</code></p>
</div></details></div>
<div class="toot" id="created-2045"><h2>Issue #2045 created<span class="toot-id"> #created-2045</span></h2><div class="pubdate">12 Jun at 22:20:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2045">https://github.com/qt4cg/qtspecs/issues/2045</a></div><details><summary>Functions taking "." as default argument, when "." is empty</summary><div class="markup"><p>A number of functions such as <code>fn:name()</code> take the context value as their default argument, with the implication that <code>name()</code> is exactly equivalent to <code>name(.)</code>.</p>
<p>However, these functions also say that a type error XPTY0004 is raised if the context value is not a single node.</p>
<p>It seems to me that if the context value is an empty sequence, no type error should be raised; the effect of <code>() -&gt; name()</code> should be the same as <code>name(())</code>.</p>
</div></details></div>
<div class="toot" id="created-2044"><h2>Pull request #2044 created<span class="toot-id"> #created-2044</span></h2><div class="pubdate">10 Jun at 19:42:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2044">https://github.com/qt4cg/qtspecs/pull/2044</a></div><details><summary>Hide `MarkedNCName` from XPath spec</summary><div class="markup"><p>Today's merge of qt4cg/qtspecs#2028 has added the <code>MarkedNCName</code> production to both the XQuery and the XPath spec. It is however only used within the XQuery spec.</p>
</div></details></div>
<div class="toot" id="minutes—06-10"><h2>QT4 CG meeting 124 draft minutes<span class="toot-id"> #minutes—06-10</span></h2><div class="pubdate">10 Jun at 16:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/06-10">https://qt4cg.org/meeting/minutes/2025/06-10</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2027"><h2>Issue #2027 closed<span class="toot-id"> #closed-2027</span></h2><div class="pubdate">10 Jun at 16:09:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2027">https://github.com/qt4cg/qtspecs/issues/2027</a></div><p>QNameLiteral syntax for namespace and Processing Instruction constructors</p></div>
<div class="toot" id="closed-2028"><h2>Issue #2028 closed<span class="toot-id"> #closed-2028</span></h2><div class="pubdate">10 Jun at 16:09:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2028">https://github.com/qt4cg/qtspecs/pull/2028</a></div><p>2027 '#' syntax for computed PIs and namespaces</p></div>
<div class="toot" id="closed-2032"><h2>Issue #2032 closed<span class="toot-id"> #closed-2032</span></h2><div class="pubdate">10 Jun at 16:01:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2032">https://github.com/qt4cg/qtspecs/issues/2032</a></div><p>Simple typo in XPath 4.0 example - inherited from XPath 3.0 spec</p></div>
<div class="toot" id="closed-2033"><h2>Issue #2033 closed<span class="toot-id"> #closed-2033</span></h2><div class="pubdate">10 Jun at 16:01:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2033">https://github.com/qt4cg/qtspecs/pull/2033</a></div><p>2032 Fix typo in example</p></div>
<div class="toot" id="closed-2022"><h2>Issue #2022 closed<span class="toot-id"> #closed-2022</span></h2><div class="pubdate">10 Jun at 15:57:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2022">https://github.com/qt4cg/qtspecs/issues/2022</a></div><p>Simplify optional XQuery conformance features</p></div>
<div class="toot" id="closed-2026"><h2>Issue #2026 closed<span class="toot-id"> #closed-2026</span></h2><div class="pubdate">10 Jun at 15:57:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2026">https://github.com/qt4cg/qtspecs/pull/2026</a></div><p>2022 Drop module feature</p></div>
<div class="toot" id="created-2043"><h2>Pull request #2043 created<span class="toot-id"> #created-2043</span></h2><div class="pubdate">09 Jun at 17:10:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2043">https://github.com/qt4cg/qtspecs/pull/2043</a></div><details><summary>2038 Tweak the rules for fn:apply-templates references to modes</summary><div class="markup"><p>Fix #2038</p>
</div></details></div>
<div class="toot" id="created-2042"><h2>Pull request #2042 created<span class="toot-id"> #created-2042</span></h2><div class="pubdate">09 Jun at 16:34:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2042">https://github.com/qt4cg/qtspecs/pull/2042</a></div><details><summary>2041 Correction to xsl:namespace-alias example</summary><div class="markup"><p>Fix #2041</p>
</div></details></div>
<div class="toot" id="created-2041"><h2>Issue #2041 created<span class="toot-id"> #created-2041</span></h2><div class="pubdate">09 Jun at 16:30:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2041">https://github.com/qt4cg/qtspecs/issues/2041</a></div><details><summary>Incorrect example of xsl:namespace-alias</summary><div class="markup"><p>Reported against XSLT 3.0</p>
<p>https://github.com/w3c/qtspecs/issues/71</p>
</div></details></div>
<div class="toot" id="agenda-06-10"><h2>QT4 CG meeting 124 draft agenda<span class="toot-id"> #agenda-06-10</span></h2><div class="pubdate">09 Jun at 07:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/06-10">https://qt4cg.org/meeting/agenda/2025/06-10</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2040"><h2>Issue #2040 created<span class="toot-id"> #created-2040</span></h2><div class="pubdate">08 Jun at 19:56:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2040">https://github.com/qt4cg/qtspecs/issues/2040</a></div><details><summary>XQuery context value declaration</summary><div class="markup"><p>Section 5.17:</p>
<ul>
<li>
<p>there is no changes entry flagging the fact that the coercion rules are now applied (and corresponding test cases such as contextDecl-037a do not identity a PR). The relevant PR is PR #254 .</p>
</li>
<li>
<p>The statement "<em>The context value declaration has the effect of setting the context value static type T in the static context.</em>" is incorrect. The static context no longer includes a context value static type.</p>
</li>
<li>
<p>The statement "<em>In all cases where the context value has a value, that value must match the type T according to the rules for SequenceType matching</em>" is incorrect (or at least, misleading): as stated two paragraphs later, coercion is applied. But because there can be multiple context value declarations in different modules, specifying different types, perhaps the intent is that coercion is applied only to a value supplied in the query, and not to a value supplied externally? If so, this needs clarifying. There are apparently no tests for coercing an externally-supplied value to the required type.</p>
</li>
</ul>
</div></details></div>
<div class="toot" id="created-2039"><h2>Issue #2039 created<span class="toot-id"> #created-2039</span></h2><div class="pubdate">07 Jun at 21:37:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2039">https://github.com/qt4cg/qtspecs/issues/2039</a></div><details><summary>Generalize context item to context value in XSLT</summary><div class="markup"><p>Various places, for example the xsl:context-item declaration and the xsl:evaluate/@context-item attribute, should be updated to allow the there being a context value rather than a context item.</p>
<p>At present the context value at instruction level is always either a singleton or absent. We should consider generalizing this to align with XPath, where the <code>-&gt;</code> and <code>?[....]</code> operators allow the context value to be an arbitrary sequence.</p>
<p>An xsl:for-each-member instruction that iterates over an array and binds each member to the context value would make sense.</p>
</div></details></div>
<div class="toot" id="created-2038"><h2>Issue #2038 created<span class="toot-id"> #created-2038</span></h2><div class="pubdate">05 Jun at 14:04:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2038">https://github.com/qt4cg/qtspecs/issues/2038</a></div><details><summary>Drop dependency of fn:apply-templates on the default mode</summary><div class="markup"><p>The new <code>fn:apply-templates</code> function in XSLT can invoke the "default mode", either by specifying <code>mode="#default"</code> or by not specifying a mode. The default mode is defined by the nearest containing instruction that has a <code>[xsl:]default-mode</code> attribute.</p>
<p>I would like to drop this dependency.</p>
<p>Most of the cases where a function call depends on the static context (especially an XSLT function) are cases where the relevant property is fixed for a package (e.g. the set of named keys, decimal formats, or character maps). There are places where there is a dependency on something tha can vary in a more fine-grained way - notably (a) the default collation, and (b) the set of namespace bindings, but on the whole such dependencies are undesirable (a) because they introduce opportunities for user error (e.g. when copying and pasting code) and (b) because they increase the amount of information the processor has to keep around at runtime just in case it is needed (for example, in a dynamic function call). I would therefore like to avoid introducing this dependency.</p>
<p>The proposed change is (a) to drop "#default" as a value of the <code>mode</code> option for this function, and (b) to say that if no mode is specified by <code>fn:apply-templates</code> the unnamed mode is used.</p>
</div></details></div>
<div class="toot" id="created-2037"><h2>Pull request #2037 created<span class="toot-id"> #created-2037</span></h2><div class="pubdate">03 Jun at 14:45:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2037">https://github.com/qt4cg/qtspecs/pull/2037</a></div><details><summary>2036 Add rule for streamability of xsl:map</summary><div class="markup"><p>Fix #2036</p>
</div></details></div>
<div class="toot" id="created-2036"><h2>Issue #2036 created<span class="toot-id"> #created-2036</span></h2><div class="pubdate">03 Jun at 14:34:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2036">https://github.com/qt4cg/qtspecs/issues/2036</a></div><details><summary>Streamability of xsl:map instruction</summary><div class="markup"><p>The special condition that allows more than one operand of xsl:map to be consuming should apply only if the <code>duplicates</code> attribute is absent (defaulting to "error"). If duplicates are allowed then in general the result cannot be streamed.</p>
</div></details></div>
<div class="toot" id="closed-1955"><h2>Issue #1955 closed<span class="toot-id"> #closed-1955</span></h2><div class="pubdate">02 Jun at 21:23:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1955">https://github.com/qt4cg/qtspecs/issues/1955</a></div><p>fn:doc, fn:parse-xml: entity expansion</p></div>
<div class="toot" id="created-2035"><h2>Issue #2035 created<span class="toot-id"> #created-2035</span></h2><div class="pubdate">02 Jun at 17:00:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2035">https://github.com/qt4cg/qtspecs/issues/2035</a></div><details><summary>Recursive record types: unrealistic example in XPath spec</summary><div class="markup"><p>The example of mutually-recursive record types in XPath §3.2.8.3.1 (using the schema component model as an example) is unrealistic, because an instance of this structure would be cyclic at the instance level, and therefore would be non-instantiable. In practice, the only way to represent cyclic structures using maps and arrays is by use of functions to represent some of the relationships, as we do in the schema record type returned by functions such as fn:schema-type(). We should change the example to use this technique and explain why it is being used: it would still illustrate the point; although it would be in danger of becoming excessively complicated.</p>
</div></details></div>
<div class="toot" id="created-2034"><h2>Issue #2034 created<span class="toot-id"> #created-2034</span></h2><div class="pubdate">01 Jun at 18:33:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2034">https://github.com/qt4cg/qtspecs/issues/2034</a></div><details><summary>fn:parse-xml, fn:doc: `safe` option</summary><div class="markup"><p>This issue replaces #1955.</p>
<p>The first feedback that we got for the <code>entity-expansion-limit</code> option indicates that our current solution is neither fish nor fowl (weder Fisch noch Fleisch?):</p>
<ol>
<li>
<p>With the initial suggestion in #1860, I hoped we could define sane defaults to prevent attacks caused by <code>fn:parse-xml</code> and <code>fn:doc</code>. This turned out to be difficult. Instead, we now have two specific options (allow-external-entities, entity-expansion-limit) that need to be explicitly assigned to make parsing safer.</p>
</li>
<li>
<p>In order to parse certain XML documents, like <a href="https://dblp.org/xml/dblp.xml.gz"><code>dblp..xml.gz</code></a>, more than one JDK 11 limit needs to be increased:</p>
</li>
</ol>
<pre><code>http://www.oracle.com/xml/jaxp/properties/entityExpansionLimit
http://www.oracle.com/xml/jaxp/properties/maxGeneralEntitySizeLimit
http://www.oracle.com/xml/jaxp/properties/totalEntitySizeLimit
</code></pre>
<p>As we have observed, XML parsing depends on the specific XML parsers. I believe it would be more user-friendly to replace the specific settings with a single option <code>safe</code>, and to let the processor decide which properties are assigned:</p>
<ol>
<li><code>true</code> (default): Avoid XXE and billion laughs attacks</li>
<li><code>false</code>: disable safe parsing (increase limits, allow parsing of external resources)</li>
</ol>
</div></details></div>
<div class="toot" id="created-2033"><h2>Pull request #2033 created<span class="toot-id"> #created-2033</span></h2><div class="pubdate">29 May at 13:41:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2033">https://github.com/qt4cg/qtspecs/pull/2033</a></div><details><summary>2032 Fix typo in example</summary><div class="markup"><p>Fix #2032</p>
</div></details></div>
<div class="toot" id="created-2032"><h2>Issue #2032 created<span class="toot-id"> #created-2032</span></h2><div class="pubdate">29 May at 05:43:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2032">https://github.com/qt4cg/qtspecs/issues/2032</a></div><details><summary>Simple typo in XPath 4.0 example - inherited from XPath 3.0 spec</summary><div class="markup"><p>Location of typo: <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.xml#id-array-test">Array Types</a> section.</p>
<p>Current text:</p>
<p><code>[ 1, 2 ] instance array(*) returns true()</code></p>
<p>Expected text:</p>
<p><code>[ 1, 2 ] instance of array(*) returns true()</code></p>
</div></details></div>
<div class="toot" id="created-2031"><h2>Pull request #2031 created<span class="toot-id"> #created-2031</span></h2><div class="pubdate">28 May at 17:55:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2031">https://github.com/qt4cg/qtspecs/pull/2031</a></div><details><summary>2025 JNodes</summary><div class="markup"><p>Fix #2025</p>
<p>This is a first draft for review.</p>
<p>It includes changes to the data model, functions and operators, and XQuery/XPath. It does not yet include changes to XSLT.</p>
<p>It's a big proposal, but I think it removes more complexity from the spec than it adds. It's basically a unification of two concepts, both of which were addressing aspects of the same problem, namely that lookup expressions lose too much information. It gets rid of the pin/label mechanism, and modifiers on lookup expressions, and introduces JNodes and JAxes in their place. (Any suggestions for improved terminology are more than welcome.)</p>
<p>I think we get a lot more "bangs for the buck" with this solution, and it makes navigation of JSON trees work in a much closer way to familiar navigation of XML trees. It needs a lot more work on examples and explanation, of course.</p>
</div></details></div>
<div class="toot" id="closed-1859"><h2>Issue #1859 closed<span class="toot-id"> #closed-1859</span></h2><div class="pubdate">28 May at 10:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1859">https://github.com/qt4cg/qtspecs/issues/1859</a></div><p>Question on `fn:chain` and `err:FOAP0001`</p></div>
<div class="toot" id="closed-1894"><h2>Issue #1894 closed<span class="toot-id"> #closed-1894</span></h2><div class="pubdate">28 May at 09:46:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1894">https://github.com/qt4cg/qtspecs/pull/1894</a></div><p>Additional examples to fn:chain - in a new branch</p></div>
<div class="toot" id="closed-1883"><h2>Issue #1883 closed<span class="toot-id"> #closed-1883</span></h2><div class="pubdate">28 May at 09:45:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1883">https://github.com/qt4cg/qtspecs/pull/1883</a></div><p>882 Replace fn:chain by fn:compose</p></div>
<div class="toot" id="created-2030"><h2>Pull request #2030 created<span class="toot-id"> #created-2030</span></h2><div class="pubdate">28 May at 09:14:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2030">https://github.com/qt4cg/qtspecs/pull/2030</a></div><details><summary>2029 xsd validator notes and examples</summary><div class="markup"><p>Adds more explanation to xsd:validator</p>
<p>Extracts material from the XQuery and XSLT specs describing the validation process, moving this to a new section in F&amp;O, to reduce duplication.</p>
<p>Fix #2029</p>
</div></details></div>
<div class="toot" id="closed-1959"><h2>Issue #1959 closed<span class="toot-id"> #closed-1959</span></h2><div class="pubdate">27 May at 16:14:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1959">https://github.com/qt4cg/qtspecs/pull/1959</a></div><p>1953 (part) XSLT Worked example using methods to implement atomic sets</p></div>
<div class="toot" id="closed-882"><h2>Issue #882 closed<span class="toot-id"> #closed-882</span></h2><div class="pubdate">27 May at 16:11:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/882">https://github.com/qt4cg/qtspecs/issues/882</a></div><p>fn:chain or fn:compose</p></div>
<div class="toot" id="closed-1984"><h2>Issue #1984 closed<span class="toot-id"> #closed-1984</span></h2><div class="pubdate">27 May at 16:11:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1984">https://github.com/qt4cg/qtspecs/pull/1984</a></div><p>882 Drop fn:chain</p></div>
<div class="toot" id="closed-2023"><h2>Issue #2023 closed<span class="toot-id"> #closed-2023</span></h2><div class="pubdate">27 May at 16:06:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2023">https://github.com/qt4cg/qtspecs/issues/2023</a></div><p>Semantics of X?$a</p></div>
<div class="toot" id="closed-2024"><h2>Issue #2024 closed<span class="toot-id"> #closed-2024</span></h2><div class="pubdate">27 May at 16:06:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2024">https://github.com/qt4cg/qtspecs/pull/2024</a></div><p>Add rules for $V?$X</p></div>
<div class="toot" id="created-2029"><h2>Issue #2029 created<span class="toot-id"> #created-2029</span></h2><div class="pubdate">27 May at 09:26:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2029">https://github.com/qt4cg/qtspecs/issues/2029</a></div><details><summary>fn:xsd-validator - more explanation needed</summary><div class="markup"><p>See action QT4CG-119-02</p>
<p>In the review when the function was accepted, I was asked to supply more notes and examples indicating how the various options for assembling a schema interacted with each other.</p>
</div></details></div>
<div class="toot" id="created-2028"><h2>Pull request #2028 created<span class="toot-id"> #created-2028</span></h2><div class="pubdate">27 May at 09:19:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2028">https://github.com/qt4cg/qtspecs/pull/2028</a></div><details><summary>2027 '#' syntax for computed PIs and namespaces</summary><div class="markup"><p>Fix #2027</p>
</div></details></div>
<div class="toot" id="created-2027"><h2>Issue #2027 created<span class="toot-id"> #created-2027</span></h2><div class="pubdate">27 May at 08:05:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2027">https://github.com/qt4cg/qtspecs/issues/2027</a></div><details><summary>QNameLiteral syntax for namespace and Processing Instruction constructors</summary><div class="markup"><p>Action QT4CG-021-01 (should be QT4CG-121-01)</p>
<p>We now allow QNameLiterals to be used in element and attribute constructors, for example <code>attribute #xml:space {"default"}</code>.</p>
<p>For symmetry we need a similar syntax for namespace and processing-instruction constructors. These have the same ambiguity problem if the node name clashes with a reserved word such as "div", but they are constrained to be NCNames (or no-namespace QNames, depending on your perspective).</p>
<p>One possible solution is to use a new construct such as NCNameLiteral (but the name is wrong, unless we also allow it to be used in contexts where a Literal is allowed). Another possibility is for the grammar to allow a QNameLiteral, but for the semantics to restrict it to be in no namespace.</p>
</div></details></div>
<div class="toot" id="created-2026"><h2>Pull request #2026 created<span class="toot-id"> #created-2026</span></h2><div class="pubdate">26 May at 23:32:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2026">https://github.com/qt4cg/qtspecs/pull/2026</a></div><details><summary>2022 Drop module feature</summary><div class="markup"><p>Fix #2022</p>
<p>The effect is that support for library modules is no longer optional.</p>
<p>I decided not to pursue merging the "schema import" and "typed data" features into one.</p>
</div></details></div>
<div class="toot" id="agenda-05-27"><h2>QT4 CG meeting 123 draft agenda<span class="toot-id"> #agenda-05-27</span></h2><div class="pubdate">25 May at 09:16:15 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/05-27">https://qt4cg.org/meeting/agenda/2025/05-27</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-2025"><h2>Issue #2025 created<span class="toot-id"> #created-2025</span></h2><div class="pubdate">25 May at 07:36:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2025">https://github.com/qt4cg/qtspecs/issues/2025</a></div><details><summary>Combine the concepts of pins/labels and modified lookups</summary><div class="markup"><p>We have two rather separate mechanisms, both designed to solve aspects of what is essentially the same problem: lookup expressions lose too much information.</p>
<p>Pinning tries to solve the problem by saying that if the origin of the lookup is pinned, then the results of the lookup carry a label containing information about the key and the parent.</p>
<p>Modifiers like pair::* try to solve the problem by returning a map containing the key and the value as separate fields.</p>
<p>But pinning only solves part of the problem, in particular it doesn't prevent X?* flattening the result, and the <code>pairs</code> modifier only solves part of the problem, in particular it doesn't retain parentage.</p>
<p>I would like to try combining them and trying to create a mechanism that is better than either. I don't yet know exactly how this might work, but I'm thinking along the lines:</p>
<ul>
<li>Replace the concept of labelled items with labelled values (that is, a label can be attached to any value, not just an item)</li>
<li>Scrap pin() as an explicit function</li>
<li>A lookup expression like $X ? child::Y returns a sequence of labelled values (no flattening)</li>
<li>The properties of a labelled value include:
** target - the actual value
** key - the associated key (or array index)
** parent - the containing map or array</li>
<li>These properties might be made available through syntax such as <code>$LV ? target::*</code> , <code>$LV ? key::*</code>, <code>$LV ? parent::*</code> (or otherwise)</li>
<li>ancestor and ancestor-or-self can be made available as derived properties</li>
<li>Many operations when given a labelled value should automatically operate on its target, and ignore the label (rather like atomisation). Exactly which operations do this is an interesting question to which I don't yet know the answer. It's tricky because child::* returns a sequence of labelled values, and we want to be able to manipulate this in unflattened form. Perhaps child::* should instead return an array of labelled values? But then you end up with another lookup operation to extract the members of this array.</li>
</ul>
</div></details></div>
<div class="toot" id="created-2024"><h2>Pull request #2024 created<span class="toot-id"> #created-2024</span></h2><div class="pubdate">23 May at 22:50:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2024">https://github.com/qt4cg/qtspecs/pull/2024</a></div><details><summary>Add rules for $V?$X</summary><div class="markup"><p>Fix #2023</p>
</div></details></div>
<div class="toot" id="created-2023"><h2>Issue #2023 created<span class="toot-id"> #created-2023</span></h2><div class="pubdate">23 May at 08:56:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2023">https://github.com/qt4cg/qtspecs/issues/2023</a></div><details><summary>Semantics of X?$a</summary><div class="markup"><p>In §4.14.3.1 we describe the semantics of lookup expressions. Rules 3a to 3e and 4a to 4e all start "if the KeySpecifier KS is..." and should enumerate all the possibilities for a KeySpecifier. But the case where the KeySpecifier is a VarRef is not mentioned.</p>
<p>Of course, <code>X?$a</code> is supposed to be a shorthand for <code>X?($a)</code>, we just fail to state the fact.</p>
</div></details></div>
<div class="toot" id="created-2022"><h2>Issue #2022 created<span class="toot-id"> #created-2022</span></h2><div class="pubdate">22 May at 23:21:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2022">https://github.com/qt4cg/qtspecs/issues/2022</a></div><details><summary>Simplify optional XQuery conformance features</summary><div class="markup"><p>In XQuery I propose:</p>
<ul>
<li>Dropping the "module feature" - every conformant XQ40 implementation must support library modules</li>
<li>Merging the "schema-aware" and "typed-data" features into a single optional feature, aligned with schema-awareness in XSLT</li>
</ul>
</div></details></div>
<div class="toot" id="created-2021"><h2>Issue #2021 created<span class="toot-id"> #created-2021</span></h2><div class="pubdate">22 May at 15:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2021">https://github.com/qt4cg/qtspecs/issues/2021</a></div><details><summary>XSLT: Move "Patterns" section into "Template Rules"</summary><div class="markup"><p>I propose to move XSLT section §5.4 Patterns so it becomes §6.1, under Template Rules, where it will hopefully be easier to find.</p>
<p>Because this will produce a large number of diffs, I propose to make it a separate PR rather than combining it with the work I am currently doing on patterns and template rules for maps and arrays.</p>
</div></details></div>
<div class="toot" id="closed-2020"><h2>Issue #2020 closed<span class="toot-id"> #closed-2020</span></h2><div class="pubdate">22 May at 12:05:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2020">https://github.com/qt4cg/qtspecs/issues/2020</a></div><p>Reconsider the rationale for the xsl:select instruction</p></div>
<div class="toot" id="created-2020"><h2>Issue #2020 created<span class="toot-id"> #created-2020</span></h2><div class="pubdate">22 May at 06:29:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2020">https://github.com/qt4cg/qtspecs/issues/2020</a></div><details><summary>Reconsider the rationale for the xsl:select instruction</summary><div class="markup"><p>The <a href="https://qt4cg.org/specifications/xslt-40/Overview.html#element-select">section for xsl:select</a> in the XSLT specification includes the following rationale:</p>
<blockquote>
<p>An XPath expression written within an XML attribute is subjected by the XML parser to attribute value normalization, which changes the arrangement of whitespace within the value. While this will rarely affect the actual meaning of the expression, it can mean that formatting is lost. <strong>Multi-line attribute values are therefore best avoided.</strong> The loss of formatting also makes it difficult for an XSLT processor to provide precise error locations.</p>
</blockquote>
<p>There are good reasons why <code>xsl:select</code> would be a useful instruction, but I don't think providing precise error locations is one of them. This is just circumventing a problem that is solvable today for <code>select</code> attributes. If an implementer wanted to supply a more precise error location in attribute values (and this would certainly help developers) they could adopt a solution similar to the <a href="https://tc39.es/ecma426/#sec-intro">Ecma SourceMap</a> used by EcmaScript transpilers and minifiers.</p>
<p>In XSLT 3.0, we frequently work with multi-line <code>select</code> attribute values on XSLT instructions without major issues. Examples include: when calling using  <code>fold-left()</code> functions with one or more inner functions or using multi-case if/else expressions. Using <code>xsl:select</code> just to get good error messages does not seem like a good trade-off for the added verbosity.</p>
<p>For these cases, one can either use a simple XPath linter in the XSLT editor to highlight the specific error tokens caused by basic typos and unresolved references, and then fall back on using the compiler error messages with approximate line-numbers for (the many) cases that the linter cannot pick up.</p>
<h2>Precise XSLT Error Locations and AI Agents</h2>
<p>Modern XSLT editors are today fully integrated with AI Agents (e.g. GitHub Copilot or AI Positron). These agents use reported error-locations to explain and suggest a fix for the XSLT problem for the user. Precise error locations are critical to the quality of the explanation and the fix. This help should be available equally for XSLT <code>select</code> attributes or <code>xsl:select</code> instructions.</p>
</div></details></div>
<div class="toot" id="created-2019"><h2>Pull request #2019 created<span class="toot-id"> #created-2019</span></h2><div class="pubdate">21 May at 22:59:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2019">https://github.com/qt4cg/qtspecs/pull/2019</a></div><details><summary>1776: XSLT template rules for maps and array</summary><div class="markup"><p>Currently work In progress, committed so that the draft can be reviewed.</p>
<p>Changes in three main areas:</p>
<ul>
<li>Pattern syntax: patterns such as <code>?item</code> and <code>?parent?item</code> are defined to match items in a map by their key</li>
<li>Built-in template rules for on-no-match="shallow-copy-all". Revisits the built in template rules for this scenario.</li>
<li>General revision of the processing model for xsl:apply-templates applied to a tree of maps and arrays.</li>
</ul>
</div></details></div>
<div class="toot" id="created-2018"><h2>Issue #2018 created<span class="toot-id"> #created-2018</span></h2><div class="pubdate">21 May at 19:44:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2018">https://github.com/qt4cg/qtspecs/issues/2018</a></div><details><summary>Type-checking the result of xsl:apply-templates</summary><div class="markup"><p>Code that calls <code>xsl:apply-templates</code> inevitably has expectations about the type of the result. For example someone doing</p>
<p><code>&lt;xsl:apply-templates select="@*"/&gt;</code></p>
<p>may have an expectation that the result will be a sequence of attribute nodes, and the code might fail untidily if it is anything else. There is currently no way of stating this expectation, or of triggering coercion on the result. We have added an attribute <code>xsl:mode/@as</code> but different calls on apply-templates in the same mode may have different expectations. (I'm seeing this particularly with modes that process maps and arrays)</p>
<p>We could add an <code>as</code> attribute to xsl:apply-templates to make the expectation explicit.</p>
</div></details></div>
<div class="toot" id="created-2017"><h2>Issue #2017 created<span class="toot-id"> #created-2017</span></h2><div class="pubdate">21 May at 13:31:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2017">https://github.com/qt4cg/qtspecs/issues/2017</a></div><details><summary>`fn:sort-by`: Observations</summary><div class="markup"><p>We should make the second parameter obligatory (<code>fn:sort-by(1 to 3)</code> seems confusing).</p>
<p><code>sort(keys := fn { ?key })</code> occurs twice in the remaining text; should be <code>sort(key := fn { ?key })</code>.</p>
</div></details></div>
<div class="toot" id="closed-1795"><h2>Issue #1795 closed<span class="toot-id"> #closed-1795</span></h2><div class="pubdate">21 May at 09:19:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1795">https://github.com/qt4cg/qtspecs/issues/1795</a></div><p>XSLT templates: Matching values in a map by key</p></div>
<div class="toot" id="closed-1981"><h2>Issue #1981 closed<span class="toot-id"> #closed-1981</span></h2><div class="pubdate">21 May at 08:44:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1981">https://github.com/qt4cg/qtspecs/issues/1981</a></div><p>Syntax for QName literals clashes with XQuery pragmas</p></div>
<div class="toot" id="created-2016"><h2>Issue #2016 created<span class="toot-id"> #created-2016</span></h2><div class="pubdate">21 May at 06:42:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2016">https://github.com/qt4cg/qtspecs/issues/2016</a></div><details><summary>File Module: Incorporate changes</summary><div class="markup"><p>The EXPath File Module must be revised in several steps. First of all, several functions need to be incorporated that were added to the initial version (details: https://docs.basex.org/12/File_Functions).</p>
</div></details></div>
<div class="toot" id="created-2015"><h2>Pull request #2015 created<span class="toot-id"> #created-2015</span></h2><div class="pubdate">21 May at 00:09:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2015">https://github.com/qt4cg/qtspecs/pull/2015</a></div><details><summary>2009 Avoid constructing document node when it makes no sense</summary><div class="markup"><p>Fix #2009</p>
<p>The rules for xsl:variable are changed so there is no attempt to construct an implicit temporary tree when the sequence constructor contains an <code>xsl:map</code>. <code>xsl:array</code>, or <code>xsl:select</code> instruction (perhaps mixed with other instructions).</p>
<p>Compatibility: note that <code>xsl:array</code> and <code>xsl:select</code> are new in 4.0, while xsl:map inside <code>xsl:variable</code> always throws an error in XSLT 3.0.</p>
<p>Justification:</p>
<ul>
<li>a child <code>xsl:select</code> element behaves like a <code>select</code> attribute</li>
<li>if the content of xsl:variable is <code>xsl:map</code> or <code>xsl:array</code> it makes no sense to require the user to add <code>as=map(*)</code> or <code>as=array(*)</code> because the type is obvious anyway.</li>
</ul>
</div></details></div>
<div class="toot" id="created-2014"><h2>Pull request #2014 created<span class="toot-id"> #created-2014</span></h2><div class="pubdate">20 May at 21:50:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2014">https://github.com/qt4cg/qtspecs/pull/2014</a></div><details><summary>QT4CG-122-01 Add notes, examples, and rationale for xsl:select</summary><div class="markup"><p>Completes action QT4CG-122-01</p>
</div></details></div>
<div class="toot" id="closed-2008"><h2>Issue #2008 closed<span class="toot-id"> #closed-2008</span></h2><div class="pubdate">20 May at 18:07:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2008">https://github.com/qt4cg/qtspecs/pull/2008</a></div><p>2004 Add xsl:select instruction</p></div>
<div class="toot" id="closed-2004"><h2>Issue #2004 closed<span class="toot-id"> #closed-2004</span></h2><div class="pubdate">20 May at 18:07:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2004">https://github.com/qt4cg/qtspecs/issues/2004</a></div><p>xsl:xpath instruction</p></div>
<div class="toot" id="minutes—05-20"><h2>QT4 CG meeting 122 draft minutes<span class="toot-id"> #minutes—05-20</span></h2><div class="pubdate">20 May at 16:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/05-20">https://qt4cg.org/meeting/minutes/2025/05-20</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-2006"><h2>Issue #2006 closed<span class="toot-id"> #closed-2006</span></h2><div class="pubdate">20 May at 16:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2006">https://github.com/qt4cg/qtspecs/pull/2006</a></div><p>2005 Add fn:apply-templates function</p></div>
<div class="toot" id="closed-2005"><h2>Issue #2005 closed<span class="toot-id"> #closed-2005</span></h2><div class="pubdate">20 May at 16:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2005">https://github.com/qt4cg/qtspecs/issues/2005</a></div><p>apply-templates() as a function</p></div>
<div class="toot" id="closed-1991"><h2>Issue #1991 closed<span class="toot-id"> #closed-1991</span></h2><div class="pubdate">20 May at 16:08:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1991">https://github.com/qt4cg/qtspecs/pull/1991</a></div><p>835 Add built-in named record types to static context</p></div>
<div class="toot" id="closed-1085"><h2>Issue #1085 closed<span class="toot-id"> #closed-1085</span></h2><div class="pubdate">20 May at 16:06:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1085">https://github.com/qt4cg/qtspecs/issues/1085</a></div><p>Parameters to fn:sort</p></div>
<div class="toot" id="closed-2001"><h2>Issue #2001 closed<span class="toot-id"> #closed-2001</span></h2><div class="pubdate">20 May at 16:06:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2001">https://github.com/qt4cg/qtspecs/pull/2001</a></div><p>1085 Revert fn:sort to the 3.1 spec; introduce fn:sort-by</p></div>
<div class="toot" id="closed-1992"><h2>Issue #1992 closed<span class="toot-id"> #closed-1992</span></h2><div class="pubdate">20 May at 16:04:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1992">https://github.com/qt4cg/qtspecs/issues/1992</a></div><p>Type of fn:schema-type-record ? constructor</p></div>
<div class="toot" id="closed-1999"><h2>Issue #1999 closed<span class="toot-id"> #closed-1999</span></h2><div class="pubdate">20 May at 16:04:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1999">https://github.com/qt4cg/qtspecs/pull/1999</a></div><p>1992 Correct type of constructor function in schema-type-record</p></div>
<div class="toot" id="closed-1997"><h2>Issue #1997 closed<span class="toot-id"> #closed-1997</span></h2><div class="pubdate">20 May at 16:02:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1997">https://github.com/qt4cg/qtspecs/issues/1997</a></div><p>Coercion Rules: §3.4.1 rule 3(c)</p></div>
<div class="toot" id="closed-1998"><h2>Issue #1998 closed<span class="toot-id"> #closed-1998</span></h2><div class="pubdate">20 May at 16:02:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1998">https://github.com/qt4cg/qtspecs/pull/1998</a></div><p>1997 Correct nesting of item coercion rules</p></div>
<div class="toot" id="created-2013"><h2>Pull request #2013 created<span class="toot-id"> #created-2013</span></h2><div class="pubdate">20 May at 09:15:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2013">https://github.com/qt4cg/qtspecs/pull/2013</a></div><details><summary>748 Parse functions: consistency</summary><div class="markup"><p>Closes #748</p>
</div></details></div>
<div class="toot" id="created-2012"><h2>Issue #2012 created<span class="toot-id"> #created-2012</span></h2><div class="pubdate">19 May at 08:14:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2012">https://github.com/qt4cg/qtspecs/issues/2012</a></div><details><summary>Add array:sort-with</summary><div class="markup"><p>Issue #655 PR #795 introduced fn:sort-with.</p>
<p>We should define array:sort-with for consistency.</p>
</div></details></div>
<div class="toot" id="created-2011"><h2>Pull request #2011 created<span class="toot-id"> #created-2011</span></h2><div class="pubdate">18 May at 10:33:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2011">https://github.com/qt4cg/qtspecs/pull/2011</a></div><details><summary>675(part): Add XSLT static typing rules for new kinds of XPath expression</summary><div class="markup"><p>Updates the static typing rules in XSLT for new kinds of expression introduced in XPath 4.0. These rules are used in streamability analysis, but more work needs to be done to complete the streamability analysis.</p>
<p>Production rules are now referenced by name, as production numbers are no longer available.</p>
</div></details></div>
<div class="toot" id="created-2010"><h2>Issue #2010 created<span class="toot-id"> #created-2010</span></h2><div class="pubdate">17 May at 15:33:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2010">https://github.com/qt4cg/qtspecs/issues/2010</a></div><details><summary>XSLT patterns: generalize union, intersect, and except</summary><div class="markup"><p>This is related to issue #402.</p>
<p>We have generalised the meaning of union, intersect, and except, when used in XSLT patterns, so that they now mean:</p>
<ul>
<li>A union B - matches either A or B</li>
<li>A intersect B - matches both A and B</li>
<li>A except B - matches A and does not match B</li>
</ul>
<p>With these semantics, there is no longer any sensible reason to restrict these pattern operators to apply only to node patterns. The semantics work equally well for patterns that match (for example) maps or arrays. For example</p>
<p><code>&lt;xsl:template match="record(a, b) except record(a, b, c)"&gt;</code></p>
</div></details></div>
<div class="toot" id="created-2009"><h2>Issue #2009 created<span class="toot-id"> #created-2009</span></h2><div class="pubdate">17 May at 08:16:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2009">https://github.com/qt4cg/qtspecs/issues/2009</a></div><details><summary>xsl:variable implicit document nodes</summary><div class="markup"><p>In XSLT 3.0, an <code>xsl:variable</code> instruction with no <code>select</code> or <code>as</code> attribute implicitly wraps the value created by the sequence constructor in a document node. This inevitably fails if the content is a map, making it necessary to write</p>
<pre><code>&lt;xsl:variable name="m" as="map(*)"&gt;
   &lt;xsl:map&gt;...&lt;/xsl:map&gt;
&lt;/xsl:variable&gt;
</code></pre>
<p>I propose that this wrapping should not happen if the first item in the result of the sequence constructor is a function item (including a map or array). The practical effect on users is that they can leave out the <code>as="map(*)"</code> attribute in this situation.</p>
<p>For function items other than arrays, this is currently an error condition so there is no incompatibility.</p>
<p>For arrays it does represent an incompatible change -- the current rules ("Constructing complex content") say that an array is flattened. But XSLT 3.0 has no instruction to construct an array, it would have to be done using <code>xsl:sequence</code>; and no-one would deliberately construct an array merely in order to flatten it, so the situation is unlikely to arise in practice.</p>
<p>The proposal is that the decision whether or not to construct a wrapping document node should be based on the first item in the sequence. This is to allow lazy evaluation. A function item appearing later in the sequence would be handled the same way as now -- most likely an error. An empty sequence continues to result in a childless document node.</p>
</div></details></div>
<div class="toot" id="created-2008"><h2>Pull request #2008 created<span class="toot-id"> #created-2008</span></h2><div class="pubdate">16 May at 21:38:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2008">https://github.com/qt4cg/qtspecs/pull/2008</a></div><details><summary>2004 Add xsl:select instruction</summary><div class="markup"><p>Fix #2004</p>
</div></details></div>
<div class="toot" id="closed-322"><h2>Issue #322 closed<span class="toot-id"> #closed-322</span></h2><div class="pubdate">16 May at 19:56:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/322">https://github.com/qt4cg/qtspecs/issues/322</a></div><p>Map construction in XSLT: xsl:record instruction</p></div>
<div class="toot" id="created-2007"><h2>Issue #2007 created<span class="toot-id"> #created-2007</span></h2><div class="pubdate">16 May at 17:06:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2007">https://github.com/qt4cg/qtspecs/issues/2007</a></div><details><summary>Creating arrays in XSLT</summary><div class="markup"><p>This kind of code comes up a lot, and is hard to simplify except by dropping into XPath:</p>
<pre><code>                &lt;xsl:array&gt;
                  &lt;xsl:for-each select="?members?*[?_nodeType='MethodDeclaration']"&gt;
                     &lt;xsl:array-member&gt;
                        &lt;xsl:apply-templates select="."/&gt;
                     &lt;/xsl:array-member&gt;
                  &lt;/xsl:for-each&gt;
               &lt;/xsl:array&gt;
</code></pre>
<p>Issue #2005 (PR #2006) make it feasible to do it all in XPath (by calling the apply-templates() function) but I don't feel that's the whole answer.</p>
<p>Perhaps we could define something like</p>
<pre><code>&lt;xsl:array-build for-each="?members?*[?_nodeType='MethodDeclaration']"&gt;
   &lt;xsl:apply-templates select="."/&gt;
&lt;/xsl:array-build&gt;
</code></pre>
</div></details></div>
<div class="toot" id="created-2006"><h2>Pull request #2006 created<span class="toot-id"> #created-2006</span></h2><div class="pubdate">15 May at 23:26:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2006">https://github.com/qt4cg/qtspecs/pull/2006</a></div><details><summary>2005 Add fn:apply-templates function</summary><div class="markup"><p>Fix #2005</p>
</div></details></div>
<div class="toot" id="created-2005"><h2>Issue #2005 created<span class="toot-id"> #created-2005</span></h2><div class="pubdate">15 May at 16:53:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2005">https://github.com/qt4cg/qtspecs/issues/2005</a></div><details><summary>apply-templates() as a function</summary><div class="markup"><p>I propose introducing <code>apply-templates()</code> as an xslt-only function, with semantics broadly equivalent to the <code>xsl:apply-templates</code> instruction.</p>
<p>The main use case identified so far is when constructing maps and arrays, it enables the XPath syntax to be used rather than the much more verbose XSLT syntax.</p>
<p>Parameters:</p>
<ul>
<li>select: the items to be processed using matching template rules</li>
<li>with-params: the parameters to be passed. Like with-params on xsl:evaluate, this means variable names exist at run-time, which is a bit of an innovation, but I think it's manageable</li>
<li>mode: again, this means mode names exist at run-time, which may have consequences. There are open questions about what the default should be, or how the various options (default mode, unnamed mode, current mode) should be expressed.</li>
</ul>
</div></details></div>
<div class="toot" id="created-2004"><h2>Issue #2004 created<span class="toot-id"> #created-2004</span></h2><div class="pubdate">15 May at 16:41:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2004">https://github.com/qt4cg/qtspecs/issues/2004</a></div><details><summary>xsl:xpath instruction</summary><div class="markup"><p>In the case study https://github.com/qt4cg/qtspecs/issues/1786#issuecomment-2884424739 I encountered a use case where an instruction <code>xsl:xpath</code> would be useful.</p>
<pre><code>&lt;xsl:xpath&gt;
   { "class":
       { "name": f:degenerify(name/@identifier),
          "abstract": ? abstract,
           "extends": array{? extendedTypes =!&gt; map:merge(apply-templates()) },
           "implements": array{? implementedTypes =!&gt; map:merge(apply-templates()) }
             ...
       }
  }
 &lt;/xsl:xpath&gt;
</code></pre>
<p>The instruction is very simple: <code>&lt;xsl:xpath&gt;EXPR&lt;/xsl:xpath&gt;</code> is equivalent to <code>&lt;xsl:sequence select="EXPR"/&gt;</code>. It's particularly useful because XPath constructors for maps and arrays are so much more concise than the XSLT equivalents. Compared with using xsl:sequence, it means that:</p>
<ul>
<li>XML attribute value normalization doesn't kick in, so your formatting is better protected (meaning also that the system has some chance of computing line numbers correctly for diagnostics)</li>
<li>You haven't tied up either single or double-quotes as an attribute delimiter; both can be freely used within the expression.</li>
<li>You aren't creating the false impression that you're returning a (multi-item) sequence</li>
</ul>
<p>Note that the content is NOT a sequence constructor; no child elements are allowed; and the content is not interpreted as a text value template. Unlike xsl:evaluate, the XPath expression is statically fixed.</p>
<p>(This example also introduces apply-templates as a function, but that will be a separate proposal).</p>
</div></details></div>
<div class="toot" id="created-2003"><h2>Issue #2003 created<span class="toot-id"> #created-2003</span></h2><div class="pubdate">15 May at 16:08:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2003">https://github.com/qt4cg/qtspecs/issues/2003</a></div><details><summary>Conditional entries in map constructors</summary><div class="markup"><p>If you're constructing a map using a map constructor, adding an entry conditionally can be a real pain, and typically involves a wholesale rewrite of the way the map is constructed. It would be nice to be able to mark an entry as optional so users don't have to resort to such wholesale rewrites.</p>
<p>The difficulty of course is finding a nice syntax: one that is both intuitively readable and grammatically unambiguous.</p>
<p>One possibility might be:</p>
<p><code>MapConstructorEntry  ::=  MapKeyExpr&nbsp;":"&nbsp;&nbsp;MapValueExpr "optional"?</code></p>
<p>with the semantics that if the "optional" keyword is present, and the result of evaluating MapValueExpr is an empty sequence, then the entry is omitted from the constructed map.</p>
<p>A more ambitious construct might be</p>
<p><code>MapConstructorEntry  ::=  MapKeyExpr&nbsp;":"&nbsp;&nbsp;MapValueExpr  ("when" MapEntryCondition)?</code></p>
<p>which adds the entry to the map only if the condition is true.</p>
<p>For example:</p>
<pre><code>let $map := {"height": string(@height), 
            "width": string(@width), 
            "weight": string(@weight) when exists(@weight)}
</code></pre>
</div></details></div>
<div class="toot" id="created-2002"><h2>Issue #2002 created<span class="toot-id"> #created-2002</span></h2><div class="pubdate">15 May at 12:25:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2002">https://github.com/qt4cg/qtspecs/issues/2002</a></div><details><summary>Adaptive serialization: QNames</summary><div class="markup"><p>We could use the new QName literal syntax when serializing QNames with the <code>adaptive</code> method:</p>
<pre><code class="language-xquery">serialize(xs:QName('x'), { 'method': 'adaptive' })

(: current output: Q{}x :)
(: proposed output: #x or #Q{}x :)
</code></pre>
</div></details></div>
<div class="toot" id="created-2001"><h2>Pull request #2001 created<span class="toot-id"> #created-2001</span></h2><div class="pubdate">14 May at 17:50:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/2001">https://github.com/qt4cg/qtspecs/pull/2001</a></div><details><summary>1085 Revert fn:sort to the 3.1 spec; introduce fn:sort-by</summary><div class="markup"><p>Fix #1085</p>
<p>The new functionality introduced into the 4.0 version of fn:sort is repackaged into a new function fn:sort-by with a much cleaner interface; the fn:sort function reverts to its 3.1 specification.</p>
<p>If this PR attracts support then the corresponding change will be applied to the array:sort function.</p>
</div></details></div>
<div class="toot" id="created-2000"><h2>Issue #2000 created<span class="toot-id"> #created-2000</span></h2><div class="pubdate">14 May at 14:11:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/2000">https://github.com/qt4cg/qtspecs/issues/2000</a></div><details><summary>element-to-map() - type signature of plan</summary><div class="markup"><p>The specifications of element-to-map() and element-to-map-plan() use different record types for the data structure representing the plan. In both cases the definition is less precise than it might be (though not wrong). The two functions should use a common named record type, which should be as precise as possible.</p>
</div></details></div>
<div class="toot" id="closed-1982"><h2>Issue #1982 closed<span class="toot-id"> #closed-1982</span></h2><div class="pubdate">13 May at 17:24:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1982">https://github.com/qt4cg/qtspecs/pull/1982</a></div><p>1981 Ambiguity with qname literals and pragmas</p></div>
<div class="toot" id="closed-1889"><h2>Issue #1889 closed<span class="toot-id"> #closed-1889</span></h2><div class="pubdate">13 May at 17:19:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1889">https://github.com/qt4cg/qtspecs/issues/1889</a></div><p>HTML serialization: `html-version` and `version` parameters; allowed values</p></div>
<div class="toot" id="closed-1977"><h2>Issue #1977 closed<span class="toot-id"> #closed-1977</span></h2><div class="pubdate">13 May at 17:19:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1977">https://github.com/qt4cg/qtspecs/pull/1977</a></div><p>1889 Tidy up handling of HTML serialization version, default to HTML5</p></div>
<div class="toot" id="closed-1985"><h2>Issue #1985 closed<span class="toot-id"> #closed-1985</span></h2><div class="pubdate">13 May at 17:13:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1985">https://github.com/qt4cg/qtspecs/issues/1985</a></div><p>Default namespace terminology</p></div>
<div class="toot" id="closed-1987"><h2>Issue #1987 closed<span class="toot-id"> #closed-1987</span></h2><div class="pubdate">13 May at 17:13:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1987">https://github.com/qt4cg/qtspecs/pull/1987</a></div><p>1985 Tidy up namespace terminology</p></div>
<div class="toot" id="closed-1986"><h2>Issue #1986 closed<span class="toot-id"> #closed-1986</span></h2><div class="pubdate">13 May at 16:49:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1986">https://github.com/qt4cg/qtspecs/issues/1986</a></div><p>Obsolete note on reporting errors</p></div>
<div class="toot" id="closed-1988"><h2>Issue #1988 closed<span class="toot-id"> #closed-1988</span></h2><div class="pubdate">13 May at 16:49:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1988">https://github.com/qt4cg/qtspecs/pull/1988</a></div><p>1986 Drop obsolete notes on error reporting</p></div>
<div class="toot" id="closed-1989"><h2>Issue #1989 closed<span class="toot-id"> #closed-1989</span></h2><div class="pubdate">13 May at 16:49:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1989">https://github.com/qt4cg/qtspecs/pull/1989</a></div><p>1983 QName literals in node constructors</p></div>
<div class="toot" id="closed-1983"><h2>Issue #1983 closed<span class="toot-id"> #closed-1983</span></h2><div class="pubdate">13 May at 16:49:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1983">https://github.com/qt4cg/qtspecs/issues/1983</a></div><p>Computed node constructors - use QName literals rather than string literals</p></div>
<div class="toot" id="closed-1990"><h2>Issue #1990 closed<span class="toot-id"> #closed-1990</span></h2><div class="pubdate">13 May at 16:48:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1990">https://github.com/qt4cg/qtspecs/pull/1990</a></div><p>Update schema-for-xslt40.xsd</p></div>
<div class="toot" id="created-1999"><h2>Pull request #1999 created<span class="toot-id"> #created-1999</span></h2><div class="pubdate">12 May at 15:24:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1999">https://github.com/qt4cg/qtspecs/pull/1999</a></div><details><summary>1992 Correct type of constructor function in schema-type-record</summary><div class="markup"><p>Fix #1992</p>
</div></details></div>
<div class="toot" id="created-1998"><h2>Pull request #1998 created<span class="toot-id"> #created-1998</span></h2><div class="pubdate">12 May at 14:28:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1998">https://github.com/qt4cg/qtspecs/pull/1998</a></div><details><summary>1997 Correct nesting of item coercion rules</summary><div class="markup"><p>Fix #1997</p>
<p>(A correction to an editorial error that made a substantive difference to the spec.)</p>
</div></details></div>
<div class="toot" id="created-1997"><h2>Issue #1997 created<span class="toot-id"> #created-1997</span></h2><div class="pubdate">12 May at 13:57:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1997">https://github.com/qt4cg/qtspecs/issues/1997</a></div><details><summary>Coercion Rules: §3.4.1 rule 3(c)</summary><div class="markup"><p>This section reads:</p>
<blockquote>
<p>If R is an [atomic type] and J is an [atomic item], then:</p>
<ul>
<li>If J is an instance of R then it is used unchanged.</li>
<li>If J is an instance of type xs:untypedAtomic then:
** If R is an [enumeration type] then A is cast to xs:string.
** If R is [namespace-sensitive] then a [type error] [[err:XPTY0117]] is raised.</li>
<li>Otherwise, J is cast to type R.</li>
</ul>
</blockquote>
<p>The last line (rule 3(c)) looks all wrong. If we just did a cast at this point then rules 4 and 5 would be unnecessary.</p>
<p>It's not easy to trace the history, but I think it went wrong when the rules for choice/union types were refactored (around 2024-04-12). The line in question appears to have originally been under a conditional "if A is an instance of xs:untypedAtomic...".</p>
</div></details></div>
<div class="toot" id="created-1996"><h2>Issue #1996 created<span class="toot-id"> #created-1996</span></h2><div class="pubdate">12 May at 11:05:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1996">https://github.com/qt4cg/qtspecs/issues/1996</a></div><details><summary>Lookups, KeySpecifier: add NumericLiteral and ContextValueRef?</summary><div class="markup"><p>Various types of expressions are allowed as a <code>KeySpecifier</code>:</p>
<pre><code>Lookup  ::=  ("?" | "??") (Modifier "::")? KeySpecifier
KeySpecifier  ::=  NCName | IntegerLiteral | StringLiteral | VarRef | ParenthesizedExpr | LookupWildcard | TypeSpecifier
</code></pre>
<p>Maybe we could add <code>ContextValueRef</code> and <code>NumericLiteral</code> to the list, to make the following expressions legal:</p>
<pre><code class="language-xquery">{ '1.5': 'one and a half' }?1.5
array { 1 to 256 }?0x80
(3, 4, 5) ! $array?.
</code></pre>
</div></details></div>
<div class="toot" id="created-1995"><h2>Issue #1995 created<span class="toot-id"> #created-1995</span></h2><div class="pubdate">12 May at 10:56:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1995">https://github.com/qt4cg/qtspecs/issues/1995</a></div><details><summary>Consistency: array lookups</summary><div class="markup"><p>The different variants to look up array members should be unified. For example (if I interpret the rules correctly), the following expressions can be evaluated…</p>
<pre><code class="language-xquery">[ 'a' ]?(&lt;x&gt;1&lt;/x&gt;)
[ 'a' ]??(number(&lt;x&gt;1&lt;/x&gt;))
[ 'a' ]??(1e0)
let $a := 1e0 return [ 'a' ]??$a
</code></pre>
<p>…whereas the following expressions raise errors:</p>
<pre><code class="language-xquery">[ 'a' ]?(number(&lt;x&gt;1&lt;/x&gt;))
[ 'a' ]?(1e0)
let $a := 1e0 return [ 'a' ]?$a
</code></pre>
<p>We should probably try to make all of them legal, or try to justify what happens.</p>
</div></details></div>
<div class="toot" id="agenda-05-13"><h2>QT4 CG meeting 121 draft agenda<span class="toot-id"> #agenda-05-13</span></h2><div class="pubdate">12 May at 09:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/05-13">https://qt4cg.org/meeting/agenda/2025/05-13</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1797"><h2>Issue #1797 closed<span class="toot-id"> #closed-1797</span></h2><div class="pubdate">12 May at 09:30:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1797">https://github.com/qt4cg/qtspecs/issues/1797</a></div><p>elements-to-maps: separate function to construct a plan</p></div>
<div class="toot" id="closed-1993"><h2>Issue #1993 closed<span class="toot-id"> #closed-1993</span></h2><div class="pubdate">12 May at 08:25:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1993">https://github.com/qt4cg/qtspecs/issues/1993</a></div><p>Incorrect test generated for map:pairs</p></div>
<div class="toot" id="closed-1994"><h2>Issue #1994 closed<span class="toot-id"> #closed-1994</span></h2><div class="pubdate">12 May at 08:25:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1994">https://github.com/qt4cg/qtspecs/pull/1994</a></div><p>1993 Stylesheet fix to copy the occurrence indicator</p></div>
<div class="toot" id="created-1994"><h2>Pull request #1994 created<span class="toot-id"> #created-1994</span></h2><div class="pubdate">11 May at 21:04:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1994">https://github.com/qt4cg/qtspecs/pull/1994</a></div><details><summary>1993 Stylesheet fix to copy the occurrence indicator</summary><div class="markup"><p>Fix #1993</p>
</div></details></div>
<div class="toot" id="created-1993"><h2>Issue #1993 created<span class="toot-id"> #created-1993</span></h2><div class="pubdate">11 May at 20:52:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1993">https://github.com/qt4cg/qtspecs/issues/1993</a></div><details><summary>Incorrect test generated for map:pairs</summary><div class="markup"><p>The signature for map:pairs is</p>
<pre><code>map:pairs(
$map	as map(*)	
) as key-value-pair*
</code></pre>
<p>but the test case generated in misc-BuiltInKeywords is (incorrectly)</p>
<p><code>map:pairs(map := ?) instance of function(map(*)) as fn:key-value-pair</code></p>
<p>Note the missing <code>*</code> at the end.</p>
</div></details></div>
<div class="toot" id="created-1992"><h2>Issue #1992 created<span class="toot-id"> #created-1992</span></h2><div class="pubdate">11 May at 16:24:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1992">https://github.com/qt4cg/qtspecs/issues/1992</a></div><details><summary>Type of fn:schema-type-record ? constructor</summary><div class="markup"><p>In the type fn:schema-type-record (returned by functions such as fn:schema-type), the field <code>constructor</code> is said to be of type <code>fn(xs:anyAtomicType) as xs:anyAtomicType</code>. It is also said to be "the same function as returned by [fn:function-lookup] applied to the type name (with arity one)". But that function has type <code>fn(xs:anyAtomicType?) as T?</code></p>
<p>The correct type for the <code>constructor</code> field should be <code>fn(xs:anyAtomicType?) as xs:anyAtomicType?</code></p>
</div></details></div>
<div class="toot" id="created-1991"><h2>Pull request #1991 created<span class="toot-id"> #created-1991</span></h2><div class="pubdate">11 May at 10:45:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1991">https://github.com/qt4cg/qtspecs/pull/1991</a></div><details><summary>835 Add built-in named record types to static context</summary><div class="markup"><p>This PR adds six built-in named record types to the static context of every application:</p>
<p>Record [key-value-pair]
Record [load-xquery-module-record]
Record [parsed-csv-structure-record]
Record [random-number-generator-record]
Record [schema-type-record]
Record [uri-structure-record]</p>
<p>These are now listed in Appendix C of F&amp;O</p>
<p>Issue 835 requests a review of the names of these records; perhaps putting them in one place will make that review easier. Personally, I am happy with the names as currently defined.</p>
</div></details></div>
<div class="toot" id="created-1990"><h2>Pull request #1990 created<span class="toot-id"> #created-1990</span></h2><div class="pubdate">08 May at 18:22:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1990">https://github.com/qt4cg/qtspecs/pull/1990</a></div><details><summary>Update schema-for-xslt40.xsd</summary><div class="markup"><p>Fixed invalid syntax xs:simpleType/@ref (moved to @memberTypes) in simpleType named method</p>
<p>Based the type fixed-namespaces-type-default on xs:token instead of xs:string to allow for whitespace normalization</p>
<p>Changed collation attribute on xsl:merge-key to be an avt (according to spec)</p>
<p>Changed attributes that were previously of type "xsl:char-optionally-expanded" to just xs:string since the spec says they can be any string.  I couldn't think of a reason they should be limited to one character optionally followed by a colon and more characters, so I assumed this was some sort of artifact from the past.</p>
<p>Changed xsl:next-iteration and xsl:evaluate to not allow mixed content</p>
<p>Corrected _split_when to _split-when</p>
<p>Added missing shadow attributes (in two places) for allow-duplicate-names, build-tree, json-lines and json-node-output-method</p>
<p>Added missing shadow attribute for select on perform-sort</p>
<p>Added assertions for required attributes:</p>
<ul>
<li>xsl:use-package - name</li>
<li>xsl:expose - names, component and visibility</li>
</ul>
<p>Made the errors attribute a list of tokens instead of just xs:token.  Doesn't affect validation but I think it is more clear.</p>
<p>Changed default value of per-mille from a tilde to ‰</p>
<p>Changed the default value of the on-no-match attribute from shallow-skip to text-only-copy, per the spec</p>
<p>Gave xsl:exclude-result-prefixes the same type as no-namespace exclude-result-prefixes, to allow for #all and #default</p>
<p>Gave xsl:extension-element-prefixes the same type as no-namespace extension-element-prefixes, to allow for #default</p>
<p>Removed the xsl:prefixes and xsl:char-optionally-expanded types since they were no longer used after the above changes</p>
<p>Changed the type of the visibility attribute on xsl:attribute-set, xsl:function, xsl:template and xsl:variable to xsl:visibility-not-hidden-type to exclude "hidden" per the spec</p>
<p>Changed the keyword value of the fixed-namespaces attribute from #default to #standard (and adjusted type names)</p>
</div></details></div>
<div class="toot" id="created-1989"><h2>Pull request #1989 created<span class="toot-id"> #created-1989</span></h2><div class="pubdate">08 May at 11:53:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1989">https://github.com/qt4cg/qtspecs/pull/1989</a></div><details><summary>1983 QName literals in node constructors</summary><div class="markup"><p>Fix #1983</p>
</div></details></div>
<div class="toot" id="created-1988"><h2>Pull request #1988 created<span class="toot-id"> #created-1988</span></h2><div class="pubdate">07 May at 13:15:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1988">https://github.com/qt4cg/qtspecs/pull/1988</a></div><details><summary>1986 Drop obsolete notes on error reporting</summary><div class="markup"><p>Fix #1986</p>
</div></details></div>
<div class="toot" id="created-1987"><h2>Pull request #1987 created<span class="toot-id"> #created-1987</span></h2><div class="pubdate">07 May at 13:08:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1987">https://github.com/qt4cg/qtspecs/pull/1987</a></div><details><summary>1985 Tidy up namespace terminology</summary><div class="markup"><p>Fix #1985</p>
<p>Editorial.</p>
<p>The main effect is to centralise the descriptions of how to expand unprefixed QNames into a few named rules which can be referenced and reused throughout the spec.</p>
</div></details></div>
<div class="toot" id="created-1986"><h2>Issue #1986 created<span class="toot-id"> #created-1986</span></h2><div class="pubdate">07 May at 10:00:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1986">https://github.com/qt4cg/qtspecs/issues/1986</a></div><details><summary>Obsolete note on reporting errors</summary><div class="markup"><p>I propose dropping the folliowing text in XQuery §2.4.2</p>
<p>None of this text says anything prescriptive, and the suggested notation of URI#local appears outdated.</p>
<blockquote>
<p>The method by which an XQuery 4.0 processor reports error information to the external environment is <a href="file:///Users/mike/GitHub/mhk/qtspecs/build/www/xquery-40/xquery-40.html#dt-implementation-defined">implementation-defined</a>.</p>
<p>An error can be represented by a URI reference that is derived from the error QName as follows: an error with namespace URI NS and local part LP can be represented as the URI reference NS # LP . For example, an error whose QName is err:XPST0017 could be represented as http://www.w3.org/2005/xqt-errors#XPST0017.</p>
<p>Note:</p>
<p>Along with a code identifying an error, implementations may wish to return additional information, such as the location of the error or the processing phase in which it was detected. If an implementation chooses to do so, then the mechanism that it uses to return this information is <a href="file:///Users/mike/GitHub/mhk/qtspecs/build/www/xquery-40/xquery-40.html#dt-implementation-defined">implementation-defined</a>.</p>
</blockquote>
</div></details></div>
<div class="toot" id="created-1985"><h2>Issue #1985 created<span class="toot-id"> #created-1985</span></h2><div class="pubdate">07 May at 07:43:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1985">https://github.com/qt4cg/qtspecs/issues/1985</a></div><details><summary>Default namespace terminology</summary><div class="markup"><p>There are places in the spec that use sloppy terminology regarding namespaces. For example 2.1.3 says</p>
<blockquote>
<p>the namespace URI is inferred from the prefix by examining the in-scope namespaces in the static context</p>
</blockquote>
<p>But the static context does not define "in-scope namespaces", it defines "statically known namespaces"</p>
<p>I propose to put together an editorial PR to tidy this up.</p>
</div></details></div>
<div class="toot" id="created-1984"><h2>Pull request #1984 created<span class="toot-id"> #created-1984</span></h2><div class="pubdate">06 May at 20:53:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1984">https://github.com/qt4cg/qtspecs/pull/1984</a></div><details><summary>882 Drop fn:chain</summary><div class="markup"><p>Fix #882</p>
<p>Supersedes PR #1883</p>
<p>There has been a great deal of discussion about the relative merits of the status-quo fn:chain function and the proposed replacement fn:compose. The CG was polled on whether it preferred to have fn:chain only, fn:compose only, or both, or neither. There was no clear consensus. The only option which no-one seemed to favour was to have fn:chain only -- which is the status quo. Since no-one is happy with the status quo I am therefore proposing that we drop this function. We can then start with a clean slate.</p>
<p>For the record the main criticisms of the fn:chain function as currently specified were:</p>
<p>(a) it is more useful to have a function that combines several functions into a single function, without actually applying that function to a set of supplied arguments</p>
<p>(b) The function has special-case behaviour for arrays (if the input is not an array and the function has arity &gt; 1 then the input sequence is converted to an array).</p>
<p>(c) The need for the function is not clearly motivated; the examples given can all be achieved in some simpler more intuitive way.</p>
</div></details></div>
<div class="toot" id="created-1983"><h2>Issue #1983 created<span class="toot-id"> #created-1983</span></h2><div class="pubdate">06 May at 20:32:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1983">https://github.com/qt4cg/qtspecs/issues/1983</a></div><details><summary>Computed node constructors - use QName literals rather than string literals</summary><div class="markup"><p>We have introduced (in 4.0) the option to specify element and attribute names in computed node constructors in the form of string literals. We should replace this with QName literals.</p>
</div></details></div>
<div class="toot" id="created-1982"><h2>Pull request #1982 created<span class="toot-id"> #created-1982</span></h2><div class="pubdate">06 May at 20:30:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1982">https://github.com/qt4cg/qtspecs/pull/1982</a></div><details><summary>1981 Ambiguity with qname literals and pragmas</summary><div class="markup"><p>Resolves the syntax problem identified in #1981 by requiring a space between <code>(</code> and <code>#</code>.</p>
<p>Adds more examples and notes scattered around the specs.</p>
</div></details></div>
<div class="toot" id="created-1981"><h2>Issue #1981 created<span class="toot-id"> #created-1981</span></h2><div class="pubdate">06 May at 16:41:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1981">https://github.com/qt4cg/qtspecs/issues/1981</a></div><details><summary>Syntax for QName literals clashes with XQuery pragmas</summary><div class="markup"><p>Unfortunately (as revealed by implementation and testing) the syntax for QName literals clashes with the syntax for pragmas in XQuery.</p>
<p>In the expression <code>error(#err:XPTY0004)</code>, the longest token after <code>error</code> is <code>(#</code> which looks like the start of a pragma.</p>
<p>It's actually a wee bit complicated. Looking at the tokenization rules, we shouldn't be recognizing a pragma here because there is no closing <code>#)</code>. The tokenization notes say "The lexical production rules for [variable terminals] have been designed so that there is minimal need for backtracking."; the introduction of the new syntax would mean that this is no longer the case. But regardless of the details, I think we have to change the QName literal syntax.</p>
<p>I propose we go for doubling the hash: <code>error(##err:XPTY0004)</code>. We need to qualify the rules for tokenizing a pragma to say that a pragma is recognized when we see (<code>(#</code>, optional whitespace, EQName) - that's not unlike the rules we have for other "variable tokens".</p>
</div></details></div>
<div class="toot" id="closed-1972"><h2>Issue #1972 closed<span class="toot-id"> #closed-1972</span></h2><div class="pubdate">06 May at 16:22:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1972">https://github.com/qt4cg/qtspecs/issues/1972</a></div><p>Dynamic function call applied to empty sequence</p></div>
<div class="toot" id="closed-1240"><h2>Issue #1240 closed<span class="toot-id"> #closed-1240</span></h2><div class="pubdate">06 May at 16:22:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1240">https://github.com/qt4cg/qtspecs/issues/1240</a></div><p>$sequence-of-maps ? info()</p></div>
<div class="toot" id="closed-1975"><h2>Issue #1975 closed<span class="toot-id"> #closed-1975</span></h2><div class="pubdate">06 May at 16:22:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1975">https://github.com/qt4cg/qtspecs/pull/1975</a></div><p>1240 Allow operand of dynamic function call to be a sequence</p></div>
<div class="toot" id="closed-1661"><h2>Issue #1661 closed<span class="toot-id"> #closed-1661</span></h2><div class="pubdate">06 May at 16:19:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1661">https://github.com/qt4cg/qtspecs/issues/1661</a></div><p>QName arguments: also allow strings</p></div>
<div class="toot" id="closed-1976"><h2>Issue #1976 closed<span class="toot-id"> #closed-1976</span></h2><div class="pubdate">06 May at 16:19:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1976">https://github.com/qt4cg/qtspecs/pull/1976</a></div><p>1661 Introduce QName literals</p></div>
<div class="toot" id="closed-1973"><h2>Issue #1973 closed<span class="toot-id"> #closed-1973</span></h2><div class="pubdate">06 May at 16:16:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1973">https://github.com/qt4cg/qtspecs/issues/1973</a></div><p>Substantitively disjoint types</p></div>
<div class="toot" id="closed-1974"><h2>Issue #1974 closed<span class="toot-id"> #closed-1974</span></h2><div class="pubdate">06 May at 16:16:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1974">https://github.com/qt4cg/qtspecs/pull/1974</a></div><p>1973 Cross-reference from type analysis to definition of disjointedness</p></div>
<div class="toot" id="closed-1951"><h2>Issue #1951 closed<span class="toot-id"> #closed-1951</span></h2><div class="pubdate">06 May at 16:14:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1951">https://github.com/qt4cg/qtspecs/issues/1951</a></div><p>Some nits regarding the method attribute</p></div>
<div class="toot" id="closed-1971"><h2>Issue #1971 closed<span class="toot-id"> #closed-1971</span></h2><div class="pubdate">06 May at 16:14:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1971">https://github.com/qt4cg/qtspecs/pull/1971</a></div><p>1951 Clarifications on serialization parameters</p></div>
<div class="toot" id="closed-1952"><h2>Issue #1952 closed<span class="toot-id"> #closed-1952</span></h2><div class="pubdate">06 May at 16:08:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1952">https://github.com/qt4cg/qtspecs/issues/1952</a></div><p>Change option name from xsi-schema-location to use-xsi-schema-location</p></div>
<div class="toot" id="closed-1969"><h2>Issue #1969 closed<span class="toot-id"> #closed-1969</span></h2><div class="pubdate">06 May at 16:08:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1969">https://github.com/qt4cg/qtspecs/pull/1969</a></div><p>1952 Change option name xsi-schema-location</p></div>
<div class="toot" id="closed-1967"><h2>Issue #1967 closed<span class="toot-id"> #closed-1967</span></h2><div class="pubdate">06 May at 16:05:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1967">https://github.com/qt4cg/qtspecs/issues/1967</a></div><p>Example for fn:unparsed-binary uses obsolete function name</p></div>
<div class="toot" id="closed-1968"><h2>Issue #1968 closed<span class="toot-id"> #closed-1968</span></h2><div class="pubdate">06 May at 16:05:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1968">https://github.com/qt4cg/qtspecs/pull/1968</a></div><p>1967 r/binary-resource/unparsed-binary/</p></div>
<div class="toot" id="closed-1957"><h2>Issue #1957 closed<span class="toot-id"> #closed-1957</span></h2><div class="pubdate">06 May at 16:02:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1957">https://github.com/qt4cg/qtspecs/issues/1957</a></div><p>Schema for XSLT incorrectly allows mixed content for xsl:output</p></div>
<div class="toot" id="closed-1964"><h2>Issue #1964 closed<span class="toot-id"> #closed-1964</span></h2><div class="pubdate">06 May at 16:02:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1964">https://github.com/qt4cg/qtspecs/pull/1964</a></div><p>1957 xsl output allows mixed content</p></div>
<div class="toot" id="closed-1958"><h2>Issue #1958 closed<span class="toot-id"> #closed-1958</span></h2><div class="pubdate">06 May at 15:59:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1958">https://github.com/qt4cg/qtspecs/issues/1958</a></div><p>Typo in map:build</p></div>
<div class="toot" id="closed-1963"><h2>Issue #1963 closed<span class="toot-id"> #closed-1963</span></h2><div class="pubdate">06 May at 15:59:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1963">https://github.com/qt4cg/qtspecs/pull/1963</a></div><p>1958 Fix simple typo in map:build</p></div>
<div class="toot" id="created-1980"><h2>Issue #1980 created<span class="toot-id"> #created-1980</span></h2><div class="pubdate">06 May at 14:12:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1980">https://github.com/qt4cg/qtspecs/issues/1980</a></div><details><summary>HTML serialization: the rules for adding a meta element need to be aligned with HTML5</summary><div class="markup"><p>See Saxon bugs:</p>
<p>https://saxonica.plan.io/issues/5852
https://saxonica.plan.io/issues/6772</p>
<p>regarding the recognition and generation of META elements in the HTML and XHTML header sections.</p>
<p>Saxon is producing HTML5 output as mandated by the 3.1 serialization spec but this is apparently either invalid or deprecated by the HTML5 specification. The 4.0 serialization spec makes some adjustments in this area but I don't think it is fully in line yet with HTML5.</p>
</div></details></div>
<div class="toot" id="created-1979"><h2>Issue #1979 created<span class="toot-id"> #created-1979</span></h2><div class="pubdate">04 May at 09:36:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1979">https://github.com/qt4cg/qtspecs/issues/1979</a></div><details><summary>Records: Type Safety</summary><div class="markup"><p>One cognitive challenge with records is to internalize that records are not independent types, but only map constraints. As a consequence, no type safety guarantees exist when records are accessed and updated:</p>
<ul>
<li>A lookup of a non-existing key raises no error.</li>
<li>A record update may result in a map that does not match the original record definition.</li>
</ul>
<p>This makes it hard and often impossible/illegal for processors to output helpful error messages.</p>
<p>There are reasons why we don’t want to make records too strict: an extensible record may include keys that are not defined in the record type:</p>
<pre><code class="language-xquery">(: must not raise an error :)
declare record local:r(a, *);
let $r as local:r := { 'a': 1, 'b': 2 }
return $r?b
</code></pre>
<p>However, for <strong>non-extensible</strong> records, I think we should <strong>allow</strong> processors to perform stricter checks when unknown keys are looked up, or when the result of an update would conflict with the original record type:</p>
<pre><code class="language-xquery">declare record local:r(a as xs:integer);
(: unknown key :)
local:r(1)?b,
(: invalid value type :)
map:put(local:r(1), 'a', 'string')
</code></pre>
<p>As records are no independent types, it will be difficult to <strong>enforce</strong> errors in all cases: It would require implementations to always know that a currently processed map has once been validated against a specific record type. But in many cases, implementations may be able to preserve record types for maps that have been coerced to a record, or created with a record declaration, and propagate them to updated maps. For example, we already do so when we can statically infer that the resulting map of a <code>map:put</code> call will match the original record type.</p>
</div></details></div>
<div class="toot" id="created-1978"><h2>Issue #1978 created<span class="toot-id"> #created-1978</span></h2><div class="pubdate">04 May at 00:55:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1978">https://github.com/qt4cg/qtspecs/issues/1978</a></div><details><summary>Function `map:build` does not allow expressing the dependency of a value on its key. Some simple types of maps cannot be built.</summary><div class="markup"><h2>The Problem</h2>
<p>Function <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-map-build"><strong><code>map:build</code></strong></a>, does not allow to explicitly define the functional dependency of a value on its key.</p>
<p>As result, it is unusable for creating even such simple maps as the following:</p>
<p>The input is:</p>
<p><code>("apple", "apricot", "banana", "blueberry", "cherry")</code></p>
<p>The <code>$keys</code> function is:
<code>$keys := fn($x){characters($x)}</code>
That is, every  character, in every input string, is a key.</p>
<p>We need the values to be: if an input string contains the key two or more times, then each such string, else the empty sequence.</p>
<p>The expected map  to be produced is:</p>
<pre><code class="language-xq">{
  "a":  "banana",
  "b": "blueberry",
  "c": (),
  "e": "blueberry",
  "h": (),
  "i": (),
  "l": (), (: Lowercase L :)
  "n", "banana",
  "o", (),
  "p": "apple",
  "r": ("cherry", "blueberry"),
  "t": (),
  "y": ()
}
</code></pre>
<h2>Solution</h2>
<p>We provide a new definition of <strong><code>map:build</code></strong> - this can be a complete replacement of the current function, or could be added as a new overload.
I am in the process of writing a PR, and your feedback would be appreciated.</p>
<p>The definition is simple:</p>
<pre><code class="language-xq">let $mapBuild := fn(
$input	as item()*,	
$keys	as (fn($item as item(), $position as xs:integer) as xs:anyAtomicType*),
$value	as (fn($key as xs:anyAtomicType, $input as item()*) as item()*)
) as map(*)
{
  let $allKeys := distinct-values(for-each($input, $keys))
   return
     $allKeys ! map:pair(., $value(., $input)) =&gt; map:of-pairs()
}
</code></pre>
<p>As can be seen from executing the code below, the redefined function can be successfully used to build the "problematic" map above, and also all currently provided examples in the FO Spec for the function <code>map:build</code>.</p>
<pre><code class="language-xq">let $mapBuild := fn(
$input	as item()*,	
$keys	as (fn($item as item(), $position as xs:integer) as xs:anyAtomicType*),
$value	as (fn($key as xs:anyAtomicType, $input as item()*) as item()*)
) as map(*)
{
  let $allKeys := distinct-values(for-each($input, $keys))
   return
     $allKeys ! map:pair(., $value(., $input)) =&gt; map:of-pairs()
}
 return
   let $input := ("apple", "apricot", "banana", "blueberry", "cherry"),
       $employees :=
         &lt;employees&gt;
           &lt;employee name="Jim Nelson" location="New York" ssn="1234567890" salary="123456"/&gt;
           &lt;employee name="Ann West" location="New York" ssn="0987654321" salary="99999"/&gt;
           &lt;employee name="Peter Smith" location="Seattle" ssn="123454321" salary="155223"/&gt;
           &lt;employee name="Karen Johnson" location="Seattle" ssn="5432198760" salary="175000"/&gt;
           &lt;employee name="Jonh Lagarde" location="Boston" ssn="9999999999" salary="145000"/&gt;
           &lt;employee name="Samantha Weird" location="Boston" ssn="1111111111" salary="153000"/&gt;
         &lt;/employees&gt;
    return
(    
     $mapBuild(
       $input,
       fn($string, $pos) {distinct-values(characters($string))},
       fn($key, $input)
       {
         filter($input, fn($string, $pos){$key = duplicate-values(characters($string))}) 
       }
     ),
     $mapBuild((), string#1, string#1),
     $mapBuild(1 to 10, fn {. mod 3}, fn($key, $input){filter($input, fn{$key = . mod 3})}),
     $mapBuild(1 to 5, identity#1, format-integer(?, "w")),
     $mapBuild(("January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"),
               substring(?, 1, 1), fn($key, $input){filter($input, fn{$key = substring(., 1, 1)})}
              ),
     $mapBuild(
        ("apple", "apricot", "banana", "blueberry", "cherry"),
        substring(?, 1, 1), fn($key, $input){sum($input[$key eq substring(., 1, 1)] ! string-length(.))}
     ),
     $mapBuild(
       ('Wang', 'Liu', 'Zhao'),
       fn($name, $pos) { $name },
       fn($key, $input){index-of($input, $key)}
     ),  
     let $titles := 
       &lt;titles&gt;
        &lt;title&gt;A Beginner’s Guide to &lt;ix&gt;Java&lt;/ix&gt;&lt;/title&gt;
        &lt;title&gt;Learning &lt;ix&gt;XML&lt;/ix&gt;&lt;/title&gt;
        &lt;title&gt;Using &lt;ix&gt;XML&lt;/ix&gt; with &lt;ix&gt;Java&lt;/ix&gt;&lt;/title&gt;
      &lt;/titles&gt;
     return
       $mapBuild($titles/title, 
                 fn($title){$title/ix}, 
                 fn($key, $input){filter($input, fn($elem){$key = $elem/ix})}
               ),
      $mapBuild(
        $employees//employee, fn{@ssn}, fn($key, $input){filter($input, fn($elem){$key = $elem/@ssn})}
      ),
      $mapBuild(
        $employees//employee, fn{@location}, fn($key, $input) {count(filter($input, fn($elem){$key = $elem/@location}))}
      ),
      $mapBuild(
        $employees//employee, fn{@location}, fn($key, $input) {max((filter($input, fn($elem){$key = $elem/@location}))/xs:decimal(@salary))}
      )
)
</code></pre>
<p>All results (executed with BaseX) are the expected, correct ones:</p>
<pre><code class="language-xq">{"a":"banana","p":"apple","l":(),"e":"blueberry","r":("blueberry","cherry"),"i":(),"c":(),"o":(),"t":(),"b":"blueberry","n":"banana","u":(),"y":(),"h":()}
{}
{1:(1,4,7,10),2:(2,5,8),0:(3,6,9)}
{1:"one",2:"two",3:"three",4:"four",5:"five"}
{"J":("January","June","July"),"F":"February","M":("March","May"),"A":("April","August"),"S":"September","O":"October","N":"November","D":"December"}
{"a":12,"b":15,"c":6}
{"Wang":1,"Liu":2,"Zhao":3}
{"Java":(&lt;title&gt;A Beginner’s Guide to &lt;ix&gt;Java&lt;/ix&gt;&lt;/title&gt;,&lt;title&gt;Using &lt;ix&gt;XML&lt;/ix&gt; with &lt;ix&gt;Java&lt;/ix&gt;&lt;/title&gt;),"XML":(&lt;title&gt;Learning &lt;ix&gt;XML&lt;/ix&gt;&lt;/title&gt;,&lt;title&gt;Using &lt;ix&gt;XML&lt;/ix&gt; with &lt;ix&gt;Java&lt;/ix&gt;&lt;/title&gt;)}
{"1234567890":&lt;employee name="Jim Nelson" location="New York" ssn="1234567890" salary="123456"/&gt;,"0987654321":&lt;employee name="Ann West" location="New York" ssn="0987654321" salary="99999"/&gt;,"123454321":&lt;employee name="Peter Smith" location="Seattle" ssn="123454321" salary="155223"/&gt;,"5432198760":&lt;employee name="Karen Johnson" location="Seattle" ssn="5432198760" salary="175000"/&gt;,"9999999999":&lt;employee name="Jonh Lagarde" location="Boston" ssn="9999999999" salary="145000"/&gt;,"1111111111":&lt;employee name="Samantha Weird" location="Boston" ssn="1111111111" salary="153000"/&gt;}
{"New York":2,"Seattle":2,"Boston":2}
{"New York":123456,"Seattle":175000,"Boston":153000}
</code></pre>
<p><img src="https://github.com/user-attachments/assets/716658e3-8fac-4cc4-96fb-d6981037c4df" alt="Image"></p>
</div></details></div>
<div class="toot" id="created-1977"><h2>Pull request #1977 created<span class="toot-id"> #created-1977</span></h2><div class="pubdate">02 May at 15:59:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1977">https://github.com/qt4cg/qtspecs/pull/1977</a></div><details><summary>1889 Tidy up handling of HTML serialization version, default to HTML5</summary><div class="markup"><p>Does some general tidying up of the serialization text, but the main substantive changes are (a) to make HTML5 the default version, and (b) to make support for earlier versions effectively optional.</p>
<p>Please review carefully. Marking as editorial because I'm not sure any test cases need to change, but I might be wrong.</p>
<p>Fix #1889</p>
</div></details></div>
<div class="toot" id="created-1976"><h2>Pull request #1976 created<span class="toot-id"> #created-1976</span></h2><div class="pubdate">02 May at 11:56:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1976">https://github.com/qt4cg/qtspecs/pull/1976</a></div><details><summary>1661 Introduce QName literals</summary><div class="markup"><p>Fix #1661</p>
<p>See also #747</p>
<p>As discussed in the issue, I wasn't happy with the idea of changing the coercion rules to allow strings to be provided where a QName is expected, because of the need to keep the namespace context around at run-time, and because of potential confusion about exactly what namespace context is used.</p>
<p>Instead I have gone back to the idea of introducing QName literals, using the simple syntax #EQName.</p>
<p>Examples:</p>
<pre><code>error(#err:XPTY0004)
node-name($node) = #xml:space
format-number($num, #de)
load-xquery-module($module)?variables?(#myvar)
transform({'initial-template':#xsl:initial-template})
{'last': 'Kay', 'first': 'Michael', 'suffix':#fn:null}
</code></pre>
</div></details></div>
<div class="toot" id="created-1975"><h2>Pull request #1975 created<span class="toot-id"> #created-1975</span></h2><div class="pubdate">02 May at 10:28:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1975">https://github.com/qt4cg/qtspecs/pull/1975</a></div><details><summary>1240 Allow operand of dynamic function call to be a sequence</summary><div class="markup"><p>Fix #1240
Fix #1972</p>
<p>This PR enables use of expressions such as <code>$rectangle?area() - sum($rectangle?contents()?area())</code> which would previously have failed with a type error.</p>
</div></details></div>
<div class="toot" id="created-1974"><h2>Pull request #1974 created<span class="toot-id"> #created-1974</span></h2><div class="pubdate">02 May at 09:13:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1974">https://github.com/qt4cg/qtspecs/pull/1974</a></div><details><summary>1973 Cross-reference from type analysis to definition of disjointedness</summary><div class="markup"><p>Fix #1973</p>
</div></details></div>
<div class="toot" id="created-1973"><h2>Issue #1973 created<span class="toot-id"> #created-1973</span></h2><div class="pubdate">02 May at 08:41:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1973">https://github.com/qt4cg/qtspecs/issues/1973</a></div><details><summary>Substantitively disjoint types</summary><div class="markup"><p>Section §2.3.3.1 Static Analysis Phase mentions</p>
<blockquote>
<p>A processor may raise a type error during static analysis if the inferred static type of an expression has no overlap (intersection) with the required type, and cannot be converted to the required type using the [coercion rules].</p>
</blockquote>
<p>This should cross-refer to the more precisely defined concept of types being "substantively disjoint" - see §3.4.3.</p>
</div></details></div>
<div class="toot" id="created-1972"><h2>Issue #1972 created<span class="toot-id"> #created-1972</span></h2><div class="pubdate">02 May at 08:24:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1972">https://github.com/qt4cg/qtspecs/issues/1972</a></div><details><summary>Dynamic function call applied to empty sequence</summary><div class="markup"><p>A note in F+O under map:get states</p>
<blockquote>
<p><code>map:get(map:get(map:get($map, 'employee'), 'name'), 'first')</code> can be written as <code>$map('employee')('name')('first')</code>.</p>
</blockquote>
<p>That's technically correct: both these expressions will fail in the same way if <code>$map</code> does not contain an entry for the key <code>employee</code>. Unlike the lookup expression <code>$map?employee?name?first</code> which returns an empty sequence in this situation.</p>
<p>The rules for dynamic function calls (xpath, §4.5.3.1) state that <code>$F($X)</code> raises a type error if <code>$F</code> is an empty sequence.</p>
<p>I think it would be more useful if both map:get() and dynamic function calls were changed to have "empty if empty" semantics.</p>
<p>This is related to #1240 which goes further by allowing <code>$F</code> to be a sequence of function items.</p>
</div></details></div>
<div class="toot" id="created-1971"><h2>Pull request #1971 created<span class="toot-id"> #created-1971</span></h2><div class="pubdate">01 May at 22:11:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1971">https://github.com/qt4cg/qtspecs/pull/1971</a></div><details><summary>1951 Clarifications on serialization parameters</summary><div class="markup"><p>Fix #1951</p>
</div></details></div>
<div class="toot" id="created-1970"><h2>Issue #1970 created<span class="toot-id"> #created-1970</span></h2><div class="pubdate">30 Apr at 09:08:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1970">https://github.com/qt4cg/qtspecs/issues/1970</a></div><details><summary>Editorial notes</summary><div class="markup"><h3>XQFO</h3>
<ul>
<li><code>fn:fold-right</code> has an obsolete change section saying that “The $action callback function accepts an optional position argument.”</li>
<li>“then [the] operation will fail”</li>
<li>remove whitespace before/after QName literals (#1982)</li>
<li><code>fn:unparsed-binary</code>: return type: <code>xs:base64Binary?</code></li>
</ul>
<p>(everyone: feel free to add notes, I’ll create a PR sometime later)</p>
</div></details></div>
<div class="toot" id="created-1969"><h2>Pull request #1969 created<span class="toot-id"> #created-1969</span></h2><div class="pubdate">30 Apr at 08:53:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1969">https://github.com/qt4cg/qtspecs/pull/1969</a></div><details><summary>1952 Change option name xsi-schema-location</summary><div class="markup"><p>Change to use-xsi-schema-location (because the value is a boolean, not a location)</p>
<p>Fix #1952</p>
</div></details></div>
<div class="toot" id="created-1968"><h2>Pull request #1968 created<span class="toot-id"> #created-1968</span></h2><div class="pubdate">30 Apr at 08:47:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1968">https://github.com/qt4cg/qtspecs/pull/1968</a></div><details><summary>1967 r/binary-resource/unparsed-binary/</summary><div class="markup"><p>Fix #1967</p>
</div></details></div>
<div class="toot" id="created-1967"><h2>Issue #1967 created<span class="toot-id"> #created-1967</span></h2><div class="pubdate">30 Apr at 08:27:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1967">https://github.com/qt4cg/qtspecs/issues/1967</a></div><details><summary>Example for fn:unparsed-binary uses obsolete function name</summary><div class="markup"><p>One of the examples for the new function fn:unparsed-binary uses the obsolete function name fn:binary-resource</p>
</div></details></div>
<div class="toot" id="closed-1568"><h2>Issue #1568 closed<span class="toot-id"> #closed-1568</span></h2><div class="pubdate">30 Apr at 07:34:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1568">https://github.com/qt4cg/qtspecs/issues/1568</a></div><p>Define a Unicode case-insensitive collation</p></div>
<div class="toot" id="closed-1966"><h2>Issue #1966 closed<span class="toot-id"> #closed-1966</span></h2><div class="pubdate">30 Apr at 07:34:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1966">https://github.com/qt4cg/qtspecs/pull/1966</a></div><p>1568b Add unicode case-blind collation</p></div>
<div class="toot" id="closed-1945"><h2>Issue #1945 closed<span class="toot-id"> #closed-1945</span></h2><div class="pubdate">30 Apr at 06:11:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1945">https://github.com/qt4cg/qtspecs/pull/1945</a></div><p>1568 unicode case blind collation</p></div>
<div class="toot" id="created-1966"><h2>Pull request #1966 created<span class="toot-id"> #created-1966</span></h2><div class="pubdate">30 Apr at 06:08:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1966">https://github.com/qt4cg/qtspecs/pull/1966</a></div><details><summary>1568b Add unicode case-blind collation</summary><div class="markup"><p>Replaces #1945 which was approved by the CG, but had pull conflicts because of incidental editorial changes</p>
<p>Fix #1568</p>
</div></details></div>
<div class="toot" id="created-1965"><h2>Issue #1965 created<span class="toot-id"> #created-1965</span></h2><div class="pubdate">30 Apr at 01:13:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1965">https://github.com/qt4cg/qtspecs/issues/1965</a></div><details><summary>The Generator record</summary><div class="markup"><p>This is a continuation of the original issue <strong>https://github.com/qt4cg/qtspecs/issues/716</strong>, created almost 2 years ago, and having accumulated a lot of very useful discussion.</p>
<p>Now, when we have methods that are fields of records, it became practical to produce the record type entirely in code, and <strong>this is the base for the planned PR.</strong></p>
<h2>1. What it contains</h2>
<ul>
<li>The standard record fields as originally published:</li>
</ul>
<pre><code class="language-xq">     initialized as xs:boolean,
     endReached as xs:boolean,
     getCurrent as %method fn() as item()*,
     moveNext as %method fn(*)
</code></pre>
<ul>
<li>The following 34 methods - this will form the signatures and formal definitions of the methods inside the documentation:</li>
</ul>
<pre><code class="language-xq">toArray := %method fn()
take := %method fn($n as xs:integer)
takeWhile := %method fn($pred as function(item()*) as xs:boolean)
skip := %method fn($n as xs:nonNegativeInteger)
skipWhile := %method fn($pred as function(item()*) as xs:boolean)
some := %method fn()
someWhere := %method fn($pred)
subrange := %method fn($m as xs:positiveInteger, $n as xs:integer)
chunk := %method fn($size as xs:positiveInteger)
head := %method fn()
tail := %method fn()
at := %method fn($ind as xs:nonNegativeInteger)
for-each := %method fn($fun as function(*))
for-each-pair := %method fn($gen2 as f:generator, $fun as function(*))
zip := %method fn($gen2 as f:generator)
concat := %method fn($gen2 as f:generator)
append := %method fn($value as item()*)
prepend := %method fn($value as item()*)
insertAt := %method fn($pos as xs:positiveInteger, $value as item()*)
removeAt := %method fn($pos as xs:nonNegativeInteger)
replace := %method fn($funIsMatching as function(item()*) as xs:boolean, $replacement as item()*)
reverse := %method fn()
filter := %method fn($pred as function(item()*) as xs:boolean)
fold-left := %method fn($init as item()*, $action as fn(*))
fold-right := %method fn($init as item()*, $action as fn(*))
fold-lazy := %method fn($init as item()*, $action as fn(*), $shortCircuitProvider as function(*))
scan-left := %method fn($init as item()*, $action as fn(*))
scan-right := %method fn($init as item()*, $action as fn(*))
makeGenerator := %method fn($provider as function(*))
makeGeneratorFromArray := %method fn($input as array(*))
makeGeneratorFromSequence := %method fn($input as item()*)
toSequence := %method fn()
emptyGenerator := %method fn()
</code></pre>
<ul>
<li>90 tests/examples - with calls to all the methods  - in normal and edge cases</li>
</ul>
<h2>2. Where to get the executable (with BaseX) code?</h2>
<p>For everyone's convenience, you will find the complete executable code at the end of this issue/initial-comment.
Alternatively, the code is available here: https://github.com/dnovatchev/Articles/blob/main/Generators/Code/generator.xpath</p>
<p>The latter will always contain the latest, up-to-date code.
And, of course, please execute the code with BaseX, as I have done many times:</p>
<p><img src="https://github.com/user-attachments/assets/e8d671d1-fda8-418e-a5c8-bb75e81d7a5a" alt="Image"></p>
<h2>3. What this gives us:</h2>
<ol>
<li>Working with huge collections, that would otherwise be restricted by the available memory.</li>
<li>Deferred execution.</li>
<li>Handling collections containing unknown or infinite number of members</li>
</ol>
<ul>
<li>A (next) member is produced only on request. <strong>No time is spent on producing all members of the collection</strong>.</li>
<li>A (next) member is produced only on request. <strong>No memory is consumed to store all members of the collection</strong>.</li>
</ul>
<ol start="4">
<li>Lazy evaluation - due to the above and also using the <strong><em>fold-lazy</em></strong> method (also described in <strong><em><a href="https://medium.com/@dimitrenovatchev/laziness-in-xpath-the-trouble-with-fn-fold-right-cbb1cc654d1c?sk=872244cf80bfcb52d67bcb8b359478ff">this article</a></em></strong>)</li>
<li>Implementation of the original idea about Kollection - https://github.com/qt4cg/qtspecs/issues/910 .</li>
</ol>
<h2>4. What assistance is needed</h2>
<p>I will greatly appreciate any recommendations on how to proceed with the actual PR:</p>
<ul>
<li>Can this be a single PR ?</li>
<li>If this is too-big for a single PR, then how to proceed, like splitting it to pieces?</li>
<li>Any observations and comments on the code itself.</li>
</ul>
<h2>5. References:</h2>
<ol>
<li>The original issue: <strong><em>Generators in XPath</em></strong>: https://github.com/qt4cg/qtspecs/issues/716</li>
<li>This article: <strong><em><a href="https://medium.com/@dimitrenovatchev/generators-in-xpath-987a609cfbd5?sk=6334d48f9565f78eba90b212e461243b">Generators in XPath</a></em></strong></li>
<li>The article defining fold-lazy : <strong><em><a href="https://medium.com/@dimitrenovatchev/laziness-in-xpath-the-trouble-with-fn-fold-right-cbb1cc654d1c?sk=872244cf80bfcb52d67bcb8b359478ff">"Laziness in XPath. The trouble with fn:fold-right"</a></em></strong></li>
</ol>
<h2>6. Complete, executable definition of the <strong><em>generator</em></strong> record</h2>
<pre><code class="language-xq">declare namespace f = "http://www.w3.org/2005/xpath-functions-2025";
declare record f:generator 
   ( initialized as xs:boolean,
     endReached as xs:boolean,
     getCurrent as %method fn() as item()*,
     moveNext as %method fn(*) (: as f:generator, :),
     toArray := %method fn()
     {
       while-do( [., []],
                function( $inArr) 
                { $inArr(1)?initialized and not($inArr(1)?endReached) },                 
                function($inArr) 
                { array{$inArr(1)?moveNext(), 
                        array:append($inArr(2), $inArr(1)?getCurrent())
                       } 
                 }         
       ) (2)
     },
     
     take := %method fn($n as xs:integer) 
     {
      let $gen := if(not(?initialized)) then ?moveNext()
                    else .
       return
         if($gen?endReached or $n le 0) then $gen?emptyGenerator()
          else
            let $current := $gen?getCurrent(),
                $newResultGen := map:put(., "getCurrent", %method fn(){$current}),
                $nextGen := $gen?moveNext()
             return
               if($nextGen?endReached) then $newResultGen
                 else
                   let
                       $newResultGen2 :=  map:put($newResultGen, "moveNext", %method fn() {$nextGen?take($n -1)}) 
                     return
                       $newResultGen2
      },
      
      takeWhile := %method fn($pred as function(item()*) as xs:boolean)
      {
        let $gen := if(not(?initialized)) then ?moveNext()
                      else .
         return
           if($gen?endReached) then $gen?emptyGenerator()
            else      
              let $current := $gen?getCurrent()
                return
                  if(not($pred($current))) then $gen?emptyGenerator()
                  else
                    let $newResultGen := map:put(., "getCurrent", %method fn(){$current}),
                        $nextGen := ?moveNext()
                     return
                        if($nextGen?endReached) then $newResultGen
                        else
                          let $newResultGen2 :=  map:put($newResultGen, "moveNext", %method fn() {$nextGen?takeWhile($pred)}) 
                           return $newResultGen2  
      },
     
     skipStrict := %method fn($n as xs:nonNegativeInteger, $issueErrorOnEmpty as xs:boolean) 
     {
            if($n eq 0) then .
              else if(?endReached) 
                     then if($issueErrorOnEmpty)
                           then error((), "Input Generator too-short") 
                           else ?emptyGenerator()
              else 
                let $gen := if(not(?initialized)) then ?moveNext()
                             else .
                  return
                    if(not($gen?endReached)) then $gen?moveNext()?skipStrict($n -1, $issueErrorOnEmpty)
                      else $gen?emptyGenerator()                 

     },
     skip := %method fn($n as xs:nonNegativeInteger) 
     {
       ?skipStrict($n, false())
     },
     
     skipWhile := %method fn($pred as function(item()*) as xs:boolean)
     {
        let $gen := if(not(?initialized)) then ?moveNext()
                      else .
         return
           if($gen?endReached) then $gen?emptyGenerator()
            else
              let $current := $gen?getCurrent()
               return
                 if(not($pred($current))) then $gen
                  else $gen?moveNext()?skipWhile($pred)                    
     },
     
     some := %method fn()
     {
       ?initialized and not(?endReached)
     },
     
     someWhere := %method fn($pred)
     {
       ?filter($pred)?some()
     },
     
     subrange := %method fn($m as xs:positiveInteger, $n as xs:integer)
     {
       ?skip($m - 1)?take($n - $m + 1)
     },
     
     chunk := %method fn($size as xs:positiveInteger)
     {
        let $gen := if(not(?initialized)) then ?moveNext()
                      else .
         return
           if($gen?endReached) then $gen?emptyGenerator()
           else
             let $thisChunk := $gen?take($size)?toArray(),
                 $cutGen := $gen?skip($size),
                 $resultGen := $gen =&gt; map:put("getCurrent", %method fn(){$thisChunk})
                                    =&gt; map:put("moveNext", %method fn(){$cutGen?chunk($size)})
              return $resultGen
     },
     
     head := %method fn() {?take(1)?getCurrent()},
     tail := %method fn() {?skip(1)},
     
     at := %method fn($ind as xs:nonNegativeInteger) {?subrange($ind, $ind)?getCurrent()},
           
     for-each := %method fn($fun as function(*))
     {
      let $gen := if(not(?initialized)) then ?moveNext()
                    else .        
       return
         if(?endReached) then ?emptyGenerator()
          else
           let $current := $fun(?getCurrent()),
                $newResultGen := map:put(., "getCurrent", %method fn(){$current}),
                $nextGen := ?moveNext()
            return
              if($nextGen?endReached) then $newResultGen
                else
                  let $newResultGen2 :=  map:put($newResultGen, "moveNext", %method fn() {$nextGen?for-each($fun)}) 
                     return
                       $newResultGen2                    
      },
      
      for-each-pair := %method fn($gen2 as f:generator, $fun as function(*))
      {
        let $gen := if(not(?initialized)) then ?moveNext()
                    else .,
            $gen2 := if(not($gen2?initialized)) then $gen2?moveNext()
                    else $gen2
         return
            if(?endReached or $gen2?endReached) then ?emptyGenerator() 
             else  
               let $current := $fun(?getCurrent(), $gen2?getCurrent()),
                   $newResultGen := map:put(., "getCurrent", %method fn(){$current}),
                   $nextGen1 := ?moveNext(),
                   $nextGen2 := $gen2?moveNext()
                return
                   if($nextGen1?endReached or $nextGen2?endReached) then $newResultGen
                     else
                       let $newResultGen2 := map:put($newResultGen, "moveNext", %method fn(){$nextGen1?for-each-pair($nextGen2, $fun)})
                         return
                           $newResultGen2                        
      },
      
      zip := %method fn($gen2 as f:generator)
      {
        ?for-each-pair($gen2, fn($x1, $x2){[$x1, $x2]})
      },

      concat := %method fn($gen2 as f:generator)
      {
        let $gen := if(not(?initialized)) then ?moveNext()
                    else .,
            $gen2 := if(not($gen2?initialized)) then $gen2?moveNext()
                    else $gen2,
            $resultGen := if($gen?endReached) then $gen2
                            else if($gen2?endReached) then $gen
                            else
                              $gen  =&gt; map:put(  "moveNext", 
                                                %method fn()
                                                 {
                                                 let $nextGen := $gen?moveNext()
                                                   return 
                                                     $nextGen?concat($gen2)
                                                 }
                                              )                                   
        return 
           $resultGen            
      },

      append := %method fn($value as item()*)
      {
        let $gen := if(not(?initialized)) then ?moveNext()
                    else .,
            $genSingle := $gen =&gt; map:put("getCurrent", %method fn(){$value})
                               =&gt; map:put("moveNext", %method fn(){?emptyGenerator()})
                               =&gt; map:put("endReached", false())
         return
           $gen?concat($genSingle)                    
      },
      
      prepend := %method fn($value as item()*)
      {
                let $gen := if(not(?initialized)) then ?moveNext()
                    else .,
                    $genSingle := $gen =&gt; map:put("getCurrent", %method fn(){$value})
                                       =&gt; map:put("moveNext", %method fn(){?emptyGenerator()})
         return
           $genSingle?concat($gen)  
      },
      
      insertAt := %method fn($pos as xs:positiveInteger, $value as item()*)
      {
        let $genTail := ?skipStrict($pos - 1, true())
         return
            if($pos gt 1)
              then ?take($pos - 1)?append($value)?concat($genTail)
              else $genTail?prepend($value)               
      },
      
      removeAt := %method fn($pos as xs:nonNegativeInteger)
      {
        let $genTail := ?skipStrict($pos, true())
          return
            if($pos gt 1)
              then ?take($pos - 1)?concat($genTail)
              else $genTail
      },
    
      replace := %method fn($funIsMatching as function(item()*) as xs:boolean, $replacement as item()*)
      {
        if(?endReached) then .
          else
            let $current := ?getCurrent()
              return
                if($funIsMatching($current))
                  then let $nextGen := ?moveNext()
                     return
                       . =&gt; map:put("getCurrent", %method fn() {$replacement})
                         =&gt; map:put("moveNext", %method fn() { $nextGen } 
                                  )
                  else (: $current is not the match for replacement :)
                    let $nextGen := ?moveNext()
                      return . =&gt; map:put("moveNext", 
                                           %method fn()
                                           {
                                             let $intendedReplace := function($z) {$z?replace($funIsMatching, $replacement)}
                                              return
                                                if($nextGen?endReached) then $nextGen
                                                else $intendedReplace($nextGen)
                                           }
                                        )
      },
      
      reverse := %method fn()
      {
        if(?endReached) then ?emptyGenerator()
          else
           let $current := ?getCurrent()
             return
               ?tail()?reverse()?append($current)
      },

      filter := %method fn($pred as function(item()*) as xs:boolean)
      {
             if(?initialized and ?endReached) then ?emptyGenerator()
              else
                let $getNextGoodGen := function($gen as map(*), 
                                             $pred as function(item()*) as xs:boolean)
                   {
                      if($gen?endReached) then $gen?emptyGenerator()
                      else
                        let $mapResult := 
                              while-do(
                                       $gen,
                                       function($x) { not($x?endReached) and not($pred($x?getCurrent()))},
                                       function($x) { $x?moveNext() }
                                       )   
                        return 
                          if($mapResult?endReached) then $gen?emptyGenerator()
                           else $mapResult                  
                   },
                   
                   $gen := if(?initialized) then . 
                             else ?moveNext(),
                   $nextGoodGen := $getNextGoodGen($gen, $pred)
                return
                  if($nextGoodGen?endReached) then $gen?emptyGenerator()
                  else
                    $nextGoodGen =&gt; map:put("moveNext", 
                                            %method fn() 
                                              {
                                                let $nextGoodGen := $getNextGoodGen(?inputGen?moveNext(), $pred)
                                                  return
                                                    if($nextGoodGen?endReached) then $nextGoodGen?emptyGenerator()
                                                    else
                                                      map:put(map:put($nextGoodGen, "moveNext", %method fn() {$nextGoodGen?moveNext()?filter($pred)}),
                                                                      "inputGen", $nextGoodGen
                                                              )
                                               }
                                           )
                                   =&gt;
                                     map:put("inputGen", $nextGoodGen)
        },     
        fold-left := %method fn($init as item()*, $action as fn(*))
        {
          if(?endReached) then $init
            else ?tail()?fold-left($action($init, ?getCurrent()), $action)
        },
        
        fold-right := %method fn($init as item()*, $action as fn(*))
        {
          if(?endReached) then $init
            else $action(?head(), ?tail()?fold-right($init, $action))
        },
        
        fold-lazy := %method fn($init as item()*, $action as fn(*), $shortCircuitProvider as function(*))
        {
          if(?endReached) then $init
          else
           let $current := ?getCurrent()
             return
               if(function-arity($shortCircuitProvider($current, $init)) eq 0)
                 then $shortCircuitProvider($current, $init)()
                 else $action($current, ?moveNext()?fold-lazy($init, $action, $shortCircuitProvider))
        },
        
        scan-left := %method fn($init as item()*, $action as fn(*))
        {
          let $resultGen := ?emptyGenerator() 
                                =&gt; map:put("endReached", false())
                                =&gt; map:put("getCurrent", %method fn(){$init})
           return
             if(?endReached) 
               then $resultGen =&gt; map:put("moveNext", %method fn(){?emptyGenerator()})
               else
                 let $resultGen := $resultGen =&gt; map:put("getCurrent", %method fn(){$init}),
                     $partialFoldResult := $action($init, ?getCurrent())
                   return
                     let $nextGen := ?moveNext()
                      return
                        $resultGen =&gt; map:put("moveNext", %method fn()
                                              { 
                                                  $nextGen?scan-left($partialFoldResult, $action)
                                               }
                                              )            
        },
      
        scan-right := %method fn($init as item()*, $action as fn(*))
        {
          ?reverse()?scan-left($init, $action)?reverse()                         
        },
        
        makeGenerator := %method fn($provider as function(*))
        {
         let $gen := if(not(?initialized)) then ?moveNext()
                    else .,
              $nextDataItemGetter := $provider(0),
              $nextGen := if(not($nextDataItemGetter instance of function(*))) then $gen?emptyGenerator()  
                           else $gen?emptyGenerator()
                            =&gt; map:put("numDataItems", 1)
                            =&gt; map:put("current", $nextDataItemGetter())
                            =&gt; map:put("endReached", false())
                            =&gt; map:put("getCurrent", %method fn() {?current})
                            =&gt; map:put("moveNext",  
                                       %method fn() 
                                        {
                                          let $nextDataItemGetter := $provider(?numDataItems)
                                            return
                                              if(not($nextDataItemGetter instance of function(*))) then ?emptyGenerator()
                                              else
                                                . =&gt; map:put("current", $nextDataItemGetter())
                                                  =&gt; map:put("numDataItems", ?numDataItems + 1)
                                        }
                                       )
           return $nextGen                                                  
        },
        
        makeGeneratorFromArray := %method fn($input as array(*))
        {
          let $size := array:size($input),
              $arrayProvider := fn($ind as xs:integer)
                                {
                                  if($ind +1 gt $size) then -1
                                   else fn(){$input($ind + 1)}
                                }
           return ?makeGenerator($arrayProvider)
        },
        
        makeGeneratorFromSequence := %method fn($input as item()*)
        {
          let $size := count($input),
              $seqProvider := fn($ind as xs:integer)
                                {
                                  if($ind +1 gt $size) then -1
                                   else fn(){$input[$ind + 1]}
                                }
           return ?makeGenerator($seqProvider)
        },
        
        toSequence := %method fn() {?toArray() =&gt; array:items()},     
        
        emptyGenerator := %method fn() 
        {
          . =&gt; map:put("initialized", true()) =&gt; map:put("endReached", true())
            =&gt; map:put("getCurrent", %method fn() {error((),"getCurrent() called on an emptyGenerator")})
            =&gt; map:put("moveNext", %method fn() {error((),"moveNext() called on an emptyGenerator")})
        },      
     *
   );

let $gen2ToInf := f:generator(initialized := true(), endReached := false(), 
                              getCurrent := %method fn(){?last +1},
                              moveNext := %method fn()
                              {
                                if(not(?initialized))
                                  then map:put(., "inittialized", true())
                                  else map:put(., "last", ?last + 1)
                              },
                              options := {"last" : 1}
                             ),
    $double := fn($n) {2*$n},
    $sum2 := fn($m, $n) {$m + $n},
    $product := fn($m, $n) {$m * $n}
  return    
  (
    "$gen2ToInf?take(3)?toArray()",
    $gen2ToInf?take(3)?toArray(),
    "================",    
    "$gen2ToInf?take(3)?skip(2)?getCurrent()",
    $gen2ToInf?take(3)?skip(2)?getCurrent(),
    (: $gen2ToInf?take(3)?moveNext()?moveNext()?moveNext()?getCurrent(), :)
    "================",
    "$gen2ToInf?getCurrent()",
    $gen2ToInf?getCurrent(),
    "$gen2ToInf?moveNext()?getCurrent()",
    $gen2ToInf?moveNext()?getCurrent(),
    "================",
    "$gen2ToInf?take(5) instance of f:generator",
    $gen2ToInf?take(5) instance of f:generator,
    "==&gt;  $gen2ToInf?skip(7) instance of f:generator",
    $gen2ToInf?skip(7) instance of f:generator,  
    "================",
    "$gen2ToInf?subrange(4, 6)?getCurrent()",
    $gen2ToInf?subrange(4, 6)?getCurrent(), 
    "$gen2ToInf?subrange(4, 6)?moveNext()?getCurrent()",
    $gen2ToInf?subrange(4, 6)?moveNext()?getCurrent(),
    "$gen2ToInf?subrange(4, 6)?moveNext()?moveNext()?getCurrent()",
    $gen2ToInf?subrange(4, 6)?moveNext()?moveNext()?getCurrent(),
    (: $gen2ToInf?subrange(4, 6)?moveNext()?moveNext()?moveNext()?getCurrent() :) (: Must raise error:)    
    "================",    
    "$gen2ToInf?subrange(4, 6)?head()",
    $gen2ToInf?subrange(4, 6)?head(),  
    "$gen2ToInf?subrange(4, 6)?tail()?head()",
    $gen2ToInf?subrange(4, 6)?tail()?head(),
    "$gen2ToInf?subrange(4, 6)?toArray()",
    $gen2ToInf?subrange(4, 6)?toArray(),
    "$gen2ToInf?head()",
    $gen2ToInf?head(),
    "==&gt;  $gen2ToInf?tail()?head()",
    $gen2ToInf?tail()?head(),
    "================", 
    "$gen2ToInf?subrange(4, 6)?tail()?toArray()",
    $gen2ToInf?subrange(4, 6)?tail()?toArray(),
    "================",
    "$gen2ToInf?at(5)",
    $gen2ToInf?at(5), 
    "================",
    "$gen2ToInf?subrange(1, 5)?toArray()",
    $gen2ToInf?subrange(1, 5)?toArray(),
    "$gen2ToInf?subrange(1, 5)?for-each($double)?toArray()",
    $gen2ToInf?subrange(1, 5)?for-each($double)?toArray(),
    "$gen2ToInf?take(5)?for-each($double)?toArray()",
    $gen2ToInf?take(5)?for-each($double)?toArray(),
    "==&gt;  $gen2ToInf?for-each($double)?take(5)?toArray()",
    $gen2ToInf?for-each($double)?take(5)?toArray(),
    "================",
    "$gen2ToInf?subrange(1, 5)?toArray()",
    $gen2ToInf?subrange(1, 5)?toArray(),
    "$gen2ToInf?subrange(6, 10)?toArray()",
    $gen2ToInf?subrange(6, 10)?toArray(),
    "$gen2ToInf?subrange(1, 5)?for-each-pair($gen2ToInf?subrange(6, 10), $sum2)?toArray()",
    $gen2ToInf?subrange(1, 5)?for-each-pair($gen2ToInf?subrange(6, 10), $sum2)?toArray(), 
    "==&gt;  $gen2ToInf?for-each-pair($gen2ToInf, $sum2)?take(5)?toArray()",
    $gen2ToInf?for-each-pair($gen2ToInf, $sum2)?take(5)?toArray(),
    "================",
    "==&gt;  $gen2ToInf?filter(fn($n){$n mod 2 eq 1})?getCurrent()",
    $gen2ToInf?filter(fn($n){$n mod 2 eq 1})?getCurrent(),
    "$gen2ToInf?filter(fn($n){$n mod 2 eq 1})?moveNext()?getCurrent()",
    $gen2ToInf?filter(fn($n){$n mod 2 eq 1})?moveNext()?getCurrent(),
    "================", 
    "$gen2ToInf?filter(fn($n){$n mod 2 eq 1})?take(10)?toArray()",
    $gen2ToInf?filter(fn($n){$n mod 2 eq 1})?take(10)?toArray(),  
    "================", 
    "$gen2ToInf?filter(fn($n){$n mod 2 eq 1})?take(10)?toSequence()",
    $gen2ToInf?filter(fn($n){$n mod 2 eq 1})?take(10)?toSequence(),
    "================", 
    "$gen2ToInf?takeWhile(fn($n){$n &lt; 11})?toArray()",
    $gen2ToInf?takeWhile(fn($n){$n &lt; 11})?toArray(), 
    "$gen2ToInf?takeWhile(fn($n){$n &lt; 2})?toArray()",
    $gen2ToInf?takeWhile(fn($n){$n &lt; 2})?toArray(), 
    "================", 
    "$gen2ToInf?skipWhile(fn($n){$n &lt; 11})?take(5)?toArray()",
    $gen2ToInf?skipWhile(fn($n){$n &lt; 11})?take(5)?toArray(),
    "==&gt; $gen2ToInf?skipWhile(fn($n){$n &lt; 2})",
    $gen2ToInf?skipWhile(fn($n){$n &lt; 2}),
    "
     ==&gt; $gen2ToInf?skipWhile(fn($n){$n &lt; 2})?skip(1)",
    $gen2ToInf?skipWhile(fn($n){$n &lt; 2})?skip(1),
(:    $gen2ToInf?skipWhile(fn($x) {$x ge 2}) :) (: ?skip(1) :)
    "================", 
    "$gen2ToInf?some()",
     $gen2ToInf?some(),
     "let $empty := $gen2ToInf?emptyGenerator()
      return $empty?some()",
     let $empty := $gen2ToInf?emptyGenerator()
      return $empty?some(),
    "================",
    "$gen2ToInf?take(5)?filter(fn($n){$n ge 7})?some()",
     $gen2ToInf?take(5)?filter(fn($n){$n ge 7})?some(),  
     "$gen2ToInf?take(5)?someWhere(fn($n){$n ge 7})",
     $gen2ToInf?take(5)?someWhere(fn($n){$n ge 7}), 
     "$gen2ToInf?take(5)?someWhere(fn($n){$n ge 6})",
     $gen2ToInf?take(5)?someWhere(fn($n){$n ge 6}),
     "$gen2ToInf?someWhere(fn($n){$n ge 100})",
     $gen2ToInf?someWhere(fn($n){$n ge 100}),
     "================",
     "$gen2ToInf?take(10)?take(11)?toArray()",
     $gen2ToInf?take(10)?take(11)?toArray(),
     "$gen2ToInf?take(10)?skip(10)?toArray()",
     $gen2ToInf?take(10)?skip(10)?toArray(),
     "$gen2ToInf?take(10)?skip(9)?toArray()",     
     $gen2ToInf?take(10)?skip(9)?toArray(),
     "$gen2ToInf?take(10)?subrange(3, 12)?toArray()",
     $gen2ToInf?take(10)?subrange(3, 12)?toArray(),
     "$gen2ToInf?take(10)?subrange(5, 3)?toArray()",
     $gen2ToInf?take(10)?subrange(5, 3)?toArray(),
     "================",
     "$gen2ToInf?take(100)?chunk(20)?getCurrent()",
      $gen2ToInf?take(100)?chunk(20)?getCurrent(),
      "==&gt;  $gen2ToInf?chunk(20)?take(5)?toArray()",
      $gen2ToInf?chunk(20)?take(5)?toArray(),
     "================",
     "$gen2ToInf?take(100)?chunk(20)?moveNext()?getCurrent()",
      $gen2ToInf?take(100)?chunk(20)?moveNext()?getCurrent(),
     "$gen2ToInf?take(100)?chunk(20)?moveNext()?moveNext()?getCurrent()", 
      $gen2ToInf?take(100)?chunk(20)?moveNext()?moveNext()?getCurrent(),
     "$gen2ToInf?take(100)?chunk(20)?skip(1)?getCurrent()",      
      $gen2ToInf?take(100)?chunk(20)?skip(1)?getCurrent(),
     "================",      
     "$gen2ToInf?take(100)?chunk(20)?for-each(fn($genX){$genX})?toArray()",      
      $gen2ToInf?take(100)?chunk(20)?for-each(fn($genX){$genX})?toArray(),
     "================",  
     "$gen2ToInf?take(10)?chunk(4)?toArray()",
      $gen2ToInf?take(10)?chunk(4)?toArray(),
      "$gen2ToInf?take(10)?chunk(4)?for-each(fn($arr){array:size($arr)})?toArray()",
      $gen2ToInf?take(10)?chunk(4)?for-each(fn($arr){array:size($arr)})?toArray(),
     "================", 
     "$gen2ToInf?subrange(10, 15)?concat($gen2ToInf?subrange(1, 9))?toArray()",
     $gen2ToInf?subrange(10, 15)?concat($gen2ToInf?subrange(1, 9))?toArray(),
     "================", 
     "$gen2ToInf?subrange(1, 5)?append(101)?toArray()",
     $gen2ToInf?subrange(1, 5)?append(101)?toArray(),
     "$gen2ToInf?subrange(1, 5)?prepend(101)?toArray()",
     $gen2ToInf?subrange(1, 5)?prepend(101)?toArray(),
     "==&gt;  $gen2ToInf?append(101)",
     $gen2ToInf?append(101),
     "$gen2ToInf?prepend(101)?take(5)?toArray()",
     $gen2ToInf?prepend(101)?take(5)?toArray(),
     "================", 
     "$gen2ToInf?subrange(1, 5)?zip($gen2ToInf?subrange(6, 10))?toArray()",
     $gen2ToInf?subrange(1, 5)?zip($gen2ToInf?subrange(6, 10))?toArray(),
     "$gen2ToInf?subrange(1, 5)?zip($gen2ToInf?subrange(10, 20))?toArray()",
     $gen2ToInf?subrange(1, 5)?zip($gen2ToInf?subrange(10, 20))?toArray(),
     "==&gt;  $gen2ToInf?zip($gen2ToInf?skip(5))?take(10)?toArray()",
     $gen2ToInf?zip($gen2ToInf?skip(5))?take(10)?toArray(),
     "================", 
     "$gen2ToInf?makeGenerator(fn($numGenerated as xs:integer)
                                 {if($numGenerated le 9) then fn() {$numGenerated + 1} else -1} 
                             )?toArray()",
     $gen2ToInf?makeGenerator(fn($numGenerated as xs:integer)
                                 {if($numGenerated le 9) then fn() {$numGenerated + 1} else -1} 
                             )?toArray(),
     "================", 
     "$gen2ToInf?makeGeneratorFromArray([1, 4, 9, 16, 25])?toArray()",
      $gen2ToInf?makeGeneratorFromArray([1, 4, 9, 16, 25])?toArray(),
      "$gen2ToInf?makeGeneratorFromSequence((1, 8, 27, 64, 125))?toArray()",
      $gen2ToInf?makeGeneratorFromSequence((1, 8, 27, 64, 125))?toArray(), 
     "================", 
     "$gen2ToInf?take(10)?insertAt(3, ""XYZ"")?toArray()",
      $gen2ToInf?take(10)?insertAt(3, "XYZ")?toArray(),
      "$gen2ToInf?take(10)?insertAt(1, ""ABC"")?toArray()",
      $gen2ToInf?take(10)?insertAt(1, "ABC")?toArray(),
      "$gen2ToInf?take(10)?insertAt(11, ""PQR"")?toArray()",
      $gen2ToInf?take(10)?insertAt(11, "PQR")?toArray(),
      "==&gt;  $gen2ToInf?insertAt(3, ""XYZ"")?take(10)?toArray()", 
      $gen2ToInf?insertAt(3, "XYZ")?take(10)?toArray(),
     (: , $gen2ToInf?take(10)?insertAt(12, "GHI")?toArray() :)  (:  Must raise error "Input Generator too-short." :) 
     "================", 
     "$gen2ToInf?take(10)?removeAt(3)?toArray()",
      $gen2ToInf?take(10)?removeAt(3)?toArray(),
      "$gen2ToInf?take(10)?removeAt(1)?toArray()",
      $gen2ToInf?take(10)?removeAt(1)?toArray(),
      "$gen2ToInf?take(10)?removeAt(10)?toArray()",
      $gen2ToInf?take(10)?removeAt(10)?toArray(),
      "==&gt;  $gen2ToInf?removeAt(3)?take(10)?toArray()",
      $gen2ToInf?removeAt(3)?take(10)?toArray(),
      (: , $gen2ToInf?take(10)?removeAt(11)?toArray() :)        (:  Must raise error "Input Generator too-short." :) 
     "================",
     "$gen2ToInf?take(10)?replace(fn($x){$x gt 4}, ""Replacement"")?toArray()",
      $gen2ToInf?take(10)?replace(fn($x){$x gt 4}, "Replacement")?toArray(),
      "$gen2ToInf?take(10)?replace(fn($x){$x lt 3}, ""Replacement"")?toArray()",
      $gen2ToInf?take(10)?replace(fn($x){$x lt 3}, "Replacement")?toArray(),
      "$gen2ToInf?take(10)?replace(fn($x){$x gt 10}, ""Replacement"")?toArray()",
      $gen2ToInf?take(10)?replace(fn($x){$x gt 10}, "Replacement")?toArray(),
      "$gen2ToInf?take(10)?replace(fn($x){$x gt 11}, ""Replacement"")?toArray()",
      $gen2ToInf?take(10)?replace(fn($x){$x gt 11}, "Replacement")?toArray(),
      "$gen2ToInf?take(10)?replace(fn($x){$x lt 2}, ""Replacement"")?toArray()",
      $gen2ToInf?take(10)?replace(fn($x){$x lt 2}, "Replacement")?toArray(),
      "==&gt; $gen2ToInf?replace(fn($x){$x gt 4}, ""Replacement"")?take(10)?toArray()",
      $gen2ToInf?replace(fn($x){$x gt 4}, "Replacement")?take(10)?toArray(),
      "$gen2ToInf?replace(fn($x){$x lt 3}, ""Replacement"")?take(10)?toArray()",
      $gen2ToInf?replace(fn($x){$x lt 3}, "Replacement")?take(10)?toArray(),
    (:  
      Will result in endless loop:
      
      , "==&gt;  ==&gt;  ==&gt;  $gen2ToInf?replace(fn($x){$x lt 2}, ""Replacement"")?take(10)?toArray() &lt;==  &lt;==  &lt;==",
      $gen2ToInf?replace2(fn($x){$x lt 2}, "Replacement")?take(10)?toArray() 
    :)
    "================",
    "$gen2ToInf?emptyGenerator()?reverse()?toArray()",
    $gen2ToInf?emptyGenerator()?reverse()?toArray(),
    "$gen2ToInf?emptyGenerator()?append(2)?reverse()?toArray()",
    $gen2ToInf?emptyGenerator()?append(2)?reverse()?toArray(),
    "$gen2ToInf?take(10)?reverse()?toArray()",
    $gen2ToInf?take(10)?reverse()?toArray(),
    "================",
    "$gen2ToInf?take(5)?fold-left(0, fn($x, $y){$x + $y})",
    $gen2ToInf?take(5)?fold-left(0, fn($x, $y){$x + $y}),
    "================",
    "$gen2ToInf?take(5)?fold-right(0, fn($x, $y){$x + $y})",
    $gen2ToInf?take(5)?fold-right(0, fn($x, $y){$x + $y}),
    "================",
    "$gen2ToInf?emptyGenerator()?scan-left(0, fn($x, $y){$x + $y})?toArray()",
    $gen2ToInf?emptyGenerator()?scan-left(0, fn($x, $y){$x + $y})?toArray(),
    "$gen2ToInf?take(5)?scan-left(0, fn($x, $y){$x + $y})?toArray()",
    $gen2ToInf?take(5)?scan-left(0, fn($x, $y){$x + $y})?toArray(),
    "================",
    "$gen2ToInf?makeGeneratorFromSequence((1 to 10))?scan-right(0, fn($x, $y){$x + $y})?toArray()",
    $gen2ToInf?makeGeneratorFromSequence((1 to 10))?scan-right(0, fn($x, $y){$x + $y})?toArray(),
    "================",
    let $multShortCircuitProvider := fn($x, $y)
        {
          if($x eq 0) then fn(){0}
            else fn($z) {$x * $z}
        },
        $gen-5ToInf := $gen2ToInf?for-each(fn($n){$n -7})
     return
     (
       "let $multShortCircuitProvider := fn($x, $y)
        {
          if($x eq 0) then fn(){0}
            else fn($z) {$x * $z}
        },
            $gen-5ToInf := $gen2ToInf?for-each(fn($n){$n -7})
          return
            $gen2ToInf?take(5)?fold-lazy(1, $product, $multShortCircuitProvider),
            $gen-5ToInf?fold-lazy(1, $product, $multShortCircuitProvider)",
       $gen2ToInf?take(5)?fold-lazy(1, $product, $multShortCircuitProvider),
       $gen-5ToInf?fold-lazy(1, $product, $multShortCircuitProvider)
     )
   )
</code></pre>
</div></details></div>
<div class="toot" id="closed-1954"><h2>Issue #1954 closed<span class="toot-id"> #closed-1954</span></h2><div class="pubdate">29 Apr at 20:43:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1954">https://github.com/qt4cg/qtspecs/issues/1954</a></div><p>Private fields in records</p></div>
<div class="toot" id="created-1964"><h2>Pull request #1964 created<span class="toot-id"> #created-1964</span></h2><div class="pubdate">29 Apr at 20:39:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1964">https://github.com/qt4cg/qtspecs/pull/1964</a></div><details><summary>1957 xsl output allows mixed content</summary><div class="markup"><p>Change to schema-for-xslt40</p>
<p>Fix #1957 (xsl:output disallow mixed content)</p>
<p>Add support for xsl:import-schema/@role</p>
</div></details></div>
<div class="toot" id="minutes—04-29"><h2>QT4 CG meeting 119 draft minutes<span class="toot-id"> #minutes—04-29</span></h2><div class="pubdate">29 Apr at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/04-29">https://qt4cg.org/meeting/minutes/2025/04-29</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1961"><h2>Issue #1961 closed<span class="toot-id"> #closed-1961</span></h2><div class="pubdate">29 Apr at 16:20:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1961">https://github.com/qt4cg/qtspecs/pull/1961</a></div><p>Attempt to show that xsl:record allows extra attributes</p></div>
<div class="toot" id="closed-1956"><h2>Issue #1956 closed<span class="toot-id"> #closed-1956</span></h2><div class="pubdate">29 Apr at 16:17:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1956">https://github.com/qt4cg/qtspecs/pull/1956</a></div><p>1954 (part) Private variables and functions don't need to be in the module namespace</p></div>
<div class="toot" id="closed-1271"><h2>Issue #1271 closed<span class="toot-id"> #closed-1271</span></h2><div class="pubdate">29 Apr at 16:15:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1271">https://github.com/qt4cg/qtspecs/issues/1271</a></div><p>Schema validation in XPath</p></div>
<div class="toot" id="closed-1933"><h2>Issue #1933 closed<span class="toot-id"> #closed-1933</span></h2><div class="pubdate">29 Apr at 16:15:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1933">https://github.com/qt4cg/qtspecs/pull/1933</a></div><p>1271 fn:xsd-validator() function</p></div>
<div class="toot" id="closed-557"><h2>Issue #557 closed<span class="toot-id"> #closed-557</span></h2><div class="pubdate">29 Apr at 16:12:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/557">https://github.com/qt4cg/qtspecs/issues/557</a></div><p>fn:unparsed-binary: accessing and manipulating binary types</p></div>
<div class="toot" id="closed-1587"><h2>Issue #1587 closed<span class="toot-id"> #closed-1587</span></h2><div class="pubdate">29 Apr at 16:12:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1587">https://github.com/qt4cg/qtspecs/pull/1587</a></div><p>557 Add fn:unparsed-binary function</p></div>
<div class="toot" id="closed-1319"><h2>Issue #1319 closed<span class="toot-id"> #closed-1319</span></h2><div class="pubdate">29 Apr at 16:10:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1319">https://github.com/qt4cg/qtspecs/issues/1319</a></div><p>Specification Documents: Editors and Contributors</p></div>
<div class="toot" id="closed-1416"><h2>Issue #1416 closed<span class="toot-id"> #closed-1416</span></h2><div class="pubdate">29 Apr at 16:10:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1416">https://github.com/qt4cg/qtspecs/issues/1416</a></div><p>Key-value pairs: built-in record type `pair`</p></div>
<div class="toot" id="closed-1844"><h2>Issue #1844 closed<span class="toot-id"> #closed-1844</span></h2><div class="pubdate">29 Apr at 16:10:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1844">https://github.com/qt4cg/qtspecs/issues/1844</a></div><p>Drop mapping arrow operator</p></div>
<div class="toot" id="closed-1704"><h2>Issue #1704 closed<span class="toot-id"> #closed-1704</span></h2><div class="pubdate">29 Apr at 16:09:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1704">https://github.com/qt4cg/qtspecs/issues/1704</a></div><p>Ignore the byte order mark more completely/globally</p></div>
<div class="toot" id="closed-1950"><h2>Issue #1950 closed<span class="toot-id"> #closed-1950</span></h2><div class="pubdate">29 Apr at 16:09:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1950">https://github.com/qt4cg/qtspecs/pull/1950</a></div><p>1704 Add rules/notes for BOM and related topics</p></div>
<div class="toot" id="closed-1906"><h2>Issue #1906 closed<span class="toot-id"> #closed-1906</span></h2><div class="pubdate">29 Apr at 16:05:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1906">https://github.com/qt4cg/qtspecs/pull/1906</a></div><p>1797 elements-to-maps-conversion-plan function</p></div>
<div class="toot" id="created-1963"><h2>Pull request #1963 created<span class="toot-id"> #created-1963</span></h2><div class="pubdate">29 Apr at 14:10:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1963">https://github.com/qt4cg/qtspecs/pull/1963</a></div><details><summary>1958 Fix simple typo in map:build</summary><div class="markup"><p>Fix #1958</p>
</div></details></div>
<div class="toot" id="created-1962"><h2>Issue #1962 created<span class="toot-id"> #created-1962</span></h2><div class="pubdate">26 Apr at 11:05:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1962">https://github.com/qt4cg/qtspecs/issues/1962</a></div><details><summary>fn:map-to-element</summary><div class="markup"><p>As this feature request has been reported back to us more than once, I want to raise the question here if we want to introduce a function that inverts the result of <code>fn:map-to-element</code> back to an XML representation – provided that a conversion plan exists.</p>
<p>Many results would certainly be lossy, but as the plan is now available separately, it would be possible to roundtrip a lot of data with regular structures, without having to write custom conversion code.</p>
</div></details></div>
<div class="toot" id="created-1961"><h2>Pull request #1961 created<span class="toot-id"> #created-1961</span></h2><div class="pubdate">25 Apr at 11:26:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1961">https://github.com/qt4cg/qtspecs/pull/1961</a></div><details><summary>Attempt to show that xsl:record allows extra attributes</summary><div class="markup"><p>By the simple expedient of adding</p>
<pre><code class="language-xml">&lt;e:attribute name="*" required="yes"&gt;
   &lt;e:data-type name="expression"/&gt;
&lt;/e:attribute&gt;
</code></pre>
<p>to the syntax summary we get</p>
<p><img src="https://github.com/user-attachments/assets/0eaab6d7-9b0e-4b67-92e2-fd3cd6d6ce9e" alt="Screenshot 2025-04-25 at 12-25-57 XSL Transformations (XSLT) Version 4 0"></p>
<p>With some additional prose, would that be sufficient?</p>
</div></details></div>
<div class="toot" id="closed-1960"><h2>Issue #1960 closed<span class="toot-id"> #closed-1960</span></h2><div class="pubdate">25 Apr at 08:59:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1960">https://github.com/qt4cg/qtspecs/pull/1960</a></div><p>Attempt to improve rendering of the dynamic ToC</p></div>
<div class="toot" id="created-1960"><h2>Pull request #1960 created<span class="toot-id"> #created-1960</span></h2><div class="pubdate">25 Apr at 08:58:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1960">https://github.com/qt4cg/qtspecs/pull/1960</a></div><details><summary>Attempt to improve rendering of the dynamic ToC</summary><div class="markup"><p>This is an attempt to complete action QT4CG-116-03.</p>
<p>Part of the confusion in the rendering is that it’s partly done by CSS and partly done by JavaScript and those had gotten out of sync. Given that the JavaScript code has to do some of the work, I changed things so it does all of the work.</p>
<p>I also discovered that the weird Firefox bug where the font size changed was, wait for it, caused by the particular codepoint being used for “changed”. So I, uh, changed it.</p>
<p>We now get ✚ for new sections, ✭ for changed sections, and both when there are both new and changed sections. I spent a bit of time trying to find a third symbol, but gave up.</p>
<p>The markup in the XSLT specification isn’t quite the same as in other specifications, so the results are a tiny bit odd in places. There are some sections that get marked “both” in the ToC but when you expand the ToC, there’s only one mark. I haven’t tried to work out what’s going on there yet.</p>
</div></details></div>
<div class="toot" id="created-1959"><h2>Pull request #1959 created<span class="toot-id"> #created-1959</span></h2><div class="pubdate">24 Apr at 15:49:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1959">https://github.com/qt4cg/qtspecs/pull/1959</a></div><details><summary>1953 (part) XSLT Worked example using methods to implement atomic sets</summary><div class="markup"><p>Provides an XSLT package that uses named record types and methods to implement an atomic set data type, as an example of how abstract data types can now be implemented.</p>
</div></details></div>
<div class="toot" id="created-1958"><h2>Issue #1958 created<span class="toot-id"> #created-1958</span></h2><div class="pubdate">24 Apr at 14:41:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1958">https://github.com/qt4cg/qtspecs/issues/1958</a></div><details><summary>Typo in map:build</summary><div class="markup"><blockquote>
<p>If the key is already present, the processor combines the new value
for the key with the existing value as determined by <strong>the and duplicates</strong> option.</p>
</blockquote>
</div></details></div>
<div class="toot" id="created-1957"><h2>Issue #1957 created<span class="toot-id"> #created-1957</span></h2><div class="pubdate">24 Apr at 11:58:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1957">https://github.com/qt4cg/qtspecs/issues/1957</a></div><details><summary>Schema for XSLT incorrectly allows mixed content for xsl:output</summary><div class="markup"><p>The declaration (line 1412) says mixed="true".</p>
</div></details></div>
<div class="toot" id="created-1956"><h2>Pull request #1956 created<span class="toot-id"> #created-1956</span></h2><div class="pubdate">24 Apr at 11:34:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1956">https://github.com/qt4cg/qtspecs/pull/1956</a></div><details><summary>1954 (part) Private variables and functions don't need to be in the module namespace</summary><div class="markup"><p>See issue #1954</p>
<p>The PR removes the requirement for private variables and functions declared in library modules to be in the module namespace. There has never been any sensible reason for this restriction.</p>
<p>The restriction is retained for public variables and functions; one could argue that it is unnecessary in that case also, but it does no harm and enforces good coding discipline.</p>
</div></details></div>
<div class="toot" id="created-1955"><h2>Issue #1955 created<span class="toot-id"> #created-1955</span></h2><div class="pubdate">24 Apr at 09:58:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1955">https://github.com/qt4cg/qtspecs/issues/1955</a></div><details><summary>fn:doc, fn:parse-xml: entity expansion</summary><div class="markup"><p>The current rule for the <code>entity-expansion-limit</code> option is:</p>
<blockquote>
<p>The processor should impose a limit on the number of entity references that are expanded, or on the size of the expanded entities, depending on the options available in the underlying XML parser; the limit should be commensurate with the value requested, but the precise effect may be . <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#implementation-dependent">implementation-dependent</a>. If the XML parser does not offer the ability to impose a limit, or if the value is zero, then entity expansion should if possible be disabled entirely, leading to a dynamic error if the input contains any entity references. A negative value should be interpreted as placing no limits on entity expansion.</p>
</blockquote>
<p>By default, Java uses 64000 as limit. An explicit value less than or equal to 0 indicates no limit (https://docs.oracle.com/javase/tutorial/jaxp/limits/limits.html, https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/module-summary.html). I don’t know about other languages.</p>
<p>I would like to…</p>
<ol>
<li>change the option to an <code>expand-entities</code> Boolean, or</li>
<li>change the rules and make <code>0</code> disable the limit.</li>
</ol>
<p>Any favorites?</p>
</div></details></div>
<div class="toot" id="created-1954"><h2>Issue #1954 created<span class="toot-id"> #created-1954</span></h2><div class="pubdate">24 Apr at 09:39:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1954">https://github.com/qt4cg/qtspecs/issues/1954</a></div><details><summary>Private fields in records</summary><div class="markup"><p>It would be nice to have some way of indicating that some of the fields in a record are (in some sense) private, intended for internal use.</p>
<p>I'm not proposing full encapsulation - the instances of a record type are maps, and can be manipulated by functions such as map:keys(), map:get(), and map:put() which expose all the keys.</p>
<p>Rather I'm proposing a convention that makes it difficult to access the fields "accidentally" using lookup expressions: a bit like naming the fields using a leading underscore, but something a bit stronger. Analogous to reflection in Java, which allows you to break encapsulation with a bit of effort.</p>
<p>I'd suggest making the keys for these "private" fields QNames rather than strings:</p>
<ul>
<li>In the record declaration, we allow a field name to be a QName rather than a string: record(private:data as item()*, long, lat).</li>
<li>QNames can't be used directly in a lookup; to access the field, you need to know what namespace "private" is bound to, which doesn't need to be published information (though it is of course discoverable)</li>
<li>Internally the implementor of this interface can bind a QName to a private variable and use this:</li>
</ul>
<p><code>declare %private variable $private:data as xs:QName('http://my.private.namespace/', 'data')</code></p>
<p>and then access it using <code>$record?$private:data</code></p>
</div></details></div>
<div class="toot" id="created-1953"><h2>Issue #1953 created<span class="toot-id"> #created-1953</span></h2><div class="pubdate">24 Apr at 09:19:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1953">https://github.com/qt4cg/qtspecs/issues/1953</a></div><details><summary>Make generation of constructor function for named record types optional</summary><div class="markup"><p>I propose that when a named record type is declared in XQuery or XSLT, the generation of a constructor function should be optional.</p>
<p>Perhaps in XQuery it should only happen if there is an annotation <code>%constructor</code>, and in XSLT if there is an attribute <code>constructor="yes"</code>. I think it's better for the default to be "no constructor" because it's better to make the existence of a constructor explicitly visible.</p>
<p>There are cases where you don't want a system-generated constructor primarily because you want to provide your own constructor which perhaps accepts the data in a slightly different form, or perhaps imposes constraints like cross-validation of supplied arguments.</p>
</div></details></div>
<div class="toot" id="created-1952"><h2>Issue #1952 created<span class="toot-id"> #created-1952</span></h2><div class="pubdate">23 Apr at 21:47:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1952">https://github.com/qt4cg/qtspecs/issues/1952</a></div><details><summary>Change option name from xsi-schema-location to use-xsi-schema-location</summary><div class="markup"><p>Functions (such as fn:doc and fn:parse-xml) that have a boolean option <code>xsi-schema-location</code> should change this to <code>use-xsi-schema-location</code> to make it clearer that the expected value is a boolean and not a schema location.</p>
<p>(Comment made in passing at the last meeting).</p>
</div></details></div>
<div class="toot" id="created-1951"><h2>Issue #1951 created<span class="toot-id"> #created-1951</span></h2><div class="pubdate">23 Apr at 15:54:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1951">https://github.com/qt4cg/qtspecs/issues/1951</a></div><details><summary>Some nits regarding the method attribute</summary><div class="markup"><p>A few minor comments on the method attribute (that also apply to XSLT 3.0):</p>
<ol>
<li>
<p>A note in section 25.1 says "In the case of the attributes <strong>method</strong>, cdata-section-elements, suppress-indentation, and use-character-maps, the effective value of the attribute contains a space-separated <strong>list</strong> of EQNames."  The effective value of the method attribute should not be a list of values, just one value, right?</p>
</li>
<li>
<p>The XSD schema requires that the method attribute contain a colon if it is not one of the 6 "built-in" values.  (The type xsl:method restricts xsl:EQName with the pattern "\c*:\c*").  Now that it can be an expanded QName,  it should also allow for Q{...}.</p>
</li>
<li>
<p>A note in section 3.2 says:  "Extension attributes may also be used to influence the behavior of the serialization methods <strong>xml, xhtml, html, or text</strong>, to the extent that... If a serialization method other than one of these <strong>four</strong> is requested (<strong>using a prefixed QName</strong> in the method parameter) then...".<br>
a. This lists only 4 methods, Should "json" and "adaptive" be added to the list and "four" changed to "six"?
b. Should "using a prefixed QName" be changed to something like "using an EQName with a non-absent namespace"?</p>
</li>
<li>
<p>In the note about error XTSE1570 in Section 26.2.  "The value must (if present) be a valid EQName. If it is a lexical QName with no a prefix, then it identifies a method specified in [XSLT and XQuery Serialization] and must be one of <strong>xml, html, xhtml, or text</strong>.
a. It only lists the 4 methods, leaving out "json" and "adaptive"
b. Typo - "no a prefix" should be "no prefix"</p>
</li>
</ol>
<p>Thanks!</p>
</div></details></div>
<div class="toot" id="created-1950"><h2>Pull request #1950 created<span class="toot-id"> #created-1950</span></h2><div class="pubdate">23 Apr at 15:52:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1950">https://github.com/qt4cg/qtspecs/pull/1950</a></div><details><summary>1704 Add rules/notes for BOM and related topics</summary><div class="markup"><p>Fix #1704</p>
<p>The main substantive change is that unparsed-text() now explicitly discards any leading BOM.</p>
<p>Other functions that involve decoding of octets to strings are updated to reflect the changes that we made to reference the concept of "permitted characters".</p>
</div></details></div>
<div class="toot" id="closed-1644"><h2>Issue #1644 closed<span class="toot-id"> #closed-1644</span></h2><div class="pubdate">23 Apr at 15:29:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1644">https://github.com/qt4cg/qtspecs/issues/1644</a></div><p>fn:elements-to-maps: Mixed Content</p></div>
<div class="toot" id="closed-1658"><h2>Issue #1658 closed<span class="toot-id"> #closed-1658</span></h2><div class="pubdate">23 Apr at 15:28:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1658">https://github.com/qt4cg/qtspecs/issues/1658</a></div><p>fn:elements-to-maps: `empty`, normalize space ?</p></div>
<div class="toot" id="closed-1647"><h2>Issue #1647 closed<span class="toot-id"> #closed-1647</span></h2><div class="pubdate">23 Apr at 15:28:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1647">https://github.com/qt4cg/qtspecs/issues/1647</a></div><p>fn:elements-to-maps: Explicit Layouts</p></div>
<div class="toot" id="created-1949"><h2>Issue #1949 created<span class="toot-id"> #created-1949</span></h2><div class="pubdate">23 Apr at 15:26:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1949">https://github.com/qt4cg/qtspecs/issues/1949</a></div><details><summary>fn:element-to-map: Updated Feedback</summary><div class="markup"><p>My feedback is based on the latest version PR (#1906):</p>
<p><strong>1. Boolean types</strong></p>
<p>I think we should be careful about changing data to a representation that differs from the input data. If the input contains <code>0</code> and <code>1</code>, it seems too invasive to me to return a boolean. Many users will not be aware that those numbers are valid candidates for Boolean conversions in XPath. That’s why I would still pledge for adapting the type rule detections, and placing <code>numeric</code> before <code>boolean</code> (related: 5).</p>
<p>Things are even more awkward (if I got the rules right) when working without a conversion plan:</p>
<pre><code class="language-xquery">(: Query :)
element-to-map(&lt;x&gt;&lt;a&gt;1&lt;/a&gt;&lt;a&gt;2&lt;/a&gt;&lt;/x&gt;)

(: Result :)
{ "x": [ true(), 2 ] }
</code></pre>
<p><strong>2. Explicit types</strong></p>
<p>I still feel uneasy that we ignore the specified type if it does not match – even more because XML is known for its rigor that documents must be well-formed to be accepted. I agree we should allow users to be lax about their generated output – by deliberately omitting types – but if type hints are supplied, I think we should take them serious.</p>
<p>An example:</p>
<pre><code class="language-xquery">element-to-map(
  &lt;a&gt;2&lt;/a&gt;,
  { 'plan': { 'a': { 'layout': 'simple', 'type': 'boolean' } } }
)
</code></pre>
<p><strong>3. Numeric casts</strong></p>
<blockquote>
<p>If the prescribed type is <code>numeric</code> and the value is castable as <code>xs:numeric</code>, then it is output as an instance of <code>xs:integer</code>, <code>xs:decimal</code>, or <code>xs:double</code> depending on the lexical form of the value, following the same rules as for XPath numeric literals.</p>
</blockquote>
<p>Unless we use the same rule somewhere else in the spec, I would definitely vote for making things easier and choose consistency. <code>xs:numeric(&lt;a&gt;1&lt;/a&gt;)</code> returns a double value, so I think we should do exactly the same here. If the result will be serialized as JSON, everything will be a number anyway.</p>
<p><strong>4. Normalized space</strong></p>
<blockquote>
<ol start="2">
<li>If <code>empty($EE/(* | text())</code> …the layout is <code>empty</code></li>
</ol>
</blockquote>
<p>I still believe <code>empty($EE/(* | text()[normalize-space()])</code> would be a better choice. The error sections for both <code>empty</code> and <code>list</code> state that “whitespace-only text nodes are discarded.”, so it is not clear to me why the rules for whitespace text nodes differ for these layouts.</p>
<p><strong>5. 18.5.2 Creating a conversion plan</strong></p>
<p>The current rules do not mention yet that <code>child</code> keys need to be added for <code>list</code> and <code>list-plus</code>.</p>
<p>In general, I would appreciate if redundancy could be removed. I’m still struggling finding all relevant information without resorting to the tests. For example, I think that due to the new XQuery code, a lot of informal and possibly lossy rules can be dropped.</p>
<p><strong>6. Function signatures: <code>document-node()</code>, <code>element()</code></strong></p>
<p>Both functions should accept only elements, or accept both document nodes and elements. Maybe it’s better to only accept elements; it would resemble the name of the function.</p>
<p><strong>7. <code>deep-skip</code> option</strong></p>
<p>I wouldn’t be able to tell how a <code>shallow-skip</code> option could work, so maybe <code>skip</code> is sufficient?</p>
<p><strong>8. Streamability</strong></p>
<blockquote>
<ul>
<li>The conversion is not streamable.</li>
</ul>
</blockquote>
<p>It is not clear (to me) what this means. Is this XSLT-related? Maybe a reference would be helpful, or we should drop the phrase if it’s not relevant anymore?</p>
<p>My observation was that <code>fn:element-to-map</code> can be implemented without keeping the full document in main-memory, so maybe we should let the processors decide what to do?</p>
<p><strong>9. JSON</strong></p>
<blockquote>
<p>Example output: …shown as serialized JSON. The result is always shown as a singleton map…</p>
</blockquote>
<p>This sounds contradictory, as there are no maps in the JSON terminology (but objects). Maybe there is no need to mention the JSON serialization, as the presented results are maps &amp; arrays that can be run as XPath expressions out of the box.</p>
<p><strong>10. Layout rules: errors</strong></p>
<p>The error rules for <code>empty</code> and <code>empty-plus</code> say: “If any other child nodes are present, this layout fails.”. For the <code>simple</code> and <code>simple-plus</code> layouts, it is “If any child elements are present, this layout fails.”.</p>
<p>Am I right to assume that in both cases it’s only child element that result in a failure?</p>
</div></details></div>
<div class="toot" id="created-1948"><h2>Issue #1948 created<span class="toot-id"> #created-1948</span></h2><div class="pubdate">23 Apr at 14:43:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1948">https://github.com/qt4cg/qtspecs/issues/1948</a></div><details><summary>fn:element-to-map: Tests</summary><div class="markup"><p>My feedback is based on the latest version PR (#1906) and the latest test cases (https://github.com/qt4cg/qt4tests/pull/223). I decided to list my observations in this repository, as I am not sure whether it’s the tests or the spec that may possibly need to be revised:</p>
<ol>
<li><code>element-to-map-017</code>:</li>
</ol>
<p>As discussed in the last meeting (see also https://github.com/qt4cg/qtspecs/pull/1906#issuecomment-2821502378), the <code>xsi:type</code> attribute should already be ignored in the choice of the conversion plan, in order to choose a plan that does not include attributes:</p>
<pre><code>element-to-map(parse-xml('&lt;a xmlns="http://a.com/" xsi:type="xs:integer"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;2&lt;/a&gt;')/*)
Result: { "Q{http://a.com/}a": 2 }
Expect: { "Q{http://a.com/}a": { "#content": "2" } }
</code></pre>
<ol start="2">
<li><code>element-to-map-401</code>:</li>
</ol>
<p>I would expect the <code>record</code> layout to be also applied for the <code>b</code> child node:</p>
<pre><code>element-to-map(parse-xml('&lt;a id="3"&gt;&lt;b/&gt;&lt;/a&gt;')/a, {'plan': {'a': {'layout': 'empty'},
  '*': {'layout': 'record'}, '@id': {'type': 'numeric'} }})
Result: { "a": { "@id": 3, "b": { } } }
Expect: { "a": { "@id": 3, "b": "" } }
</code></pre>
<ol start="3">
<li><code>element-to-map-420</code> and others:</li>
</ol>
<p>As discussed in the meeting, <code>list</code> layouts require a <code>child</code> key:</p>
<pre><code>element-to-map(parse-xml('&lt;a id="zz"&gt;&lt;b/&gt;&lt;b/&gt;&lt;c/&gt;&lt;/a&gt;')/a, {'plan':{'a':{'layout':'list'}}})
Error : XPTY0004: Missing key 'child' (node: a).
Expect: FOJS0008
</code></pre>
<ol start="4">
<li><code>element-to-map-511</code>:</li>
</ol>
<p>I would expect the <code>mixed</code> layout to be also applied for the <code>a</code> child node:</p>
<pre><code>element-to-map(parse-xml('&lt;a&gt;The &lt;i&gt;short&lt;/i&gt; introduction&lt;/a&gt;')/a, {'plan': {'a': {'layout':'simple'}, '*': {'layout':'mixed'} }})
Result: { "a": [ "The ", { "i": [ "short" ] }, " introduction" ] }
Expect: { "a": array { ("The ", { "i": "short" }, " introduction") } }
</code></pre>
</div></details></div>
<div class="toot" id="closed-1936"><h2>Issue #1936 closed<span class="toot-id"> #closed-1936</span></h2><div class="pubdate">22 Apr at 20:19:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1936">https://github.com/qt4cg/qtspecs/issues/1936</a></div><p>XSD for XSLT 4.0 is missing form="qualified" on several attributes within the attribute group "literal-result-element-attributes"</p></div>
<div class="toot" id="closed-1943"><h2>Issue #1943 closed<span class="toot-id"> #closed-1943</span></h2><div class="pubdate">22 Apr at 20:16:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1943">https://github.com/qt4cg/qtspecs/pull/1943</a></div><p>Mark attribute declarations as form=qualified</p></div>
<div class="toot" id="closed-1947"><h2>Issue #1947 closed<span class="toot-id"> #closed-1947</span></h2><div class="pubdate">22 Apr at 20:16:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1947">https://github.com/qt4cg/qtspecs/pull/1947</a></div><p>1936 Mark attributes with form=qualified</p></div>
<div class="toot" id="created-1947"><h2>Pull request #1947 created<span class="toot-id"> #created-1947</span></h2><div class="pubdate">22 Apr at 20:16:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1947">https://github.com/qt4cg/qtspecs/pull/1947</a></div><details><summary>1936 Mark attributes with form=qualified</summary><div class="markup"><p>Fix #1936</p>
</div></details></div>
<div class="toot" id="created-1946"><h2>Issue #1946 created<span class="toot-id"> #created-1946</span></h2><div class="pubdate">22 Apr at 16:27:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1946">https://github.com/qt4cg/qtspecs/issues/1946</a></div><details><summary>We need examples of a record with an entry that is a %method and invoking this method with the result it must produce</summary><div class="markup"><p>We have two new great features in XPath 4.0 - the <strong>record</strong> and <strong>%method</strong> entries of a map.</p>
<p>It is natural to combine the two and have a record, one of whose entries is a method.</p>
<p>Unfortunately, at present there is no such example in the relevant Specs, and this leaves the reader trying to guess even the syntax of the specific record definition.</p>
<p>Therefore, we need at least one such example, to help readers and implementors in this.</p>
<p>BaseX did a great job in implementing both records and  %method map-entries, and I constructed the following example, which is syntactically correct, but results in error (due to function coercion - explained in a separate issue here: https://github.com/qt4cg/qtspecs/issues/1938).</p>
<p>This code:</p>
<pre><code class="language-xq">declare namespace t = "my:t";
declare record t:location 
   ( longitude as xs:integer,
     latitude as xs:integer,
     myFun2 as %method fn() as xs:integer,
     *
   );
   
   let $r := t:location(longitude := 25, latitude := 10, myFun2 := %method fn() {?longitude + ?latitude}
                        )
     return ($r, $r?myFun2())
</code></pre>
<p>When executed with BaseX, raises an error: <strong><em>[XPDY0002] .: Context value is undefined.</em></strong></p>
<p>We need the specification to provide a similar example, and what the result should be.</p>
<p>In particular:</p>
<ol>
<li>Must the return type of the method myFun2 (above) be specified or can it be omitted? BaseX raises a syntax error if this is specified as: <code>myFun2 as %method fn()</code> : "<strong><em>Expecting 'as', found ','</em></strong> ?</li>
<li>If the method entry is specified as having a particular type (such as: <code>as xs:integer</code>) then can the corresponding function, provided in the construction of this record omit the function type (such as <code>myFun2 := %method fn() {?longitude + ?latitude}</code>) , even though it is clear that the type of the result is <code>xs:integer</code> ?</li>
</ol>
</div></details></div>
<div class="toot" id="closed-1941"><h2>Issue #1941 closed<span class="toot-id"> #closed-1941</span></h2><div class="pubdate">22 Apr at 16:13:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1941">https://github.com/qt4cg/qtspecs/pull/1941</a></div><p>Add PR numbers and dates to change metadata</p></div>
<div class="toot" id="closed-1921"><h2>Issue #1921 closed<span class="toot-id"> #closed-1921</span></h2><div class="pubdate">22 Apr at 16:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1921">https://github.com/qt4cg/qtspecs/issues/1921</a></div><p>XSLT: semantics of PatternVersionRange</p></div>
<div class="toot" id="closed-1922"><h2>Issue #1922 closed<span class="toot-id"> #closed-1922</span></h2><div class="pubdate">22 Apr at 16:10:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1922">https://github.com/qt4cg/qtspecs/pull/1922</a></div><p>1921 Expand definition of version ranges in XSLT</p></div>
<div class="toot" id="closed-1907"><h2>Issue #1907 closed<span class="toot-id"> #closed-1907</span></h2><div class="pubdate">22 Apr at 16:07:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1907">https://github.com/qt4cg/qtspecs/issues/1907</a></div><p>Method lookup: wildcards</p></div>
<div class="toot" id="closed-1926"><h2>Issue #1926 closed<span class="toot-id"> #closed-1926</span></h2><div class="pubdate">22 Apr at 16:07:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1926">https://github.com/qt4cg/qtspecs/pull/1926</a></div><p>1907 method lookup (disallow wildcard selection)</p></div>
<div class="toot" id="closed-1928"><h2>Issue #1928 closed<span class="toot-id"> #closed-1928</span></h2><div class="pubdate">22 Apr at 16:04:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1928">https://github.com/qt4cg/qtspecs/pull/1928</a></div><p>1844b Arrow Expressions</p></div>
<div class="toot" id="closed-1724"><h2>Issue #1724 closed<span class="toot-id"> #closed-1724</span></h2><div class="pubdate">22 Apr at 16:03:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1724">https://github.com/qt4cg/qtspecs/issues/1724</a></div><p>Allow @copy-namespaces on &lt;xsl:mode&gt;?</p></div>
<div class="toot" id="closed-1929"><h2>Issue #1929 closed<span class="toot-id"> #closed-1929</span></h2><div class="pubdate">22 Apr at 16:03:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1929">https://github.com/qt4cg/qtspecs/pull/1929</a></div><p>1725 xsl:mode/@copy-namespaces</p></div>
<div class="toot" id="closed-1939"><h2>Issue #1939 closed<span class="toot-id"> #closed-1939</span></h2><div class="pubdate">22 Apr at 16:01:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1939">https://github.com/qt4cg/qtspecs/issues/1939</a></div><p>XQDY0153 (from try/finally) should be a type error</p></div>
<div class="toot" id="closed-1940"><h2>Issue #1940 closed<span class="toot-id"> #closed-1940</span></h2><div class="pubdate">22 Apr at 16:01:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1940">https://github.com/qt4cg/qtspecs/pull/1940</a></div><p>1939 XQDY0153 (from try/finally) should be a type error</p></div>
<div class="toot" id="closed-1931"><h2>Issue #1931 closed<span class="toot-id"> #closed-1931</span></h2><div class="pubdate">22 Apr at 15:58:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1931">https://github.com/qt4cg/qtspecs/pull/1931</a></div><p>QT4-CG-116-02 improve description of validation</p></div>
<div class="toot" id="closed-910"><h2>Issue #910 closed<span class="toot-id"> #closed-910</span></h2><div class="pubdate">22 Apr at 15:57:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/910">https://github.com/qt4cg/qtspecs/issues/910</a></div><p>Introduce a Kollection object with functions that operate on all types of items that can be containers of unlimited number of "members"</p></div>
<div class="toot" id="created-1945"><h2>Pull request #1945 created<span class="toot-id"> #created-1945</span></h2><div class="pubdate">22 Apr at 14:46:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1945">https://github.com/qt4cg/qtspecs/pull/1945</a></div><details><summary>1568 unicode case blind collation</summary><div class="markup"><p>Fix #1568</p>
</div></details></div>
<div class="toot" id="created-1944"><h2>Issue #1944 created<span class="toot-id"> #created-1944</span></h2><div class="pubdate">22 Apr at 09:14:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1944">https://github.com/qt4cg/qtspecs/issues/1944</a></div><details><summary>Try/Catch/Finally - order of evaluation</summary><div class="markup"><p>I'm struggling a bit with try/catch/finally. Is there an implied constraint on the order of evaluation? The spec appears to suggest so:</p>
<blockquote>
<p>its expression will be evaluated after the expressions of the try clause and a possibly evaluated catch clause.</p>
</blockquote>
<p>What does <strong>evaluated after</strong> actually mean in a functional language? I can't see how to reconcile this with the general principles of the language regarding lazy evaluation etc. Is there some kind of exception to the general rule that you only have to evaluate as much of an expression as is needed to work out what the result is going to be?</p>
<p>It seems to me that the hidden unstated purpose of "finally" is to execute expressions that have side-effects, and without a proper semantic framework for handling side-effects, this is going to get us into trouble.</p>
</div></details></div>
<div class="toot" id="created-1943"><h2>Pull request #1943 created<span class="toot-id"> #created-1943</span></h2><div class="pubdate">21 Apr at 21:18:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1943">https://github.com/qt4cg/qtspecs/pull/1943</a></div><details><summary>Mark attribute declarations as form=qualified</summary><div class="markup"><p>Resubmitted because of some clerical error...</p>
</div></details></div>
<div class="toot" id="closed-1937"><h2>Issue #1937 closed<span class="toot-id"> #closed-1937</span></h2><div class="pubdate">21 Apr at 21:15:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1937">https://github.com/qt4cg/qtspecs/pull/1937</a></div><p>1936 Mark attribute declarations as form=qualified</p></div>
<div class="toot" id="created-1942"><h2>Pull request #1942 created<span class="toot-id"> #created-1942</span></h2><div class="pubdate">21 Apr at 19:54:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1942">https://github.com/qt4cg/qtspecs/pull/1942</a></div><details><summary>37 Support sequence, array, and map destructuring declarations</summary><div class="markup"><p>Closes #37.</p>
<p>This currently only supports XPath. I'm working on the wording for XQuery.</p>
</div></details></div>
<div class="toot" id="created-1941"><h2>Pull request #1941 created<span class="toot-id"> #created-1941</span></h2><div class="pubdate">21 Apr at 16:23:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1941">https://github.com/qt4cg/qtspecs/pull/1941</a></div><details><summary>Add PR numbers and dates to change metadata</summary><div class="markup"><p>Purely editorial. No issue raised.</p>
</div></details></div>
<div class="toot" id="created-1940"><h2>Pull request #1940 created<span class="toot-id"> #created-1940</span></h2><div class="pubdate">21 Apr at 10:33:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1940">https://github.com/qt4cg/qtspecs/pull/1940</a></div><details><summary>1939 XQDY0153 (from try/finally) should be a type error</summary><div class="markup"><p>Closes #1939</p>
</div></details></div>
<div class="toot" id="created-1939"><h2>Issue #1939 created<span class="toot-id"> #created-1939</span></h2><div class="pubdate">20 Apr at 11:58:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1939">https://github.com/qt4cg/qtspecs/issues/1939</a></div><details><summary>XQDY0153 (from try/finally) should be a type error</summary><div class="markup"><p>The <code>finally</code> clause is required to return an empty sequence. If not, it raises XQDY0153. This should be a type error rather than a dynamic error, so that it can be raised statically when appropriate.</p>
<p>Also noted in passing: "the the" in item 4 of the "changes" section of §4.20).</p>
</div></details></div>
<div class="toot" id="created-1938"><h2>Issue #1938 created<span class="toot-id"> #created-1938</span></h2><div class="pubdate">18 Apr at 20:36:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1938">https://github.com/qt4cg/qtspecs/issues/1938</a></div><details><summary>Invoking coerced methods</summary><div class="markup"><p>@ChristianGruen, in BaseXdb/basex#2420, brought up a test case similar to this:</p>
<pre><code class="language-xquery">declare record local:r(
    f as fn() as item()
);

local:r(%method fn() {.})
? f()
=&gt; map:keys()
</code></pre>
<p>With a method passed to the constructor, and retrieved by the lookup operator, one would expect the function call to return the map, and the result to be <code>f</code>, the set of keys of the map. With BaseX's current implementation however, it fails with <code>[XPDY0002] .: Context value is undefined.</code></p>
<p>The reason for this failure is function coercion. The record constructor asks for a more specific type than that of the supplied function, so it is subject to function coercion. This creates a new function item, which preserves the method annotation, and which effects a call to the original one. The lookup operator then is applied to the newly created function item, which as a method is equipped with the map as its context item. But when the original function gets called, that context item is not propagated to it. So there is a (rightful?) complaint about an undefined context.</p>
<p>I may be missing something here, but I do not see anything in the spec that makes the context item available to the coerced function, so I think that the described behavior is in fact conformant to the spec.</p>
<p>But as it contradicts the original expectation, I would be grateful for a clarification.</p>
</div></details></div>
<div class="toot" id="created-1937"><h2>Pull request #1937 created<span class="toot-id"> #created-1937</span></h2><div class="pubdate">17 Apr at 16:32:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1937">https://github.com/qt4cg/qtspecs/pull/1937</a></div><details><summary>1936 Mark attribute declarations as form=qualified</summary><div class="markup"><p>Fix #1936</p>
</div></details></div>
<div class="toot" id="created-1936"><h2>Issue #1936 created<span class="toot-id"> #created-1936</span></h2><div class="pubdate">16 Apr at 17:37:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1936">https://github.com/qt4cg/qtspecs/issues/1936</a></div><details><summary>XSD for XSLT 4.0 is missing form="qualified" on several attributes within the attribute group "literal-result-element-attributes"</summary><div class="markup"><p>The attributes in attribute group "literal-result-element-attributes" should be in the XSL namespace, and most of them are, except for xsl:default-mode, xsl:default-validation and xsl:expand-text.  Those 3 are missing their form="qualified" attribute, so they would default to being in no namespace.</p>
<p>I know it's non-normative but it would be good to make the correction. (This is also an issue for the XSD for XSLT 3.0).</p>
</div></details></div>
<div class="toot" id="closed-1799"><h2>Issue #1799 closed<span class="toot-id"> #closed-1799</span></h2><div class="pubdate">15 Apr at 23:06:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1799">https://github.com/qt4cg/qtspecs/issues/1799</a></div><p>"well-formed HTML document"?</p></div>
<div class="toot" id="closed-1891"><h2>Issue #1891 closed<span class="toot-id"> #closed-1891</span></h2><div class="pubdate">15 Apr at 23:06:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1891">https://github.com/qt4cg/qtspecs/issues/1891</a></div><p>`fn:parse-html`: `html-version`</p></div>
<div class="toot" id="closed-1918"><h2>Issue #1918 closed<span class="toot-id"> #closed-1918</span></h2><div class="pubdate">15 Apr at 23:06:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1918">https://github.com/qt4cg/qtspecs/pull/1918</a></div><p>1891 clarifications on HTML versions and errors</p></div>
<div class="toot" id="closed-1363"><h2>Issue #1363 closed<span class="toot-id"> #closed-1363</span></h2><div class="pubdate">15 Apr at 22:50:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1363">https://github.com/qt4cg/qtspecs/issues/1363</a></div><p>map:get and array:get</p></div>
<div class="toot" id="closed-1901"><h2>Issue #1901 closed<span class="toot-id"> #closed-1901</span></h2><div class="pubdate">15 Apr at 22:50:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1901">https://github.com/qt4cg/qtspecs/pull/1901</a></div><p>1363 fallback becomes a value not a function</p></div>
<div class="toot" id="closed-1896"><h2>Issue #1896 closed<span class="toot-id"> #closed-1896</span></h2><div class="pubdate">15 Apr at 16:10:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1896">https://github.com/qt4cg/qtspecs/issues/1896</a></div><p>Drop "parameter names" as a property of a function item</p></div>
<div class="toot" id="closed-1916"><h2>Issue #1916 closed<span class="toot-id"> #closed-1916</span></h2><div class="pubdate">15 Apr at 16:10:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1916">https://github.com/qt4cg/qtspecs/pull/1916</a></div><p>1896 Drop parameter names as a property of function items</p></div>
<div class="toot" id="closed-1932"><h2>Issue #1932 closed<span class="toot-id"> #closed-1932</span></h2><div class="pubdate">15 Apr at 16:07:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1932">https://github.com/qt4cg/qtspecs/pull/1932</a></div><p>QT4-CG-115-01 xsl:next-match examples</p></div>
<div class="toot" id="closed-1930"><h2>Issue #1930 closed<span class="toot-id"> #closed-1930</span></h2><div class="pubdate">15 Apr at 16:04:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1930">https://github.com/qt4cg/qtspecs/pull/1930</a></div><p>QT4-CG-116-04 correction to fn:function-identity</p></div>
<div class="toot" id="closed-1923"><h2>Issue #1923 closed<span class="toot-id"> #closed-1923</span></h2><div class="pubdate">15 Apr at 16:02:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1923">https://github.com/qt4cg/qtspecs/issues/1923</a></div><p>Arithmetic Expressions needlessly mentions UnionExpr</p></div>
<div class="toot" id="closed-1924"><h2>Issue #1924 closed<span class="toot-id"> #closed-1924</span></h2><div class="pubdate">15 Apr at 16:02:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1924">https://github.com/qt4cg/qtspecs/pull/1924</a></div><p>1923 Editorial adjustments for arithmetic expressions</p></div>
<div class="toot" id="closed-269"><h2>Issue #269 closed<span class="toot-id"> #closed-269</span></h2><div class="pubdate">15 Apr at 16:01:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/269">https://github.com/qt4cg/qtspecs/issues/269</a></div><p>Function for URI relativization</p></div>
<div class="toot" id="closed-826"><h2>Issue #826 closed<span class="toot-id"> #closed-826</span></h2><div class="pubdate">15 Apr at 16:01:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/826">https://github.com/qt4cg/qtspecs/issues/826</a></div><p>Arrays: Representation of single members of an array</p></div>
<div class="toot" id="closed-1566"><h2>Issue #1566 closed<span class="toot-id"> #closed-1566</span></h2><div class="pubdate">15 Apr at 16:01:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1566">https://github.com/qt4cg/qtspecs/issues/1566</a></div><p>EXPath Modules: Future</p></div>
<div class="toot" id="closed-1754"><h2>Issue #1754 closed<span class="toot-id"> #closed-1754</span></h2><div class="pubdate">15 Apr at 16:01:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1754">https://github.com/qt4cg/qtspecs/issues/1754</a></div><p>Inverse functions to bin:hex, bin:bin, and bin:octal</p></div>
<div class="toot" id="closed-1780"><h2>Issue #1780 closed<span class="toot-id"> #closed-1780</span></h2><div class="pubdate">15 Apr at 16:01:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1780">https://github.com/qt4cg/qtspecs/issues/1780</a></div><p>xsl:for-each optional variable introduction</p></div>
<div class="toot" id="closed-1905"><h2>Issue #1905 closed<span class="toot-id"> #closed-1905</span></h2><div class="pubdate">15 Apr at 15:58:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1905">https://github.com/qt4cg/qtspecs/issues/1905</a></div><p>Editorial edits</p></div>
<div class="toot" id="closed-1919"><h2>Issue #1919 closed<span class="toot-id"> #closed-1919</span></h2><div class="pubdate">15 Apr at 15:58:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1919">https://github.com/qt4cg/qtspecs/pull/1919</a></div><p>1905 Editorial edits</p></div>
<div class="toot" id="created-1935"><h2>Issue #1935 created<span class="toot-id"> #created-1935</span></h2><div class="pubdate">15 Apr at 14:11:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1935">https://github.com/qt4cg/qtspecs/issues/1935</a></div><details><summary>doc-available() with invalid options</summary><div class="markup"><p>The doc-available function needs to make it clear what happens when invalid options are supplied.</p>
<p>Clearly invalid options such as <code>xinclude="yes-or-no"</code> should be an error (rather than resulting in a return value of false, as the current spec might suggest).</p>
<p>It's less clear what should happen if say you request schema validation with a non-schema-aware processor. I think this probably calls for returning false rather than an error.</p>
</div></details></div>
<div class="toot" id="created-1934"><h2>Issue #1934 created<span class="toot-id"> #created-1934</span></h2><div class="pubdate">14 Apr at 14:26:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1934">https://github.com/qt4cg/qtspecs/issues/1934</a></div><details><summary>Supporting RELAX NG validation</summary><div class="markup"><p>At <a href="https://qt4cg.org/meeting/minutes/2025/04-08.html">meeting 116</a>, the question was raised: why don't we support RELAX NG validation?</p>
<p>I think that's a good question. Further, I think we should, if we can work out the technical details and arrive at consensus.</p>
<p>The good news is that it's <em>a lot</em> simpler than XSD validation. For those not familiar with RELAX NG, the 50,000 foot summary is that it's (more-or-less) regular expressions over trees. The grammar defines a number of patterns, including at least one designated as a start pattern. If the document matches (any one of the) start pattern(s), then it's valid. A trivial example looks like this:</p>
<pre><code>start = doc

doc =
    element doc {
        attribute date { xsd:date },
        p+
    }

p =
    element p {
        text
    }
</code></pre>
<p>(RELAX NG also has an XML syntax, but the "compact syntax" is isomorphic and many people find it easier to read.)</p>
<p>A couple of things to note: the "p" in "p+" in the doc pattern is a reference to the "p" pattern, not to the element named "p". And although the date attribute has to conform to an <code>xsd:date</code>, that <em>does not</em> do any type assignment. RELAX NG allows user-defined data types; I suggest we make that an implementation-defined feature. Since no type assignment is performed, it doesn't really matter.</p>
<p>How might we add support for RELAX NG validation? A sketch...</p>
<ol>
<li>
<p>Add to the static context a set of RELAX NG patterns. Initally empty, these are patterns that can match the document element during RELAX NG validation. (The union of all of the "start" patterns from all of the imported RELAX NG grammars.) There's no user-access to these patterns, so we don't technically need to add them to the data model, though I suppose we could.</p>
</li>
<li>
<p>In XQuery, allow schema import to import RELAX NG grammars. This has no effect except that the start patterns defined in that grammar are added to the start patterns in the static context. It is an error to specify “fixed” or “default element namespace” if the imported schema is a RELAX NG grammar.</p>
</li>
<li>
<p>Add “relax-ng” as a <code>ValidationMode</code> in <code>ValidateExpr</code>. It is an error to also specify a “type”.</p>
<p>If RELAX NG validation is requested, the patterns in the static context are used to attempt to validate the document. If one succeeds, the validated document is returned. If none succeed, that’s an error.</p>
</li>
<li>
<p>In XSLT, allow schema import to import RELAX NG grammars.</p>
</li>
</ol>
<ul>
<li>Details about role, TBD</li>
<li>Details about literal schema elements, TBD</li>
</ul>
<ol start="5">
<li>
<p>In XSLT, on elements that have a validation attribute, allow the value “relax-ng” with semantics analagous to the validate expression in XQuery.</p>
</li>
<li>
<p>In the F&amp;O functions that have “dtd-validation” and “xsd-validation” options, add a boolean “relax-ng” validation option. If true, validation is done with the patterns in the static context.</p>
</li>
</ol>
<p>There's one small wrinkle, the <a href="https://relaxng.org/compatibility-20011203.html">RELAX NG DTD Compatibility</a> specification defines some annotations that allow a RELAX NG grammar to return default attributes. That means RELAX NG validation <em>can</em> return a different document than was validated, but I'm not sure how important that support is in 2025 if there were strong objections.</p>
</div></details></div>
<div class="toot" id="created-1933"><h2>Pull request #1933 created<span class="toot-id"> #created-1933</span></h2><div class="pubdate">14 Apr at 11:26:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1933">https://github.com/qt4cg/qtspecs/pull/1933</a></div><details><summary>1271 fn:xsd-validator() function</summary><div class="markup"><p>This proposal makes schema validation (as performed by the XQuery validate expression) available as a function. This allows additional options to be defined without extending the grammar, it makes it easier to incorporate validation within a pipeline of function calls, and it makes validation available from XPath.</p>
<p>If the proposal is accepted I would propose doing some editorial reorganisation so that the current XQuery and XSLT text describing the semantics of validation are directed to the definition of this function, reducing duplication in the specs.</p>
<p>Fix #1271</p>
</div></details></div>
<div class="toot" id="created-1932"><h2>Pull request #1932 created<span class="toot-id"> #created-1932</span></h2><div class="pubdate">14 Apr at 09:25:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1932">https://github.com/qt4cg/qtspecs/pull/1932</a></div><details><summary>QT4-CG-115-01 xsl:next-match examples</summary><div class="markup"><p>Adds an example demonstrating passing of parameter through a chain of xsl:next-match instructions</p>
</div></details></div>
<div class="toot" id="created-1931"><h2>Pull request #1931 created<span class="toot-id"> #created-1931</span></h2><div class="pubdate">14 Apr at 08:57:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1931">https://github.com/qt4cg/qtspecs/pull/1931</a></div><details><summary>QT4-CG-116-02 improve description of validation</summary><div class="markup"><p>Improves the description of the semantics of the <code>xsd-validation</code> option on <code>parse-xml()</code> and <code>doc()</code>. Also brings the two functions into line by adding the <code>xsi-schema-location</code> option from <code>doc()</code> to <code>parse-xml()</code>.</p>
</div></details></div>
<div class="toot" id="created-1930"><h2>Pull request #1930 created<span class="toot-id"> #created-1930</span></h2><div class="pubdate">14 Apr at 08:42:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1930">https://github.com/qt4cg/qtspecs/pull/1930</a></div><details><summary>QT4-CG-116-04 correction to fn:function-identity</summary><div class="markup"><p>Fix a simple typo.</p>
</div></details></div>
<div class="toot" id="created-1929"><h2>Pull request #1929 created<span class="toot-id"> #created-1929</span></h2><div class="pubdate">13 Apr at 08:55:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1929">https://github.com/qt4cg/qtspecs/pull/1929</a></div><details><summary>1725 xsl:mode/@copy-namespaces</summary><div class="markup"><p>Fix #1724</p>
</div></details></div>
<div class="toot" id="closed-1742"><h2>Issue #1742 closed<span class="toot-id"> #closed-1742</span></h2><div class="pubdate">12 Apr at 23:20:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1742">https://github.com/qt4cg/qtspecs/issues/1742</a></div><p>Maps constructed using streamed xsl:fork instruction should not be ordered</p></div>
<div class="toot" id="closed-1925"><h2>Issue #1925 closed<span class="toot-id"> #closed-1925</span></h2><div class="pubdate">12 Apr at 17:08:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1925">https://github.com/qt4cg/qtspecs/pull/1925</a></div><p>1844 Arrow Expressions</p></div>
<div class="toot" id="created-1928"><h2>Pull request #1928 created<span class="toot-id"> #created-1928</span></h2><div class="pubdate">12 Apr at 17:05:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1928">https://github.com/qt4cg/qtspecs/pull/1928</a></div><details><summary>1844b Arrow Expressions</summary><div class="markup"><p>This PR doesn't do what issue https://github.com/qt4cg/qtspecs/issues/1844 suggests, namely dropping the mapping arrow. Instead it picks up a couple of points made in passing in that issue:</p>
<p>(a) drops remaining references to the obsolete =?&gt; operator</p>
<p>(b) simplifies the grammar for arrow expressions</p>
<p>(c) improves the way arrow expressions are described, including their relationship to pipeline expressions.</p>
</div></details></div>
<div class="toot" id="closed-1927"><h2>Issue #1927 closed<span class="toot-id"> #closed-1927</span></h2><div class="pubdate">12 Apr at 15:33:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1927">https://github.com/qt4cg/qtspecs/pull/1927</a></div><p>1907b method lookup</p></div>
<div class="toot" id="created-1927"><h2>Pull request #1927 created<span class="toot-id"> #created-1927</span></h2><div class="pubdate">12 Apr at 15:33:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1927">https://github.com/qt4cg/qtspecs/pull/1927</a></div><details><summary>1907b method lookup</summary><div class="markup"><p>Fix #1907</p>
</div></details></div>
<div class="toot" id="created-1926"><h2>Pull request #1926 created<span class="toot-id"> #created-1926</span></h2><div class="pubdate">12 Apr at 15:29:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1926">https://github.com/qt4cg/qtspecs/pull/1926</a></div><details><summary>1907 method lookup (disallow wildcard selection)</summary><div class="markup"><p>Fix #1907</p>
</div></details></div>
<div class="toot" id="closed-1341"><h2>Issue #1341 closed<span class="toot-id"> #closed-1341</span></h2><div class="pubdate">12 Apr at 14:55:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1341">https://github.com/qt4cg/qtspecs/issues/1341</a></div><p>Remove the `$position`  argument from the `$action` function passed to folds</p></div>
<div class="toot" id="created-1925"><h2>Pull request #1925 created<span class="toot-id"> #created-1925</span></h2><div class="pubdate">12 Apr at 13:49:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1925">https://github.com/qt4cg/qtspecs/pull/1925</a></div><details><summary>1844 Arrow Expressions</summary><div class="markup"><p>This PR doesn't do what issue #1844 suggests, namely dropping the mapping arrow. Instead it picks up a couple of points made in passing in that issue:</p>
<p>(a) drops remaining references to the obsolete <code>=?&gt;</code> operator</p>
<p>(b) simplifies the grammar for arrow expressions</p>
<p>(c) improves the way arrow expressions are described, including their relationship to pipeline expressions.</p>
</div></details></div>
<div class="toot" id="created-1924"><h2>Pull request #1924 created<span class="toot-id"> #created-1924</span></h2><div class="pubdate">12 Apr at 09:28:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1924">https://github.com/qt4cg/qtspecs/pull/1924</a></div><details><summary>1923 Editorial adjustments for arithmetic expressions</summary><div class="markup"><p>Fix #1923</p>
</div></details></div>
<div class="toot" id="created-1923"><h2>Issue #1923 created<span class="toot-id"> #created-1923</span></h2><div class="pubdate">11 Apr at 16:52:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1923">https://github.com/qt4cg/qtspecs/issues/1923</a></div><details><summary>Arithmetic Expressions needlessly mentions UnionExpr</summary><div class="markup"><p>Minor editorial adjustment needed at XPath specs, 4.8 Arithmetic Expressions. The definition of UnionExpr is mentioned in the EBNF snippets at the top, but that definition is not discussed, nor should it be. This snippet should be dropped.</p>
</div></details></div>
<div class="toot" id="created-1922"><h2>Pull request #1922 created<span class="toot-id"> #created-1922</span></h2><div class="pubdate">11 Apr at 10:46:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1922">https://github.com/qt4cg/qtspecs/pull/1922</a></div><details><summary>1921 Expand definition of version ranges in XSLT</summary><div class="markup"><p>Fix #1921</p>
<p>Simple editorial bug fix.</p>
</div></details></div>
<div class="toot" id="created-1921"><h2>Issue #1921 created<span class="toot-id"> #created-1921</span></h2><div class="pubdate">10 Apr at 21:26:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1921">https://github.com/qt4cg/qtspecs/issues/1921</a></div><details><summary>XSLT: semantics of PatternVersionRange</summary><div class="markup"><p>In XSLT §3.5.1 The semantics of <code>VersionTo</code> and <code>VersionFromTo</code> are described as if the keyword <code>to</code> is always followed by a <code>VersionPrefix</code>, whereas the syntax allows a choice of a <code>VersionPrefix</code> or a <code>PackageVersion</code>.</p>
<p>This problem is present in XSLT 3.0.</p>
<p>See also Saxon bug https://saxonica.plan.io/issues/6746</p>
<p>Note also the absence of tests for the form <code>to VersionPrefix</code>.</p>
</div></details></div>
<div class="toot" id="closed-1737"><h2>Issue #1737 closed<span class="toot-id"> #closed-1737</span></h2><div class="pubdate">10 Apr at 12:44:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1737">https://github.com/qt4cg/qtspecs/issues/1737</a></div><p>Grammar problems introduced by #1732</p></div>
<div class="toot" id="closed-1798"><h2>Issue #1798 closed<span class="toot-id"> #closed-1798</span></h2><div class="pubdate">10 Apr at 12:42:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1798">https://github.com/qt4cg/qtspecs/issues/1798</a></div><p>Getting the value of the new identity-(DM)property of a function. `fn:function-identity`</p></div>
<div class="toot" id="created-1920"><h2>Issue #1920 created<span class="toot-id"> #created-1920</span></h2><div class="pubdate">10 Apr at 12:39:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1920">https://github.com/qt4cg/qtspecs/issues/1920</a></div><details><summary>Parse functions: determinism</summary><div class="markup"><p>The function <code>fn:parse-xml</code> is nondeterministic: Every function call may return a different node instance. Most other parse functions (<code>fn:parse-json</code>, <code>fn:parse-csv</code>, <code>fn:csv-to-xml</code>, etc) are deterministic, and I believe we should change that and make them nondeterministic as well.</p>
<p>We could also make <code>fn:json-doc</code> nondeterministic. If we don’t, we should probably add a <code>stable</code> option.</p>
</div></details></div>
<div class="toot" id="created-1919"><h2>Pull request #1919 created<span class="toot-id"> #created-1919</span></h2><div class="pubdate">10 Apr at 09:44:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1919">https://github.com/qt4cg/qtspecs/pull/1919</a></div><details><summary>1905 Editorial edits</summary><div class="markup"><p>Closes #1905</p>
</div></details></div>
<div class="toot" id="closed-1917"><h2>Issue #1917 closed<span class="toot-id"> #closed-1917</span></h2><div class="pubdate">09 Apr at 16:31:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1917">https://github.com/qt4cg/qtspecs/pull/1917</a></div><p>1891 HTML versions and errors</p></div>
<div class="toot" id="created-1918"><h2>Pull request #1918 created<span class="toot-id"> #created-1918</span></h2><div class="pubdate">09 Apr at 16:30:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1918">https://github.com/qt4cg/qtspecs/pull/1918</a></div><details><summary>1891 clarifications on HTML versions and errors</summary><div class="markup"><p>Fix #1891
Fix #1799</p>
<p>partial fix for #1889</p>
</div></details></div>
<div class="toot" id="created-1917"><h2>Pull request #1917 created<span class="toot-id"> #created-1917</span></h2><div class="pubdate">09 Apr at 16:24:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1917">https://github.com/qt4cg/qtspecs/pull/1917</a></div><details><summary>1891 HTML versions and errors</summary><div class="markup"><p>Fix #1891
Fix #1799</p>
<p>partial fix for #1889</p>
</div></details></div>
<div class="toot" id="created-1916"><h2>Pull request #1916 created<span class="toot-id"> #created-1916</span></h2><div class="pubdate">08 Apr at 18:31:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1916">https://github.com/qt4cg/qtspecs/pull/1916</a></div><details><summary>1896 Drop parameter names as a property of function items</summary><div class="markup"><p>Fix #1896</p>
</div></details></div>
<div class="toot" id="closed-1911"><h2>Issue #1911 closed<span class="toot-id"> #closed-1911</span></h2><div class="pubdate">08 Apr at 18:15:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1911">https://github.com/qt4cg/qtspecs/issues/1911</a></div><p>Remarks on recent changes to regular expression handling</p></div>
<div class="toot" id="closed-1902"><h2>Issue #1902 closed<span class="toot-id"> #closed-1902</span></h2><div class="pubdate">08 Apr at 18:02:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1902">https://github.com/qt4cg/qtspecs/issues/1902</a></div><p>`binary:unpack-integer`, overflow/underflow</p></div>
<div class="toot" id="closed-451"><h2>Issue #451 closed<span class="toot-id"> #closed-451</span></h2><div class="pubdate">08 Apr at 16:32:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/451">https://github.com/qt4cg/qtspecs/issues/451</a></div><p>Multiple Schemas</p></div>
<div class="toot" id="closed-1819"><h2>Issue #1819 closed<span class="toot-id"> #closed-1819</span></h2><div class="pubdate">08 Apr at 16:32:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1819">https://github.com/qt4cg/qtspecs/pull/1819</a></div><p>451 Multiple schemas in XSLT</p></div>
<div class="toot" id="closed-1881"><h2>Issue #1881 closed<span class="toot-id"> #closed-1881</span></h2><div class="pubdate">08 Apr at 16:29:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1881">https://github.com/qt4cg/qtspecs/issues/1881</a></div><p>fn:function-identity for maps and arrays</p></div>
<div class="toot" id="closed-1895"><h2>Issue #1895 closed<span class="toot-id"> #closed-1895</span></h2><div class="pubdate">08 Apr at 16:29:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1895">https://github.com/qt4cg/qtspecs/pull/1895</a></div><p>1881 Function identity for maps and arrays</p></div>
<div class="toot" id="closed-1876"><h2>Issue #1876 closed<span class="toot-id"> #closed-1876</span></h2><div class="pubdate">08 Apr at 16:26:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1876">https://github.com/qt4cg/qtspecs/issues/1876</a></div><p>`fn:replace`:  Combine $replacement and $action parameters</p></div>
<div class="toot" id="closed-1897"><h2>Issue #1897 closed<span class="toot-id"> #closed-1897</span></h2><div class="pubdate">08 Apr at 16:26:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1897">https://github.com/qt4cg/qtspecs/pull/1897</a></div><p>1876 In fn:replace(), merge the $replacement and $action parameters</p></div>
<div class="toot" id="closed-1520"><h2>Issue #1520 closed<span class="toot-id"> #closed-1520</span></h2><div class="pubdate">08 Apr at 16:22:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1520">https://github.com/qt4cg/qtspecs/issues/1520</a></div><p>Type declarations of cyclically dependent modules</p></div>
<div class="toot" id="closed-1908"><h2>Issue #1908 closed<span class="toot-id"> #closed-1908</span></h2><div class="pubdate">08 Apr at 16:22:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1908">https://github.com/qt4cg/qtspecs/pull/1908</a></div><p>1520 Allow forwards references to named item types</p></div>
<div class="toot" id="closed-1910"><h2>Issue #1910 closed<span class="toot-id"> #closed-1910</span></h2><div class="pubdate">08 Apr at 16:20:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1910">https://github.com/qt4cg/qtspecs/pull/1910</a></div><p>1021 (part 1) Add $options arg to doc() and doc-available()</p></div>
<div class="toot" id="closed-501"><h2>Issue #501 closed<span class="toot-id"> #closed-501</span></h2><div class="pubdate">08 Apr at 16:16:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/501">https://github.com/qt4cg/qtspecs/issues/501</a></div><p>Error handling: try/finally</p></div>
<div class="toot" id="closed-1914"><h2>Issue #1914 closed<span class="toot-id"> #closed-1914</span></h2><div class="pubdate">08 Apr at 16:16:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1914">https://github.com/qt4cg/qtspecs/pull/1914</a></div><p>501 Error handling: try/finally</p></div>
<div class="toot" id="closed-1915"><h2>Issue #1915 closed<span class="toot-id"> #closed-1915</span></h2><div class="pubdate">08 Apr at 16:13:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1915">https://github.com/qt4cg/qtspecs/pull/1915</a></div><p>1902b bin:unpack out of range error</p></div>
<div class="toot" id="closed-1624"><h2>Issue #1624 closed<span class="toot-id"> #closed-1624</span></h2><div class="pubdate">08 Apr at 16:11:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1624">https://github.com/qt4cg/qtspecs/issues/1624</a></div><p>document-node(a|b) is the same type as document-node(a)|document-node(b)</p></div>
<div class="toot" id="closed-1898"><h2>Issue #1898 closed<span class="toot-id"> #closed-1898</span></h2><div class="pubdate">08 Apr at 16:11:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1898">https://github.com/qt4cg/qtspecs/pull/1898</a></div><p>1624b Expand rules for document node subtyping</p></div>
<div class="toot" id="closed-1832"><h2>Issue #1832 closed<span class="toot-id"> #closed-1832</span></h2><div class="pubdate">08 Apr at 16:07:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1832">https://github.com/qt4cg/qtspecs/issues/1832</a></div><p>Associativity of Operators, especially "||" (Appendix A.5)</p></div>
<div class="toot" id="closed-1904"><h2>Issue #1904 closed<span class="toot-id"> #closed-1904</span></h2><div class="pubdate">08 Apr at 16:07:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1904">https://github.com/qt4cg/qtspecs/pull/1904</a></div><p>1832 Operator Associativity</p></div>
<div class="toot" id="closed-564"><h2>Issue #564 closed<span class="toot-id"> #closed-564</span></h2><div class="pubdate">08 Apr at 16:06:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/564">https://github.com/qt4cg/qtspecs/issues/564</a></div><p>Sorted maps</p></div>
<div class="toot" id="closed-982"><h2>Issue #982 closed<span class="toot-id"> #closed-982</span></h2><div class="pubdate">08 Apr at 16:06:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/982">https://github.com/qt4cg/qtspecs/issues/982</a></div><p>scan-left, scan-right: position argument, array functions</p></div>
<div class="toot" id="closed-1846"><h2>Issue #1846 closed<span class="toot-id"> #closed-1846</span></h2><div class="pubdate">08 Apr at 16:06:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1846">https://github.com/qt4cg/qtspecs/issues/1846</a></div><p>%method functions, dynamic function calls</p></div>
<div class="toot" id="closed-1900"><h2>Issue #1900 closed<span class="toot-id"> #closed-1900</span></h2><div class="pubdate">08 Apr at 16:06:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1900">https://github.com/qt4cg/qtspecs/issues/1900</a></div><p>Records: instance checks</p></div>
<div class="toot" id="closed-1913"><h2>Issue #1913 closed<span class="toot-id"> #closed-1913</span></h2><div class="pubdate">08 Apr at 16:03:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1913">https://github.com/qt4cg/qtspecs/pull/1913</a></div><p>1911 Clarifications for regular expressions</p></div>
<div class="toot" id="closed-1645"><h2>Issue #1645 closed<span class="toot-id"> #closed-1645</span></h2><div class="pubdate">08 Apr at 14:29:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1645">https://github.com/qt4cg/qtspecs/issues/1645</a></div><p>fn:elements-to-maps: Debugging</p></div>
<div class="toot" id="closed-1646"><h2>Issue #1646 closed<span class="toot-id"> #closed-1646</span></h2><div class="pubdate">08 Apr at 14:28:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1646">https://github.com/qt4cg/qtspecs/issues/1646</a></div><p>fn:elements-to-maps: Robustness</p></div>
<div class="toot" id="closed-1648"><h2>Issue #1648 closed<span class="toot-id"> #closed-1648</span></h2><div class="pubdate">08 Apr at 14:27:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1648">https://github.com/qt4cg/qtspecs/issues/1648</a></div><p>fn:elements-to-maps: Types</p></div>
<div class="toot" id="closed-1909"><h2>Issue #1909 closed<span class="toot-id"> #closed-1909</span></h2><div class="pubdate">06 Apr at 23:22:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1909">https://github.com/qt4cg/qtspecs/pull/1909</a></div><p>1902 bin unpack out of range</p></div>
<div class="toot" id="created-1915"><h2>Pull request #1915 created<span class="toot-id"> #created-1915</span></h2><div class="pubdate">06 Apr at 23:21:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1915">https://github.com/qt4cg/qtspecs/pull/1915</a></div><details><summary>1902b bin:unpack out of range error</summary><div class="markup"><p>Replaces PR #1909</p>
<p>Adds error conditions for unpacking an integer that is too large for the implementation</p>
</div></details></div>
<div class="toot" id="created-1914"><h2>Pull request #1914 created<span class="toot-id"> #created-1914</span></h2><div class="pubdate">04 Apr at 16:08:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1914">https://github.com/qt4cg/qtspecs/pull/1914</a></div><details><summary>501 Error handling: try/finally</summary><div class="markup"><p>Closes #501</p>
</div></details></div>
<div class="toot" id="created-1913"><h2>Pull request #1913 created<span class="toot-id"> #created-1913</span></h2><div class="pubdate">04 Apr at 15:08:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1913">https://github.com/qt4cg/qtspecs/pull/1913</a></div><details><summary>1911 Clarifications for regular expressions</summary><div class="markup"><ol>
<li>Reinstates the non-capturing group syntax <code>(?: xxx )</code></li>
<li>Clarifies that a zero-length matching segment does not overlap an immediately preceding adjacent (but non-zero-length) segment.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1912"><h2>Issue #1912 created<span class="toot-id"> #created-1912</span></h2><div class="pubdate">04 Apr at 14:05:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1912">https://github.com/qt4cg/qtspecs/issues/1912</a></div><details><summary>Error handling: `fn:throw`</summary><div class="markup"><p>Adopted from #501:</p>
<p>In https://github.com/qt4cg/qtspecs/pull/493, a function/expression was suggested to re-throw errors:</p>
<pre><code class="language-xquery">try {
  (: wild stuff :)
} catch * {
  module:log($err:description),
  fn:throw($err:map)
}
</code></pre>
<p>Existing errors map can be modified before rethrowing them:</p>
<pre><code class="language-xquery">try {
  1 div 0
} catch * {
  module:log($err:description),
  fn:throw($err:map =&gt; map:put('description', 'Arithmetic error'))
}
</code></pre>
</div></details></div>
<div class="toot" id="created-1911"><h2>Issue #1911 created<span class="toot-id"> #created-1911</span></h2><div class="pubdate">02 Apr at 13:45:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1911">https://github.com/qt4cg/qtspecs/issues/1911</a></div><details><summary>Remarks on recent changes to regular expression handling</summary><div class="markup"><p>I would like to share these observations that I made while working on recent changes of regular expression handling per #1856.</p>
<p>The section that mentions potential rewrites of <code>\b</code> and <code>\B</code> misses to consider the start and end of the string, as well as the empty string. It should rather read:</p>
<blockquote>
<p><code>\b</code> can be rewritten to an equivalent form in terms of lookbehind and lookahead assertions:</p>
<p><code>(?:(*positive_lookbehind:\w)(?:$|(*positive_lookahead:\W))|(?:^|(*positive_lookbehind:\W))(*positive_lookahead:\w))</code></p>
<p>A similar rewrite is possible for <code>\B</code>, but it must additionally take care of the empty string.</p>
</blockquote>
<p>For <code>fn:analyze-string</code>, it might be useful to add a clarifying remark about empty matches at the end of the result (see qt4cg/qt4tests#224).</p>
<p>The specification of <code>fn:analyze-string</code> contains a duplicated word, <code>the the</code>. The same also occurs in several other places in the documents.</p>
</div></details></div>
<div class="toot" id="created-1910"><h2>Pull request #1910 created<span class="toot-id"> #created-1910</span></h2><div class="pubdate">31 Mar at 16:50:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1910">https://github.com/qt4cg/qtspecs/pull/1910</a></div><details><summary>1021 (part 1) Add $options arg to doc() and doc-available()</summary><div class="markup"><p>To follow: options for collection() and uri-collection().</p>
</div></details></div>
<div class="toot" id="created-1909"><h2>Pull request #1909 created<span class="toot-id"> #created-1909</span></h2><div class="pubdate">31 Mar at 15:40:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1909">https://github.com/qt4cg/qtspecs/pull/1909</a></div><details><summary>1902 bin unpack out of range</summary><div class="markup"><p>Add error condition.</p>
<p>Fix #1902</p>
<p>I also did some work on removing errors and warnings from the EXPath binary build.  There are a couple of outstanding issues I'm not sure how to fix:</p>
<p>(a) The function bin:bin had the incorrect id value func-bin-binary instead of func-bin-bin. I've corrected it, but the database of section ids needs updating.</p>
<p>(b) In database.xml, the EXPath binary spec is identified as document-summary/@uri = "https://qt4cg.org/specifications/EXPath/binary-40/". But the actual location of the specification is "https://qt4cg.org/specifications/expath-binary-40/"</p>
<p>(c) There are tags such as <code>&lt;code&gt;bin:index-of-range&lt;/code&gt;</code> which the stylesheet is trying to interpret as function names rather than error codes. They actually refer to obsolete error codes so we can't use <code>&lt;errorref&gt;</code></p>
</div></details></div>
<div class="toot" id="created-1908"><h2>Pull request #1908 created<span class="toot-id"> #created-1908</span></h2><div class="pubdate">31 Mar at 11:32:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1908">https://github.com/qt4cg/qtspecs/pull/1908</a></div><details><summary>1520 Allow forwards references to named item types</summary><div class="markup"><p>Fix #1520</p>
</div></details></div>
<div class="toot" id="created-1907"><h2>Issue #1907 created<span class="toot-id"> #created-1907</span></h2><div class="pubdate">29 Mar at 17:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1907">https://github.com/qt4cg/qtspecs/issues/1907</a></div><details><summary>Method lookup: wildcards</summary><div class="markup"><p>We should ignore the <code>%method</code> annotation for wildcard lookups:</p>
<pre><code class="language-xquery">let $data := { 'fn': %method fn() { . } }
return $data?*
</code></pre>
<p>I cannot see when this makes sense as it only seems to work if the wildcard lookup returns a single item (→ “selects a key/value pair whose value part is a singleton method”). In addition, it makes streaming of wildcard results troublesome.</p>
<p>If we believe we should support context value bindings for wildcards, I think it would be better to apply it to each item of the returned value, instead of the value as a whole.</p>
</div></details></div>
<div class="toot" id="created-1906"><h2>Pull request #1906 created<span class="toot-id"> #created-1906</span></h2><div class="pubdate">28 Mar at 15:16:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1906">https://github.com/qt4cg/qtspecs/pull/1906</a></div><details><summary>1797 elements-to-maps-conversion-plan function</summary><div class="markup"><p>The PR drops the "uniform" option of <code>elements-to-maps</code> into a separate function <code>elements-to-maps-conversion-plan</code>, which can be used to analyze a corpus of data and generate a conversion plan for use by <code>elements-to-maps</code>. This is useful when the conversion is to be applied to documents that are not part of the corpus, for example when new documents arrive for conversion every day and need to be converted in a consistent way. It also provides a more general mechanism for users to override the system decisions on what layouts to use for what elements.</p>
<p>The PR is not entirely complete at this stage: the technical detail is all there, but examples need to be reviewed. Comments are welcome at this stage.</p>
<p>There are a few other minor changes. The most notable are:</p>
<ul>
<li>More consistent fallback when an inappropriate layout is chosen. If the layout does not allow attributes, then attributes are discarded; if there is any other mismatch, the converter falls back to serialized XML layout.</li>
<li>Better handling of boolean and numeric element and attribute content.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1905"><h2>Issue #1905 created<span class="toot-id"> #created-1905</span></h2><div class="pubdate">27 Mar at 15:40:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1905">https://github.com/qt4cg/qtspecs/issues/1905</a></div><details><summary>Editorial edits</summary><div class="markup"><p>XQFO:</p>
<ul>
<li>Buggy examples/results: <code>map:put</code>, <code>map:of-pairs</code>, <code>fn:scan-left</code></li>
<li>duplicates: <code>the the</code>, …</li>
<li>Boolean defaults: <code>true()</code>/<code>false()</code> vs. <code>true</code>/<code>false</code></li>
</ul>
<p>…to be continued</p>
</div></details></div>
<div class="toot" id="created-1904"><h2>Pull request #1904 created<span class="toot-id"> #created-1904</span></h2><div class="pubdate">27 Mar at 11:42:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1904">https://github.com/qt4cg/qtspecs/pull/1904</a></div><details><summary>1832 Operator Associativity</summary><div class="markup"><p>Update the table and explanatory notes.</p>
<p>Fix #1832</p>
</div></details></div>
<div class="toot" id="created-1903"><h2>Issue #1903 created<span class="toot-id"> #created-1903</span></h2><div class="pubdate">27 Mar at 11:27:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1903">https://github.com/qt4cg/qtspecs/issues/1903</a></div><details><summary>`fn:scan-left`, `fn:scan-right`: missing steps</summary><div class="markup"><p>I have labeled #982 (which included position arguments) to be closed to focus on the remaining todos:</p>
<ol>
<li>The types of the <code>$action</code> parameters of <code>fn:fold-right</code> and <code>fn:scan-right</code> should be aligned. In particular, <code>item()*</code> and <code>item()</code> of the scan function should be swapped: → #1919</li>
</ol>
<pre><code class="language-xquery">fn:fold-right(
  $input   as item()*,	
  $init    as item()*,	
  $action  as fn(item(), item()*) as item()*	
) as item()*

fn:scan-right(
  $input   as item()*,	
  $init    as item()*,	
  $action  as fn(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<ol start="2">
<li>The result of the last example of <code>fn:scan-left</code> is syntactically wrong. → #1919</li>
<li>The equivalent array functions are still missing (if we still believe we want to include them).</li>
<li>We need tests.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1902"><h2>Issue #1902 created<span class="toot-id"> #created-1902</span></h2><div class="pubdate">27 Mar at 10:20:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1902">https://github.com/qt4cg/qtspecs/issues/1902</a></div><details><summary>`binary:unpack-integer`, overflow/underflow</summary><div class="markup"><p>If <code>binary:unpack-integer</code> or <code>binary:unpack-unsigned-integer</code> generates a value that exceeds the range supported by the implementation, <code>err:FOAR0002</code> should be raised.</p>
<p>Related: https://github.com/expath/expath-cg/issues/116</p>
</div></details></div>
<div class="toot" id="created-1901"><h2>Pull request #1901 created<span class="toot-id"> #created-1901</span></h2><div class="pubdate">27 Mar at 00:44:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1901">https://github.com/qt4cg/qtspecs/pull/1901</a></div><details><summary>1363 fallback becomes a value not a function</summary><div class="markup"><p>Issue #1363 generated a large amount of discussion on how to handle absent keys in map:get() and out-of-range indexes in array:get().</p>
<p>I felt that one of the simplest proposals was to change the $fallback argument to be a simple default value, rather than a function. This eliminates some of the more "clever" use cases, but these can always be achieved in other ways, as the discussion thread demonstrates. Meanwhile reducing <code>$fallback</code> to a simple default value makes life easier for the 90% of cases where this is all that is needed (especially for arrays, when the desire is to return a default value rather than throwing an error).</p>
<p>This PR therefore implements that simple proposal.</p>
<p>Fix #1363</p>
</div></details></div>
<div class="toot" id="closed-1766"><h2>Issue #1766 closed<span class="toot-id"> #closed-1766</span></h2><div class="pubdate">26 Mar at 15:26:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1766">https://github.com/qt4cg/qtspecs/pull/1766</a></div><p>1715 Drop array bound checking</p></div>
<div class="toot" id="created-1900"><h2>Issue #1900 created<span class="toot-id"> #created-1900</span></h2><div class="pubdate">26 Mar at 14:13:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1900">https://github.com/qt4cg/qtspecs/issues/1900</a></div><details><summary>Records: instance checks</summary><div class="markup"><p>Continues #1862:</p>
<p>In the last meeting, we discussed whether the order of record entries should be considered in instance checks. After further reflection and attempts to implement it, I believe this will make things much easier in the long term:</p>
<p>In <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-item-coercion-rules">3.4.1 Item Coercion Rules</a>, the coercion of records was added as a second exceptional case: The coercion may change the item in question even if the upstream instance check is succesful. This leads to additional action that I believe could simply be avoided if the successful instance means that no further action is required. I think it will also reduce possible cost that was indicated in https://github.com/qt4cg/qtspecs/issues/1862#issuecomment-2709104860.</p>
<p>Note: This issue clearly focuses on implications for the implementation. From a user perspective, I assume it will hardly ever make a difference whether we consider order or not. My assumption is that nearly all records will have the expected order anyway, or they will match the order once the first coercion has taken place.</p>
<p>All this takes time to specify. I will be glad to make an attempt and write the PR.</p>
</div></details></div>
<div class="toot" id="closed-1899"><h2>Issue #1899 closed<span class="toot-id"> #closed-1899</span></h2><div class="pubdate">26 Mar at 08:42:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1899">https://github.com/qt4cg/qtspecs/pull/1899</a></div><p>Superflous whitespace change to nudge CI; apologies for the noise.</p></div>
<div class="toot" id="created-1899"><h2>Pull request #1899 created<span class="toot-id"> #created-1899</span></h2><div class="pubdate">26 Mar at 08:26:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1899">https://github.com/qt4cg/qtspecs/pull/1899</a></div><p>Superflous whitespace change to nudge CI; apologies for the noise.</p></div>
<div class="toot" id="closed-1660"><h2>Issue #1660 closed<span class="toot-id"> #closed-1660</span></h2><div class="pubdate">25 Mar at 20:23:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1660">https://github.com/qt4cg/qtspecs/issues/1660</a></div><p>Further suggestions for fn:path</p></div>
<div class="toot" id="closed-1747"><h2>Issue #1747 closed<span class="toot-id"> #closed-1747</span></h2><div class="pubdate">25 Mar at 20:05:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1747">https://github.com/qt4cg/qtspecs/issues/1747</a></div><p>Function finder is broken</p></div>
<div class="toot" id="closed-1858"><h2>Issue #1858 closed<span class="toot-id"> #closed-1858</span></h2><div class="pubdate">25 Mar at 19:07:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1858">https://github.com/qt4cg/qtspecs/pull/1858</a></div><p>Initial xsl:record</p></div>
<div class="toot" id="closed-1870"><h2>Issue #1870 closed<span class="toot-id"> #closed-1870</span></h2><div class="pubdate">25 Mar at 19:00:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1870">https://github.com/qt4cg/qtspecs/issues/1870</a></div><p>Rename $zero keyword of fold-left and fold-right</p></div>
<div class="toot" id="closed-1887"><h2>Issue #1887 closed<span class="toot-id"> #closed-1887</span></h2><div class="pubdate">25 Mar at 18:59:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1887">https://github.com/qt4cg/qtspecs/pull/1887</a></div><p>1870 rename $zero keyword of fold functions</p></div>
<div class="toot" id="closed-1886"><h2>Issue #1886 closed<span class="toot-id"> #closed-1886</span></h2><div class="pubdate">25 Mar at 18:48:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1886">https://github.com/qt4cg/qtspecs/pull/1886</a></div><p>1660 Additional options for fn:path</p></div>
<div class="toot" id="closed-1862"><h2>Issue #1862 closed<span class="toot-id"> #closed-1862</span></h2><div class="pubdate">25 Mar at 18:47:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1862">https://github.com/qt4cg/qtspecs/issues/1862</a></div><p>Records: consider order</p></div>
<div class="toot" id="closed-1874"><h2>Issue #1874 closed<span class="toot-id"> #closed-1874</span></h2><div class="pubdate">25 Mar at 18:47:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1874">https://github.com/qt4cg/qtspecs/pull/1874</a></div><p>1862 Coercing to a record type changes map order</p></div>
<div class="toot" id="closed-1861"><h2>Issue #1861 closed<span class="toot-id"> #closed-1861</span></h2><div class="pubdate">25 Mar at 18:46:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1861">https://github.com/qt4cg/qtspecs/issues/1861</a></div><p>xsl:next-match with-all-params</p></div>
<div class="toot" id="closed-1875"><h2>Issue #1875 closed<span class="toot-id"> #closed-1875</span></h2><div class="pubdate">25 Mar at 18:46:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1875">https://github.com/qt4cg/qtspecs/pull/1875</a></div><p>1861 Params passed automatically through next-match</p></div>
<div class="toot" id="created-1898"><h2>Pull request #1898 created<span class="toot-id"> #created-1898</span></h2><div class="pubdate">25 Mar at 15:33:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1898">https://github.com/qt4cg/qtspecs/pull/1898</a></div><details><summary>1624b Expand rules for document node subtyping</summary><div class="markup"><p>Fix #1624</p>
</div></details></div>
<div class="toot" id="created-1897"><h2>Pull request #1897 created<span class="toot-id"> #created-1897</span></h2><div class="pubdate">25 Mar at 11:57:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1897">https://github.com/qt4cg/qtspecs/pull/1897</a></div><details><summary>1876 In fn:replace(), merge the $replacement and $action parameters</summary><div class="markup"><p>Fix #1876</p>
</div></details></div>
<div class="toot" id="closed-1884"><h2>Issue #1884 closed<span class="toot-id"> #closed-1884</span></h2><div class="pubdate">25 Mar at 11:10:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1884">https://github.com/qt4cg/qtspecs/issues/1884</a></div><p>Deep-equality keys</p></div>
<div class="toot" id="created-1896"><h2>Issue #1896 created<span class="toot-id"> #created-1896</span></h2><div class="pubdate">25 Mar at 10:59:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1896">https://github.com/qt4cg/qtspecs/issues/1896</a></div><details><summary>Drop "parameter names" as a property of a function item</summary><div class="markup"><p>One of the properties of function items is the parameter names.</p>
<p>This property is unused; there is nothing that depends on the value of this property, and no way of discovering the value, and it isn't defined for all function items, e.g. maps and arrays, or functions returned by functions such as fn:op. It causes complications, such as whether two functions can have the same identity if they have different parameter names. I propose to drop it.</p>
<p>Of course, there are open issues that suggest allowing parameter names to be used in dynamic function calls. But I see little chance of coming up with a design that achieves this, because in general when you're given a function item to call, you have no idea what the parameter names are, and the person supplying the function item has very little control over what the parameter names will be.</p>
</div></details></div>
<div class="toot" id="created-1895"><h2>Pull request #1895 created<span class="toot-id"> #created-1895</span></h2><div class="pubdate">25 Mar at 10:15:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1895">https://github.com/qt4cg/qtspecs/pull/1895</a></div><details><summary>1881 Function identity for maps and arrays</summary><div class="markup"><p>Supplies rules for how <code>fn:function-identity()</code> should handle maps and arrays.</p>
<p>Also makes the point that labels are ignored. There's a general statement to the effect in XDM that labels are ignored except where otherwise specified, but it's useful to avoid any doubt here.</p>
<p>Fix #1881</p>
</div></details></div>
<div class="toot" id="closed-1892"><h2>Issue #1892 closed<span class="toot-id"> #closed-1892</span></h2><div class="pubdate">24 Mar at 18:07:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1892">https://github.com/qt4cg/qtspecs/pull/1892</a></div><p>Dnovatchev dn examples (ignore this)</p></div>
<div class="toot" id="created-1894"><h2>Pull request #1894 created<span class="toot-id"> #created-1894</span></h2><div class="pubdate">24 Mar at 17:32:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1894">https://github.com/qt4cg/qtspecs/pull/1894</a></div><details><summary>Additional examples to fn:chain - in a new branch</summary><div class="markup"><p>Re-submitted the same as PR 1890.
Added some new examples to fn:chain.</p>
</div></details></div>
<div class="toot" id="closed-1890"><h2>Issue #1890 closed<span class="toot-id"> #closed-1890</span></h2><div class="pubdate">24 Mar at 17:11:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1890">https://github.com/qt4cg/qtspecs/pull/1890</a></div><p>More examples added to fn:chain</p></div>
<div class="toot" id="closed-1893"><h2>Issue #1893 closed<span class="toot-id"> #closed-1893</span></h2><div class="pubdate">24 Mar at 17:01:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1893">https://github.com/qt4cg/qtspecs/pull/1893</a></div><p>Fix broken markup</p></div>
<div class="toot" id="created-1893"><h2>Pull request #1893 created<span class="toot-id"> #created-1893</span></h2><div class="pubdate">24 Mar at 16:48:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1893">https://github.com/qt4cg/qtspecs/pull/1893</a></div><details><summary>Fix broken markup</summary><div class="markup"><p>I cannot imagine how we got a merged PR that included broken markup, but it's probably made a mess of the diffs recently.</p>
</div></details></div>
<div class="toot" id="created-1892"><h2>Pull request #1892 created<span class="toot-id"> #created-1892</span></h2><div class="pubdate">24 Mar at 15:56:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1892">https://github.com/qt4cg/qtspecs/pull/1892</a></div><details><summary>Dnovatchev dn examples (ignore this)</summary><div class="markup"><p>This PR #1890 rebased off master to test if it makes for cleaner diffs.</p>
</div></details></div>
<div class="toot" id="created-1891"><h2>Issue #1891 created<span class="toot-id"> #created-1891</span></h2><div class="pubdate">24 Mar at 12:26:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1891">https://github.com/qt4cg/qtspecs/issues/1891</a></div><details><summary>`fn:parse-html`: `html-version`</summary><div class="markup"><p>Maybe we can align the HTML versions that <code>fn:parse-html</code> needs to support with the remaining specification. It currently says:</p>
<blockquote>
<p>Valid values an implementation must support for the <code>html</code> method are:
<code>3</code>, <code>3.2</code> for HTML 3.2 W3C Recommendation, 14 January 1997
<code>4</code>, <code>4.01</code> for HTML 4.01 W3C Recommendation, 24 December 1999
<code>5.0</code> for HTML5 W3C Recommendation, 28 October 2014
<code>5.1</code> for HTML 5.1 W3C Recommendation, 1 November 2016
<code>5.2</code> for HTML 5.2 W3C Recommendation, 14 December 2017
<code>LS</code> for HTML Living Standard, WHATWG
<code>5</code> may be equivalent to any of <code>5.0</code>, <code>5.1</code>, <code>5.2</code>, or <code>LS</code></p>
</blockquote>
<p>In the XQFO and Serialization specs, only HTML 4.0/4.01 and HTML 5 are mentioned.</p>
<p>@rhdunn Do you have an opinion on this?</p>
<p>Related: #1889</p>
</div></details></div>
<div class="toot" id="created-1890"><h2>Pull request #1890 created<span class="toot-id"> #created-1890</span></h2><div class="pubdate">23 Mar at 22:34:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1890">https://github.com/qt4cg/qtspecs/pull/1890</a></div><details><summary>More examples added to fn:chain</summary><div class="markup"><p>Added 6 more examples and tests
All are correctly executed.</p>
</div></details></div>
<div class="toot" id="created-1889"><h2>Issue #1889 created<span class="toot-id"> #created-1889</span></h2><div class="pubdate">20 Mar at 15:32:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1889">https://github.com/qt4cg/qtspecs/issues/1889</a></div><details><summary>HTML serialization: `html-version` and `version` parameters; allowed values</summary><div class="markup"><p>The serialization spec says (<a href="https://qt4cg.org/specifications/xslt-xquery-serialization-40/Overview.html#HTML_VERSION">HTML Output Method: the version and html-version Parameters</a>):</p>
<blockquote>
<p>If the <code>html-version</code> serialization parameter is not absent, the requested HTML version is the value of the <code>html-version</code> serialization parameter; otherwise, it is the value of the <code>version</code> serialization parameter.</p>
</blockquote>
<p><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-serialize">fn:serialize</a> defines the following defaults:</p>
<ul>
<li><code>html-version</code>: <code>5</code></li>
<li><code>version</code>: <code>1.0</code></li>
</ul>
<p>I wonder whether these rules cover all possible cases:</p>
<ol>
<li>Is it correct that HTML will be serialized as HTML5 if no options are supplied?</li>
</ol>
<pre><code class="language-xquery">(: html-version=5 :) 
serialize(&lt;html/&gt;, { 'method': 'html' })
</code></pre>
<ol start="2">
<li>If only <code>version</code> is supplied, is it correct that it is ignored because of <code>html-version</code> defaulting to <code>5</code>?</li>
</ol>
<pre><code class="language-xquery">(: html-version=5 ? :) 
serialize(&lt;html/&gt;, { 'method': 'html', 'version': '4.01' })
</code></pre>
<ol start="3">
<li>If no, i.e., if <code>{ 'version': '4.01' }</code> is expected to overwrite the default for <code>html-version</code>, how can we know at which stage the default values are to be considered?</li>
</ol>
<p>In addition, the serialization specification mentions versions HTML 4.01 and HTML5 various times, but it seems to be up to the implementation to decide which HTML versions to support. However, we seem to have test cases for <code>4.0</code> and <code>5</code>. Would it make sense to define a miminum set of versions that need to be supported?</p>
<p>Finally, for some reason, the <code>html-version</code> parameter was defined to be a decimal, whereas <code>version</code> is defined as a string (since XQFO 3.1). Maybe this leads to the surprising result that Saxon seems to accept the option <code>{ 'version': '4.0' }</code>, but rejects <code>{ 'html-version': 4 }</code>.</p>
</div></details></div>
<div class="toot" id="created-1888"><h2>Pull request #1888 created<span class="toot-id"> #created-1888</span></h2><div class="pubdate">20 Mar at 04:57:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1888">https://github.com/qt4cg/qtspecs/pull/1888</a></div><details><summary>366 xsl:package-location</summary><div class="markup"><p>First draft, for initial feedback.</p>
<p>Notes:</p>
<ul>
<li>Because the CG has little energy/resources to develop the EXPath Zip module, I have situated the question of archive (compressed or not) in the URI scheme itself. There are dozens of archives, dozens of URI schemes. The only case where I have found overlap is in the <code>jar:</code> scheme/archive. Yes, I've seen <code>zip:</code> used as an alias for <code>jar:</code>, but it's not an official IANA URI scheme. This may need discussion.</li>
<li>I have opted to bind <code>@priority</code> to a non-zero integer. This is the first time the constraint for the union of positive and negative integers has been placed on an XSLT attribute, so I may not have correctly set up <code>element-catalog.xml</code>.</li>
<li>I have opted to not make attribute values <code>format</code>, <code>name</code>, and <code>version</code> as criteria for the priority package location (new term), so that developers can be warned when the package is at odds with the declaration. To make them criteria would mean that inconsistencies between the declaration and the referenced packages would remain undetected.</li>
<li>I adopted the terms "URL" and "entry" based upon the IANA nomenclature for the jar: scheme.</li>
<li>I may have overthought the distinction between archive and non-archive URIs. Feedback is appreciated.</li>
<li>Error code <code>3000</code> has been broken up into different possible errors.</li>
<li>Suggestions on the type and number of tests that need to be written for the test suite are welcome.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1887"><h2>Pull request #1887 created<span class="toot-id"> #created-1887</span></h2><div class="pubdate">18 Mar at 21:29:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1887">https://github.com/qt4cg/qtspecs/pull/1887</a></div><details><summary>1870 rename $zero keyword of fold functions</summary><div class="markup"><p>Fix #1870</p>
</div></details></div>
<div class="toot" id="closed-998"><h2>Issue #998 closed<span class="toot-id"> #closed-998</span></h2><div class="pubdate">18 Mar at 20:54:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/998">https://github.com/qt4cg/qtspecs/issues/998</a></div><p>regular expression addition - lookbehind assertions and lookahead assertions</p></div>
<div class="toot" id="closed-1848"><h2>Issue #1848 closed<span class="toot-id"> #closed-1848</span></h2><div class="pubdate">18 Mar at 20:53:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1848">https://github.com/qt4cg/qtspecs/issues/1848</a></div><p>Define regular expressions using XSD 1.1 as baseline</p></div>
<div class="toot" id="closed-1856"><h2>Issue #1856 closed<span class="toot-id"> #closed-1856</span></h2><div class="pubdate">18 Mar at 20:50:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1856">https://github.com/qt4cg/qtspecs/pull/1856</a></div><p>998 Add boundary and lookahead/behind assertions</p></div>
<div class="toot" id="created-1886"><h2>Pull request #1886 created<span class="toot-id"> #created-1886</span></h2><div class="pubdate">18 Mar at 18:33:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1886">https://github.com/qt4cg/qtspecs/pull/1886</a></div><p>1660 Additional options for fn:path</p></div>
<div class="toot" id="closed-1860"><h2>Issue #1860 closed<span class="toot-id"> #closed-1860</span></h2><div class="pubdate">18 Mar at 17:36:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1860">https://github.com/qt4cg/qtspecs/issues/1860</a></div><p>fn:parse-xml: DTDs, external resources</p></div>
<div class="toot" id="closed-1857"><h2>Issue #1857 closed<span class="toot-id"> #closed-1857</span></h2><div class="pubdate">18 Mar at 17:36:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1857">https://github.com/qt4cg/qtspecs/issues/1857</a></div><p>fn:parse-xml: `xinclude`</p></div>
<div class="toot" id="closed-1879"><h2>Issue #1879 closed<span class="toot-id"> #closed-1879</span></h2><div class="pubdate">18 Mar at 17:36:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1879">https://github.com/qt4cg/qtspecs/pull/1879</a></div><p>1857, 1860: Add more options to parse-xml</p></div>
<div class="toot" id="closed-1882"><h2>Issue #1882 closed<span class="toot-id"> #closed-1882</span></h2><div class="pubdate">18 Mar at 17:34:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1882">https://github.com/qt4cg/qtspecs/pull/1882</a></div><p>982 Editorial rewrite of scan-left and scan-right</p></div>
<div class="toot" id="closed-1866"><h2>Issue #1866 closed<span class="toot-id"> #closed-1866</span></h2><div class="pubdate">18 Mar at 17:32:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1866">https://github.com/qt4cg/qtspecs/issues/1866</a></div><p>Ambiguities introduced by #1864</p></div>
<div class="toot" id="closed-1877"><h2>Issue #1877 closed<span class="toot-id"> #closed-1877</span></h2><div class="pubdate">18 Mar at 17:32:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1877">https://github.com/qt4cg/qtspecs/pull/1877</a></div><p>1866 Disambiguate TypeSpecifier syntax</p></div>
<div class="toot" id="closed-1867"><h2>Issue #1867 closed<span class="toot-id"> #closed-1867</span></h2><div class="pubdate">18 Mar at 17:30:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1867">https://github.com/qt4cg/qtspecs/pull/1867</a></div><p>1341 Drop position from fold callbacks</p></div>
<div class="toot" id="closed-1869"><h2>Issue #1869 closed<span class="toot-id"> #closed-1869</span></h2><div class="pubdate">18 Mar at 17:28:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1869">https://github.com/qt4cg/qtspecs/issues/1869</a></div><p>`fn:duplicate-values`: Order of results</p></div>
<div class="toot" id="closed-1873"><h2>Issue #1873 closed<span class="toot-id"> #closed-1873</span></h2><div class="pubdate">18 Mar at 17:28:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1873">https://github.com/qt4cg/qtspecs/pull/1873</a></div><p>1869 duplicate values</p></div>
<div class="toot" id="closed-1851"><h2>Issue #1851 closed<span class="toot-id"> #closed-1851</span></h2><div class="pubdate">18 Mar at 17:26:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1851">https://github.com/qt4cg/qtspecs/issues/1851</a></div><p>Questions on `fn:atomic-type-annotation`</p></div>
<div class="toot" id="closed-1878"><h2>Issue #1878 closed<span class="toot-id"> #closed-1878</span></h2><div class="pubdate">18 Mar at 17:26:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1878">https://github.com/qt4cg/qtspecs/pull/1878</a></div><p>1851 Make ?variety optional; explain namespace-sensitive</p></div>
<div class="toot" id="closed-1863"><h2>Issue #1863 closed<span class="toot-id"> #closed-1863</span></h2><div class="pubdate">18 Mar at 17:24:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1863">https://github.com/qt4cg/qtspecs/issues/1863</a></div><p>add \U \u L \u \E to replace() (case conversion)</p></div>
<div class="toot" id="closed-1880"><h2>Issue #1880 closed<span class="toot-id"> #closed-1880</span></h2><div class="pubdate">18 Mar at 17:23:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1880">https://github.com/qt4cg/qtspecs/pull/1880</a></div><p>Editorial revision of fn:function-identity</p></div>
<div class="toot" id="created-1885"><h2>Issue #1885 created<span class="toot-id"> #created-1885</span></h2><div class="pubdate">18 Mar at 16:51:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1885">https://github.com/qt4cg/qtspecs/issues/1885</a></div><details><summary>Use the spcification grammar markup to define the regular expression grammar in F&amp;O</summary><div class="markup"><p>The grammar for regular expressions in the regular expression section of F&amp;O is currently defined as a code block. Making it use the grammar markup used to define the pattern, XPath, and XQuery grammars would:</p>
<ol>
<li>give the grammar a unified appearance with the other grammars;</li>
<li>allow grammar elements to be cross referenced and linked back to the grammar.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1884"><h2>Issue #1884 created<span class="toot-id"> #created-1884</span></h2><div class="pubdate">17 Mar at 18:18:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1884">https://github.com/qt4cg/qtspecs/issues/1884</a></div><details><summary>Deep-equality keys</summary><div class="markup"><p>Issue #119 proposes extending maps to allow arbitrary values as keys. This is very difficult to achieve, (a) because the fact that keys are atomic items is deeply embedded in the design of a number of functions and operations on maps, and (b) because it's very hard to define an equality function that suits everyone.</p>
<p>The way we tacked variable equality semantics for strings was via the collation-key() function, which takes a string and a collation as input and produces an opaque key value, which can be used as a key in maps, and which reflects the desired equality semantics.</p>
<p>We could extend the same idea to values other than strings. In particular, we could define a deep-equality-key() that can be calculated for any sequence, and that takes all the matching options of the deep-equal() function as a parameter. (We could then redefine <code>deep-equal(a, b, options)</code> to mean <code>deep-equality-key(a, options) eq deep-equality-key(b, options)</code>).</p>
<p>The main drawback is that the deep-equality-keys for large node trees or maps would be rather long strings. People might use the functionality without realising the expense.</p>
<p>Another problem is that one of our options in deep-equals() is a callback function for item equality, and we couldn't replicate this when computing a key. But this callback is the only way we have, for example, to compare nodes by identity rather than by content.</p>
<p>Note that an internal deep-equality-key concept (or at least a deep-equality hashcode) is needed anyway for efficient implementation of deep-equals where order is deemed irrelevant. Without it, the function becomes O(n^2). Quite independently of this proposal, we should perhaps have an explicit option on deep-equals() to compare nodes by identity.</p>
</div></details></div>
<div class="toot" id="closed-1296"><h2>Issue #1296 closed<span class="toot-id"> #closed-1296</span></h2><div class="pubdate">17 Mar at 09:47:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1296">https://github.com/qt4cg/qtspecs/pull/1296</a></div><p>982 Rewrite of scan-left and scan-right</p></div>
<div class="toot" id="created-1883"><h2>Pull request #1883 created<span class="toot-id"> #created-1883</span></h2><div class="pubdate">16 Mar at 18:19:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1883">https://github.com/qt4cg/qtspecs/pull/1883</a></div><details><summary>882 Replace fn:chain by fn:compose</summary><div class="markup"><p>Drops the existing fn:chain function and replaces it with a new fn:compose function.</p>
<p>This combines two separate changes:</p>
<p>(a) whereas fn:chain applies a sequence of functions to an input, fn:compose returns a composite function that can be used repeatedly with different inputs.</p>
<p>(b) the fn:compose function is restricted to arity-1 functions, which leads to a much simpler specification that still handles the vast majority of practical use cases.</p>
<p>In particular, note that if the sequence of functions to be applied is statically known, then it can always be written out explicitly; the real use case for this function is when the sequence of functions is constructed dynamically. And in this situation, fn:chain in its current form can easily fail because of problems with the arity of the functions included in the chain.</p>
</div></details></div>
<div class="toot" id="closed-1865"><h2>Issue #1865 closed<span class="toot-id"> #closed-1865</span></h2><div class="pubdate">16 Mar at 17:13:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><p>Callback functions, position argument: consistency</p></div>
<div class="toot" id="created-1882"><h2>Pull request #1882 created<span class="toot-id"> #created-1882</span></h2><div class="pubdate">16 Mar at 00:09:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1882">https://github.com/qt4cg/qtspecs/pull/1882</a></div><details><summary>982 Editorial rewrite of scan-left and scan-right</summary><div class="markup"><p>This is intended to be purely an editorial rewrite, it does not change the functionality.</p>
<p>Replaces #1296.</p>
<p>Addresses #982, but we still need to add corresponding functions for arrays.</p>
</div></details></div>
<div class="toot" id="created-1881"><h2>Issue #1881 created<span class="toot-id"> #created-1881</span></h2><div class="pubdate">15 Mar at 08:28:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1881">https://github.com/qt4cg/qtspecs/issues/1881</a></div><details><summary>fn:function-identity for maps and arrays</summary><div class="markup"><p>The data model spec says that function identity is not defined for maps and arrays.</p>
<p>The specification of fn:function-identity() fails to mention this fact.</p>
</div></details></div>
<div class="toot" id="created-1880"><h2>Pull request #1880 created<span class="toot-id"> #created-1880</span></h2><div class="pubdate">15 Mar at 01:16:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1880">https://github.com/qt4cg/qtspecs/pull/1880</a></div><details><summary>Editorial revision of fn:function-identity</summary><div class="markup"><p>Tidies up the text and adds examples</p>
</div></details></div>
<div class="toot" id="created-1879"><h2>Pull request #1879 created<span class="toot-id"> #created-1879</span></h2><div class="pubdate">14 Mar at 15:50:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1879">https://github.com/qt4cg/qtspecs/pull/1879</a></div><details><summary>1857, 1860: Add more options to parse-xml</summary><div class="markup"><p>Add options to control entity expansion and XInclude processing.</p>
<p>Fix #1857
Fix #1860</p>
</div></details></div>
<div class="toot" id="created-1878"><h2>Pull request #1878 created<span class="toot-id"> #created-1878</span></h2><div class="pubdate">14 Mar at 14:58:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1878">https://github.com/qt4cg/qtspecs/pull/1878</a></div><details><summary>1851 Make ?variety optional; explain namespace-sensitive</summary><div class="markup"><p>Fix #1851</p>
<p>Allow ?variety to be absent e.g. for xs:anySimpleType</p>
<p>Define namespace-sensitive by an xtermref to the definition in the XP/XQ spec.</p>
</div></details></div>
<div class="toot" id="created-1877"><h2>Pull request #1877 created<span class="toot-id"> #created-1877</span></h2><div class="pubdate">14 Mar at 14:38:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1877">https://github.com/qt4cg/qtspecs/pull/1877</a></div><details><summary>1866 Disambiguate TypeSpecifier syntax</summary><div class="markup"><p>Fix #1866</p>
</div></details></div>
<div class="toot" id="created-1876"><h2>Issue #1876 created<span class="toot-id"> #created-1876</span></h2><div class="pubdate">14 Mar at 13:10:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1876">https://github.com/qt4cg/qtspecs/issues/1876</a></div><details><summary>`fn:replace`:  Combine $replacement and $action parameters</summary><div class="markup"><p>We could combine the competing <code>$replacement</code> and <code>$action</code> parameters:</p>
<pre><code class="language-xquery">replace(
  'this is a test',
  '(\w)(\w+)?',
  fn($s, $g) { upper-case($g[1]) || lower-case($g[2]) }
)
</code></pre>
<p>Original comment: https://github.com/qt4cg/qtspecs/issues/1863#issuecomment-2711149296</p>
</div></details></div>
<div class="toot" id="created-1875"><h2>Pull request #1875 created<span class="toot-id"> #created-1875</span></h2><div class="pubdate">14 Mar at 11:27:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1875">https://github.com/qt4cg/qtspecs/pull/1875</a></div><details><summary>1861 Params passed automatically through next-match</summary><div class="markup"><p>Fix #1861</p>
</div></details></div>
<div class="toot" id="created-1874"><h2>Pull request #1874 created<span class="toot-id"> #created-1874</span></h2><div class="pubdate">14 Mar at 10:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1874">https://github.com/qt4cg/qtspecs/pull/1874</a></div><details><summary>1862 Coercing to a record type changes map order</summary><div class="markup"><p>Fix #1862</p>
</div></details></div>
<div class="toot" id="created-1873"><h2>Pull request #1873 created<span class="toot-id"> #created-1873</span></h2><div class="pubdate">14 Mar at 09:55:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1873">https://github.com/qt4cg/qtspecs/pull/1873</a></div><details><summary>1869 duplicate values</summary><div class="markup"><p>Fix #1869</p>
</div></details></div>
<div class="toot" id="created-1872"><h2>Issue #1872 created<span class="toot-id"> #created-1872</span></h2><div class="pubdate">13 Mar at 11:31:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1872">https://github.com/qt4cg/qtspecs/issues/1872</a></div><details><summary>Arrays: members → values / entries?</summary><div class="markup"><p>I am pretty sure the first reaction will be DONT!, but for the sake of consistency it seems important enough for me to bring this up:</p>
<p>Could we rename array “members” to “values”?</p>
<p>Some advantages that I would see:</p>
<ul>
<li>We could treat arrays and maps more similarly.</li>
<li>We already have a <code>values</code> lookup key specifier for arrays.</li>
<li>No 3.1 array function contains the string “member”, so we will not introduce any backward inconsistencies.</li>
<li>All 4.0 features that use this string could be safely renamed.</li>
</ul>
<p>Of course the term “values” is a very common one, but we have to decided to stick with “map values” – and arrays and maps are very similar.</p>
<p>Finally, I noticed that also the term “member” has different meanings in the spec and is not exclusively used for arrays (e.g. in the rules for <code>fn:innermost</code>, <code>fn:format-integer</code> or for members of union types).</p>
</div></details></div>
<div class="toot" id="closed-1338"><h2>Issue #1338 closed<span class="toot-id"> #closed-1338</span></h2><div class="pubdate">13 Mar at 10:40:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1338">https://github.com/qt4cg/qtspecs/issues/1338</a></div><p>Arrays and maps: Members, entries, values, contents, pairs, …</p></div>
<div class="toot" id="created-1871"><h2>Issue #1871 created<span class="toot-id"> #created-1871</span></h2><div class="pubdate">13 Mar at 10:39:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1871">https://github.com/qt4cg/qtspecs/issues/1871</a></div><details><summary>Arrays and maps: consistency</summary><div class="markup"><h3>Suggestions (based on #1338, related: #1868)</h3>
<ol>
<li>In symmetry with the <code>pairs</code> lookup specifier, we should add <code>array:pairs</code> and an inverse <code>array:of-pairs</code> function.</li>
<li>In symmetry with the <code>values</code> lookup specifier, we should add <code>array:values</code> and <code>map:values</code> functions, to retrieve the values of maps and the members of arrays as a sequence of arrays.</li>
<li>In return, <code>array:members</code> and <code>array:of-members</code> seem redundant, and we should drop them.</li>
<li>In analogy with the <code>keys</code> specifier and <code>map:keys</code>, we should add <code>array:keys</code> (which returns a dense integer range).</li>
</ol>
<h3>Background</h3>
<p>With version 4.0, we are adding a lot of promising and powerful new map and array features. This is a big step forward, compared to the obvious limitations of 3.1.</p>
<p>Some aspects of the 3.1 design have made it difficult (or impossible) to fully adjust array and maps, but (in my opinion) the old overall concept was impressively consistent – and it is definitely a big challenge to achieve a 4.0 design that is not too fragmented.</p>
<p>To me, this becomes particularly evident in the case of arrays. The following example sums up the items of all members of an array. For the cumbersome 3.1 solution…</p>
<pre><code class="language-xquery">for $pos in 1 to array:size($array)
return sum($array($pos))
</code></pre>
<p>…we now have several (roughly?) equivalent options to do this:</p>
<ol>
<li><code>for member $m in $array return sum($m)</code></li>
<li><code>array:members($array) ! sum(?value)</code></li>
<li><code>$array?pairs::* ! sum(?value)</code></li>
<li><code>$array?values::* ! sum(.)</code></li>
</ol>
<p>The examples above imply that:</p>
<ul>
<li>for 1., an <em>array member</em> is a sequence;</li>
<li>for 2., an <em>array member</em> is a map;</li>
<li>for 3., an <em>array</em> has pairs (but there is no <code>array:pairs</code>);</li>
<li>for 4., an <em>array</em> has values (but there is no <code>array:values</code>).</li>
</ul>
</div></details></div>
<div class="toot" id="created-1870"><h2>Issue #1870 created<span class="toot-id"> #created-1870</span></h2><div class="pubdate">12 Mar at 22:19:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1870">https://github.com/qt4cg/qtspecs/issues/1870</a></div><details><summary>Rename $zero keyword of fold-left and fold-right</summary><div class="markup"><p>I find the name $zero for this parameter unhelpful and confusing.</p>
<p>I suggest <code>$accum</code>, short for "accumulator" or "accumulated result".</p>
</div></details></div>
<div class="toot" id="created-1869"><h2>Issue #1869 created<span class="toot-id"> #created-1869</span></h2><div class="pubdate">12 Mar at 18:44:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1869">https://github.com/qt4cg/qtspecs/issues/1869</a></div><details><summary>`fn:duplicate-values`: Order of results</summary><div class="markup"><p>With https://github.com/qt4cg/qtspecs/pull/987, a rule was added to <code>fn:duplicate-values</code>:</p>
<blockquote>
<p>For any set of values that compare equal, the one that is returned is the one that appears first in $values.</p>
</blockquote>
<p>I think we should adapt the behavior to return the duplicates in the order they appear, not the original values:</p>
<ul>
<li>A common use case for this function is to find the first duplicate in a list.</li>
<li>If we return the original values in the correct order, we need to parse the full sequence before we can know which will be the first result. A worst-case example:</li>
</ul>
<pre><code class="language-xquery">(0x7FFFFFFFFFFFFFFF, 1, 1 to 0x7FFFFFFFFFFFFFFF)
=&gt; duplicate-values()
=&gt; head()
</code></pre>
</div></details></div>
<div class="toot" id="created-1868"><h2>Issue #1868 created<span class="toot-id"> #created-1868</span></h2><div class="pubdate">12 Mar at 18:19:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1868">https://github.com/qt4cg/qtspecs/issues/1868</a></div><details><summary>array:members() to include index position</summary><div class="markup"><p>Currently <code>array:members(["a", "b"])</code> returns</p>
<pre><code>{'value': "a"},
{'value': "b"}
</code></pre>
<p>I suggest that it should instead return</p>
<pre><code>{'key': 1, 'value': "a"},
{'key': 2, 'value': "b"}
</code></pre>
<p>The extra information is useful for any operation that wants to take account of positions as well as values. For example, rearranging an array into multiple columns. Using the names "key" and "value" also means that the data is suitable for converting an array to a map by means of <code>map:of-pairs</code>.</p>
<p>The function array:of-members() should change to accept <code>record('value', *)</code> (making the record type extensible) so that the key part is ignored if present.</p>
</div></details></div>
<div class="toot" id="created-1867"><h2>Pull request #1867 created<span class="toot-id"> #created-1867</span></h2><div class="pubdate">12 Mar at 18:02:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1867">https://github.com/qt4cg/qtspecs/pull/1867</a></div><details><summary>1341 Drop position from fold callbacks</summary><div class="markup"><p>Following up on issue 1341, we decided to drop the position argument from the 4 fold functions.</p>
<p>Most of the changes in this PR are dealing with the collateral damage - changes to "formal equivalents" of other functions that previously relied on fold-left having the position available to the callback function.</p>
</div></details></div>
<div class="toot" id="created-1866"><h2>Issue #1866 created<span class="toot-id"> #created-1866</span></h2><div class="pubdate">12 Mar at 08:15:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1866">https://github.com/qt4cg/qtspecs/issues/1866</a></div><details><summary>Ambiguities introduced by #1864</summary><div class="markup"><p>The grammar check done by <a href="https://github.com/GuntherRademacher/rex-parser-generator/tree/main/docs/sample-grammars/XQuery-40">RExification of XQuery and XPath 4.0 Grammars</a> has detected a bunch of LALR(2) conflicts caused by the recent addition of <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-TypeSpecifier"><code>TypeSpecifier</code></a> to the <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-KeySpecifier"><code>KeySpecifier</code></a> production.</p>
<p>In fact these are ambiguities between following being used as a <code>QName</code> (via <code>EQName</code>, <code>TypeName</code>), or as a keyword:</p>
<ul>
<li><code>array</code></li>
<li><code>attribute</code></li>
<li><code>comment</code></li>
<li><code>document-node</code></li>
<li><code>element</code></li>
<li><code>empty-sequence</code></li>
<li><code>enum</code></li>
<li><code>fn</code></li>
<li><code>function</code></li>
<li><code>item</code></li>
<li><code>map</code></li>
<li><code>namespace-node</code></li>
<li><code>node</code></li>
<li><code>processing-instruction</code></li>
<li><code>record</code></li>
<li><code>schema-attribute</code></li>
<li><code>schema-element</code></li>
<li><code>text</code></li>
</ul>
<p>E.g. <code>element</code> in</p>
<pre><code>$A?~element()
</code></pre>
<p>can be parsed as an element test, <code>element()</code>, or as a type name <code>element</code> followed by a <code>PositionalArgumentList</code>. This is similar to what the "reserved-function-names" constraint covers, but that does not apply here because there is no function name involved.</p>
<p>The <code>SequenceType</code> in <code>TypeSpecifier</code>, enclosed in extra parenthese, does not present a problem, so my proposal is to drop <code>ItemType</code> from <code>TypeSpecifier</code> and rewrite the production to</p>
<pre><code>TypeSpecifier
         ::= '~' '(' SequenceType ')' 
</code></pre>
</div></details></div>
<div class="toot" id="created-1865"><h2>Issue #1865 created<span class="toot-id"> #created-1865</span></h2><div class="pubdate">11 Mar at 20:37:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><details><summary>Callback functions, position argument: consistency</summary><div class="markup"><ul>
<li>In https://github.com/qt4cg/qtspecs/pull/1735#issuecomment-2715090198, it was decided to remove the position argument from <code>fn:fold-left</code> and <code>fn:fold-right</code>. → #1867</li>
<li>As maps are ordered now, we should add the position argument to iterative map functions (e.g., <code>map:for-each</code>; basically all functions for which equivalent sequence and array functions exist).</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1227"><h2>Issue #1227 closed<span class="toot-id"> #closed-1227</span></h2><div class="pubdate">11 Mar at 17:41:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1227">https://github.com/qt4cg/qtspecs/pull/1227</a></div><p>150 PR resubmission for fn ranks</p></div>
<div class="toot" id="closed-1456"><h2>Issue #1456 closed<span class="toot-id"> #closed-1456</span></h2><div class="pubdate">11 Mar at 17:04:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1456">https://github.com/qt4cg/qtspecs/issues/1456</a></div><p>Filtering by type in lookup expressions</p></div>
<div class="toot" id="closed-1864"><h2>Issue #1864 closed<span class="toot-id"> #closed-1864</span></h2><div class="pubdate">11 Mar at 17:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="closed-1740"><h2>Issue #1740 closed<span class="toot-id"> #closed-1740</span></h2><div class="pubdate">11 Mar at 17:02:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1740">https://github.com/qt4cg/qtspecs/pull/1740</a></div><p>1725b Further elaboration of duplicates handling in maps</p></div>
<div class="toot" id="closed-1735"><h2>Issue #1735 closed<span class="toot-id"> #closed-1735</span></h2><div class="pubdate">11 Mar at 17:02:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><p>1341 Drop $position callback from many functions</p></div>
<div class="toot" id="closed-1794"><h2>Issue #1794 closed<span class="toot-id"> #closed-1794</span></h2><div class="pubdate">11 Mar at 15:16:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1794">https://github.com/qt4cg/qtspecs/issues/1794</a></div><p>Lookup: select all except</p></div>
<div class="toot" id="closed-1778"><h2>Issue #1778 closed<span class="toot-id"> #closed-1778</span></h2><div class="pubdate">10 Mar at 16:22:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1778">https://github.com/qt4cg/qtspecs/pull/1778</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="created-1864"><h2>Pull request #1864 created<span class="toot-id"> #created-1864</span></h2><div class="pubdate">10 Mar at 16:21:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><details><summary>1456 Lookup expressions filtered by type</summary><div class="markup"><p>Fix #1456</p>
<p>Technically identical to PR #1778, but reworked because it had become impossible to resolve the merge conflicts.</p>
</div></details></div>
<div class="toot" id="created-1863"><h2>Issue #1863 created<span class="toot-id"> #created-1863</span></h2><div class="pubdate">10 Mar at 05:49:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1863">https://github.com/qt4cg/qtspecs/issues/1863</a></div><details><summary>add \U \u L \u \E to replace() (case conversion)</summary><div class="markup"><p>Many systems using regular expressions support case conversion in the replacement strings.</p>
<p>For example,</p>
<pre><code class="language-bash">sed -e 's/[aA]*/\L\u&amp;/'
</code></pre>
<p>given AAA as input, produces Aaa.</p>
<p>It’s not 100% clear to me its worth adding, since an action function can do the same thing with more or less work,
but for reference,</p>
<p>\U turns the replaced text into upper case until \E, \L, or the end of the replacement string
\L turns the replaces text to lower case in the same way
\u and \l affect the single next character and operate independently of \U, \L, \E.</p>
<p>I wrote up some more precise spec text and can make a pull request; the case in the sed example above is common in text conversion projects but slightly tricky to get right with a function,</p>
<pre><code>          fn { upper-case(substring(., 1, 1)) || lower-case(substring(., 2) }
</code></pre>
<p>This is simple, but consider <code>\2 \L\u\1\3</code> as a function, where <code>\1</code> may be empty.</p>
<p>Overall i don’t have strong feelings either way, except that supporting them may help people migrate from other systems or languages. \E feels uncomfortably procedural. In Perl and libpcre i think, \E also turns of \Q (which disables all metadata characters up until \E).</p>
<p>Like &lt; and &gt; in patterns, \L and friends can be emulated with some care, but that’s true of a lot of regular expression syntax, and one point of the shorthands (as i see it) is to move the feature towards being accessible by people with less of a programming background.</p>
</div></details></div>
<div class="toot" id="created-1862"><h2>Issue #1862 created<span class="toot-id"> #created-1862</span></h2><div class="pubdate">09 Mar at 18:55:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1862">https://github.com/qt4cg/qtspecs/issues/1862</a></div><details><summary>Records: consider order</summary><div class="markup"><p>I think we should make the order of record entries part of instance checks and coercion rules:</p>
<ol>
<li>It will be less confusing for users if records have a well-defined order (similar to objects in OOL), in particular if records are serialized.</li>
<li>It will be much easier for implementations to access record entries by their internal index if the order is statically known. There will still be opportunities for optimizing lookups in arbitrary maps (index-based access has generally become easier with maps being ordered).</li>
</ol>
</div></details></div>
<div class="toot" id="created-1861"><h2>Issue #1861 created<span class="toot-id"> #created-1861</span></h2><div class="pubdate">07 Mar at 08:27:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1861">https://github.com/qt4cg/qtspecs/issues/1861</a></div><details><summary>xsl:next-match with-all-params</summary><div class="markup"><h2>Problem</h2>
<p>The <code>&lt;xsl:next-match&gt;</code> instruction is useful when writing local templates to customize the behavior of an imported XSLT. Unfortunately, there is a limitation due to the fact that <code>&lt;xsl:next-match&gt;</code> does not pass along parameters unless the parameters are defined as tunneling or the parameters are explicitly coded using <code>&lt;xsl:with-param&gt;</code>.</p>
<p>The fact that <code>&lt;xsl:next-match&gt;</code> does not automatically pass along parameters can be surprising or lead to cumbersome workarounds, and limits how <code>&lt;xsl:next-match&gt;</code> can be used when writing local templates to customize the behavior of imported XSLT.</p>
<ul>
<li>
<p>In situations where parameters are defined in an imported XSLT it might not be feasible to change parameters to tunneling.</p>
</li>
<li>
<p>In situations where a variety of parameters might be in scope when a template that uses <code>&lt;xsl:next-match&gt;</code> is invoked, currently each parameter needs to be explicitly coded using <code>&lt;xsl:param&gt;</code> and <code>&lt;xsl:with-param&gt;</code> in <code>&lt;xsl:next-match&gt;</code>, even though the parameters might not be relevant to the purpose or logic of the template. This may lead to fragile and less maintainable code and increases the cognitive load for developers, especially when working with complex, multi-layered stylesheets.</p>
</li>
</ul>
<p>This proposal aims to simplify the use of the <code>&lt;xsl:next-match&gt;</code> instruction while being backwards compatible.</p>
<h2>Proposal</h2>
<ul>
<li>
<p>Add an option to <code>&lt;xsl:next-match&gt;</code> to enable passing along all parameters. This option might take the form of a new optional attribute on <code>&lt;xsl:next-match&gt;</code> named <code>with-all-params</code> (this name is similar to the existing element name <code>&lt;xsl:with-param&gt;</code>) that takes a yes/no (or Boolean) value and defaults to no (false).</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="no"/&gt;</code> would operate the same as <code>&lt;xsl:next-match/&gt;</code> currently does.</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="yes"/&gt;</code> would operate the same as <code>&lt;xsl:next-match/&gt;</code> currently does with the difference that all parameters that were in scope when the current template was invoked will remain in scope for the next matching template.</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> that contains <code>&lt;xsl:with-param&gt;</code> should operate the same as described in the preceding paragraph with the difference that parameters defined by <code>&lt;xsl:with-param&gt;</code> will also be in scope for the next matching template.</p>
</li>
<li>
<p>If a parameter defined by <code>&lt;xsl:with-param&gt;</code> within <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> has the same name as a parameter that was in scope when the current template was invoked, then the effective value of that parameter should be the value defined by <code>&lt;xsl:with-param&gt;</code>. This will allow a template to override parameters when necessary.</p>
</li>
</ul>
<p>To summarize, <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> should invoke the next matching template and automatically pass along all parameters that were in scope when the current template was invoked, and optionally allow using <code>&lt;xsl:with-param&gt;</code> to set additional parameters or modify parameter values.</p>
<h2>Example</h2>
<p>Given this input document:</p>
<pre><code class="language-xml">&lt;!-- input.xml --&gt;
&lt;section&gt;
    &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;

</code></pre>
<p>This stylesheet <code>import.xsl</code> provides a set of base templates. The template matching element "p" uses <code>&lt;xsl:next-match/&gt;</code> in it's current (default) operation.</p>
<pre><code class="language-xml">&lt;!-- import.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0" expand-text="yes"&gt;
    
    &lt;xsl:output indent="yes"/&gt;
    &lt;xsl:mode on-no-match="shallow-copy"/&gt;
    
    &lt;xsl:template match="section"&gt;
        &lt;section&gt;
            &lt;xsl:apply-templates&gt;
                &lt;xsl:with-param name="a" select="'a'"/&gt;
                &lt;xsl:with-param name="b" select="'b'"/&gt;
            &lt;/xsl:apply-templates&gt;
        &lt;/section&gt;
    &lt;/xsl:template&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;xsl:param name="a"/&gt;
        &lt;xsl:param name="b"/&gt;
        &lt;xsl:param name="c"/&gt;
        &lt;p&gt;a {$a}&lt;/p&gt;
        &lt;p&gt;b {$b}&lt;/p&gt;
        &lt;p&gt;c {$c}&lt;/p&gt;
        &lt;xsl:next-match/&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This is the output of the above stylesheet <code>import.xsl</code> and the input document:</p>
<pre><code class="language-xml">&lt;section&gt;
   &lt;p&gt;a a&lt;/p&gt;
   &lt;p&gt;b b&lt;/p&gt;
   &lt;p&gt;c &lt;/p&gt;
   &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;
</code></pre>
<p>This stylesheet <code>before.xsl</code> imports the stylesheet <code>import.xsl</code> and defines a template to customize how <code>&lt;p&gt;</code> elements are processed. The parameter <code>$a</code> needs to be intercepted and forwarded even though this template is not doing anything with <code>$a</code>. The parameter <code>$b</code> is overridden, and the parameter <code>$c</code> is added within <code>&lt;xsl:next-match&gt;</code>.</p>
<pre><code class="language-xml">&lt;!-- before.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0"&gt;
    
    &lt;xsl:import href="import.xsl"/&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;xsl:param name="a"/&gt;
        &lt;p&gt;customization&lt;/p&gt;
        &lt;xsl:next-match&gt;
            &lt;xsl:with-param name="a" select="$a"/&gt;
            &lt;xsl:with-param name="b" select="'buzz'"/&gt;
            &lt;xsl:with-param name="c" select="'c'"/&gt;
        &lt;/xsl:next-match&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This stylesheet <code>after.xsl</code> does the same thing as the previous stylesheet but uses <code>with-all-params="yes"</code>. The template does not need to intercept and forward the parameter <code>$a</code> because this is handled automatically by <code>with-all-params="yes"</code>. The parameter <code>$b</code> is overridden, and the parameter <code>$c</code> is added within <code>&lt;xsl:next-match&gt;</code> in the same way as the previous stylesheet. Although this is a small example in which the parameter <code>$a</code> is the only savings, the benefit of  <code>with-all-params="yes"</code> can be significant in scenarios where there are more parameters.</p>
<pre><code class="language-xml">&lt;!-- after.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="4.0"&gt;
    
    &lt;xsl:import href="import.xsl"/&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;p&gt;customization&lt;/p&gt;
        &lt;xsl:next-match with-all-params="yes"&gt;
            &lt;xsl:with-param name="b" select="'buzz'"/&gt;
            &lt;xsl:with-param name="c" select="'c'"/&gt;
        &lt;/xsl:next-match&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>The two stylesheets above (<code>before.xsl</code> and <code>after.xsl</code>) should produce the same output.</p>
<pre><code class="language-xml">&lt;!-- output.xml --&gt;
&lt;section&gt;
   &lt;p&gt;customization&lt;/p&gt;
   &lt;p&gt;a a&lt;/p&gt;
   &lt;p&gt;b buzz&lt;/p&gt;
   &lt;p&gt;c c&lt;/p&gt;
   &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;
</code></pre>
</div></details></div>
<div class="toot" id="closed-1801"><h2>Issue #1801 closed<span class="toot-id"> #closed-1801</span></h2><div class="pubdate">05 Mar at 19:07:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1801">https://github.com/qt4cg/qtspecs/pull/1801</a></div><p>1798 Function fn:function-identity</p></div>
<div class="toot" id="created-1860"><h2>Issue #1860 created<span class="toot-id"> #created-1860</span></h2><div class="pubdate">05 Mar at 17:51:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1860">https://github.com/qt4cg/qtspecs/issues/1860</a></div><details><summary>fn:parse-xml: DTDs, external resources</summary><div class="markup"><p>The text doesn’t say much about what DTD validation means. Is my assumption correct that it boils down to a <code>SAXParserFactory.setValidating</code> call in Java?</p>
<p>What about DTDs in general? Given the following snippets (using the default <code>false</code> for DTD validation)…</p>
<pre><code class="language-xquery">&lt;!-- xml.dtd --&gt;
&lt;!ENTITY arrow "→"&gt;

parse-xml(`
  &lt;!DOCTYPE xml SYSTEM 'xml.dtd'&gt;
  &lt;xml&gt;&amp;arrow;&lt;/xml&gt;`
)
</code></pre>
<p>…should the result be <code>&lt;xml/&gt;</code>, <code>&lt;xml&gt;→&lt;/xml&gt;</code>, or an error? In other words, should the (potentially external) <code>xml.dtd</code> resource be resolved and interpreted?</p>
<p>Maybe we should introduce an additional <code>DTD</code> option (or options?) to control the loading of external DTDs and the handling of entities, for example:</p>
<pre><code>http://apache.org/xml/features/nonvalidating/load-external-dtd
http://xml.org/sax/features/external-general-entities
http://xml.org/sax/features/external-parameter-entities
</code></pre>
<p>Thoughts are welcome.</p>
</div></details></div>
<div class="toot" id="created-1859"><h2>Issue #1859 created<span class="toot-id"> #created-1859</span></h2><div class="pubdate">05 Mar at 15:36:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1859">https://github.com/qt4cg/qtspecs/issues/1859</a></div><details><summary>Question on `fn:chain` and `err:FOAP0001`</summary><div class="markup"><p>Per #1280,  <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply"><code>fn:apply</code></a> has been changed to allow the number of arguments to be greater than the arity of the function.</p>
<p><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-chain"><code>fn:chain</code></a> is defined in terms of <code>fn:apply</code>, and it also refers to the error code <code>err:FOAP0001</code> which belongs to <code>fn:apply</code>.</p>
<p>However the condition for the error differs between the two:</p>
<ul>
<li>
<p><code>fn:chain</code></p>
<blockquote>
<p>An error [<a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#ERRFOAP0001">err:FOAP0001</a>] is raised if the arity of any function $f in $functions is different from the number of members in the array that is passed to <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply">fn:apply</a>.</p>
</blockquote>
</li>
<li>
<p><code>fn:apply</code></p>
<blockquote>
<p>A dynamic error is raised if the arity of the function $function is greater than the size of the array $arguments ([<a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#ERRFOAP0001">err:FOAP0001</a>]).</p>
</blockquote>
</li>
</ul>
<p>Also in <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#error-summary">B Error Codes</a>, <code>err:FOAP001</code> still asks for the arity to exaclty match the number of arguments:</p>
<blockquote>
<p>err:FOAP0001, Wrong number of arguments.</p>
<p>Raised when <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply">fn:apply</a> is called and the arity of the supplied function is not the same as the number of members in the supplied array.</p>
</blockquote>
<p>Should not the description of <code>fn:chain</code> and the error summary be adapted to the changed behaviour of <code>fn:apply</code>?</p>
</div></details></div>
<div class="toot" id="closed-1853"><h2>Issue #1853 closed<span class="toot-id"> #closed-1853</span></h2><div class="pubdate">04 Mar at 18:57:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1853">https://github.com/qt4cg/qtspecs/pull/1853</a></div><p>1845 Revised design of methods to use . rather than $this</p></div>
<div class="toot" id="closed-1845"><h2>Issue #1845 closed<span class="toot-id"> #closed-1845</span></h2><div class="pubdate">04 Mar at 18:14:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1845">https://github.com/qt4cg/qtspecs/issues/1845</a></div><p>Should we add additional syntactic sugar for use with %method functions?</p></div>
<div class="toot" id="closed-1820"><h2>Issue #1820 closed<span class="toot-id"> #closed-1820</span></h2><div class="pubdate">04 Mar at 17:21:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1820">https://github.com/qt4cg/qtspecs/issues/1820</a></div><p>Delta markers in collapsed TOC</p></div>
<div class="toot" id="closed-1838"><h2>Issue #1838 closed<span class="toot-id"> #closed-1838</span></h2><div class="pubdate">04 Mar at 17:21:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1838">https://github.com/qt4cg/qtspecs/pull/1838</a></div><p>1820 Attempt to add change markup in collapsed ToC</p></div>
<div class="toot" id="closed-1796"><h2>Issue #1796 closed<span class="toot-id"> #closed-1796</span></h2><div class="pubdate">04 Mar at 17:18:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1796">https://github.com/qt4cg/qtspecs/issues/1796</a></div><p>Allow fn:invisible-xml to return a function that returns an item()</p></div>
<div class="toot" id="closed-1839"><h2>Issue #1839 closed<span class="toot-id"> #closed-1839</span></h2><div class="pubdate">04 Mar at 17:18:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1839">https://github.com/qt4cg/qtspecs/pull/1839</a></div><p>Relax the return type of the Invisible XML parsing function</p></div>
<div class="toot" id="closed-1849"><h2>Issue #1849 closed<span class="toot-id"> #closed-1849</span></h2><div class="pubdate">04 Mar at 17:15:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1849">https://github.com/qt4cg/qtspecs/pull/1849</a></div><p>Reduce the indentation in the ToC</p></div>
<div class="toot" id="closed-1850"><h2>Issue #1850 closed<span class="toot-id"> #closed-1850</span></h2><div class="pubdate">04 Mar at 17:12:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1850">https://github.com/qt4cg/qtspecs/pull/1850</a></div><p>Actions from meeting 111</p></div>
<div class="toot" id="closed-1771"><h2>Issue #1771 closed<span class="toot-id"> #closed-1771</span></h2><div class="pubdate">04 Mar at 17:10:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1771">https://github.com/qt4cg/qtspecs/issues/1771</a></div><p>fn:deep-equal: map order</p></div>
<div class="toot" id="closed-1855"><h2>Issue #1855 closed<span class="toot-id"> #closed-1855</span></h2><div class="pubdate">04 Mar at 17:10:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1855">https://github.com/qt4cg/qtspecs/pull/1855</a></div><p>1771 Add option for deep-equal to consider map order</p></div>
<div class="toot" id="closed-1847"><h2>Issue #1847 closed<span class="toot-id"> #closed-1847</span></h2><div class="pubdate">04 Mar at 16:23:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1847">https://github.com/qt4cg/qtspecs/issues/1847</a></div><p>%method functions: explicit self reference?</p></div>
<div class="toot" id="created-1858"><h2>Pull request #1858 created<span class="toot-id"> #created-1858</span></h2><div class="pubdate">04 Mar at 12:04:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1858">https://github.com/qt4cg/qtspecs/pull/1858</a></div><details><summary>Initial xsl:record</summary><div class="markup"><p>An initial draft of the xsl:record instruction, for discussion</p>
</div></details></div>
<div class="toot" id="closed-1656"><h2>Issue #1656 closed<span class="toot-id"> #closed-1656</span></h2><div class="pubdate">03 Mar at 18:39:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1656">https://github.com/qt4cg/qtspecs/issues/1656</a></div><p>Ordered Maps: Updates</p></div>
<div class="toot" id="closed-1829"><h2>Issue #1829 closed<span class="toot-id"> #closed-1829</span></h2><div class="pubdate">03 Mar at 18:30:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1829">https://github.com/qt4cg/qtspecs/issues/1829</a></div><p>Problems with new arrow expression syntax</p></div>
<div class="toot" id="closed-1854"><h2>Issue #1854 closed<span class="toot-id"> #closed-1854</span></h2><div class="pubdate">03 Mar at 18:24:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1854">https://github.com/qt4cg/qtspecs/issues/1854</a></div><p>Can someone direct me to the motivating use case of objects?</p></div>
<div class="toot" id="created-1857"><h2>Issue #1857 created<span class="toot-id"> #created-1857</span></h2><div class="pubdate">03 Mar at 16:59:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1857">https://github.com/qt4cg/qtspecs/issues/1857</a></div><details><summary>fn:parse-xml: `xinclude`</summary><div class="markup"><p>We should allow XInclude processing to be enabled/disabled, as it can potentially lead to memory leaks.</p>
</div></details></div>
<div class="toot" id="closed-1835"><h2>Issue #1835 closed<span class="toot-id"> #closed-1835</span></h2><div class="pubdate">03 Mar at 12:38:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1835">https://github.com/qt4cg/qtspecs/pull/1835</a></div><p>add zero-width assertions to regular expressions</p></div>
<div class="toot" id="created-1856"><h2>Pull request #1856 created<span class="toot-id"> #created-1856</span></h2><div class="pubdate">03 Mar at 12:34:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1856">https://github.com/qt4cg/qtspecs/pull/1856</a></div><details><summary>998 Add boundary and lookahead/behind assertions</summary><div class="markup"><p>Incorporates and supersedes #1835</p>
</div></details></div>
<div class="toot" id="closed-1836"><h2>Issue #1836 closed<span class="toot-id"> #closed-1836</span></h2><div class="pubdate">02 Mar at 19:12:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1836">https://github.com/qt4cg/qtspecs/issues/1836</a></div><p>unparsed-text-lines() - line endings</p></div>
<div class="toot" id="created-1855"><h2>Pull request #1855 created<span class="toot-id"> #created-1855</span></h2><div class="pubdate">02 Mar at 19:06:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1855">https://github.com/qt4cg/qtspecs/pull/1855</a></div><details><summary>1771 Add option for deep-equal to consider map order</summary><div class="markup"><p>Adds an option for deep-equal to treat order of entries in a map as significant.</p>
<p>Fix #1771</p>
</div></details></div>
<div class="toot" id="created-1854"><h2>Issue #1854 created<span class="toot-id"> #created-1854</span></h2><div class="pubdate">28 Feb at 11:37:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1854">https://github.com/qt4cg/qtspecs/issues/1854</a></div><details><summary>Can someone direct me to the motivating use case of objects?</summary><div class="markup"><p>There's a LOT of conversations about "this" and methods and really quite complex syntax, but (despite writing OO software for about 30+ years), I cant think of a motivating use case in the context of XSLT/XQuery.</p>
<ul>
<li>in imperative languages with mutable state...yes</li>
<li>in very large code bases requiring some abstraction/encapsulation - well maybe...there are probably easier ways to do this without 'objects'.</li>
</ul>
<p>this is the sort of canonical example people use (to illustrate simple technical points)</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': fn(){?x * ?y}}</p>
</blockquote>
<p>but actually I would write</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': 10 * 7}</p>
</blockquote>
<p>(and similarly write a data constructor for the record in that manner)</p>
<p>i.e.</p>
<blockquote>
<p>fn($x,$y){'x': $x, 'y': $y, 'area': $x * $y}</p>
</blockquote>
<p>I'm not sure at the moment its worth the effort.</p>
</div></details></div>
<div class="toot" id="created-1853"><h2>Pull request #1853 created<span class="toot-id"> #created-1853</span></h2><div class="pubdate">27 Feb at 10:38:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1853">https://github.com/qt4cg/qtspecs/pull/1853</a></div><details><summary>1845 Revised design of methods to use . rather than $this</summary><div class="markup"><p>Proposal is that in methods, the containing map should be bound to the context item rather than to the special variable $this, so fields of that map are referenced as <code>?x</code> rather than <code>$this?x</code>.</p>
</div></details></div>
<div class="toot" id="created-1852"><h2>Issue #1852 created<span class="toot-id"> #created-1852</span></h2><div class="pubdate">27 Feb at 08:56:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1852">https://github.com/qt4cg/qtspecs/issues/1852</a></div><details><summary>fn:values-except: Return atomic values that occur in A but not in B</summary><div class="markup"><p><code>fn:distinct-values</code> can be used to perform a <code>union</code> on atomic values:</p>
<pre><code class="language-xquery">(: returns 1 to 5 :)
let $one := 1 to 4, $two := 2 to 5
return distinct-values(($one, $two))
</code></pre>
<p><code>fn:duplicate-values</code> can be used for <code>intersect</code>:</p>
<pre><code class="language-xquery">(: returns 2 to 4 :)
let $one := 1 to 4, $two := 2 to 5
return duplicate-values(($one, $two))
</code></pre>
<p>A (roughly) equivalent alternative is <code>$one[. = $two]</code>.</p>
<p>I think we should add an equivalent for <code>except</code> (it requires 2 arguments instead of 1):</p>
<pre><code class="language-xquery">fn:values-except(
  $values     as xs:anyAtomicType*,
  $exclude    as xs:anyAtomicType*,
  $collation  as xs:string?         := fn:default-collation()
) as xs:anyAtomicType*
</code></pre>
<p>An example:</p>
<pre><code class="language-xquery">(: returns 1 :)
let $one := 1 to 4, $two := 2 to 5
return values-except($one, $two)
</code></pre>
<p>In principle, this function can also be written as <code>$one[not(. = $two)]</code>, but a dedicated function will be easier to understand for users and easier to optimize for processors.</p>
</div></details></div>
<div class="toot" id="closed-1247"><h2>Issue #1247 closed<span class="toot-id"> #closed-1247</span></h2><div class="pubdate">26 Feb at 23:55:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1247">https://github.com/qt4cg/qtspecs/issues/1247</a></div><p>`??type(T)` in lookup expressions - shortcuts</p></div>
<div class="toot" id="created-1851"><h2>Issue #1851 created<span class="toot-id"> #created-1851</span></h2><div class="pubdate">26 Feb at 15:42:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1851">https://github.com/qt4cg/qtspecs/issues/1851</a></div><details><summary>Questions on `fn:atomic-type-annotation`</summary><div class="markup"><p>These questions came up while working on <code>fn:atomic-type-annotation</code>:</p>
<ul>
<li>what is the <code>variety</code> of <code>xs:anySimpleType</code>?</li>
<li>should not <code>constructor</code> be absent in an <code>fn:schema-type-record</code> describing <code>xs:QName</code>?</li>
</ul>
<p>Here are the detailed observations:</p>
<h3><code>fn:schema-type-record?variety</code></h3>
<p>Consider the following query:</p>
<pre><code class="language-xquery">  (
    &lt;x&gt;42&lt;/x&gt;
    =&gt; fn:atomic-type-annotation()
  )
  ?base-type()
  ?base-type()
  ?variety
</code></pre>
<p>My interpretation is as follows:</p>
<ul>
<li>the <code>x</code> element node is atomized to a value of type <code>xs:untypedAtomic</code>,</li>
<li>so <code>fn:atomic-type-annotation</code> returns the information for <code>xs:untypedAtomic</code>,</li>
<li>the base type of that is <code>xs:anyAtomicType</code>,</li>
<li>the base type of that is <code>xs:anySimpleType</code>,</li>
<li>per <a href="https://www.w3.org/TR/xmlschema11-1/#sec-anySimpleType">XML schema 1.1, 3.16.7.1 xs:anySimpleType</a>, the <code>{variety}</code> of <code>xs:anySimpleType</code> is absent,</li>
<li>so <code>variety</code> should be absent in an <code>fn:schema-type-record</code> describing <code>xs:anySimpleType</code>,</li>
<li>the result thus should be an empty sequence.</li>
</ul>
<p>According to the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#schema-type-record">current spec</a>, <code>variety</code> must always be present with a value of type <code>enum("atomic", "list", "union", "empty", "simple", "element-only", "mixed")</code>, but also correspond to the <code>{variety}</code> of the simple type in the XSD component model.</p>
<p>Should not <code>variety</code> be optional, and omitted for <code>xs:anySimpleType</code>?</p>
<h3><code>fn:schema-type-record?constructor</code></h3>
<p>The spec says this about <code>constructor</code>:</p>
<blockquote>
<p>The field is absent for complex types and for the abstract types xs:anyAtomicType, xs:anySimpleType, and xs:NOTATION. It is also absent for all namespace-sensitive types, that is, types derived from xs:QName or xs:NOTATION.</p>
</blockquote>
<p>The formulation does not include <code>xs:QName</code>, but should not its constructor be absent for the same reasons as for the types derived from it?</p>
</div></details></div>
<div class="toot" id="created-1850"><h2>Pull request #1850 created<span class="toot-id"> #created-1850</span></h2><div class="pubdate">26 Feb at 12:36:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1850">https://github.com/qt4cg/qtspecs/pull/1850</a></div><details><summary>Actions from meeting 111</summary><div class="markup"><p>[ ] QT4CG-111-01: MK to review the editorial comments on PR #1837 and then merge the PR.</p>
<p>Done (along with a couple of other minor corrections noted in passing)</p>
<p>[ ] QT4CG-111-02: MK to fix the typo $in as xs:double+ and 1.3. 1.4 that middle “.” should be a “,”</p>
<p>Already done before the PR was merged</p>
<p>[ ] QT4CG-111-03: MK to add a %method example that uses the arrow syntax.</p>
<p>Done (though the example isn't especially convincing).</p>
<p>Also added another couple of examples and notes in passing.</p>
</div></details></div>
<div class="toot" id="created-1849"><h2>Pull request #1849 created<span class="toot-id"> #created-1849</span></h2><div class="pubdate">26 Feb at 09:57:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1849">https://github.com/qt4cg/qtspecs/pull/1849</a></div><p>Reduce the indentation in the ToC</p></div>
<div class="toot" id="created-1848"><h2>Issue #1848 created<span class="toot-id"> #created-1848</span></h2><div class="pubdate">26 Feb at 08:31:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1848">https://github.com/qt4cg/qtspecs/issues/1848</a></div><p>Define regular expressions using XSD 1.1 as baseline</p></div>
<div class="toot" id="closed-1800"><h2>Issue #1800 closed<span class="toot-id"> #closed-1800</span></h2><div class="pubdate">25 Feb at 21:17:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1800">https://github.com/qt4cg/qtspecs/issues/1800</a></div><p>The `=?&gt;` lookup arrow expression operator is weird, difficult to use, difficult to understand, difficult to read and unnatural</p></div>
<div class="toot" id="closed-1817"><h2>Issue #1817 closed<span class="toot-id"> #closed-1817</span></h2><div class="pubdate">25 Feb at 21:17:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1817">https://github.com/qt4cg/qtspecs/pull/1817</a></div><p>1800 Methods</p></div>
<div class="toot" id="closed-1843"><h2>Issue #1843 closed<span class="toot-id"> #closed-1843</span></h2><div class="pubdate">25 Feb at 18:20:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1843">https://github.com/qt4cg/qtspecs/issues/1843</a></div><p>XQFO: TOC texts</p></div>
<div class="toot" id="created-1847"><h2>Issue #1847 created<span class="toot-id"> #created-1847</span></h2><div class="pubdate">25 Feb at 18:14:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1847">https://github.com/qt4cg/qtspecs/issues/1847</a></div><details><summary>%method functions: explicit self reference?</summary><div class="markup"><p>This is a discussion issue; I am torn and would be interested in feedback:</p>
<p>With the just added <code>%method</code> annotation, basically two things happen:</p>
<ol>
<li>An implicit <code>$this</code> parameter is preprended to the remaining parameters of a function.</li>
<li>The current map will be bound to the first parameter by the lookup operator.</li>
</ol>
<p>The inner workings of the example in the spec were not entierly obvious in today’s meeting…</p>
<pre><code class="language-xquery">let $area := %method fn() { $this?x * $this?y }
return $area({ 'x': 3, 'y': 4 })
</code></pre>
<p>…and I am wondering if we are not more flexible by making the self-referencing parameter explicit. This way, it would be up to the user to decide how the parameter is called…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn($self) { $self?value + 1 } }
return $number?inc()
</code></pre>
<p>…the focus function syntax could be used alternatively…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn { ?value + 1 } }
return $number?inc()
</code></pre>
<p>…and it would allow for a stricter typing (<code>$this as map(*)</code> is not very specific), and thus for better error reporting:</p>
<pre><code class="language-xquery">declare record coord(
  x as xs:double,
  y as xs:double,
  product := %method fn($coord as coord) { $coord?x * $coord?y }
);
coord(3, 4)?product()
</code></pre>
<p>Obviously, it would cause new issues:</p>
<ul>
<li><code>%method fn() {}</code> would need to be made illegal</li>
<li>The type of the first argument would need to be <code>map(*)</code> or a subtype of it.</li>
<li>Users may be led to write…</li>
</ul>
<pre><code class="language-xquery">let $map := { 'fn': %method fn($a, $b) { $a * $b } }
return $map?fn(2, 3)
</code></pre>
<p>On the other hand, the existence of the <code>%method</code> annotation should indicate that this function type differs from others.</p>
<p>If we stick with the invisible <code>$this</code> parameter, I wonder what <code>function-arity(%method fn() {})</code> is supposed to return?</p>
</div></details></div>
<div class="toot" id="created-1846"><h2>Issue #1846 created<span class="toot-id"> #created-1846</span></h2><div class="pubdate">25 Feb at 17:48:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1846">https://github.com/qt4cg/qtspecs/issues/1846</a></div><details><summary>%method functions, dynamic function calls</summary><div class="markup"><p>With the #1817, the <code>%method</code> annotation was introduced for functions. It is interpreted by the lookup operator:</p>
<pre><code class="language-xquery">let $number := { 'value': -3, 'abs': %method fn() { abs($this?value) } }
return $number?abs()
</code></pre>
<p>I think we should extend this mechanism to dynamic function calls, as many people use the constructs interchangeably:</p>
<pre><code class="language-xquery">return $number('abs')()
</code></pre>
<p>I agree that the binding mechanism should not apply for <code>map:get</code> or any other map functions and iterations.</p>
</div></details></div>
<div class="toot" id="closed-1830"><h2>Issue #1830 closed<span class="toot-id"> #closed-1830</span></h2><div class="pubdate">25 Feb at 17:32:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1830">https://github.com/qt4cg/qtspecs/pull/1830</a></div><p>1829 Reintroduce restrictions on RHS of `=&gt;`</p></div>
<div class="toot" id="closed-1815"><h2>Issue #1815 closed<span class="toot-id"> #closed-1815</span></h2><div class="pubdate">25 Feb at 17:29:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1815">https://github.com/qt4cg/qtspecs/issues/1815</a></div><p>Function annotations on function items</p></div>
<div class="toot" id="closed-1828"><h2>Issue #1828 closed<span class="toot-id"> #closed-1828</span></h2><div class="pubdate">25 Feb at 17:29:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1828">https://github.com/qt4cg/qtspecs/pull/1828</a></div><p>1815 Add more detail on annotations of function items</p></div>
<div class="toot" id="closed-1834"><h2>Issue #1834 closed<span class="toot-id"> #closed-1834</span></h2><div class="pubdate">25 Feb at 17:27:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1834">https://github.com/qt4cg/qtspecs/issues/1834</a></div><p>json-lines - refinement</p></div>
<div class="toot" id="closed-1837"><h2>Issue #1837 closed<span class="toot-id"> #closed-1837</span></h2><div class="pubdate">25 Feb at 17:27:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1837">https://github.com/qt4cg/qtspecs/pull/1837</a></div><p>1834 Additional clarification on JSON lines</p></div>
<div class="toot" id="closed-583"><h2>Issue #583 closed<span class="toot-id"> #closed-583</span></h2><div class="pubdate">25 Feb at 17:24:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/583">https://github.com/qt4cg/qtspecs/issues/583</a></div><p>(array|map):replace → *:substitute or *:change</p></div>
<div class="toot" id="closed-1833"><h2>Issue #1833 closed<span class="toot-id"> #closed-1833</span></h2><div class="pubdate">25 Feb at 17:24:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1833">https://github.com/qt4cg/qtspecs/pull/1833</a></div><p>583 Drop map:replace and array:replace</p></div>
<div class="toot" id="closed-1816"><h2>Issue #1816 closed<span class="toot-id"> #closed-1816</span></h2><div class="pubdate">25 Feb at 17:21:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1816">https://github.com/qt4cg/qtspecs/issues/1816</a></div><p>Programmatic partial application</p></div>
<div class="toot" id="closed-1825"><h2>Issue #1825 closed<span class="toot-id"> #closed-1825</span></h2><div class="pubdate">25 Feb at 17:21:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1825">https://github.com/qt4cg/qtspecs/pull/1825</a></div><p>1816 New function fn:partial-apply</p></div>
<div class="toot" id="closed-1818"><h2>Issue #1818 closed<span class="toot-id"> #closed-1818</span></h2><div class="pubdate">25 Feb at 17:18:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1818">https://github.com/qt4cg/qtspecs/issues/1818</a></div><p>Grammar problem introduced by #1802</p></div>
<div class="toot" id="closed-1826"><h2>Issue #1826 closed<span class="toot-id"> #closed-1826</span></h2><div class="pubdate">25 Feb at 17:18:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1826">https://github.com/qt4cg/qtspecs/pull/1826</a></div><p>Fix grammar bug #1818</p></div>
<div class="toot" id="closed-1823"><h2>Issue #1823 closed<span class="toot-id"> #closed-1823</span></h2><div class="pubdate">25 Feb at 17:15:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1823">https://github.com/qt4cg/qtspecs/issues/1823</a></div><p>Clearer top-level section headings in F+O</p></div>
<div class="toot" id="closed-1824"><h2>Issue #1824 closed<span class="toot-id"> #closed-1824</span></h2><div class="pubdate">25 Feb at 17:15:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1824">https://github.com/qt4cg/qtspecs/pull/1824</a></div><p>1823 Revise top-level headings in F+O spec</p></div>
<div class="toot" id="created-1845"><h2>Issue #1845 created<span class="toot-id"> #created-1845</span></h2><div class="pubdate">25 Feb at 17:14:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1845">https://github.com/qt4cg/qtspecs/issues/1845</a></div><details><summary>Should we add additional syntactic sugar for use with %method functions?</summary><div class="markup"><p>During <a href="https://qt4cg.org/meeting/minutes/2025/02-25.html">meeting 111</a>, DN was arguing for additional syntactic sugar when his connection to the call ended abruptly. This issue is to make sure we come back to those discussions.</p>
<p>Specifically, should we allow <code>^x</code> as an abbreviation for <code>$this?x</code> ?</p>
</div></details></div>
<div class="toot" id="closed-1813"><h2>Issue #1813 closed<span class="toot-id"> #closed-1813</span></h2><div class="pubdate">25 Feb at 17:12:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1813">https://github.com/qt4cg/qtspecs/issues/1813</a></div><p>Reorganise top-level sections in XDM</p></div>
<div class="toot" id="closed-1814"><h2>Issue #1814 closed<span class="toot-id"> #closed-1814</span></h2><div class="pubdate">25 Feb at 17:12:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1814">https://github.com/qt4cg/qtspecs/pull/1814</a></div><p>1813 Reorganise the XDM spec at top level</p></div>
<div class="toot" id="closed-1811"><h2>Issue #1811 closed<span class="toot-id"> #closed-1811</span></h2><div class="pubdate">25 Feb at 17:09:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1811">https://github.com/qt4cg/qtspecs/issues/1811</a></div><p>Add note concerning non-XML characters in character maps</p></div>
<div class="toot" id="closed-1812"><h2>Issue #1812 closed<span class="toot-id"> #closed-1812</span></h2><div class="pubdate">25 Feb at 17:09:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1812">https://github.com/qt4cg/qtspecs/pull/1812</a></div><p>1811 Add note regarding non-XML chars in xsl:output-character</p></div>
<div class="toot" id="created-1844"><h2>Issue #1844 created<span class="toot-id"> #created-1844</span></h2><div class="pubdate">25 Feb at 16:18:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1844">https://github.com/qt4cg/qtspecs/issues/1844</a></div><details><summary>Drop mapping arrow operator</summary><div class="markup"><p>To reduce the number of new operators, I suggest removing the mapping arrow operator <code>=!&gt;</code>, in favor of the recently added <code>-&gt;</code> operator (which now allows us to arbitrarily create chains for single items and sequences).</p>
<p>Related: https://github.com/qt4cg/qtspecs/issues/1685</p>
</div></details></div>
<div class="toot" id="created-1843"><h2>Issue #1843 created<span class="toot-id"> #created-1843</span></h2><div class="pubdate">25 Feb at 15:35:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1843">https://github.com/qt4cg/qtspecs/issues/1843</a></div><details><summary>XQFO: TOC texts</summary><div class="markup"><p>The XQFO TOC is overly verbose, and inconsistent nevertheless. With the addition of arrows and symbols, many headers stretch across several lines.</p>
<p>If no one objects, I will remove all the redundant "Functions ..." strings:</p>
<p>Current:</p>
<ol>
<li>Introduction</li>
<li>Functions on nodes and node sequences</li>
<li>Errors and diagnostics</li>
<li>Functions and operators on numerics</li>
<li>Functions on strings</li>
<li>Functions that manipulate URIs</li>
<li>Functions and operators on Boolean values</li>
<li>Functions and operators on durations</li>
<li>Functions and operators on dates and times</li>
<li>Functions related to QNames
...</li>
</ol>
<p>Proposed:</p>
<ol>
<li>Introduction</li>
<li>Nodes</li>
<li>Errors and diagnostics</li>
<li>Numerics</li>
<li>Strings</li>
<li>URIs</li>
<li>Boolean values</li>
<li>Durations</li>
<li>Dates and times</li>
<li>QNames
...</li>
</ol>
</div></details></div>
<div class="toot" id="closed-1842"><h2>Issue #1842 closed<span class="toot-id"> #closed-1842</span></h2><div class="pubdate">25 Feb at 09:14:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1842">https://github.com/qt4cg/qtspecs/issues/1842</a></div><p>This is a test of the emergency broadcast system. This is only a test.</p></div>
<div class="toot" id="created-1842"><h2>Issue #1842 created<span class="toot-id"> #created-1842</span></h2><div class="pubdate">25 Feb at 09:13:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1842">https://github.com/qt4cg/qtspecs/issues/1842</a></div><details><summary>This is a test of the emergency broadcast system. This is only a test.</summary><div class="markup"><p>Had this been a real emergency, we would have fled in terror and you would not have been informed.</p>
</div></details></div>
<div class="toot" id="closed-1840"><h2>Issue #1840 closed<span class="toot-id"> #closed-1840</span></h2><div class="pubdate">25 Feb at 09:13:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1840">https://github.com/qt4cg/qtspecs/pull/1840</a></div><p>GH action remove-label-on-reopen.yml</p></div>
<div class="toot" id="closed-1841"><h2>Issue #1841 closed<span class="toot-id"> #closed-1841</span></h2><div class="pubdate">25 Feb at 09:13:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1841">https://github.com/qt4cg/qtspecs/pull/1841</a></div><p>Action to remove label on reopen</p></div>
<div class="toot" id="created-1841"><h2>Pull request #1841 created<span class="toot-id"> #created-1841</span></h2><div class="pubdate">25 Feb at 09:12:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1841">https://github.com/qt4cg/qtspecs/pull/1841</a></div><details><summary>Action to remove label on reopen</summary><div class="markup"><p>Close #1840</p>
</div></details></div>
<div class="toot" id="created-1840"><h2>Pull request #1840 created<span class="toot-id"> #created-1840</span></h2><div class="pubdate">24 Feb at 21:03:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1840">https://github.com/qt4cg/qtspecs/pull/1840</a></div><details><summary>GH action remove-label-on-reopen.yml</summary><div class="markup"><p>In response to the mailing list post by @ndw: https://lists.w3.org/Archives/Public/public-xslt-40/2025Feb/0024.html</p>
<p>This is untested, but it might at least serve as an inspiration how to avoid the unwanted tag in an automated manner.</p>
</div></details></div>
<div class="toot" id="created-1839"><h2>Pull request #1839 created<span class="toot-id"> #created-1839</span></h2><div class="pubdate">24 Feb at 17:09:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1839">https://github.com/qt4cg/qtspecs/pull/1839</a></div><details><summary>Relax the return type of the Invisible XML parsing function</summary><div class="markup"><p>Fix #1796</p>
<p>This change does not appear to change any test results. (In other words, none of our tests checked that the return type was explicitly a document node.)</p>
</div></details></div>
<div class="toot" id="created-1838"><h2>Pull request #1838 created<span class="toot-id"> #created-1838</span></h2><div class="pubdate">24 Feb at 15:59:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1838">https://github.com/qt4cg/qtspecs/pull/1838</a></div><details><summary>1820 Attempt to add change markup in collapsed ToC</summary><div class="markup"><p>Fix #1820</p>
<p>This PR updates the styling so that a small "Δ" is added to the expand arrow when there are changes or additions in the concealed subsections. It's smaller and not blue. I could argue that this is on purpose so that the marking is different and perhaps more subtle. But the truth is, it was just easier to add the Δ without any markup that would make it larger or blue.</p>
<p>I've opted to conceal the Δ when the ToC is "open" on the grounds that you can see what is or isn't marked new on the revealed subsctions.</p>
</div></details></div>
<div class="toot" id="closed-1827"><h2>Issue #1827 closed<span class="toot-id"> #closed-1827</span></h2><div class="pubdate">24 Feb at 11:24:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1827">https://github.com/qt4cg/qtspecs/issues/1827</a></div><p>XPath TOC: For and Let Expressions: whitespace</p></div>
<div class="toot" id="closed-1831"><h2>Issue #1831 closed<span class="toot-id"> #closed-1831</span></h2><div class="pubdate">24 Feb at 11:24:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1831">https://github.com/qt4cg/qtspecs/pull/1831</a></div><p>1827 Fix excess whitespace in TOC</p></div>
<div class="toot" id="created-1837"><h2>Pull request #1837 created<span class="toot-id"> #created-1837</span></h2><div class="pubdate">24 Feb at 10:07:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1837">https://github.com/qt4cg/qtspecs/pull/1837</a></div><details><summary>1834 Additional clarification on JSON lines</summary><div class="markup"><p>Fix #1834</p>
</div></details></div>
<div class="toot" id="created-1836"><h2>Issue #1836 created<span class="toot-id"> #created-1836</span></h2><div class="pubdate">24 Feb at 09:42:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1836">https://github.com/qt4cg/qtspecs/issues/1836</a></div><details><summary>unparsed-text-lines() - line endings</summary><div class="markup"><p>The description of the unparsed-text-lines function contradicts itself regarding line endings.</p>
<p>First it says that the function is equivalent to calling <code>unparsed-text()</code> and applying <code>tokenize(., '\n')</code> to the result.</p>
<p>Then it says that it accepts x0A, x0D, or x0D0A as line endings.</p>
</div></details></div>
<div class="toot" id="created-1835"><h2>Pull request #1835 created<span class="toot-id"> #created-1835</span></h2><div class="pubdate">24 Feb at 08:15:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1835">https://github.com/qt4cg/qtspecs/pull/1835</a></div><details><summary>add zero-width assertions to regular expressions</summary><div class="markup"><p>Proposal for issues !998 and !1006 to add zero-width assertions - lookahead, lookbehind, and word boundary.</p>
<p>Word boundaries use the already-defined \w and \W from XML Schema.</p>
<p>The syntax for lookahead and lookbehind assertions supports the two most common variants, one using &lt; and &gt; and the other using <code>(*positive_lookahead:expr)</code>, which is at least amenable to Web searches, and doesn’t need escaping in XSLT or XQuery.</p>
<p>Note that word boundary &lt; \b \B &gt; assertions can be rewritten in terms of lookahead and lookbehind assertions.</p>
<p>Perl has a more powerful form of \b and \B that can match grapheme clusters, the Unicode linebreaking algorithm, and more, but supporting that would require language and script based mechanisms; if the graphemes() function is added, it would be worth considering. For now, i made it an error to write \b{...} so that the support could be added later if wanted, and also so that copying regular expressions into XPath would raise an error for the unsupported feature.</p>
<p>I will reopen !998 - if this is accepted i can produce test cases. Of course, i’m also happy to edit/rewrite etc.  The syntax is widely supported, although \K is i think not in libpcre (but, libpcre has looser restrictions on negative backward assertions).</p>
</div></details></div>
<div class="toot" id="created-1834"><h2>Issue #1834 created<span class="toot-id"> #created-1834</span></h2><div class="pubdate">23 Feb at 17:42:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1834">https://github.com/qt4cg/qtspecs/issues/1834</a></div><details><summary>json-lines - refinement</summary><div class="markup"><p>Some suggestions regarding support for json-lines:</p>
<p>(a) The json-lines spec has no official standing. It might therefore be a good idea if we summarize its essentials, just in case it disappears off the web.
(b) The spec makes the final newline optional. Our test cases assume no final newline. We should probably mandate this for interoperability.
(c) We should tell people how to read files in json-lines format - specifically <code>unparsed-text-lines() ! parse-json()</code></p>
</div></details></div>
<div class="toot" id="created-1833"><h2>Pull request #1833 created<span class="toot-id"> #created-1833</span></h2><div class="pubdate">21 Feb at 09:32:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1833">https://github.com/qt4cg/qtspecs/pull/1833</a></div><details><summary>583 Drop map:replace and array:replace</summary><div class="markup"><p>Fix #583</p>
</div></details></div>
<div class="toot" id="created-1832"><h2>Issue #1832 created<span class="toot-id"> #created-1832</span></h2><div class="pubdate">21 Feb at 00:22:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1832">https://github.com/qt4cg/qtspecs/issues/1832</a></div><details><summary>Associativity of Operators, especially "||" (Appendix A.5)</summary><div class="markup"><p>The associativity of the <code>||</code> operator is given as "left-to-right" - it should surely be "either" (like comma, "or", and  "union").</p>
<p>Other aspects of this table are questionable.</p>
<ul>
<li>The operator <code>?[]</code> for filtering a map or array should probably be included.</li>
<li>Arguably <code>=&gt;</code> and <code>?</code> should be omitted because the RHS is not actually an expression, though it's true that if <code>A =&gt; B =&gt; C</code> is allowed, then it means <code>(A =&gt; B) =&gt; C</code>.</li>
<li><code>+</code> and <code>*</code> are associative, it's only in conjunction with other operators that they aren't.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1831"><h2>Pull request #1831 created<span class="toot-id"> #created-1831</span></h2><div class="pubdate">20 Feb at 21:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1831">https://github.com/qt4cg/qtspecs/pull/1831</a></div><details><summary>1827 Fix excess whitespace in TOC</summary><div class="markup"><p>Fix #1827</p>
</div></details></div>
<div class="toot" id="created-1830"><h2>Pull request #1830 created<span class="toot-id"> #created-1830</span></h2><div class="pubdate">20 Feb at 12:41:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1830">https://github.com/qt4cg/qtspecs/pull/1830</a></div><details><summary>1829 Reintroduce restrictions on RHS of `=&gt;`</summary><div class="markup"><p>Partial reversion of PR #1763</p>
</div></details></div>
<div class="toot" id="created-1829"><h2>Issue #1829 created<span class="toot-id"> #created-1829</span></h2><div class="pubdate">20 Feb at 11:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1829">https://github.com/qt4cg/qtspecs/issues/1829</a></div><details><summary>Problems with new arrow expression syntax</summary><div class="markup"><p>I'm hitting problems with implementing the changes in PR #1763</p>
<p>The problem is that the <code>=&gt;</code> can now be followed by either a static function call or a dynamic function call, and I think we need unbounded lookahead to distinguish them.</p>
<p>Consider</p>
<p><code>3 =&gt; function-lookup(xs:QName('fn:abs'), 1)()</code></p>
<p>at first sight the arrow appears to be followed by a static function call, <code>function-lookup(xs:QName('fn:abs'), 1)</code>. But treating it as such causes a parsing error when we get to the <code>()</code> - what we actually have here is a dynamic function call that starts with a static function call.</p>
<p>I propose that we revert to allowing a dynamic function call only in the form</p>
<p>a =&gt; x ( argument-list )</p>
<p>where x is a variable reference, a parenthesized expression, an inline function expression, or a map or array constructor.</p>
</div></details></div>
<div class="toot" id="created-1828"><h2>Pull request #1828 created<span class="toot-id"> #created-1828</span></h2><div class="pubdate">20 Feb at 11:25:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1828">https://github.com/qt4cg/qtspecs/pull/1828</a></div><details><summary>1815 Add more detail on annotations of function items</summary><div class="markup"><p>Fix #1815</p>
</div></details></div>
<div class="toot" id="created-1827"><h2>Issue #1827 created<span class="toot-id"> #created-1827</span></h2><div class="pubdate">20 Feb at 10:11:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1827">https://github.com/qt4cg/qtspecs/issues/1827</a></div><details><summary>XPath TOC: For and Let Expressions: whitespace</summary><div class="markup"><p>The table of contents for XPath, section 4.12, "For and Let Expressions", contains spurious whitespace. The whitespace appears to be present in the HTML, but it is not there in the source XML. In the actual section heading, there are two <code>&lt;a&gt;</code> elements before and after the heading text, each having as content a single space character.</p>
<p>The problem is also there in the equivalent section heading "FLWOR Expressions" in the XQuery spec.</p>
<p>In the "xpath-assembled" document, the heading appears as</p>
<pre><code>            &lt;head&gt;
               &lt;phrase role="xpath"&gt;For and Let Expressions&lt;/phrase&gt;
            &lt;/head&gt;
</code></pre>
<p>It seems to be the <code>phrase</code> element that's causing the trouble: or more likely, the whitespace text nodes that surround it.</p>
</div></details></div>
<div class="toot" id="created-1826"><h2>Pull request #1826 created<span class="toot-id"> #created-1826</span></h2><div class="pubdate">20 Feb at 09:55:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1826">https://github.com/qt4cg/qtspecs/pull/1826</a></div><details><summary>Fix grammar bug #1818</summary><div class="markup"><p>Fix #1818</p>
</div></details></div>
<div class="toot" id="created-1825"><h2>Pull request #1825 created<span class="toot-id"> #created-1825</span></h2><div class="pubdate">20 Feb at 09:01:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1825">https://github.com/qt4cg/qtspecs/pull/1825</a></div><details><summary>1816 New function fn:partial-apply</summary><div class="markup"><p>Fix #1816</p>
</div></details></div>
<div class="toot" id="created-1824"><h2>Pull request #1824 created<span class="toot-id"> #created-1824</span></h2><div class="pubdate">19 Feb at 21:05:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1824">https://github.com/qt4cg/qtspecs/pull/1824</a></div><details><summary>1823 Revise top-level headings in F+O spec</summary><div class="markup"><p>Revises the headings for consistency and brevity, to make the ToC easier to navigate at a glance</p>
<p>Fix #1823</p>
</div></details></div>
<div class="toot" id="created-1823"><h2>Issue #1823 created<span class="toot-id"> #created-1823</span></h2><div class="pubdate">19 Feb at 20:52:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1823">https://github.com/qt4cg/qtspecs/issues/1823</a></div><details><summary>Clearer top-level section headings in F+O</summary><div class="markup"><p>The improved rendition of the table of contents makes it apparent that the top-level sections headings in F+O are inconsistent and unnecessarily verbose.</p>
</div></details></div>
<div class="toot" id="closed-1821"><h2>Issue #1821 closed<span class="toot-id"> #closed-1821</span></h2><div class="pubdate">19 Feb at 17:53:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1821">https://github.com/qt4cg/qtspecs/issues/1821</a></div><p>Generated appendices in XDM</p></div>
<div class="toot" id="closed-1822"><h2>Issue #1822 closed<span class="toot-id"> #closed-1822</span></h2><div class="pubdate">19 Feb at 17:53:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1822">https://github.com/qt4cg/qtspecs/pull/1822</a></div><p>1821 Fix the generated appendixes in the Data Model</p></div>
<div class="toot" id="created-1822"><h2>Pull request #1822 created<span class="toot-id"> #created-1822</span></h2><div class="pubdate">19 Feb at 17:25:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1822">https://github.com/qt4cg/qtspecs/pull/1822</a></div><details><summary>1821 Fix the generated appendixes in the Data Model</summary><div class="markup"><p>Fix #1821</p>
</div></details></div>
<div class="toot" id="created-1821"><h2>Issue #1821 created<span class="toot-id"> #created-1821</span></h2><div class="pubdate">19 Feb at 09:21:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1821">https://github.com/qt4cg/qtspecs/issues/1821</a></div><details><summary>Generated appendices in XDM</summary><div class="markup"><p>The last four appendices in XDM are stylesheet-generated, and their TOC entries are added "by hand", and as a result they are incorrectly rendered.</p>
<p>I suggest using the same process for these appendices as other specs use: they should have a skeletal presence in the XML master, with a processing instruction to direct the stylesheet to expand the content; there is then no need for special machinery in the stylesheet to generate the TOC.</p>
</div></details></div>
<div class="toot" id="closed-1808"><h2>Issue #1808 closed<span class="toot-id"> #closed-1808</span></h2><div class="pubdate">18 Feb at 22:07:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1808">https://github.com/qt4cg/qtspecs/issues/1808</a></div><p>Add pipeline operator to list of tokens using '&lt;' and '&gt;' characters</p></div>
<div class="toot" id="created-1820"><h2>Issue #1820 created<span class="toot-id"> #created-1820</span></h2><div class="pubdate">18 Feb at 22:05:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1820">https://github.com/qt4cg/qtspecs/issues/1820</a></div><details><summary>Delta markers in collapsed TOC</summary><div class="markup"><p>When the TOC is shown in collapsed mode, it would be nice to promote the Δ change markers to the level where they become visible.</p>
</div></details></div>
<div class="toot" id="created-1819"><h2>Pull request #1819 created<span class="toot-id"> #created-1819</span></h2><div class="pubdate">18 Feb at 21:23:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1819">https://github.com/qt4cg/qtspecs/pull/1819</a></div><details><summary>451 Multiple schemas in XSLT</summary><div class="markup"><p>Fix #451</p>
</div></details></div>
<div class="toot" id="created-1818"><h2>Issue #1818 created<span class="toot-id"> #created-1818</span></h2><div class="pubdate">18 Feb at 20:10:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1818">https://github.com/qt4cg/qtspecs/issues/1818</a></div><details><summary>Grammar problem introduced by #1802</summary><div class="markup"><p>The recent merge of #1802 has incorrectly changed production <code>ArrowExpr</code> from</p>
<pre><code class="language-xquery">ArrowExpr
          ::= UnaryExpr ( SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget )
</code></pre>
<p>to</p>
<pre><code class="language-xquery">ArrowExpr
          ::= UnaryExpr ( SequenceArrowTarget MappingArrowTarget LookupArrowTarget )*
</code></pre>
<p>It has changed a <code>g:choice</code> operator to a <code>g:zeroOrMore</code> operator, while it should have added a <code>g:zeroOrMore</code> around the <code>g:choice</code>.</p>
</div></details></div>
<div class="toot" id="closed-1716"><h2>Issue #1716 closed<span class="toot-id"> #closed-1716</span></h2><div class="pubdate">18 Feb at 18:37:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1716">https://github.com/qt4cg/qtspecs/issues/1716</a></div><p>Variable lookahead needed for `ArrowTarget`</p></div>
<div class="toot" id="closed-1763"><h2>Issue #1763 closed<span class="toot-id"> #closed-1763</span></h2><div class="pubdate">18 Feb at 18:37:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1763">https://github.com/qt4cg/qtspecs/pull/1763</a></div><p>1716 Generalize syntax of arrow expressions</p></div>
<div class="toot" id="closed-1789"><h2>Issue #1789 closed<span class="toot-id"> #closed-1789</span></h2><div class="pubdate">18 Feb at 17:32:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1789">https://github.com/qt4cg/qtspecs/issues/1789</a></div><p>Terminology: "singleton map"</p></div>
<div class="toot" id="closed-1791"><h2>Issue #1791 closed<span class="toot-id"> #closed-1791</span></h2><div class="pubdate">18 Feb at 17:32:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1791">https://github.com/qt4cg/qtspecs/pull/1791</a></div><p>1789 Fix singleton terminology</p></div>
<div class="toot" id="minutes—02-18"><h2>QT4 CG meeting 110 draft minutes<span class="toot-id"> #minutes—02-18</span></h2><div class="pubdate">18 Feb at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-18">https://qt4cg.org/meeting/minutes/2025/02-18</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1769"><h2>Issue #1769 closed<span class="toot-id"> #closed-1769</span></h2><div class="pubdate">18 Feb at 17:17:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1769">https://github.com/qt4cg/qtspecs/pull/1769</a></div><p>Add links from processing model diagrams</p></div>
<div class="toot" id="closed-1788"><h2>Issue #1788 closed<span class="toot-id"> #closed-1788</span></h2><div class="pubdate">18 Feb at 17:14:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1788">https://github.com/qt4cg/qtspecs/issues/1788</a></div><p>Drop reference to maps being unordered</p></div>
<div class="toot" id="closed-1790"><h2>Issue #1790 closed<span class="toot-id"> #closed-1790</span></h2><div class="pubdate">18 Feb at 17:14:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1790">https://github.com/qt4cg/qtspecs/pull/1790</a></div><p>1788 Replace statement that maps are unordered</p></div>
<div class="toot" id="closed-1785"><h2>Issue #1785 closed<span class="toot-id"> #closed-1785</span></h2><div class="pubdate">18 Feb at 17:11:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1785">https://github.com/qt4cg/qtspecs/issues/1785</a></div><p>XQuery 4.0 grammar: `ArrowExpr` target, `ReverseAxis`</p></div>
<div class="toot" id="closed-1802"><h2>Issue #1802 closed<span class="toot-id"> #closed-1802</span></h2><div class="pubdate">18 Feb at 17:11:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1802">https://github.com/qt4cg/qtspecs/pull/1802</a></div><p>1785 Fix two simple grammar bugs</p></div>
<div class="toot" id="closed-1803"><h2>Issue #1803 closed<span class="toot-id"> #closed-1803</span></h2><div class="pubdate">18 Feb at 17:08:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1803">https://github.com/qt4cg/qtspecs/issues/1803</a></div><p>Drop "(Non-Normative)" from table of contents</p></div>
<div class="toot" id="closed-1804"><h2>Issue #1804 closed<span class="toot-id"> #closed-1804</span></h2><div class="pubdate">18 Feb at 17:08:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1804">https://github.com/qt4cg/qtspecs/pull/1804</a></div><p>Drop "(Non-Normative)" from ToC</p></div>
<div class="toot" id="closed-1805"><h2>Issue #1805 closed<span class="toot-id"> #closed-1805</span></h2><div class="pubdate">18 Feb at 17:05:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1805">https://github.com/qt4cg/qtspecs/issues/1805</a></div><p>Drop middle dots from term references in F&amp;O</p></div>
<div class="toot" id="closed-1806"><h2>Issue #1806 closed<span class="toot-id"> #closed-1806</span></h2><div class="pubdate">18 Feb at 17:05:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1806">https://github.com/qt4cg/qtspecs/pull/1806</a></div><p>1805 Drop middle dots from termref rendition in F+O</p></div>
<div class="toot" id="closed-1807"><h2>Issue #1807 closed<span class="toot-id"> #closed-1807</span></h2><div class="pubdate">18 Feb at 17:02:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1807">https://github.com/qt4cg/qtspecs/issues/1807</a></div><p>Two exceptions or three?</p></div>
<div class="toot" id="closed-1809"><h2>Issue #1809 closed<span class="toot-id"> #closed-1809</span></h2><div class="pubdate">18 Feb at 17:02:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1809">https://github.com/qt4cg/qtspecs/pull/1809</a></div><p>1807 Two exceptions to the rule, not three</p></div>
<div class="toot" id="closed-1631"><h2>Issue #1631 closed<span class="toot-id"> #closed-1631</span></h2><div class="pubdate">18 Feb at 17:00:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1631">https://github.com/qt4cg/qtspecs/issues/1631</a></div><p>xsl:apply-templates (without select) should allow inline content</p></div>
<div class="toot" id="closed-1810"><h2>Issue #1810 closed<span class="toot-id"> #closed-1810</span></h2><div class="pubdate">18 Feb at 16:59:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1810">https://github.com/qt4cg/qtspecs/pull/1810</a></div><p>1808 Add -&gt; to list of tokens using lt and gt characters</p></div>
<div class="toot" id="created-1817"><h2>Pull request #1817 created<span class="toot-id"> #created-1817</span></h2><div class="pubdate">18 Feb at 15:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1817">https://github.com/qt4cg/qtspecs/pull/1817</a></div><details><summary>1800 Methods</summary><div class="markup"><p>Fix #1800</p>
</div></details></div>
<div class="toot" id="created-1816"><h2>Issue #1816 created<span class="toot-id"> #created-1816</span></h2><div class="pubdate">18 Feb at 15:33:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1816">https://github.com/qt4cg/qtspecs/issues/1816</a></div><details><summary>Programmatic partial application</summary><div class="markup"><p>We don't have a programmatic way of doing partial function application, in particular it's very difficult to to a partial application supplying the first argument of a function item without knowing statically how many other arguments there are.</p>
<p>I suggest extending fn:apply so that the second argument can be a map with integer keys; it can supply some or all of the arguments to a function, and arguments that aren't supplied are retained in the returned partially-applied function item. For the example cited where only the first argument is to be supplied, supplying an array of length one would be equivalent.</p>
</div></details></div>
<div class="toot" id="created-1815"><h2>Issue #1815 created<span class="toot-id"> #created-1815</span></h2><div class="pubdate">18 Feb at 15:29:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1815">https://github.com/qt4cg/qtspecs/issues/1815</a></div><details><summary>Function annotations on function items</summary><div class="markup"><p>We say very little about function annotations on function items.</p>
<p>For example,</p>
<ul>
<li>
<p>we don't say that the function item constructed by a named function reference inherits the function annotations of the function declaration</p>
</li>
<li>
<p>we don't say whether a function item constructed by partial application (whether static or dynamic) has any function annotations, and if so what they are.</p>
</li>
<li>
<p>we don't mention them in function-lookup().</p>
</li>
</ul>
</div></details></div>
<div class="toot" id="created-1814"><h2>Pull request #1814 created<span class="toot-id"> #created-1814</span></h2><div class="pubdate">17 Feb at 12:51:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1814">https://github.com/qt4cg/qtspecs/pull/1814</a></div><details><summary>1813 Reorganise the XDM spec at top level</summary><div class="markup"><p>Fix #1813</p>
<p>The diff version is probably not too useful because a lot of material has moved around. Very little text has actually changed, and none of it substantively.</p>
</div></details></div>
<div class="toot" id="agenda-02-18"><h2>QT4 CG meeting 110 draft agenda<span class="toot-id"> #agenda-02-18</span></h2><div class="pubdate">17 Feb at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-18">https://qt4cg.org/meeting/agenda/2025/02-18</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1813"><h2>Issue #1813 created<span class="toot-id"> #created-1813</span></h2><div class="pubdate">17 Feb at 11:15:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1813">https://github.com/qt4cg/qtspecs/issues/1813</a></div><details><summary>Reorganise top-level sections in XDM</summary><div class="markup"><p>The improved presentation of the TOC for our specs makes it rather obvious that the structure of the XDM spec has become unbalanced. Most of the spec is about node trees; information about atomic values, maps, functions etc is hard to find, and sometimes appears in strange places such as "Terminology".</p>
<p>In addition, the way the spec is assembled from multiple entities serves little purpose. It makes it harder for editors to find the text that needs to be edited and to locate markup errors introduced in the course of editing.</p>
</div></details></div>
<div class="toot" id="created-1812"><h2>Pull request #1812 created<span class="toot-id"> #created-1812</span></h2><div class="pubdate">17 Feb at 10:51:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1812">https://github.com/qt4cg/qtspecs/pull/1812</a></div><details><summary>1811 Add note regarding non-XML chars in xsl:output-character</summary><div class="markup"><p>Fix #1811</p>
</div></details></div>
<div class="toot" id="created-1811"><h2>Issue #1811 created<span class="toot-id"> #created-1811</span></h2><div class="pubdate">17 Feb at 10:12:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1811">https://github.com/qt4cg/qtspecs/issues/1811</a></div><details><summary>Add note concerning non-XML characters in character maps</summary><div class="markup"><p>We have relaxed the rules for using non-XML characters in strings. It would be useful to explain how to take advantage of this in character maps.</p>
</div></details></div>
<div class="toot" id="created-1810"><h2>Pull request #1810 created<span class="toot-id"> #created-1810</span></h2><div class="pubdate">17 Feb at 09:33:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1810">https://github.com/qt4cg/qtspecs/pull/1810</a></div><p>1808 Add -&gt; to list of tokens using lt and gt characters</p></div>
<div class="toot" id="created-1809"><h2>Pull request #1809 created<span class="toot-id"> #created-1809</span></h2><div class="pubdate">17 Feb at 09:23:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1809">https://github.com/qt4cg/qtspecs/pull/1809</a></div><details><summary>1807 Two exceptions to the rule, not three</summary><div class="markup"><p>Fix #1807</p>
</div></details></div>
<div class="toot" id="created-1808"><h2>Issue #1808 created<span class="toot-id"> #created-1808</span></h2><div class="pubdate">16 Feb at 23:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1808">https://github.com/qt4cg/qtspecs/issues/1808</a></div><details><summary>Add pipeline operator to list of tokens using '&lt;' and '&gt;' characters</summary><div class="markup"><p>Add the operator <code>-&gt;</code> to the list of tokens in XPath A3.3.</p>
</div></details></div>
<div class="toot" id="created-1807"><h2>Issue #1807 created<span class="toot-id"> #created-1807</span></h2><div class="pubdate">16 Feb at 22:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1807">https://github.com/qt4cg/qtspecs/issues/1807</a></div><details><summary>Two exceptions or three?</summary><div class="markup"><p>XPath 4.5.2.7 on function identity says "There are two exceptions to this rule:" and then lists three.</p>
</div></details></div>
<div class="toot" id="created-1806"><h2>Pull request #1806 created<span class="toot-id"> #created-1806</span></h2><div class="pubdate">16 Feb at 22:44:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1806">https://github.com/qt4cg/qtspecs/pull/1806</a></div><details><summary>1805 Drop middle dots from termref rendition in F+O</summary><div class="markup"><p>Brings F+O into line with the other specs.</p>
<p>Fix #1805</p>
</div></details></div>
<div class="toot" id="created-1805"><h2>Issue #1805 created<span class="toot-id"> #created-1805</span></h2><div class="pubdate">16 Feb at 22:36:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1805">https://github.com/qt4cg/qtspecs/issues/1805</a></div><details><summary>Drop middle dots from term references in F&amp;O</summary><div class="markup"><p>The F&amp;O spec renders termref links between middle dots. None of the other specs use this convention.</p>
</div></details></div>
<div class="toot" id="created-1804"><h2>Pull request #1804 created<span class="toot-id"> #created-1804</span></h2><div class="pubdate">16 Feb at 22:05:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1804">https://github.com/qt4cg/qtspecs/pull/1804</a></div><details><summary>Drop "(Non-Normative)" from ToC</summary><div class="markup"><p>Fix #1803</p>
</div></details></div>
<div class="toot" id="created-1803"><h2>Issue #1803 created<span class="toot-id"> #created-1803</span></h2><div class="pubdate">16 Feb at 21:54:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1803">https://github.com/qt4cg/qtspecs/issues/1803</a></div><details><summary>Drop "(Non-Normative)" from table of contents</summary><div class="markup"><p>Proposal - drop the phrase "(Non-Normative)" from section titles in the table of contents (but not in the body of the document).</p>
<p>In several of the specs this phrase disrupts the indentation and formatting of the ToC, and it adds very little value.</p>
</div></details></div>
<div class="toot" id="created-1802"><h2>Pull request #1802 created<span class="toot-id"> #created-1802</span></h2><div class="pubdate">16 Feb at 19:16:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1802">https://github.com/qt4cg/qtspecs/pull/1802</a></div><details><summary>1785 Fix two simple grammar bugs</summary><div class="markup"><p>Fix #1785</p>
</div></details></div>
<div class="toot" id="created-1801"><h2>Pull request #1801 created<span class="toot-id"> #created-1801</span></h2><div class="pubdate">15 Feb at 23:08:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1801">https://github.com/qt4cg/qtspecs/pull/1801</a></div><details><summary>1798 Function fn:function-identity</summary><div class="markup"><p>The function fn:identity as already described and discussed in #1798</p>
</div></details></div>
<div class="toot" id="created-1800"><h2>Issue #1800 created<span class="toot-id"> #created-1800</span></h2><div class="pubdate">14 Feb at 20:17:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1800">https://github.com/qt4cg/qtspecs/issues/1800</a></div><details><summary>The `=?&gt;` lookup arrow expression operator is weird, difficult to use, difficult to understand, difficult to read and unnatural</summary><div class="markup"><p>The XPath 4.0 language now includes a way for a function defined as a member of a map to easily access other members (siblings) that belong to the same map instance. Special syntax, the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#lookup-arrow-expression"><strong><code>=?&gt;</code> operator</strong></a>, was introduced to call such a function. As a whole this is a huge step forward providing the user with a new, powerful mechanism to conveniently express relationships and calculations over several member-values of a map instance.</p>
<p>I am raising this issue with the goal of further improving and simplifying for the user the way to define and call a member function of a map/record, giving it a convenient way to access the values of other members of the instance of the map, on which the call has been issued.</p>
<p>In my work, I have been trying to define a number of functions that must belong to a map/record and that should be able to access other members of the same map/record to which these functions belong.</p>
<p>The experience was far from satisfying and here I describe the main problems I encountered when trying to use the <strong><code>=?&gt;</code></strong> operator, and some obvious suggestions how we can further simplify the syntax for calling any member function of a map or record.</p>
<h1>1. Problems trying to use the <strong><code>=?&gt;</code></strong> operator</h1>
<p>Here are the main problems I ran into.</p>
<p><strong>Problem1</strong>. The <strong><code>=?&gt;</code></strong> operator was:</p>
<ul>
<li>weird-looking;</li>
<li>difficult to use;</li>
<li>difficult to understand;</li>
<li>difficult to read;</li>
<li>feeling unnatural.
It would be much better if we didn't have to use any special operator at all in order to call a member function "<strong><em><code>myFunction</code></em></strong>" of a map <strong><em><code>$m</code></em></strong> by simply:
<strong><em><code>$m?myFunction(&lt;tuple of any arguments defined in the signature of the function&gt;)</code></em></strong></li>
</ul>
<p><strong>Problem2</strong>. There is no example, in the sections that describe the record type (<strong><em><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#lookup-arrow-expression">3.2.8.3</a></em></strong>), showing a record member-function that accesses the values of other members of the same instance of the record.
<strong>Thus, the new feature is effectively hidden</strong> for people who want to work with records.
We need such an example for a record, so that we don't forget that any record is also a map and possesses all functionality a map has to offer. And a statement to this effect must be added to the description of records.</p>
<p><strong>Problem 3</strong>.  This syntax is overcomplicated and difficult to use and remember, resulting in unnecessarily long and complex expressions:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn($this) { $this?width * $this?height }
} 
return $rectangle =?&gt; area()
</code></pre>
<p>It would be significantly better to use a much simplified syntax such as:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn() { ?width * ?height }
} 
return $rectangle ? area()
</code></pre>
<p>Recognizing that <strong><em><code>?name</code></em></strong> is already used since XPath 3.1 as <strong><a href="https://www.w3.org/TR/2017/REC-xpath-31-20170321/#id-unary-lookup">Unary Lookup Operator</a></strong>, and to avoid the unlikely case of collision, when a member function accesses other members of the map-owner-instance that happen to have identically the same names as expected constituents of the current context item (upon which the function is applied), we can introduce a special character to denote the current map-owner-instance, thus the above example could look like this:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn() { ^width * ^height }
} 
return $rectangle ? area()
</code></pre>
<h1>Solutions</h1>
<p><strong>Solution for Problem 1</strong> above (weirdness of the <strong><em><code>=?&gt;</code></em></strong> operator:<br>
<em>Do not introduce any special operator</em>. Just use <code>?</code> to invoke the member-function.</p>
<p><strong>Solution for Problem 2</strong> above (lack of example of a record having a member-function that accesses other members of the same map-owner-instance).
Obviously, <em>provide such an example</em>. Also <em>reiterate there that all features and functionality of a map continue to be available for records</em>.</p>
<p><strong>Solution for Problem 3</strong> above (overcomplicated syntax:</p>
<ul>
<li>Get rid of the <strong><em><code>=?&gt;</code></em></strong> operator. Use <strong><code>?</code></strong> for all references to member-functions.</li>
<li>Don't use any special variable like <strong><em><code>$this</code></em></strong>. For example, the current example in the documentation:
<code>"area": fn($this) { $this?width * $this?height }</code>
should instead be:
<code>"area": fn() { ^width * ^height }</code></li>
<li>use the <strong><code>^</code></strong> character to denote <em>owner-map-instance</em> membership. Thus <strong><em><code>^width</code></em></strong> means: "<em>The member named <strong>"width"</strong> of the map instance upon which the current function was invoked</em>"</li>
</ul>
<h1>Conclusion</h1>
<p>I will issue a PR with the solutions, provided there are not any substantial comments hilighting problems with this proposal.</p>
</div></details></div>
<div class="toot" id="created-1799"><h2>Issue #1799 created<span class="toot-id"> #created-1799</span></h2><div class="pubdate">13 Feb at 20:43:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1799">https://github.com/qt4cg/qtspecs/issues/1799</a></div><details><summary>"well-formed HTML document"?</summary><div class="markup"><p>There is an apparent ambiguity in the XPath Functions specification as to whether <code>fn:parse-html</code> raises dynamic error err:FODC0011 when <code>html-version</code> is set to one of the HTML5 versions <em>and</em> the content of <code>$html</code> is not well-formed, given the general expectation that HTML5 parsers can always parse an input string regardless of syntactic validity.</p>
<p>The HTML5 standard, for its part, has actually always allowed the parser to be aborted upon encountering a parse error (though no browser does this), so the function definition would seem to require that <code>parse-html("&lt;p&gt;Hello&lt;/p&gt;", { "method": "html", "html-version": 5 })</code> invariably raises an error, given that the input is invalid (missing opening <code>&lt;html&gt;</code> tag, etc.).</p>
<p>I don't think this is the intended behavior; my suggestion is to either have it be explicitly implementation-defined as to which parse errors cause err:FODC0011 to be raised, or require that it is never raised for HTML5.</p>
</div></details></div>
<div class="toot" id="closed-1238"><h2>Issue #1238 closed<span class="toot-id"> #closed-1238</span></h2><div class="pubdate">12 Feb at 23:39:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1238">https://github.com/qt4cg/qtspecs/issues/1238</a></div><p>XSLT on-no-match="shallow-copy-all" - revised rules</p></div>
<div class="toot" id="created-1798"><h2>Issue #1798 created<span class="toot-id"> #created-1798</span></h2><div class="pubdate">12 Feb at 20:37:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1798">https://github.com/qt4cg/qtspecs/issues/1798</a></div><details><summary>Getting the value of the new identity-(DM)property of a function. `fn:function-identity`</summary><div class="markup"><p>The current set of <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions">Functions on Functions</a></strong>: at <strong>(https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions)</strong> was recently updated with a new function to produce all annotations for a given function: <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-function-annotations">fn:function-annotations</a></strong>.
However we are still missing the ability to reference another important, newly-added property of a function: the <strong>function identity: <a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items">in DM</a></strong> and <strong><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-function-identity">in XPath</a></strong>.</p>
<hr>
<h1><strong>fn:function-identity</strong></h1>
<p><strong>Summary</strong>
Returns <strong><em><a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items">the identity of the function item</a></em></strong>.</p>
<p><strong>Signature</strong></p>
<blockquote>
<p><strong>fn:function-identity(
&nbsp;&nbsp;$function	as fn(*)	
) as xs:string</strong></p>
</blockquote>
<p><strong>Properties</strong>
This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<p><strong>Notes</strong></p>
<ol>
<li>This function can be useful  in any scenario, where the evaluation of a function call requires repeated evaluation of this same, or other functions. Often in such cases, the algorithm needs access to a general structure, containing the cached results of executing possibly many different functions applied on specific arguments-tuples.
What <strong>unique key</strong> is needed under which to group all invocations of a specific function and then the mapping between their function-call arguments and the result of the call? Remarkably, the identity of a function fits exactly the requirements (uniqueness / one per function) for such a key.
As we already have a function-identity property in the Data Model for each function-item, it is straightforward to provide this identity, and the <strong><code>fn:function-identity</code></strong> does exactly that.</li>
<li>The function identity, by definition, is generated upon the creation of a function and has meaning throughout of the life of that function. It is not meaningful to store this value across different executions, because the identity given to a function in <em>execution1</em> will generally be different from the identity, given to it in <em>execution2</em>. However, the definitions of system functions (functions defined in the specifications under the system namespaces - with standard prefixes: <strong><em><code>xs</code>, <code>fn</code>, <code>map</code>, <code>array</code>, <code>math</code>, <code>err</code>, <code>output</code></em></strong>) can be assigned permanent identities in the official Specs documents, requiring every implementation to use exactly this published identity value for the official, system functions, thus achieving efficiency and convenience during debugging.</li>
<li>The function identity, being a string, can be used as a key in a map, thus making it possible to map a particular function to a sequence of items. It becomes possible to allow function items as map-keys by extending the definition of <strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-same-key">same-keys</a></em></strong> with: "If both keys are function items: <code>$f1</code> and <code>$f2</code>, then they are <strong>the same</strong> if and only if:
<strong><em><code>function-identity($f1) eq function-identity($f2)</code></em></strong></li>
</ol>
</div></details></div>
<div class="toot" id="created-1797"><h2>Issue #1797 created<span class="toot-id"> #created-1797</span></h2><div class="pubdate">12 Feb at 16:20:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1797">https://github.com/qt4cg/qtspecs/issues/1797</a></div><details><summary>elements-to-maps: separate function to construct a plan</summary><div class="markup"><p>I propose separating out the <code>uniform=true</code> option of <code>elements-to-maps()</code> into a separate function. This function analyses the data and produces a conversion plan, which can be supplied to the "layouts" option (perhaps renamed) of the main function.</p>
<p>The benefits are:</p>
<ul>
<li>The plan can be tweaked after it is created by manual adjustment, for example if the user wants to use "empty-plus" layout wherever the system's choice would be "empty", or to take account of anticipated future changes in the structure.</li>
<li>The plan can be used to process documents that did not exist at the time it was created, thus ensuring that future documents are all converted in the same way, and avoiding the overhead of rebuilding the plan each time.</li>
<li>The plan can be created from a small sample of the documents to be converted.</li>
<li>The plan can be created from a large collection of documents including documents that don't need to be converted but which may contain structural elements that are not revealed by the documents that need converting now.</li>
<li>The user can examine the plan to see what it is doing, which is useful for diagnostics.</li>
</ul>
<p>We should define the format of the plan (a map from element names to layouts) so that it can conveniently be serialized as a JSON document.</p>
</div></details></div>
<div class="toot" id="created-1796"><h2>Issue #1796 created<span class="toot-id"> #created-1796</span></h2><div class="pubdate">12 Feb at 14:46:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1796">https://github.com/qt4cg/qtspecs/issues/1796</a></div><details><summary>Allow fn:invisible-xml to return a function that returns an item()</summary><div class="markup"><p>Our current <code>fn:invisible-xml</code> function returns a document node. That makes perfect sense when held up against the Invisible XML specification. But I wonder if we should leave the door open to some extensibility. I can imagine, for example, an implementation of an Invisible XML processor that has the ability to return a map or even a CSV structure instead of XML. (XML is the required, standard result in 1.0 but implementors have been known to offer user options to produce other serializations and one area of potential change in the future is other serialization formats.)</p>
<p>Pro: more extensible. Con: less type information about the result.</p>
</div></details></div>
<div class="toot" id="created-1795"><h2>Issue #1795 created<span class="toot-id"> #created-1795</span></h2><div class="pubdate">12 Feb at 12:51:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1795">https://github.com/qt4cg/qtspecs/issues/1795</a></div><details><summary>XSLT templates: Matching values in a map by key</summary><div class="markup"><p>The simplest coding pattern for template rule processing for JSON structures would be to take a structure like this:</p>
<pre><code>[
   {"name": "John", "address": { .... }, job-history: [ { .... }, {....} ]},
   {"name": "Jane", "address": { .... }, job-history: [ { .... }, {....} ]}
]

and to process it using template rules of the form:

&lt;xsl:template match="record(name, address, job-history)"&gt;
    &lt;xsl:apply-templates select="?*"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'name')"&gt;...&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'address')"&gt;...&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'job-history')"&gt;...&lt;/xsl:template&gt;
</code></pre>
<p>We have nearly all the ingredients in place for this. In particular, we can ensure that the <code>select="?*"</code> selects values that are labelled with the relevant key, making it technically possible to match values according to that key: <code>select="?*"</code> might select an xs:string value "John", but the string is labelled with the property key="name", so it can in principle match a template rule designed to process the "name" value.</p>
<p>The only piece that's missing is how to write the match patterns. We can write <code>match=".[label()?key = 'name']"</code>, but that's hopelessly long-winded.</p>
<p>I propose that we use the syntax <code>match="?name"</code> to match a value that is labelled with the key "name". This feels intuitive and natural, and 99% of users won't trouble with the complex underlying semantics.</p>
<p>We can extend this by borrowing other parts of the Lookup expression syntax, for example <code>match="?('X', 'Y', 'Z')"</code> to match several keys.</p>
<p>I would also suggest promoting the operators "union", "intersect" and "except" so they can be used to combine any patterns (not just node patterns) so this could be written <code>match="?X | ?X | ?Z"</code>, or we could write <code>match="?* except ?X"</code>. But note that this would create an expectation that users can also write <code>select="?* except ?X"</code> in an XPath expression; and that's quite hard to achieve: see also #1794.</p>
</div></details></div>
<div class="toot" id="created-1794"><h2>Issue #1794 created<span class="toot-id"> #created-1794</span></h2><div class="pubdate">12 Feb at 12:03:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1794">https://github.com/qt4cg/qtspecs/issues/1794</a></div><details><summary>Lookup: select all except</summary><div class="markup"><p>In lookup expressions we have <code>?*</code> to select all entries, and <code>?X</code> to select a specific entry. There is frequently a requirement to select all entries with specific exceptions.</p>
<p>One way of doing this is <code>$map =&gt; map:remove('X')?*</code></p>
<p>Another is to do <code>$map?pairs::*[?key != 'X']?value</code></p>
<p>A third option is <code>$map?[?key != 'X']?*</code></p>
<p>Or <code>$map =&gt; map:filter(($k, $v){$k != 'X'})?*</code></p>
<p>Or <code>for key $k value $v in $map where $k != 'X' return $v</code></p>
<p>None of these feels particularly user-friendly.</p>
<p>A possible syntax might be <code>$map?-X</code> or more generally <code>"?" "-" KeySpecifier</code> to select all entries that are not selected by the <code>KeySpecifier</code>. For example this would allow <code>$map?-('X', 'Y')</code> to exclude <code>X</code> and <code>Y</code>,</p>
</div></details></div>
<div class="toot" id="closed-1782"><h2>Issue #1782 closed<span class="toot-id"> #closed-1782</span></h2><div class="pubdate">12 Feb at 11:42:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1782">https://github.com/qt4cg/qtspecs/pull/1782</a></div><p>1776 Add lookup patterns using ? and ??</p></div>
<div class="toot" id="closed-1781"><h2>Issue #1781 closed<span class="toot-id"> #closed-1781</span></h2><div class="pubdate">11 Feb at 21:52:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1781">https://github.com/qt4cg/qtspecs/issues/1781</a></div><p>XSLT: drop section 23 (Processing JSON Data) and Appendix B</p></div>
<div class="toot" id="closed-1792"><h2>Issue #1792 closed<span class="toot-id"> #closed-1792</span></h2><div class="pubdate">11 Feb at 17:34:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1792">https://github.com/qt4cg/qtspecs/issues/1792</a></div><p>Schema validation errors on function catalog for EXPath binary spec</p></div>
<div class="toot" id="closed-1793"><h2>Issue #1793 closed<span class="toot-id"> #closed-1793</span></h2><div class="pubdate">11 Feb at 17:34:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1793">https://github.com/qt4cg/qtspecs/pull/1793</a></div><p>1792 Make function-catalog file schema-valid</p></div>
<div class="toot" id="created-1793"><h2>Pull request #1793 created<span class="toot-id"> #created-1793</span></h2><div class="pubdate">11 Feb at 17:34:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1793">https://github.com/qt4cg/qtspecs/pull/1793</a></div><details><summary>1792 Make function-catalog file schema-valid</summary><div class="markup"><p>Fix #1792</p>
</div></details></div>
<div class="toot" id="created-1792"><h2>Issue #1792 created<span class="toot-id"> #created-1792</span></h2><div class="pubdate">11 Feb at 17:29:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1792">https://github.com/qt4cg/qtspecs/issues/1792</a></div><details><summary>Schema validation errors on function catalog for EXPath binary spec</summary><div class="markup"><p>I'm seeing schema validation errors after rebasing, it looks like PR #1765 introduced lines like</p>
<p><code>&lt;fos:changes issue="1751"&gt;</code></p>
<p>when the @issue attribute should be on the child fos:change element.</p>
<p>Perhaps the validation done by the build has improved.</p>
<p>I'll fix this in a separate PR to be emergency-applied.</p>
</div></details></div>
<div class="toot" id="minutes—02-11"><h2>QT4 CG meeting 109 draft minutes<span class="toot-id"> #minutes—02-11</span></h2><div class="pubdate">11 Feb at 17:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-11">https://qt4cg.org/meeting/minutes/2025/02-11</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1779"><h2>Issue #1779 closed<span class="toot-id"> #closed-1779</span></h2><div class="pubdate">11 Feb at 17:04:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1779">https://github.com/qt4cg/qtspecs/issues/1779</a></div><p>XPath 4.0 EBNF grammar</p></div>
<div class="toot" id="closed-1783"><h2>Issue #1783 closed<span class="toot-id"> #closed-1783</span></h2><div class="pubdate">11 Feb at 17:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1783">https://github.com/qt4cg/qtspecs/pull/1783</a></div><p>1779 Make CharRef XQuery-only</p></div>
<div class="toot" id="closed-1752"><h2>Issue #1752 closed<span class="toot-id"> #closed-1752</span></h2><div class="pubdate">11 Feb at 17:02:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1752">https://github.com/qt4cg/qtspecs/issues/1752</a></div><p>Return type of fn:partition()</p></div>
<div class="toot" id="closed-1761"><h2>Issue #1761 closed<span class="toot-id"> #closed-1761</span></h2><div class="pubdate">11 Feb at 17:02:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1761">https://github.com/qt4cg/qtspecs/pull/1761</a></div><p>1752 Correct return type of fn:partition()</p></div>
<div class="toot" id="closed-1751"><h2>Issue #1751 closed<span class="toot-id"> #closed-1751</span></h2><div class="pubdate">11 Feb at 17:00:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1751">https://github.com/qt4cg/qtspecs/issues/1751</a></div><p>bin:encode-string - should the result have a BOM?</p></div>
<div class="toot" id="closed-1765"><h2>Issue #1765 closed<span class="toot-id"> #closed-1765</span></h2><div class="pubdate">11 Feb at 17:00:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1765">https://github.com/qt4cg/qtspecs/pull/1765</a></div><p>1751 Clarify BOM handling</p></div>
<div class="toot" id="closed-1770"><h2>Issue #1770 closed<span class="toot-id"> #closed-1770</span></h2><div class="pubdate">11 Feb at 16:58:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1770">https://github.com/qt4cg/qtspecs/issues/1770</a></div><p>Union patterns in XSLT</p></div>
<div class="toot" id="closed-1772"><h2>Issue #1772 closed<span class="toot-id"> #closed-1772</span></h2><div class="pubdate">11 Feb at 16:58:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1772">https://github.com/qt4cg/qtspecs/pull/1772</a></div><p>1770 Default priority of rules with a union pattern</p></div>
<div class="toot" id="closed-402"><h2>Issue #402 closed<span class="toot-id"> #closed-402</span></h2><div class="pubdate">11 Feb at 16:56:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/402">https://github.com/qt4cg/qtspecs/issues/402</a></div><p>XSLT patterns: intersect and except</p></div>
<div class="toot" id="closed-1773"><h2>Issue #1773 closed<span class="toot-id"> #closed-1773</span></h2><div class="pubdate">11 Feb at 16:56:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1773">https://github.com/qt4cg/qtspecs/pull/1773</a></div><p>402 Change the semantics of intersect and except in patterns</p></div>
<div class="toot" id="closed-1784"><h2>Issue #1784 closed<span class="toot-id"> #closed-1784</span></h2><div class="pubdate">11 Feb at 16:53:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1784">https://github.com/qt4cg/qtspecs/pull/1784</a></div><p>1781 Drop obsolete material from XSLT spec</p></div>
<div class="toot" id="closed-755"><h2>Issue #755 closed<span class="toot-id"> #closed-755</span></h2><div class="pubdate">11 Feb at 16:51:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/755">https://github.com/qt4cg/qtspecs/issues/755</a></div><p>with expression; chaining and concatenation</p></div>
<div class="toot" id="closed-877"><h2>Issue #877 closed<span class="toot-id"> #closed-877</span></h2><div class="pubdate">11 Feb at 16:51:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/877">https://github.com/qt4cg/qtspecs/issues/877</a></div><p>Inconsistency in XQFO comparator functions/operators with recursive rules</p></div>
<div class="toot" id="closed-1729"><h2>Issue #1729 closed<span class="toot-id"> #closed-1729</span></h2><div class="pubdate">11 Feb at 16:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1729">https://github.com/qt4cg/qtspecs/issues/1729</a></div><p>Grammar problems introduced by #1721</p></div>
<div class="toot" id="closed-1767"><h2>Issue #1767 closed<span class="toot-id"> #closed-1767</span></h2><div class="pubdate">11 Feb at 16:50:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1767">https://github.com/qt4cg/qtspecs/pull/1767</a></div><p>1729/1737 Fix grammar for "declare record"</p></div>
<div class="toot" id="created-1791"><h2>Pull request #1791 created<span class="toot-id"> #created-1791</span></h2><div class="pubdate">11 Feb at 11:12:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1791">https://github.com/qt4cg/qtspecs/pull/1791</a></div><details><summary>1789 Fix singleton terminology</summary><div class="markup"><p>Replaces "singleton map" with "single-entry map" and "singleton array" with "single-member array"; the term "singleton" now always means count()=1, not size()=1.</p>
<p>Fix #1789</p>
</div></details></div>
<div class="toot" id="created-1790"><h2>Pull request #1790 created<span class="toot-id"> #created-1790</span></h2><div class="pubdate">11 Feb at 10:04:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1790">https://github.com/qt4cg/qtspecs/pull/1790</a></div><details><summary>1788 Replace statement that maps are unordered</summary><div class="markup"><p>Fix #1788</p>
</div></details></div>
<div class="toot" id="created-1789"><h2>Issue #1789 created<span class="toot-id"> #created-1789</span></h2><div class="pubdate">11 Feb at 09:00:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1789">https://github.com/qt4cg/qtspecs/issues/1789</a></div><details><summary>Terminology: "singleton map"</summary><div class="markup"><p>We often use the term "singleton map" to mean a map containing a single entry (key-value pair).</p>
<p>But in XQ 4.14.3.1 we use the same term to mean "a sequence containing a single map".</p>
</div></details></div>
<div class="toot" id="created-1788"><h2>Issue #1788 created<span class="toot-id"> #created-1788</span></h2><div class="pubdate">10 Feb at 14:50:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1788">https://github.com/qt4cg/qtspecs/issues/1788</a></div><details><summary>Drop reference to maps being unordered</summary><div class="markup"><p>In F&amp;O 17.5.1.5 elements-to-maps record layout, mapping rules, delete</p>
<blockquote>
<p>Because the child elements are converted to a map, their order is not retained.</p>
</blockquote>
<p>Substitute a rule that the entries in the map will correspond with "order of first appearance".</p>
</div></details></div>
<div class="toot" id="agenda-02-11"><h2>QT4 CG meeting 109 draft agenda<span class="toot-id"> #agenda-02-11</span></h2><div class="pubdate">10 Feb at 14:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-11">https://qt4cg.org/meeting/agenda/2025/02-11</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1787"><h2>Issue #1787 created<span class="toot-id"> #created-1787</span></h2><div class="pubdate">10 Feb at 10:47:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1787">https://github.com/qt4cg/qtspecs/issues/1787</a></div><details><summary>Sorted maps revisited</summary><div class="markup"><p>Now that we have ordered maps established, I'd like to make another attempt to introduce sorted maps - that is, maps whose ordering is by key value. The entries in such a map would be sorted by key, but there's no attempt to maintain sort order in subsequent put() operations.</p>
<p>We introduce map:sort($m) essentially as a convenient shorthand for <code>map:of-pairs(sort(map:pairs($m), fn{?key}))</code>.</p>
<p>And then we introduce something like <code>map:get-range($from, $to)</code> which returns the keys (or pairs, or entries) whose keys are in a given range -- which the implementation can optimize if it knows the map has been sorted.</p>
</div></details></div>
<div class="toot" id="created-1786"><h2>Issue #1786 created<span class="toot-id"> #created-1786</span></h2><div class="pubdate">09 Feb at 09:38:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1786">https://github.com/qt4cg/qtspecs/issues/1786</a></div><details><summary>A case study for XSLT transformation of JSON: the transpiler</summary><div class="markup"><p>One of the design aims of XSLT 4.0 is that it should be easier to transform JSON. Back in 2016 I published a paper at XML Prague (https://www.saxonica.com/papers/xmlprague-2016mhk.pdf) with the rather disappointing result that for a couple of non-trivial JSON transformation tasks, the easiest solution was to convert the JSON to XML, transform the XML, and then convert it back. In many ways it was that discovery that motivated the whole XSLT 4.0 project. So I want to review to what extent we have solved that problem, and what remains to be done. In particular, I have recently raised a number of open issues related to how we transform JSON-derived trees of maps and arrays using template rules, and I'm not sure we can resolve those issues without testing the proposals against real use cases.</p>
<p>I'm proposing to take as a case study the Java-to-C# transpiler which we described in a 2021 paper at https://www.saxonica.com/papers/markupuk-2021mhk.pdf. This is a real XSLT application in daily use. It invokes the (open source) JavaParser to emit an XML representation of Java source code, it performs various transformations of that XML, and then finally spits out equivalent C# source code. My basic question is: suppose the JavaParser had chosen to emit JSON instead of XML (as it might perfectly reasonably have chosen to do). Would we be able to write the transpiler in XSLT 4.0 to work entirely within the JSON space, avoiding all use of XML?</p>
<p>I chose this case study for several reasons:</p>
<ul>
<li>It's entirely plausible that the input might have been JSON rather than XML</li>
<li>The application relies very heavily (and successfully) on rule-based processing: if we didn't have template rules, then it would be dominated by large xsl:choose statements with hundreds of branches.</li>
<li>At around 5000 lines of XSLT, it's large enough to be non-trivial, yet small enough to be tractable as a case study.</li>
</ul>
<p>I looked at a couple of other candidates, and found they were things that could be readily done in XSLT 3.0 without any enhancements. For example we have production XSLT 3.0 code that takes a JSON data feed from our online shop at saxonica.com and uses it to update our sales database and to generate license keys. The JSON is voluminous but the structure is simple, and the constructs in XSLT 3.0 for handling maps and arrays are entirely up to the job. The transpiler differs in that the JSON has a much more interesting recursive structure, making rule-based transformation a natural fit to the task.</p>
<p>I'm not proposing to actually produce a complete replacement of the current transpiler, only to explore the task of doing so in enough detail to get some useful insights. I propose to use this issue tracker to capture my working notes as the study proceeds, but if there are recommendations affecting the 4.0 specs (as seems likely), then I will extract those into separate issues. Perhaps at the end of the process I will write up the case study as a conference paper.</p>
<p>My rough plan is as follows:</p>
<ol>
<li>Explore conversion of the current XML output by JavaParser to JSON using the new elements-to-maps() function. We have a number of open issues on the usability of this function and it will be interesting to see whether we encounter similar difficulties to those that have already been raised, and whether the suggested solutions are appropriate.</li>
<li>Convert the xml-to-java stylesheet to work on this JSON input. This stylesheet is not actually a working part of the transpiler, rather it's something we built as a stepping stone; before attempting to convert the XML syntax tree to C#, we felt it would be instructive to write code that converted it back to Java. This is an 820-line stylesheet and it should be feasible to convert it completely.</li>
<li>The transpiler currently produces, as an intermediate output, a "digest" file containing summary information about all the classes and methods found in the Java code, and their subtyping/override relationships. We then have a process that augments this digest with attributes that are needed by the C# generation, for example which methods to label with "virtual" or "override" modifiers. I propose to experiment with producing (and transforming) this digest in JSON rather than XML format.</li>
<li>Examine the XSLT code that generates C# output to look for features that appear to be tricky to convert, for example anything that uses the parent or ancestor axis, and study to what extent we now have the capability in XSLT 4.0 to handle those situations.</li>
</ol>
<p>Using this format (a GitHub issue) to record progress carries a risk that there will be comments that take things off at a tangent. Please help by resisting that temptation: if there are interesting issues raised in your mind, please take those up as separate issues.</p>
</div></details></div>
<div class="toot" id="created-1785"><h2>Issue #1785 created<span class="toot-id"> #created-1785</span></h2><div class="pubdate">08 Feb at 08:57:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1785">https://github.com/qt4cg/qtspecs/issues/1785</a></div><details><summary>XQuery 4.0 grammar: `ArrowExpr` target, `ReverseAxis`</summary><div class="markup"><p>While testing the parser generated from the specification grammar, I encountered two issues.</p>
<h3>1. <code>ArrowExpr</code> target must be optional</h3>
<p>The current definition in the specification is as follows:</p>
<pre><code>ArrowExpr ::= UnaryExpr (SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget)
</code></pre>
<p>However, the target part must at least be optional, or better zero-or-more:</p>
<pre><code>ArrowExpr ::= UnaryExpr (SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget)*
</code></pre>
<p>Otherwise arrow targets are expected almost everywhere. Making it zero-or-more allows parsing of</p>
<pre><code>a =&gt; b() =&gt; c()
</code></pre>
<p>which would not be possible without extra parentheses if it was optional.</p>
<h3>2. Missing <code>preceding-sibling</code> in <code>ReverseAxis</code></h3>
<p>The <code>ReverseAxis</code> production currently appears as:</p>
<pre><code>ReverseAxis ::= ( "ancestor"
                | "ancestor-or-self"
                | "parent"
                | "preceding"
                | "preceding-or-self"
                | "preceding-sibling-or-self" ) "::"
</code></pre>
<p>It is missing the <code>prededing-sibling</code> axis.</p>
</div></details></div>
<div class="toot" id="created-1784"><h2>Pull request #1784 created<span class="toot-id"> #created-1784</span></h2><div class="pubdate">07 Feb at 21:45:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1784">https://github.com/qt4cg/qtspecs/pull/1784</a></div><details><summary>1781 Drop obsolete material from XSLT spec</summary><div class="markup"><p>Drops material mainly deriving from when XSLT 3.0 had to work with both XPath 3.0 and 3.1. Includes non-normative exposition and some obsolete conformance statements.</p>
</div></details></div>
<div class="toot" id="created-1783"><h2>Pull request #1783 created<span class="toot-id"> #created-1783</span></h2><div class="pubdate">07 Feb at 21:03:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1783">https://github.com/qt4cg/qtspecs/pull/1783</a></div><details><summary>1779 Make CharRef XQuery-only</summary><div class="markup"><p>Fix #1779</p>
<p>Makes the CharRef token XQuery-only.</p>
</div></details></div>
<div class="toot" id="created-1782"><h2>Pull request #1782 created<span class="toot-id"> #created-1782</span></h2><div class="pubdate">07 Feb at 12:46:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1782">https://github.com/qt4cg/qtspecs/pull/1782</a></div><details><summary>1776 Add lookup patterns using ? and ??</summary><div class="markup"><p>Fix #1776</p>
</div></details></div>
<div class="toot" id="closed-1026"><h2>Issue #1026 closed<span class="toot-id"> #closed-1026</span></h2><div class="pubdate">07 Feb at 12:44:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1026">https://github.com/qt4cg/qtspecs/issues/1026</a></div><p>XSLT match patterns on pinned maps and arrays</p></div>
<div class="toot" id="created-1781"><h2>Issue #1781 created<span class="toot-id"> #created-1781</span></h2><div class="pubdate">07 Feb at 12:15:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1781">https://github.com/qt4cg/qtspecs/issues/1781</a></div><details><summary>XSLT: drop section 23 (Processing JSON Data) and Appendix B</summary><div class="markup"><p>Section 23 Processing JSON data at one time contained the specification of maps, before this moved into XPath 3.1. This has now gone, and what's left is pretty much content-free.</p>
<p>Appendix B contains a stylesheet for converting XML to JSON. It has some educational value, but not much, and I think it can go.</p>
</div></details></div>
<div class="toot" id="created-1780"><h2>Issue #1780 created<span class="toot-id"> #created-1780</span></h2><div class="pubdate">07 Feb at 11:49:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1780">https://github.com/qt4cg/qtspecs/issues/1780</a></div><details><summary>xsl:for-each optional variable introduction</summary><div class="markup"><p>I spend quite a lot of time writing</p>
<pre><code>&lt;xsl:for-each select="foo"&gt;
   &lt;xsl:variable name="foo" select="." as="element(foo)"/&gt;
   &lt;xsl:for-each select="$foo/bar"&gt;
      &lt;xsl:variable name="bar" select="." as="element(bar)"/&gt;
      .... do some stuff with $foo and $bar
   &lt;/xsl:for-each&gt;
&lt;/xsl:for-each&gt;
</code></pre>
<p>I'd prefer to go (much like xquery)</p>
<pre><code>&lt;xsl:for-each name="foo" as="element(foo)" select="foo"&gt;
   &lt;xsl:for-each name="bar" as="element(bar)" select="$foo/bar"&gt;
      .... do some stuff with $foo and $bar
   &lt;/xsl:for-each&gt;
&lt;/xsl:for-each&gt;
</code></pre>
</div></details></div>
<div class="toot" id="created-1779"><h2>Issue #1779 created<span class="toot-id"> #created-1779</span></h2><div class="pubdate">07 Feb at 11:44:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1779">https://github.com/qt4cg/qtspecs/issues/1779</a></div><details><summary>XPath 4.0 EBNF grammar</summary><div class="markup"><p>The grammar extraction and transformation in <a href="https://github.com/GuntherRademacher/rex-parser-generator/actions/workflows/rexify-xquery-40.yml">RExify XQuery 4.0 grammar</a> has been extended to cover the XPath 4.0 specification document, resulting in an LALR(1) grammar for XPath 4.0 that is suitable for REx.</p>
<p>This update revealed a minor issue: section <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#terminal-symbols">A.3.1 Terminal Symbols</a> lists <code>CharRef</code>, which is unreferenced:</p>
<pre><code>CharRef       ::= [http://www.w3.org/TR/REC-xml#NT-CharRef]
                                                         /* xgc: xml-version */
</code></pre>
<p>Currently, the transformation process includes a rule that removes this production. The rules will be adjusted as the grammar evolves.</p>
</div></details></div>
<div class="toot" id="created-1778"><h2>Pull request #1778 created<span class="toot-id"> #created-1778</span></h2><div class="pubdate">07 Feb at 10:31:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1778">https://github.com/qt4cg/qtspecs/pull/1778</a></div><details><summary>1456 Lookup expressions filtered by type</summary><div class="markup"><p>Fix #1456</p>
<p>Allows selection of records by type within a JSON tree, for example <code>$json ?? ~record(first, last) ? last</code>.</p>
<p>I'm aware that the use of the tilde here is controversial but I think this kind of query is going to be very common; it needs something simple and I think people will get used to it. No-one has suggested anything that is obviously better, and I propose to also use <code>~</code> in other similar contexts, for example type patterns in XSLT, which will increase familiarity.</p>
<p>I suggest reading <code>~</code> as "of type".</p>
</div></details></div>
<div class="toot" id="created-1777"><h2>Issue #1777 created<span class="toot-id"> #created-1777</span></h2><div class="pubdate">06 Feb at 18:35:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1777">https://github.com/qt4cg/qtspecs/issues/1777</a></div><details><summary>Shallow copy in XSLT with maps and arrays</summary><div class="markup"><p>Currently the <code>xsl:copy</code> instruction, if applied to a map or array, does a deep copy, and ignores the content of the contained sequence constructor.</p>
<p>I propose that if the contained sequence constructor is non-empty then instead of ignoring it, we should use it to create the content of the new map or array. Specifically, for maps xsl:copy will behave essentially like xsl:map, and for arrays it will behave essentially like xsl:array.</p>
<p>This is an incompatibility with 3.1, but since a contained sequence constructor is currently totally useless in this situation, it doesn't seem likely to cause any trouble.</p>
<p>I also propose that rather than using the new built-in <code>on-no-match="shallow-copy-all</code>, we should extend the semantics of <code>shallow-copy</code> to cover maps and arrays (as currently defined for <code>shallow-copy-all</code>). Again, there is an incompatibility, but the current rules are so unhelpful that it's unlikely people are relying on them.</p>
<p>I also propose that when apply-templates is applied to a map or array, it should be automatically pinned if it is not pinned already. The means that match patterns can be used with a lot more context to match the deep contents of the map or array and override the processing of the built-in templates.</p>
<p>And I propose that when apply-templates is applied to a map or array and there is no <code>select</code> attribute, it should "do the right thing" by applying templates to the map or array contents, rather than using the useless default of <code>child::node()</code>.</p>
</div></details></div>
<div class="toot" id="created-1776"><h2>Issue #1776 created<span class="toot-id"> #created-1776</span></h2><div class="pubdate">06 Feb at 18:24:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1776">https://github.com/qt4cg/qtspecs/issues/1776</a></div><details><summary>Using `?` and `??` in XSLT patterns</summary><div class="markup"><p>I propose that the pattern <code>P1 ? P2</code>, where <code>P1</code> and <code>P2</code> are patterns, should match any labelled item $L provided that $L matches P2, and <code>$L?..</code> (that is, <code>($L =&gt; label())?parent</code> ) matches <code>P1</code>.</p>
<p>Similarly, the pattern <code>P1 ?? P2</code>, where <code>P1</code> and <code>P2</code> are patterns, should match any labelled item $L provided that $L matches P2, and <code>$L?...</code> (that is, <code>($L =&gt; label())?ancestors()</code> ) matches <code>P1</code>.</p>
<p>Note that neither the syntax nor the semantics are directly related to the lookup operator in XPath. In particular, P2 is a pattern, not a KeySpecifier. But there is a strong analogy, both with the use of <code>?</code> and <code>??</code> in XPath expressions, and with the use of <code>/</code> and <code>//</code> in patterns.</p>
</div></details></div>
<div class="toot" id="created-1775"><h2>Issue #1775 created<span class="toot-id"> #created-1775</span></h2><div class="pubdate">06 Feb at 18:11:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1775">https://github.com/qt4cg/qtspecs/issues/1775</a></div><details><summary>Navigation in JSON trees</summary><div class="markup"><p>I propose that the parse-json function should create a pinned tree, so that upwards navigation to parent and ancestor j-nodes becomes possible.</p>
<p>I propose introducing the key specifier <code>..</code>, with <code>$M?..</code> being a shorthand for <code>($M =&gt; label())?parent</code>, giving a convenient and familiar way to navigate from a j-node to its parent in a pinned tree. For example, <code>$M?..?name</code> gives the value of the <code>name</code> property in the immediately containing map.</p>
<p>Similarly, I propose introducing the key specifier <code>...</code> to navigate to ancestors, so <code>$M?...</code> becomes a shorthand for <code>($M =&gt; label())?ancestors()</code>, and <code>$M?...?name</code> returns the <code>name</code> property of all containing maps.</p>
<p>For symmetry I suggest we also provide <code>...</code> as an abbreviated axis step, short for <code>ancestor::node()</code>.</p>
<p>I'd like to find a better name for "pinned". Perhaps "tracked" better captures that what it does is to track downward navigation steps and make them reversible.</p>
<p>I'd also like to introduce the terms <code>j-tree</code> and <code>j-node</code>. A j-tree is a map or array, recursively expanded to include its entries or members. A j-node is a value in a j-tree. Perhaps confine the usage to maps and arrays that have been pinned/tracked.</p>
</div></details></div>
<div class="toot" id="created-1774"><h2>Issue #1774 created<span class="toot-id"> #created-1774</span></h2><div class="pubdate">06 Feb at 17:55:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1774">https://github.com/qt4cg/qtspecs/issues/1774</a></div><details><summary>Nomenclature: relabelling</summary><div class="markup"><p>The term <code>relabelling</code> - used when we are down-casting, for example when an <code>xs:integer</code> is supplied and the required type is <code>xs:unsignedByte</code> - is easily confused with the concept of a label, being a set of properties that can be associated with any item in XDM 4.0, and which is accessible through the <code>fn:label</code> function.</p>
<p>I suggest we rename <code>relabelling</code> as <code>rebadging</code>.</p>
<p>Apart from anything else, this has the virtue that my spell-checker won't auto-correct it...</p>
</div></details></div>
<div class="toot" id="closed-1713"><h2>Issue #1713 closed<span class="toot-id"> #closed-1713</span></h2><div class="pubdate">06 Feb at 12:18:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1713">https://github.com/qt4cg/qtspecs/issues/1713</a></div><p>Patchy exposition of XSLT type pattern syntax</p></div>
<div class="toot" id="created-1773"><h2>Pull request #1773 created<span class="toot-id"> #created-1773</span></h2><div class="pubdate">05 Feb at 17:49:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1773">https://github.com/qt4cg/qtspecs/pull/1773</a></div><details><summary>402 Change the semantics of intersect and except in patterns</summary><div class="markup"><p>Fixes a bug in the 3.0 spec whereby the <code>intersect</code> and <code>except</code> operators in a pattern have counter-intuitive semantics.</p>
<p>Fix #402</p>
</div></details></div>
<div class="toot" id="created-1772"><h2>Pull request #1772 created<span class="toot-id"> #created-1772</span></h2><div class="pubdate">05 Feb at 16:50:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1772">https://github.com/qt4cg/qtspecs/pull/1772</a></div><details><summary>1770 Default priority of rules with a union pattern</summary><div class="markup"><p>Scraps the increasingly-complicated rules for handling priority of rules with a union pattern.</p>
<p>Fix #1770</p>
</div></details></div>
<div class="toot" id="created-1771"><h2>Issue #1771 created<span class="toot-id"> #created-1771</span></h2><div class="pubdate">05 Feb at 16:09:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1771">https://github.com/qt4cg/qtspecs/issues/1771</a></div><details><summary>fn:deep-equal: map order</summary><div class="markup"><p>It may not come as a big surprise: A first feature request we received for ordered maps was to be able to take the order into account when comparing maps.</p>
<p>I would propose to add an <code>ordered-map</code> option to <code>fn:deep-equal</code>, which defaults to false:</p>
<pre><code class="language-xquery">(: returns false :)
deep-equal(
  { 1: 'one', 2: 'two' },
  { 2: 'two', 1: 'one' },
  { 'ordered-map': true() }
)
</code></pre>
<p>It should be simple to use and easy to implement.</p>
</div></details></div>
<div class="toot" id="created-1770"><h2>Issue #1770 created<span class="toot-id"> #created-1770</span></h2><div class="pubdate">05 Feb at 16:07:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1770">https://github.com/qt4cg/qtspecs/issues/1770</a></div><details><summary>Union patterns in XSLT</summary><div class="markup"><p>The original XSLT 1.0 rule for union patterns such as <code>match="A|B"</code> said that the default priority was calculated as if there were two separate template rules with <code>match="A"</code> and <code>match="B"</code>. This became more complicated with the introduction of <code>xsl:next-match</code> in XSLT 2.0 - what should happen if the item matches both branches? It became more complicated again in XSLT 3.0 with the introduction of <code>on-multiple-match</code> - is it a multiple match if an item matches both branches? And in 4.0 it's complicated further by the introduction of constructs like <code>match="element(A|B)"</code> which is deemed equivalent to <code>match=A|B</code>.</p>
<p>I would like to break this cycle with a backwards-incompatible change. The default priority of a union pattern should be the numeric maximum of the default priorities of its branches; the treatment as being somewhat-equivalent to two separate template rules should go. We should encourage implementations to issue a compatibility warning if a union pattern appears with no explicit priority, and with multiple branches having different default priority.</p>
</div></details></div>
<div class="toot" id="created-1769"><h2>Pull request #1769 created<span class="toot-id"> #created-1769</span></h2><div class="pubdate">05 Feb at 15:56:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1769">https://github.com/qt4cg/qtspecs/pull/1769</a></div><details><summary>Add links from processing model diagrams</summary><div class="markup"><p>Completes action QT4CG-108-02</p>
<p>I’ve added link targets where necessary. I didn’t try to link closer than that paragraph level, partly because I think that’s the context the reader needs, but also partly because we don’t copy ID values from all elements.</p>
<p>There’s no definition of DM4.</p>
<p>(Review of the link targets and comments on what (if anything) the remaining boxes and labels should link to most appreciated.)</p>
</div></details></div>
<div class="toot" id="closed-1768"><h2>Issue #1768 closed<span class="toot-id"> #closed-1768</span></h2><div class="pubdate">05 Feb at 15:21:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1768">https://github.com/qt4cg/qtspecs/pull/1768</a></div><p>Inline SVG images</p></div>
<div class="toot" id="created-1768"><h2>Pull request #1768 created<span class="toot-id"> #created-1768</span></h2><div class="pubdate">05 Feb at 15:21:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1768">https://github.com/qt4cg/qtspecs/pull/1768</a></div><details><summary>Inline SVG images</summary><div class="markup"><p>In order for links to work in the browser, the SVG has to be inline, not loaded from a separate file. For self-document links, I guess this makes sense.</p>
<p>This is a tools-only change.</p>
</div></details></div>
<div class="toot" id="created-1767"><h2>Pull request #1767 created<span class="toot-id"> #created-1767</span></h2><div class="pubdate">05 Feb at 15:20:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1767">https://github.com/qt4cg/qtspecs/pull/1767</a></div><details><summary>1729/1737 Fix grammar for "declare record"</summary><div class="markup"><p>Fix #1729</p>
<ul>
<li>The syntax should be "declare record", not "declare type record".</li>
<li>All the declarations using annotations should allow multiple annotations.</li>
<li>Added a note about refactoring the grammar to avoid unbounded lookahead.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1766"><h2>Pull request #1766 created<span class="toot-id"> #created-1766</span></h2><div class="pubdate">05 Feb at 12:51:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1766">https://github.com/qt4cg/qtspecs/pull/1766</a></div><details><summary>1715 Drop array bound checking</summary><div class="markup"><p>Fix #1715</p>
<p>Drops array bound checking from <code>array:get</code>, arrays-as-functions, and array lookup. Returns () instead of an error FOAY0001 when the index is out of bounds. This brings arrays and maps into closer alignment.</p>
<p>Drops the <code>$fallback</code> argument of <code>array:get()</code></p>
<p>Adds a new function <code>array:get-if-present()</code> which replicates the old behaviour of <code>array:get()</code>.</p>
<p>Functions such as <code>array:put</code>, <code>array:replace</code>, <code>array:insert-before</code>, <code>array:head</code>, <code>array:tail</code> continue to perform bound checking.</p>
</div></details></div>
<div class="toot" id="closed-1738"><h2>Issue #1738 closed<span class="toot-id"> #closed-1738</span></h2><div class="pubdate">05 Feb at 11:41:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1738">https://github.com/qt4cg/qtspecs/issues/1738</a></div><p>Formatting of lists within notes</p></div>
<div class="toot" id="created-1765"><h2>Pull request #1765 created<span class="toot-id"> #created-1765</span></h2><div class="pubdate">05 Feb at 11:36:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1765">https://github.com/qt4cg/qtspecs/pull/1765</a></div><details><summary>1751 Clarify BOM handling</summary><div class="markup"><p>Fix #1751</p>
<p>Clarifies BOM handling (and byte order generally) in <code>bin:encode-string</code> and <code>bin:decode-string</code>.</p>
<p>Also adds a note to <code>bin:octal</code> for the prevention of possible misunderstanding.</p>
</div></details></div>
<div class="toot" id="closed-1758"><h2>Issue #1758 closed<span class="toot-id"> #closed-1758</span></h2><div class="pubdate">05 Feb at 09:43:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1758">https://github.com/qt4cg/qtspecs/issues/1758</a></div><p>EXPath specification validation problems</p></div>
<div class="toot" id="closed-1759"><h2>Issue #1759 closed<span class="toot-id"> #closed-1759</span></h2><div class="pubdate">05 Feb at 09:43:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1759">https://github.com/qt4cg/qtspecs/pull/1759</a></div><p>Fix validation issues in the EXPath module function catalogs</p></div>
<div class="toot" id="closed-1739"><h2>Issue #1739 closed<span class="toot-id"> #closed-1739</span></h2><div class="pubdate">04 Feb at 23:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1739">https://github.com/qt4cg/qtspecs/issues/1739</a></div><p>Obsolete references to ordering mode</p></div>
<div class="toot" id="closed-1741"><h2>Issue #1741 closed<span class="toot-id"> #closed-1741</span></h2><div class="pubdate">04 Feb at 23:50:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1741">https://github.com/qt4cg/qtspecs/pull/1741</a></div><p>1739 drop references to ordering mode in the static context</p></div>
<div class="toot" id="minutes—02-04"><h2>QT4 CG meeting 108 draft minutes<span class="toot-id"> #minutes—02-04</span></h2><div class="pubdate">04 Feb at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-04">https://qt4cg.org/meeting/minutes/2025/02-04</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1757"><h2>Issue #1757 closed<span class="toot-id"> #closed-1757</span></h2><div class="pubdate">04 Feb at 17:10:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1757">https://github.com/qt4cg/qtspecs/issues/1757</a></div><p>Build cleanup: remove the "by hand" diffs</p></div>
<div class="toot" id="closed-1760"><h2>Issue #1760 closed<span class="toot-id"> #closed-1760</span></h2><div class="pubdate">04 Feb at 17:10:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1760">https://github.com/qt4cg/qtspecs/pull/1760</a></div><p>Remove hand-generated diffs from the builds</p></div>
<div class="toot" id="closed-1743"><h2>Issue #1743 closed<span class="toot-id"> #closed-1743</span></h2><div class="pubdate">04 Feb at 17:07:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1743">https://github.com/qt4cg/qtspecs/pull/1743</a></div><p>1738 Formatting of Notes in F&amp;O</p></div>
<div class="toot" id="closed-1733"><h2>Issue #1733 closed<span class="toot-id"> #closed-1733</span></h2><div class="pubdate">04 Feb at 17:05:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1733">https://github.com/qt4cg/qtspecs/issues/1733</a></div><p>ACTION QT4CG-088-04, reworking the processing model diagram</p></div>
<div class="toot" id="closed-1746"><h2>Issue #1746 closed<span class="toot-id"> #closed-1746</span></h2><div class="pubdate">04 Feb at 17:05:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1746">https://github.com/qt4cg/qtspecs/pull/1746</a></div><p>Replace processing model diagrams</p></div>
<div class="toot" id="closed-1750"><h2>Issue #1750 closed<span class="toot-id"> #closed-1750</span></h2><div class="pubdate">04 Feb at 17:03:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1750">https://github.com/qt4cg/qtspecs/issues/1750</a></div><p>EXPath Binary : copy-edits and minor enhancements</p></div>
<div class="toot" id="closed-1753"><h2>Issue #1753 closed<span class="toot-id"> #closed-1753</span></h2><div class="pubdate">04 Feb at 17:03:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1753">https://github.com/qt4cg/qtspecs/pull/1753</a></div><p>1750 Overhaul of EXPath binary spec</p></div>
<div class="toot" id="closed-1571"><h2>Issue #1571 closed<span class="toot-id"> #closed-1571</span></h2><div class="pubdate">04 Feb at 17:03:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1571">https://github.com/qt4cg/qtspecs/issues/1571</a></div><p>Discussion: On the implementability of the specs and helping implementors</p></div>
<div class="toot" id="closed-1699"><h2>Issue #1699 closed<span class="toot-id"> #closed-1699</span></h2><div class="pubdate">04 Feb at 17:02:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1699">https://github.com/qt4cg/qtspecs/issues/1699</a></div><p>XPath function to calculate edit distance between two strings</p></div>
<div class="toot" id="closed-1682"><h2>Issue #1682 closed<span class="toot-id"> #closed-1682</span></h2><div class="pubdate">04 Feb at 17:01:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1682">https://github.com/qt4cg/qtspecs/issues/1682</a></div><p>Type Promotion</p></div>
<div class="toot" id="closed-1734"><h2>Issue #1734 closed<span class="toot-id"> #closed-1734</span></h2><div class="pubdate">04 Feb at 17:01:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1734">https://github.com/qt4cg/qtspecs/pull/1734</a></div><p>1682 Type promotion and operator mapping</p></div>
<div class="toot" id="closed-1764"><h2>Issue #1764 closed<span class="toot-id"> #closed-1764</span></h2><div class="pubdate">04 Feb at 09:18:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1764">https://github.com/qt4cg/qtspecs/issues/1764</a></div><p>Remove the BOM from unparsed text input?</p></div>
<div class="toot" id="created-1764"><h2>Issue #1764 created<span class="toot-id"> #created-1764</span></h2><div class="pubdate">04 Feb at 08:49:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1764">https://github.com/qt4cg/qtspecs/issues/1764</a></div><details><summary>Remove the BOM from unparsed text input?</summary><div class="markup"><p>XML parsing handles the BOM for us, and we say something explicit about the BOM when parsing JSON, but we're silent about the BOM when loading unparsed text. I think the right answer is to discard the BOM and return the text that follows it...</p>
</div></details></div>
<div class="toot" id="closed-1762"><h2>Issue #1762 closed<span class="toot-id"> #closed-1762</span></h2><div class="pubdate">03 Feb at 15:36:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1762">https://github.com/qt4cg/qtspecs/issues/1762</a></div><p>Combining different kinds of arrow</p></div>
<div class="toot" id="created-1763"><h2>Pull request #1763 created<span class="toot-id"> #created-1763</span></h2><div class="pubdate">03 Feb at 15:35:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1763">https://github.com/qt4cg/qtspecs/pull/1763</a></div><details><summary>1716 Generalize syntax of arrow expressions</summary><div class="markup"><p>Fix #1716</p>
</div></details></div>
<div class="toot" id="agenda-02-04"><h2>QT4 CG meeting 108 draft agenda<span class="toot-id"> #agenda-02-04</span></h2><div class="pubdate">03 Feb at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-04">https://qt4cg.org/meeting/agenda/2025/02-04</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1762"><h2>Issue #1762 created<span class="toot-id"> #created-1762</span></h2><div class="pubdate">03 Feb at 10:44:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1762">https://github.com/qt4cg/qtspecs/issues/1762</a></div><details><summary>Combining different kinds of arrow</summary><div class="markup"><p>In the spec, under arrow expressions, we have this example:</p>
<p><code>(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() =!&gt; fn($a) { $a + 1 }() =&gt; sum()</code></p>
<p>That use of an inline function is pretty clumsy, and it would be nice to think we could eliminate it using the new <code>-&gt;</code> operator. But it ain't easy.</p>
<p>We can't do</p>
<p><code>(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() -&gt; .+1 =&gt; sum()</code></p>
<p>because the precedence is wrong.</p>
<p>We can't do</p>
<p><code>(1 to 5) =!&gt; (xs:double() =&gt; math:sqrt() -&gt; .+1 ) =&gt; sum()</code></p>
<p>because we can't have a parenthesised construct on the RHS of the mapping arrow.</p>
<p>We can use the bang operator but the parentheses are awkward:</p>
<p><code>((1 to 5) ! (xs:double(.) =&gt; math:sqrt() -&gt; (.+1) )) =&gt; sum()</code></p>
<p>If we changed the precedences we could allow</p>
<p><code>(1 to 5) ! xs:double(.) ! math:sqrt(.) ! (.+1)  -&gt; sum(.)</code></p>
<p>Which would require moving <code>-&gt;</code> so it has lower precedence than <code>!</code>. But this would disrupt its relationship with <code>=&gt;</code>.</p>
</div></details></div>
<div class="toot" id="created-1761"><h2>Pull request #1761 created<span class="toot-id"> #created-1761</span></h2><div class="pubdate">03 Feb at 10:01:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1761">https://github.com/qt4cg/qtspecs/pull/1761</a></div><details><summary>1752 Correct return type of fn:partition()</summary><div class="markup"><p>Fix #1752</p>
</div></details></div>
<div class="toot" id="created-1760"><h2>Pull request #1760 created<span class="toot-id"> #created-1760</span></h2><div class="pubdate">03 Feb at 09:44:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1760">https://github.com/qt4cg/qtspecs/pull/1760</a></div><details><summary>Remove hand-generated diffs from the builds</summary><div class="markup"><p>Fix #1757</p>
<p>The PR build isn't going to be very informative, but I'll leave this one open in case anyone wants to review the source code diffs.</p>
<p>I did not attempt to remove the XML markup from the specs. Perhaps we should, but I think we'd want to manage that carefully to avoid an absolute mountain of merge conflicts.</p>
</div></details></div>
<div class="toot" id="closed-1744"><h2>Issue #1744 closed<span class="toot-id"> #closed-1744</span></h2><div class="pubdate">03 Feb at 09:15:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1744">https://github.com/qt4cg/qtspecs/pull/1744</a></div><p>Remove dead wood re: SVG diagrams from the XSLT build</p></div>
<div class="toot" id="created-1759"><h2>Pull request #1759 created<span class="toot-id"> #created-1759</span></h2><div class="pubdate">03 Feb at 09:01:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1759">https://github.com/qt4cg/qtspecs/pull/1759</a></div><details><summary>Fix validation issues in the EXPath module function catalogs</summary><div class="markup"><p>Fix #1758</p>
</div></details></div>
<div class="toot" id="created-1758"><h2>Issue #1758 created<span class="toot-id"> #created-1758</span></h2><div class="pubdate">03 Feb at 08:50:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1758">https://github.com/qt4cg/qtspecs/issues/1758</a></div><details><summary>EXPath specification validation problems</summary><div class="markup"><p>As @michaelhkay noted in email, the function catalogs for the EXPath specifications are not being validated.</p>
<p>That validation only occurs during test generation ¯_(ツ)_/¯</p>
<ol>
<li>Add an example to the EXPath file specification so that it's possible to run test generation</li>
<li>Add test generation for EXPath file and binary to the build</li>
<li>Fix the validation errors in the function catalog</li>
</ol>
</div></details></div>
<div class="toot" id="closed-1756"><h2>Issue #1756 closed<span class="toot-id"> #closed-1756</span></h2><div class="pubdate">03 Feb at 08:43:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1756">https://github.com/qt4cg/qtspecs/pull/1756</a></div><p>Make DeltaXML diffs on the main build too</p></div>
<div class="toot" id="created-1757"><h2>Issue #1757 created<span class="toot-id"> #created-1757</span></h2><div class="pubdate">03 Feb at 08:20:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1757">https://github.com/qt4cg/qtspecs/issues/1757</a></div><details><summary>Build cleanup: remove the "by hand" diffs</summary><div class="markup"><p>Unless I'm mistaken, the 'by hand' diffs, the ones that are created from explicit diff markup added by the editors, have not been consistently maintained for some time.</p>
<p>We still have places that point to them, and I think this could be confusing.</p>
<p>I propose that we pull all of that machinery out and remove references to them.</p>
</div></details></div>
<div class="toot" id="created-1756"><h2>Pull request #1756 created<span class="toot-id"> #created-1756</span></h2><div class="pubdate">03 Feb at 07:18:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1756">https://github.com/qt4cg/qtspecs/pull/1756</a></div><details><summary>Make DeltaXML diffs on the main build too</summary><div class="markup"><p>This PR should build DeltaXML diffs of the EXPath specs...and when merged, should build them on the main build as well.</p>
</div></details></div>
<div class="toot" id="closed-1755"><h2>Issue #1755 closed<span class="toot-id"> #closed-1755</span></h2><div class="pubdate">03 Feb at 07:02:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1755">https://github.com/qt4cg/qtspecs/pull/1755</a></div><p>Attempt to make DeltaXML diffs for EXPath specs</p></div>
<div class="toot" id="created-1755"><h2>Pull request #1755 created<span class="toot-id"> #created-1755</span></h2><div class="pubdate">03 Feb at 07:02:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1755">https://github.com/qt4cg/qtspecs/pull/1755</a></div><p>Attempt to make DeltaXML diffs for EXPath specs</p></div>
<div class="toot" id="created-1754"><h2>Issue #1754 created<span class="toot-id"> #created-1754</span></h2><div class="pubdate">02 Feb at 23:57:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1754">https://github.com/qt4cg/qtspecs/issues/1754</a></div><details><summary>Inverse functions to bin:hex, bin:bin, and bin:octal</summary><div class="markup"><p>In writing formal equivalents for the functions in the binary EXPath module, I found that while we have bin:bin() which turns a string of 0s and 1s into a binary value, we don't have any convenient way of doing the inverse. The same is true for octal. For hex we can cast to hexBinary and then cast to string, but that's a bit of a circumlocution.</p>
<p>I propose functions bin:to-bin, bin:to-octal and bin:to-hex that convert a binary value to a string of binary, octal, or hexadecimal digits respectively. Perhaps with an options parameter that allows a grouping separator and grouping size to be specified.</p>
</div></details></div>
<div class="toot" id="created-1753"><h2>Pull request #1753 created<span class="toot-id"> #created-1753</span></h2><div class="pubdate">02 Feb at 21:13:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1753">https://github.com/qt4cg/qtspecs/pull/1753</a></div><details><summary>1750 Overhaul of EXPath binary spec</summary><div class="markup"><p>Apart from general copy-editing, the main changes are:</p>
<ul>
<li>A lot more examples, presented in executable markup format (though they are not yet tested)</li>
<li>Many functions now have formal equivalents (again, currently untested)</li>
<li>Allow underscores and spaces in input to bin:hex, bin:octal, and bin:bin</li>
<li>Use type xs:unsignedByte for octet arguments</li>
<li>Use an enum() type for the octet-order argument</li>
</ul>
<p>Fix #1750</p>
</div></details></div>
<div class="toot" id="created-1752"><h2>Issue #1752 created<span class="toot-id"> #created-1752</span></h2><div class="pubdate">02 Feb at 19:18:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1752">https://github.com/qt4cg/qtspecs/issues/1752</a></div><details><summary>Return type of fn:partition()</summary><div class="markup"><p>The return type of <code>fn:partition</code> should be <code>array(item()*)*</code> not <code>array(item())*</code>.</p>
</div></details></div>
<div class="toot" id="created-1751"><h2>Issue #1751 created<span class="toot-id"> #created-1751</span></h2><div class="pubdate">02 Feb at 00:28:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1751">https://github.com/qt4cg/qtspecs/issues/1751</a></div><details><summary>bin:encode-string - should the result have a BOM?</summary><div class="markup"><p>Test cases in the EXPath test suite using <code>bin:encode-string</code> with encoding=utf-16 include a BOM at the start of the output, but the spec says nothing about this. It's probably useful for some use case but a nuisance for others.</p>
</div></details></div>
<div class="toot" id="created-1750"><h2>Issue #1750 created<span class="toot-id"> #created-1750</span></h2><div class="pubdate">01 Feb at 00:44:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1750">https://github.com/qt4cg/qtspecs/issues/1750</a></div><details><summary>EXPath Binary : copy-edits and minor enhancements</summary><div class="markup"><p>Suggested minor enhancements:</p>
<ul>
<li>Allow underscores and whitespace in strings of binary, octal, or hex digits supplied as strings.</li>
<li>Use type <code>xs:unsignedByte</code> rather than xs:integer for octet values</li>
<li>Use an enum type for params like "little-endian".</li>
</ul>
<p>The following are some suggested copy-edits:</p>
<p>Abstract para 4 - link to XQuery 4.1. The last sentence of the para ("The signatures and summaries of functions defined in this document...") makes no sense.</p>
<p>1.1 para 1, twice, ".)" should be ").".</p>
<p>1.2 Mention that the coercion rules in 4.0 mean that wherever a function accepts xs:base64Binary, it also accepts xs:hexBinary (but we've changed the signature to allow either, anyway).</p>
<p>para 2. " if the result return"?</p>
<p>The Note is ineleganty worded.</p>
<p>1.3 I guess we should integrate the test suite into QT4.</p>
<p>1.5 para 2 "In accordance with current practice" eh?</p>
<p>2.1 Example would benefit from reformatting.</p>
<p>2.2 Example, similarly. Could use underscores in the long integers. "and the examples from above reverse"??</p>
<ol start="3">
<li>
<p>"fn:fn:binary-resource" does not yet exist and is triple-barrelled.</p>
</li>
<li>
<p>Avoid "apologetic quotes" in 'constants'. And elsewhere. If it doesn't work as plain English without quotes, then it needs to be a defined term.</p>
</li>
</ol>
<p>4.1 and throughout, in Examples, use the F&amp;O rendition rather than the right arrow. Also, add these functions to the example checking mechanism.</p>
<p>4.1 Notes, be more precise than "similarly". Define formal equivalent. Non-editorial enhancement: allow underscores in the string.</p>
<p>4.2 There must be a more elegant way of saying "(8-wise) (ASCII) binary digits ([01])". Allow underscores.</p>
<p>4.2 "a xs:base64Binary with no embedded data" - use the term "zero-length".</p>
<p>4.3 similarly. Allow underscores.</p>
<p>Function properties: I think all these functions are pure functions so it's a waste of space to say this explicitly for each function.</p>
<p>4.4, 4.5 Use <code>xs:unsignedByte</code> to represent octets now that we have implicit downcasting. (Changes error code [[bin:octet-out-of-range]to XPTY0004).</p>
<p>5.6 "blank octets"?</p>
<p>7.1.2 "or assumed to be represented"</p>
<p>7.1.3 "Care should be taken" - what does this mean?</p>
<p>"Positive and negative infinities are supported" - who or what is doing the supporting?</p>
<p>Use underscore rather than space as separators between digits.</p>
<p>'quiet' NaN - avoid apologetic quotes.</p>
<p>7.4 - I find the note regarding signed/unsigned integers very confusing.</p>
<p>8.1: "bitwise or" - avoid apologetic quotes. For these three functions we should say what they do rather than assuming the reader will guess from the names. bin:shift could do with more precision. Perhaps the functions could be explained more formally by a mapping from a binary value to a sequence of booleans, then for example bin:and becomes something like for-each-pair(op:from-bits($a), op:from-bits($b), op('and') ) =&gt; op:to-bits().</p>
<p>8.5: avoid the notation <code>|$by|</code> for absolute value. Not all of us remember our schooldays. (And when I was at school, <code>by</code> meant <code>b × y</code>, and $ meant dollars.)</p>
</div></details></div>
<div class="toot" id="closed-1749"><h2>Issue #1749 closed<span class="toot-id"> #closed-1749</span></h2><div class="pubdate">31 Jan at 12:56:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1749">https://github.com/qt4cg/qtspecs/pull/1749</a></div><p>Don't set the function finder position to 'fixed' on small devices</p></div>
<div class="toot" id="created-1749"><h2>Pull request #1749 created<span class="toot-id"> #created-1749</span></h2><div class="pubdate">31 Jan at 12:56:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1749">https://github.com/qt4cg/qtspecs/pull/1749</a></div><details><summary>Don't set the function finder position to 'fixed' on small devices</summary><div class="markup"><p>This is also related to 1747. It "fixes" the problem that @ChristianGruen reported where the function finder obscured content on mobile (narrow) devices. I've changed things so that it isn't at a fixed location on narrow devices. It still appears above the ToC, but it scrolls as normal.</p>
</div></details></div>
<div class="toot" id="closed-1748"><h2>Issue #1748 closed<span class="toot-id"> #closed-1748</span></h2><div class="pubdate">31 Jan at 09:41:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1748">https://github.com/qt4cg/qtspecs/pull/1748</a></div><p>Fix 'window.onload' bug in ToC JS</p></div>
<div class="toot" id="created-1748"><h2>Pull request #1748 created<span class="toot-id"> #created-1748</span></h2><div class="pubdate">31 Jan at 09:40:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1748">https://github.com/qt4cg/qtspecs/pull/1748</a></div><details><summary>Fix 'window.onload' bug in ToC JS</summary><div class="markup"><p>This fixes 1747 so I'm going to push it immediately.</p>
<p>I'm leaving the bug open because I'll also look at @ChristianGruen 's report that it is problematic on mobile.</p>
</div></details></div>
<div class="toot" id="created-1747"><h2>Issue #1747 created<span class="toot-id"> #created-1747</span></h2><div class="pubdate">31 Jan at 07:16:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1747">https://github.com/qt4cg/qtspecs/issues/1747</a></div><details><summary>Function finder is broken</summary><div class="markup"><p>The function finder in F&amp;O (and elsewhere) is broken. I believe that it uses the ToC to find the link target and now that the ToC structure has changed, it's failing.</p>
</div></details></div>
<div class="toot" id="closed-1745"><h2>Issue #1745 closed<span class="toot-id"> #closed-1745</span></h2><div class="pubdate">30 Jan at 15:50:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1745">https://github.com/qt4cg/qtspecs/pull/1745</a></div><p>Implement expanding/collapsing ToC</p></div>
<div class="toot" id="created-1746"><h2>Pull request #1746 created<span class="toot-id"> #created-1746</span></h2><div class="pubdate">30 Jan at 15:49:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1746">https://github.com/qt4cg/qtspecs/pull/1746</a></div><details><summary>Replace processing model diagrams</summary><div class="markup"><p>Fix #1733</p>
</div></details></div>
<div class="toot" id="created-1745"><h2>Pull request #1745 created<span class="toot-id"> #created-1745</span></h2><div class="pubdate">30 Jan at 13:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1745">https://github.com/qt4cg/qtspecs/pull/1745</a></div><details><summary>Implement expanding/collapsing ToC</summary><div class="markup"><p>I'm just going to merge this one because</p>
<ol>
<li>The CG agreed they wanted this</li>
<li>All of the changes are presentational, there are no technical changes</li>
<li>The PR build won't work anyway</li>
</ol>
<p>I did make a couple of executive decisions.</p>
<p>The use of "..." as the target to click on didn't seem like a practical affordance. It's not a common use of ellipsis and it looked too much like it simply meant that part of the title was elided. I went with right and down triangles instead. And I added the few lines of JS required to make them "turn".</p>
<p>I added a top-level expand/collapse that does all of the sections. I wasn't happy that with the new UI, there was no way to get an overview of the document by seeing all of the section titles.</p>
<p>I tinkered with the CSS. I'm not uniformly happy with it, especially with the treatment of long titles, but I think the aesthetic failings are infrequent.</p>
<p>We need to review accessibility before we try to publish as a CG Report.</p>
</div></details></div>
<div class="toot" id="created-1744"><h2>Pull request #1744 created<span class="toot-id"> #created-1744</span></h2><div class="pubdate">30 Jan at 10:47:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1744">https://github.com/qt4cg/qtspecs/pull/1744</a></div><details><summary>Remove dead wood re: SVG diagrams from the XSLT build</summary><div class="markup"><p>Completes action QT4CG-106-01</p>
</div></details></div>
<div class="toot" id="created-1743"><h2>Pull request #1743 created<span class="toot-id"> #created-1743</span></h2><div class="pubdate">30 Jan at 10:11:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1743">https://github.com/qt4cg/qtspecs/pull/1743</a></div><details><summary>1738 Formatting of Notes in F&amp;O</summary><div class="markup"><ol>
<li>Improves the stylesheets and CSS so that Notes sections in the F&amp;O spec are rendered with a single continuous green stripe, rather than a separate (and sometimes indented) stripe per paragraph or list item.</li>
<li>Makes some other markup changes identified in passing, especially using <code>&lt;char&gt;</code> to mark up individual characters.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1742"><h2>Issue #1742 created<span class="toot-id"> #created-1742</span></h2><div class="pubdate">29 Jan at 20:20:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1742">https://github.com/qt4cg/qtspecs/issues/1742</a></div><details><summary>Maps constructed using streamed xsl:fork instruction should not be ordered</summary><div class="markup"><p>One of the techniques used in XSLT streaming is to build multiple outputs during a single streamed pass of the input, and the multiple outputs can be captured in different entries in a map (in different prongs of an <code>xsl:fork</code> instruction). The ordering of such a map should be implementation-dependent, in order to allow construction in parallel threads.</p>
<p>Furthermore, I think that an xsl:map instruction used in this way should probably not allow duplicate keys. In principle we could collect key/value pairs during the streamed processing and then resolve duplicates at the end, but it's extra complexity.</p>
</div></details></div>
<div class="toot" id="created-1741"><h2>Pull request #1741 created<span class="toot-id"> #created-1741</span></h2><div class="pubdate">29 Jan at 11:08:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1741">https://github.com/qt4cg/qtspecs/pull/1741</a></div><details><summary>1739 drop references to ordering mode in the static context</summary><div class="markup"><p>Fix #1739</p>
</div></details></div>
<div class="toot" id="created-1740"><h2>Pull request #1740 created<span class="toot-id"> #created-1740</span></h2><div class="pubdate">29 Jan at 10:22:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1740">https://github.com/qt4cg/qtspecs/pull/1740</a></div><details><summary>1725b Further elaboration of duplicates handling in maps</summary><div class="markup"><p>Actions QT4CG-107-02 and QT4CG-107-03.</p>
<p>The three functions map:build, map:of-pairs, and map:merge now all have the same options parameters, and avoid duplication in the specification. The xsl:map instruction is defined by reference to map:merge.</p>
<p>Although the action suggested specifying these functions to use the first key from a set of duplicates, I found this was not possible because of the way map:put is defined. They therefore use the last key from the set of duplicates.</p>
<p>Fix #1725</p>
</div></details></div>
<div class="toot" id="created-1739"><h2>Issue #1739 created<span class="toot-id"> #created-1739</span></h2><div class="pubdate">29 Jan at 09:45:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1739">https://github.com/qt4cg/qtspecs/issues/1739</a></div><details><summary>Obsolete references to ordering mode</summary><div class="markup"><p>The functions <code>fn:distinct-values</code> and <code>fn:duplicate-values</code> refer to the ordering mode in the static context, a concept that we have abolished.</p>
</div></details></div>
<div class="toot" id="created-1738"><h2>Issue #1738 created<span class="toot-id"> #created-1738</span></h2><div class="pubdate">29 Jan at 00:20:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1738">https://github.com/qt4cg/qtspecs/issues/1738</a></div><details><summary>Formatting of lists within notes</summary><div class="markup"><p>The formatting of lists within notes in F&amp;O is weird: see for example the math:atan2 function.</p>
</div></details></div>
<div class="toot" id="created-1737"><h2>Issue #1737 created<span class="toot-id"> #created-1737</span></h2><div class="pubdate">28 Jan at 21:25:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1737">https://github.com/qt4cg/qtspecs/issues/1737</a></div><details><summary>Grammar problems introduced by #1732</summary><div class="markup"><p>Today's merge of #1732 has introduced two problems to the grammar as now shown in the spec:</p>
<ul>
<li>
<p><code>ValueExpr</code> has changed from</p>
<pre><code>ValueExpr ::= ValidateExpr | ExtensionExpr | SimpleMapExpr
</code></pre>
<p>to</p>
<pre><code>ValueExpr ::= SimpleMapExpr
</code></pre>
<p>This disconnects <code>ValidateExpr</code> and <code>ExtensionExpr</code> from the rest of the grammar.</p>
</li>
<li>
<p><code>AnnotatedDecl</code> has been added without being referenced. Also it describes something that would look like</p>
<pre><code class="language-xquery">declare declare variable $x external
</code></pre>
</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1722"><h2>Issue #1722 closed<span class="toot-id"> #closed-1722</span></h2><div class="pubdate">28 Jan at 19:40:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1722">https://github.com/qt4cg/qtspecs/pull/1722</a></div><p>1717 define focus functions using pipeline operator</p></div>
<div class="toot" id="closed-1717"><h2>Issue #1717 closed<span class="toot-id"> #closed-1717</span></h2><div class="pubdate">28 Jan at 19:40:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1717">https://github.com/qt4cg/qtspecs/issues/1717</a></div><p>Define focus functions in terms of the pipeline operator</p></div>
<div class="toot" id="created-1736"><h2>Issue #1736 created<span class="toot-id"> #created-1736</span></h2><div class="pubdate">28 Jan at 18:14:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1736">https://github.com/qt4cg/qtspecs/issues/1736</a></div><details><summary>Add option retain-order=false when constructing maps</summary><div class="markup"><p>I would like to provide an option on functions that potentially create large maps, including</p>
<pre><code>xsl:map
map:build
map:merge
map:of-pairs
parse-json
json-doc
</code></pre>
<p>If retain-option=false is specified, the user declares to the processor that they don't require the resulting map to be in any particular order. An implementation is of course free to ignore this and deliver an ordered map anyway, but if the implementation can save time or space by not retaining order then it is free to do so.</p>
<p>I propose to provide some data quantifying the potential benefits of this option. I realise that some optimisation hints provided in the past, for example the <code>unordered{}</code> expression, have been ineffective, but I think there is a difference here because changing maps to be ordered may result in a performance regression for people moving from 3.1 to 4.0.</p>
</div></details></div>
<div class="toot" id="minutes—01-28"><h2>QT4 CG meeting 107 draft minutes<span class="toot-id"> #minutes—01-28</span></h2><div class="pubdate">28 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-28">https://qt4cg.org/meeting/minutes/2025/01-28</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1719"><h2>Issue #1719 closed<span class="toot-id"> #closed-1719</span></h2><div class="pubdate">28 Jan at 17:13:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1719">https://github.com/qt4cg/qtspecs/issues/1719</a></div><p>Purging dead build code</p></div>
<div class="toot" id="closed-1731"><h2>Issue #1731 closed<span class="toot-id"> #closed-1731</span></h2><div class="pubdate">28 Jan at 17:13:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1731">https://github.com/qt4cg/qtspecs/pull/1731</a></div><p>1719 drop shared spec from build</p></div>
<div class="toot" id="closed-1725"><h2>Issue #1725 closed<span class="toot-id"> #closed-1725</span></h2><div class="pubdate">28 Jan at 17:10:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><p>Position of duplicates in ordered maps</p></div>
<div class="toot" id="closed-1727"><h2>Issue #1727 closed<span class="toot-id"> #closed-1727</span></h2><div class="pubdate">28 Jan at 17:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><p>1725 Define more detailed rules for duplicates in maps</p></div>
<div class="toot" id="closed-1485"><h2>Issue #1485 closed<span class="toot-id"> #closed-1485</span></h2><div class="pubdate">28 Jan at 17:07:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1485">https://github.com/qt4cg/qtspecs/issues/1485</a></div><p>Record declarations in XSLT</p></div>
<div class="toot" id="closed-1708"><h2>Issue #1708 closed<span class="toot-id"> #closed-1708</span></h2><div class="pubdate">28 Jan at 17:07:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><p>1485 Add xsl:record-type declaration</p></div>
<div class="toot" id="closed-76"><h2>Issue #76 closed<span class="toot-id"> #closed-76</span></h2><div class="pubdate">28 Jan at 17:06:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/76">https://github.com/qt4cg/qtspecs/issues/76</a></div><p>non-deterministic time</p></div>
<div class="toot" id="closed-747"><h2>Issue #747 closed<span class="toot-id"> #closed-747</span></h2><div class="pubdate">28 Jan at 17:06:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/747">https://github.com/qt4cg/qtspecs/issues/747</a></div><p>QName literals</p></div>
<div class="toot" id="closed-885"><h2>Issue #885 closed<span class="toot-id"> #closed-885</span></h2><div class="pubdate">28 Jan at 17:06:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/885">https://github.com/qt4cg/qtspecs/issues/885</a></div><p>fn:uuid</p></div>
<div class="toot" id="closed-981"><h2>Issue #981 closed<span class="toot-id"> #closed-981</span></h2><div class="pubdate">28 Jan at 17:05:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/981">https://github.com/qt4cg/qtspecs/issues/981</a></div><p>Identify optional arguments in callback functions</p></div>
<div class="toot" id="closed-1720"><h2>Issue #1720 closed<span class="toot-id"> #closed-1720</span></h2><div class="pubdate">28 Jan at 17:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><p>Grammar overhaul</p></div>
<div class="toot" id="closed-1732"><h2>Issue #1732 closed<span class="toot-id"> #closed-1732</span></h2><div class="pubdate">28 Jan at 17:04:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><p>1720 grammar simplification</p></div>
<div class="toot" id="closed-1069"><h2>Issue #1069 closed<span class="toot-id"> #closed-1069</span></h2><div class="pubdate">28 Jan at 17:03:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1069">https://github.com/qt4cg/qtspecs/issues/1069</a></div><p>fn:ucd</p></div>
<div class="toot" id="closed-1124"><h2>Issue #1124 closed<span class="toot-id"> #closed-1124</span></h2><div class="pubdate">28 Jan at 17:03:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1124">https://github.com/qt4cg/qtspecs/issues/1124</a></div><p>Formatting XPath/XQuery: Preferences, Conventions</p></div>
<div class="toot" id="closed-1252"><h2>Issue #1252 closed<span class="toot-id"> #closed-1252</span></h2><div class="pubdate">28 Jan at 17:03:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1252">https://github.com/qt4cg/qtspecs/issues/1252</a></div><p>Add a new function `fn:html-doc`</p></div>
<div class="toot" id="closed-1728"><h2>Issue #1728 closed<span class="toot-id"> #closed-1728</span></h2><div class="pubdate">28 Jan at 17:01:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><p>Fix CSS for production tables</p></div>
<div class="toot" id="created-1735"><h2>Pull request #1735 created<span class="toot-id"> #created-1735</span></h2><div class="pubdate">27 Jan at 17:09:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><details><summary>1341 Drop $position callback from many functions</summary><div class="markup"><p>Responding to the discussion in #1341, this (somewhat experimental) PR explores the possibility of dropping the optional
$position argument to the callback of many higher-order functions such as some(), every(), filter(), for-each(), fold-left(), fold-right(). Instead, it provides the option to wrap the input sequence in a call of numbered-items() which replaces each item in the input with an (item, position) pair.</p>
<p>I've done this only (so far) for higher-order sequence functions, but the intent is that the same could be done for arrays and (potentially) maps.</p>
<p>I left the position argument in place for a few functions where losing it seemed to cause genuine inconvenience:</p>
<ul>
<li>partition(), where the function wraps the supplied items into arrays, and you don't want to have to remove the positions afterwards</li>
<li>subsequence-where(), where many use cases are likely to use positional information</li>
<li>for-each-pair(), where there are two input sequences and it seems clumsy to associate position information with one or the other</li>
</ul>
<p>The main benefit is that we provide one basic mechanism which is automatically available everywhere, which means we don't have to have debates about whether or not there is a use case for adding position information to (say) fold-left or scan-right.</p>
<p>A further benefit is that the functions defined for sequences automatically become available for arrays and maps. I haven't yet explored the impact on maps and arrays; I will wait first to see what the reaction is to this proposal.</p>
</div></details></div>
<div class="toot" id="closed-1730"><h2>Issue #1730 closed<span class="toot-id"> #closed-1730</span></h2><div class="pubdate">27 Jan at 15:12:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><p>Consistency in default handling of map duplicates</p></div>
<div class="toot" id="created-1734"><h2>Pull request #1734 created<span class="toot-id"> #created-1734</span></h2><div class="pubdate">27 Jan at 13:05:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1734">https://github.com/qt4cg/qtspecs/pull/1734</a></div><details><summary>1682 Type promotion and operator mapping</summary><div class="markup"><p>Fix #1682</p>
<p>Moves the relevant parts of the operator mapping table into the sections for Arithmetic Expressions and Value Comparisons. Adds links to the op: functions in F&amp;O.</p>
<p>Drops the Type Promotion appendix, moving the rules inline; and drops the term "type promotion"</p>
<p>Adjusts the specs for sum() and avg() so they are now defined directly in terms of pairwise addition of values.</p>
</div></details></div>
<div class="toot" id="created-1733"><h2>Issue #1733 created<span class="toot-id"> #created-1733</span></h2><div class="pubdate">27 Jan at 10:17:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1733">https://github.com/qt4cg/qtspecs/issues/1733</a></div><details><summary>ACTION QT4CG-088-04, reworking the processing model diagram</summary><div class="markup"><p>I have no idea what tool was used to create the current <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-processing-model">processing model diagram</a>. We know it needs to be updated, but I've no particular skill with drawing programs, so I spent half an hour constructing a Graphviz diagram:</p>
<pre><code>digraph Processing_Model {
    subgraph clusterQT4 {
        Exec [label="Execution\nEngine" ];
        XDM [label="XPath Data\nModel"; shape="note" ];
        AST [label="Abstract\nSyntax Tree" ];
        Static [label="Static\nContext"; shape="box3d" ];
        Dynamic [label="Dynamic\nContext"; shape="box3d" ];
        Schema [label="Schema\nDefinitions"; shape="note" ];

        XPath -&gt; AST [label="&nbsp;SQ1" ];
        AST -&gt; AST [label="&nbsp;SQ5" ];
        AST -&gt; Exec [label="&nbsp;DQ1" ];
        Schema -&gt; Static;
        Static -&gt; AST [label="&nbsp;SQ4" ];
        Static -&gt; Dynamic [label="&nbsp;DQ2" ];
        Dynamic -&gt; Exec [ dir="both"; label="&nbsp;DQ5" ];
        Exec -&gt; XDM [ dir="both"; label="&nbsp;DQ4" ];
    }
    XML [ shape="note" ];
    PSVI [ shape="note" ];
    XML -&gt; PSVI [ label="&nbsp;DM1" ];
    PSVI -&gt; XDM  [ label="&nbsp;DM2" ];
    XML -&gt; XDM [ label="&nbsp;DM1" ];

    Direct [ label="&nbsp;Direct\nGeneration" ];
    Direct -&gt; XDM [ label="&nbsp;DM3" ];

    Host [label="Host\nEnvironment" ];
    Host -&gt; Schema [label="&nbsp;SI1" ];
    Host -&gt; Static [label="&nbsp;SQ2" ];
    Host -&gt; Dynamic [label="&nbsp;DQ3" ];

    Serialize [ shape="note" ];
    XDM -&gt; Serialize [ label="&nbsp;DM4" ];
}
</code></pre>
<p>It looks something like this:</p>
<p><img src="https://github.com/user-attachments/assets/7ae82045-2e28-4db2-afdc-b69cb0f72bdb" alt="Image"></p>
<p>Is this worth pursuing, or is that just half an hour of my life I'll never get back?</p>
</div></details></div>
<div class="toot" id="agenda-01-28"><h2>QT4 CG meeting 107 draft agenda<span class="toot-id"> #agenda-01-28</span></h2><div class="pubdate">27 Jan at 09:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-28">https://qt4cg.org/meeting/agenda/2025/01-28</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1732"><h2>Pull request #1732 created<span class="toot-id"> #created-1732</span></h2><div class="pubdate">26 Jan at 22:12:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><details><summary>1720 grammar simplification</summary><div class="markup"><p>This PR primarily affects the grammar file, simplifying it to remove most of the material that is only there to support the generation of a JavaCC parser (which has probably not been achievable since XPath/XQuery 2.0).</p>
<p>The section of the grammar that defines the binary operators starting with <code>OrExpr</code> is now expressed using conventional production rules, rather than the precedence-based grammar previously used. This allows deletion of some convoluted code in grammar2spec.xsl.</p>
<p>The DTD for the grammar file is revised to exclude many constructs that are no longer used.</p>
<p>Many simple token definitions (especially those that consist of a simple constant string) have been inlined.</p>
<p>Fix #1720</p>
</div></details></div>
<div class="toot" id="created-1731"><h2>Pull request #1731 created<span class="toot-id"> #created-1731</span></h2><div class="pubdate">25 Jan at 23:20:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1731">https://github.com/qt4cg/qtspecs/pull/1731</a></div><details><summary>1719 drop shared spec from build</summary><div class="markup"><p>Removes tasks from the gradle build, and associated stylesheets, that are there only to construct the "shared XPath/XQuery specification" which is no longer used by the editors or made visible to readers.</p>
<p>Also fixes a couple of link errors/warnings in the build.</p>
<p>Fix #1719</p>
</div></details></div>
<div class="toot" id="created-1730"><h2>Issue #1730 created<span class="toot-id"> #created-1730</span></h2><div class="pubdate">25 Jan at 18:03:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><details><summary>Consistency in default handling of map duplicates</summary><div class="markup"><p>In 3.1:</p>
<ul>
<li><code>map:merge()</code> defaults to duplicates = use-first</li>
<li><code>xsl:map</code> defaults to duplicates = reject</li>
</ul>
<p>In 4.0</p>
<ul>
<li><code>map:build</code> defaults to duplicates = combine</li>
<li><code>map:of-pairs</code> defaults to duplicates = combine</li>
</ul>
<p>Should we try to align the defaults?</p>
</div></details></div>
<div class="toot" id="created-1729"><h2>Issue #1729 created<span class="toot-id"> #created-1729</span></h2><div class="pubdate">24 Jan at 22:04:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1729">https://github.com/qt4cg/qtspecs/issues/1729</a></div><details><summary>Grammar problems introduced by #1721</summary><div class="markup"><p>Some productions of the XQuery 4.0 grammar were made obsolete by recent changes, but still occur in the document:</p>
<ul>
<li><code>StringConstructorStart</code></li>
<li><code>StringInterpolationStart</code></li>
<li><code>StringInterpolationEnd</code></li>
<li><code>StringConstructorEnd</code></li>
<li><code>TagQName</code></li>
<li><code>EndTagQName</code></li>
<li><code>ProcessingInstructionStart</code></li>
<li><code>ProcessingInstructionEnd</code></li>
<li><code>DirCommentContentChar</code></li>
<li><code>DirCommentContentDashChar</code></li>
</ul>
<p>Also, the replacement of <code>declare record</code> by <code>declare type record</code> has intoduced a new ambiguity. For example, with the input</p>
<pre><code class="language-xquery">declare type A as xs:integer;
declare type record as (A);
</code></pre>
<p>it remains unclear whether the second line declares a  type named "record", in which case</p>
<pre><code class="language-xquery">42 instance of record
</code></pre>
<p>or a type named "as", where</p>
<pre><code class="language-xquery">{'A': 42} instance of as
</code></pre>
<p>My proposal would be return to <code>declare record</code>. There are also 13 examples in the document using <code>declare record</code>.</p>
</div></details></div>
<div class="toot" id="closed-1723"><h2>Issue #1723 closed<span class="toot-id"> #closed-1723</span></h2><div class="pubdate">24 Jan at 21:00:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><p>`ThenAction` left over after removal of `BracedActions`</p></div>
<div class="toot" id="created-1728"><h2>Pull request #1728 created<span class="toot-id"> #created-1728</span></h2><div class="pubdate">24 Jan at 13:15:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><details><summary>Fix CSS for production tables</summary><div class="markup"><p>This PR removes some extraneous space between the rows and columns in the production tables (cellspacing) and turns off the odd grey background on comments. (I don't think the grey backbround was helping any, but if you disagree...)</p>
</div></details></div>
<div class="toot" id="closed-1721"><h2>Issue #1721 closed<span class="toot-id"> #closed-1721</span></h2><div class="pubdate">24 Jan at 13:01:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><p>1713 Revise code for generating production rules</p></div>
<div class="toot" id="created-1727"><h2>Pull request #1727 created<span class="toot-id"> #created-1727</span></h2><div class="pubdate">23 Jan at 17:58:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><details><summary>1725 Define more detailed rules for duplicates in maps</summary><div class="markup"><p>Clarifies the rules for how duplicates are handled by map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>Introduces a callback option for map:merge that is compatible with map:build and map:of-pairs, to increase commonality between all four functions/instructions.</p>
<p>Fix #1725</p>
</div></details></div>
<div class="toot" id="closed-1726"><h2>Issue #1726 closed<span class="toot-id"> #closed-1726</span></h2><div class="pubdate">23 Jan at 16:50:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1726"><h2>Pull request #1726 created<span class="toot-id"> #created-1726</span></h2><div class="pubdate">23 Jan at 12:54:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1725"><h2>Issue #1725 created<span class="toot-id"> #created-1725</span></h2><div class="pubdate">23 Jan at 11:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><details><summary>Position of duplicates in ordered maps</summary><div class="markup"><p>It became clear to me when writing test cases that the specs aren't entirely clear about what happens when building a map from an input sequence that contains duplicate keys. It says clearly what entry should be created for the duplicated key, but it doesn't say clearly where this entry should appear in the result.</p>
<p>There are four functions/instructions that this applies to: map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>I propose that in each case, the position of the entry for the duplicated key in the resulting map should correspond to the position of the first occurrence of that key in the input sequence. That is, "order of first appearance": the effect should be the same as if new entries are always created using a map:put() operation.</p>
<p>This might be slightly unexpected in the case of <code>map:merge()</code> with the option <code>duplicates=use-last</code>. It means the value will be that of the last duplicate, but its position will be that of the first duplicate. However, the other three functions/instructions achieve the effect of use-last with the callback <code>on-duplicates=fn{$a, $b){$a}</code> which only controls the value of the entry, and cannot be used to control its position, and I think it makes sense for <code>map:merge</code> with <code>duplicates=use-last</code> to behave in the same way.</p>
<p>Of course we could introduce a separate option to control the position of the combined entry, but I think that would be overkill. <code>xsl:for-each-group</code> and <code>distinct-values</code> both use the "order of first appearance" rule and this has never caused any problems. (<code>group-by</code> in XQuery delivers groups in implementation-dependent order, however).</p>
</div></details></div>
<div class="toot" id="created-1724"><h2>Issue #1724 created<span class="toot-id"> #created-1724</span></h2><div class="pubdate">22 Jan at 23:54:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1724">https://github.com/qt4cg/qtspecs/issues/1724</a></div><details><summary>Allow @copy-namespaces on &lt;xsl:mode&gt;?</summary><div class="markup"><p>As part of an XSLT transformation I need to remove an unused (anywhere) namespace declaration and <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> doesn’t appear to accept a <code>@copy-namespaces</code> attribute where I can tell it not to copy unused namespaces. The unused namespace was used on a single attribute on the input document, but I’m removing the attribute entirely as part of the transformation, so nothing will remain in the output document that uses the namespace in question. With <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> the namespace declaration is copied into the result, even though it is not used. If I use the old identity template and set the value of <code>@copy-namespaces</code> on it to something falsy, I get the result I want, that is, no unneeded namespace declaration.</p>
<p>Insofar as <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> has come to fill the role formerly occupied by the identity template, would it be reasonable to allow it also to declare that unused namespaces should not be copied? If that request is reasonable, is it reasonable to think of it as a bug fix, rather than a new-feature request?</p>
</div></details></div>
<div class="toot" id="created-1723"><h2>Issue #1723 created<span class="toot-id"> #created-1723</span></h2><div class="pubdate">22 Jan at 22:07:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><details><summary>`ThenAction` left over after removal of `BracedActions`</summary><div class="markup"><p>Thanks for fixing the <code>IfExpr</code> ambiguity.</p>
<p>In #1712, <code>BracedAction</code> was introduced to replace the previous rules for braced actions. Of these, <code>ThenAction</code> still appears in the EBNF summary, but it is no longer referenced.</p>
</div></details></div>
<div class="toot" id="closed-1651"><h2>Issue #1651 closed<span class="toot-id"> #closed-1651</span></h2><div class="pubdate">22 Jan at 17:27:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1651">https://github.com/qt4cg/qtspecs/issues/1651</a></div><p>Ordered Maps: maps that retain insertion order</p></div>
<div class="toot" id="closed-1703"><h2>Issue #1703 closed<span class="toot-id"> #closed-1703</span></h2><div class="pubdate">22 Jan at 17:27:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><p>1651 ordered maps</p></div>
<div class="toot" id="closed-1709"><h2>Issue #1709 closed<span class="toot-id"> #closed-1709</span></h2><div class="pubdate">22 Jan at 11:55:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><p>Extend diagram of item types to include record types etc</p></div>
<div class="toot" id="created-1722"><h2>Pull request #1722 created<span class="toot-id"> #created-1722</span></h2><div class="pubdate">22 Jan at 11:46:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1722">https://github.com/qt4cg/qtspecs/pull/1722</a></div><details><summary>1717 define focus functions using pipeline operator</summary><div class="markup"><p>Fix #1717</p>
<p>Provides a formal definition of focus functions making use of the new pipeline operator.</p>
</div></details></div>
<div class="toot" id="created-1721"><h2>Pull request #1721 created<span class="toot-id"> #created-1721</span></h2><div class="pubdate">22 Jan at 11:27:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><details><summary>1713 Revise code for generating production rules</summary><div class="markup"><p>The main change here is to change the way "scraps" are expanded: these are the local collections of production rules that appear inline within the spec. These are now driven by a single <code>prodrecap</code> element naming the rule to be expanded, and the logic is now automated for deciding (a) which subsidiary production rules to include in the scrap, and (b) which occurrence of a production rule to use as the target for a hyperlinked reference to that rule, depending on where the reference appears.</p>
<p>Along with this there has been a fair bit of deletion of legacy code and general modernisation (e.g using XSLT 2.0 and 3.0 constructs where appropriate).</p>
</div></details></div>
<div class="toot" id="created-1720"><h2>Issue #1720 created<span class="toot-id"> #created-1720</span></h2><div class="pubdate">22 Jan at 10:50:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><details><summary>Grammar overhaul</summary><div class="markup"><p>There is a lot of dead wood in the xpath-grammar.xml file. This issue is raised to capture some observations and suggestions about how it can be simplified.</p>
<ul>
<li>The DTD lists 19 attributes that can appear on g:token, and documents the meaning of 5 of them (very briefly). I suspect that many of the attributes are never used. Many of them were probably intended primarily for use by the JavaCC parser generator.</li>
<li>As if that weren't enough, the grammar2spec stylesheet has logic that looks for additional attributes (an example is <code>@alias-for</code>) which are not even allowed by the DTD let alone being in active use.</li>
<li>The "if" logic to assign productions to different languages (xpath, xquery, XSLT patterns) is hard to maintain and could be automated: just search for productions that are reachable from the top-level production for each language. This could be done by a preprocessing stylesheet that generates a grammar file for each language.</li>
<li>The switch into a precedence-based grammar for binary operators (g:exprProduction name="OperatorExpr") doesn't really help anyone. For generating production rules in the spec, it just complicates the generation logic. The same is true for anyone else writing applications that use the grammar as input. It doesn't really make life easier for maintainers of the grammar, because it means there is more to learn.</li>
</ul>
<p>All the JavaCC machinery is still in the repo and I think it could probably go. Leaving stuff like that lying around makes things more difficult when you need to search filestore for references to things.</p>
</div></details></div>
<div class="toot" id="created-1719"><h2>Issue #1719 created<span class="toot-id"> #created-1719</span></h2><div class="pubdate">21 Jan at 22:57:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1719">https://github.com/qt4cg/qtspecs/issues/1719</a></div><details><summary>Purging dead build code</summary><div class="markup"><p>In the course of working on #1713 I've been exploring some dark corners of the build system. There's a lot of dead code. Some of it might come in useful in the future (e.g. code supporting XQuery Update) but most will be very hard to revive. For example there's a lot of grammar machinery which is there only to allow generation of a JavaCC parser.</p>
<p>The main purpose of this issue is to capture notes that might lead to some reduction of technical debt.</p>
<p>The gradle build is currently giving me</p>
<blockquote>
<p>Warning: link-text-with-check was unable to make a link for $ref-id="doc-shared40-Prolog"</p>
</blockquote>
<p>That message comes from <code>xmlspec-override.xsl</code>. This stylesheet looks like dead code because it has lots of references to XPath30 and XQuery30. But it can't be completely dead if we're getting errors from it. It's imported from two places: xpath-functions-30.xsl in the F&amp;O tree and shared.xsl in the xquery40 tree. The message comes from gradle task <code>xquery_shared_html</code>. As far as I can see the build system is constructing an XPath specification, an XQuery specification, and a "shared" specification which is a union of the two. (It starts off "XQuery 4.0 and XPath 4.0 is an expression language that allows..."). Presumably this was intended to allow editors and WG members to review a single document rather than reviewing XPath and XQuery separately. But I don't think it's used today, I think we could kill it off.</p>
<p>shared.xsl is referenced only from build.gradle when building the shared specification.</p>
<p>xpath-functions-30.xsl doesn't appear to be referenced from anywhere, and it carries a comment saying</p>
<pre><code> Created 17 Dec 2008 by MHK.
 No longer used 16 Feb 2009?
</code></pre>
<p>In the short term I've deleted the code in xmlspec-override.xsl starting with the comment "Our inability to create a link for $ref-id may be a sign of something wrong, so...". This gets rid of the warning messages. In the longer term, subject to confirmation, I think we can delete the build targets associated with the "shared" language spec, and delete the stylesheets xmlspec-override.xsl, xpath-functions-30.xsl, and shared.xsl.</p>
</div></details></div>
<div class="toot" id="created-1718"><h2>Issue #1718 created<span class="toot-id"> #created-1718</span></h2><div class="pubdate">21 Jan at 17:45:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1718">https://github.com/qt4cg/qtspecs/issues/1718</a></div><details><summary>Ordered Maps: positions in callback functions</summary><div class="markup"><p>Now that maps have a defined order, we should add the position to HOF parameters in map functions (in alignment with sequence and array functions). Examples:</p>
<pre><code class="language-xquery">map:for-each(
  $map     as map(*),	
  $action  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as item()*	
) as item()*

map:filter(
  $map        as map(*),	
  $predicate  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as xs:boolean?	
) as map(*)
</code></pre>
</div></details></div>
<div class="toot" id="minutes—01-21"><h2>QT4 CG meeting 106 draft minutes<span class="toot-id"> #minutes—01-21</span></h2><div class="pubdate">21 Jan at 17:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-21">https://qt4cg.org/meeting/minutes/2025/01-21</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1706"><h2>Issue #1706 closed<span class="toot-id"> #closed-1706</span></h2><div class="pubdate">21 Jan at 17:22:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><p>Ambiguous `if` syntax</p></div>
<div class="toot" id="closed-1712"><h2>Issue #1712 closed<span class="toot-id"> #closed-1712</span></h2><div class="pubdate">21 Jan at 17:22:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><p>1706 Drop "else if" and "else" clauses from braced conditionals</p></div>
<div class="toot" id="closed-1685"><h2>Issue #1685 closed<span class="toot-id"> #closed-1685</span></h2><div class="pubdate">21 Jan at 17:20:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><p>Pipeline Operator</p></div>
<div class="toot" id="closed-1686"><h2>Issue #1686 closed<span class="toot-id"> #closed-1686</span></h2><div class="pubdate">21 Jan at 17:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><p>1685 Pipeline Operator</p></div>
<div class="toot" id="closed-1701"><h2>Issue #1701 closed<span class="toot-id"> #closed-1701</span></h2><div class="pubdate">21 Jan at 17:18:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><p>Add dedication to MSM (action QT4CG-088-01)</p></div>
<div class="toot" id="closed-1705"><h2>Issue #1705 closed<span class="toot-id"> #closed-1705</span></h2><div class="pubdate">21 Jan at 17:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><p>fn:divide-decimals, fn:round: large precision values</p></div>
<div class="toot" id="closed-1711"><h2>Issue #1711 closed<span class="toot-id"> #closed-1711</span></h2><div class="pubdate">21 Jan at 17:16:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><p>1705 Say that max precision is implementation-defined</p></div>
<div class="toot" id="closed-1710"><h2>Issue #1710 closed<span class="toot-id"> #closed-1710</span></h2><div class="pubdate">21 Jan at 17:14:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><p>1709 Updated type diagrams</p></div>
<div class="toot" id="closed-1606"><h2>Issue #1606 closed<span class="toot-id"> #closed-1606</span></h2><div class="pubdate">21 Jan at 17:13:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1606">https://github.com/qt4cg/qtspecs/issues/1606</a></div><p>Drop named item types other than named record types</p></div>
<div class="toot" id="closed-1494"><h2>Issue #1494 closed<span class="toot-id"> #closed-1494</span></h2><div class="pubdate">21 Jan at 17:13:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1494">https://github.com/qt4cg/qtspecs/issues/1494</a></div><p>Records: Introduction?</p></div>
<div class="toot" id="closed-1176"><h2>Issue #1176 closed<span class="toot-id"> #closed-1176</span></h2><div class="pubdate">21 Jan at 17:13:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1176">https://github.com/qt4cg/qtspecs/issues/1176</a></div><p>Use fn:parse-uri to check whether a filepath is relative or absolute</p></div>
<div class="toot" id="closed-1700"><h2>Issue #1700 closed<span class="toot-id"> #closed-1700</span></h2><div class="pubdate">21 Jan at 17:11:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><p>Remove some dead .DS_Store files</p></div>
<div class="toot" id="created-1717"><h2>Issue #1717 created<span class="toot-id"> #created-1717</span></h2><div class="pubdate">21 Jan at 16:59:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1717">https://github.com/qt4cg/qtspecs/issues/1717</a></div><details><summary>Define focus functions in terms of the pipeline operator</summary><div class="markup"><p>Now that we have accepted the pipeline operator into the language, we can define the semantics of focus functions to take advantage of them, specifically, <code>fn() { EXPR }</code> can be defined to be equivalent to <code>fn($v) { $v -&gt; EXPR }</code> where $v is an otherwise-unused variable name.</p>
</div></details></div>
<div class="toot" id="agenda-01-21"><h2>QT4 CG meeting 106 draft agenda<span class="toot-id"> #agenda-01-21</span></h2><div class="pubdate">21 Jan at 10:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-21">https://qt4cg.org/meeting/agenda/2025/01-21</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1716"><h2>Issue #1716 created<span class="toot-id"> #created-1716</span></h2><div class="pubdate">20 Jan at 21:13:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1716">https://github.com/qt4cg/qtspecs/issues/1716</a></div><details><summary>Variable lookahead needed for `ArrowTarget`</summary><div class="markup"><p>The current grammar definition allows any <code>QName</code> (via <code>EQName</code>) as an <code>ArrowStaticFunction</code>:</p>
<pre><code>ArrowTarget
         ::= ArrowStaticFunction ArgumentList
           | ArrowDynamicFunction PositionalArgumentList
ArrowStaticFunction
         ::= EQName
ArrowDynamicFunction
         ::= VarRef
           | InlineFunctionExpr
           | ParenthesizedExpr 
</code></pre>
<p>This complicates the distinction of the static and dynamic variants of <code>ArrowTarget</code>, as it cannot be done with a fixed number of lookahead tokens. E.g. in an expression starting like this</p>
<pre><code class="language-xquery">A =&gt; fn ( $A, $B, $C, (: ... :) $Z ) { } ( 
</code></pre>
<p>the distinction cannot be made before the left brace is seen. While constructing an LR parser, there is a shift-reduce conflict between shifting <code>fn</code> as a keyword of an <code>InlineFunctionExpr</code>, or reducing <code>fn</code> to the <code>QName</code> of <code>EQName</code>.</p>
<p>This can easily be fixed by adding <code>xgc: reserved-function-names</code> to <code>ArrowStaticFunction</code>, which would also be consistent with other function calls in disallowing reserved function names:</p>
<pre><code>ArrowStaticFunction
         ::= EQName
                          /* xgc: reserved-function-names */		 
</code></pre>
<p>But could not <code>ArrowTarget</code> also be written like the following?</p>
<pre><code>ArrowTarget
         ::= FunctionCall
           | DynamicFunctionCall
</code></pre>
<p>In this case, the <code>xgc: reserved-function-names</code> constraint would be inherited from <code>FunctionCall</code>. It eliminates <code>ArrowStaticFunction</code> and <code>ArrowDynamicFunction</code> and at the same time lifts some restrictions imposed by the current <code>ArrowTarget</code>. It does not cause any LALR(2) conflicts.</p>
</div></details></div>
<div class="toot" id="created-1715"><h2>Issue #1715 created<span class="toot-id"> #created-1715</span></h2><div class="pubdate">20 Jan at 13:59:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1715">https://github.com/qt4cg/qtspecs/issues/1715</a></div><details><summary>Array Lookups: partial removal of out-of-bounds checks</summary><div class="markup"><p>Various QT4 tests imply that the out-of-bounds check for arrays have been removed. An example:</p>
<pre><code class="language-xml">&lt;test-case name="UnaryLookup-005a"&gt;
  &lt;description&gt;Integer subscript into an array: array index too low&lt;/description&gt;
  &lt;created by="Michael Kay" on="2014-11-27"/&gt;
  &lt;modified by="Michael Kay" on="2024-07-22" change="returns () in 4.0"/&gt;
  &lt;dependency type="spec" value="XP40+ XQ40+"/&gt;
  &lt;test&gt;(['a', 'b'], ['c', 'd'])[ ?0 eq 'c']&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-empty/&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
</code></pre>
<p>I believe this is not reflected in the spec yet, or at least it includes examples that need to be updated:</p>
<blockquote>
<p><code>[ "a", "b" ]?3</code> raises a dynamic error <code>err:FOAY0001</code>.</p>
</blockquote>
<p>I guess that #832 would have been the PR with the relevant changes (we have already observed in another issue that some changes of this PR need to survive; see https://github.com/qt4cg/qtspecs/pull/1283#issuecomment-2568330191).</p>
<hr>
<p><strong>Edit (2025-05-26): Outdated:</strong></p>
<p>That leads me to the original reason for creating this issue:</p>
<ul>
<li>I think it’s a good idea to drop the range check for array lookups, and it would seem consistent to me to also drop it for dynamic function calls.</li>
<li>As map/array lookups and dynamic function calls are often used interchangeably, <code>$array?0</code> and <code>$array(0)</code> should behave identically.</li>
<li>The <code>FOAY0001</code> error would (and should) still be raised by the array functions, including <code>array:get</code>, <code>array:put</code>, <code>array:remove</code>, or <code>array:insert-before</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1714"><h2>Issue #1714 created<span class="toot-id"> #created-1714</span></h2><div class="pubdate">19 Jan at 23:34:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1714">https://github.com/qt4cg/qtspecs/issues/1714</a></div><details><summary>sibling:: axis. Action Item QT4CG-097-03</summary><div class="markup"><p>This issue is a reflection of the following Action Item:</p>
<p><strong>QT4CG-097-03</strong>: DN to proposal an axis for accessing the siblings of a node.</p>
<p>I have prepared a pdf file that contains the updated relevant updated sections from the "<strong><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html">Xpath 4.0</a></strong>" document:</p>
<ul>
<li>There are no deletions or conflicting changes.</li>
<li>The additions to the text are highlighted in turquoise.</li>
<li>The file that contains all relevant updated sections of the document is at:
https://github.com/dnovatchev/qtspecs/blob/dn-siblings/sibling-axis.pdf</li>
</ul>
<p><strong>If the  above doesn't work</strong>, please try:
https://github.com/dnovatchev/MathPuzzles/blob/master/sibling-axis.pdf</p>
</div></details></div>
<div class="toot" id="created-1713"><h2>Issue #1713 created<span class="toot-id"> #created-1713</span></h2><div class="pubdate">19 Jan at 11:49:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1713">https://github.com/qt4cg/qtspecs/issues/1713</a></div><details><summary>Patchy exposition of XSLT type pattern syntax</summary><div class="markup"><p>In XSLT §5.4.2.2 Type Patterns, the exposition of the grammar is "patchy" - it includes some production rules such as <code>FieldDeclaration</code> that are in the subtree of the main production rule (<code>TypePattern</code>) without giving all the intermediate rules that connect this rule to the root.</p>
<p>It's easy enough to correct this by hand, but it would be nice to prevent this happening by automating the generation of these families of grammar rules, perhaps by including all rules in the subtree up to a depth of 3, say. It would also be nice to simply list the productions to be included without having to decide manually which of them should be the principal target of <code>termref</code> references (by being marked with an ID).</p>
</div></details></div>
<div class="toot" id="created-1712"><h2>Pull request #1712 created<span class="toot-id"> #created-1712</span></h2><div class="pubdate">18 Jan at 18:51:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><details><summary>1706 Drop "else if" and "else" clauses from braced conditionals</summary><div class="markup"><p>Fix #1706</p>
</div></details></div>
<div class="toot" id="created-1711"><h2>Pull request #1711 created<span class="toot-id"> #created-1711</span></h2><div class="pubdate">18 Jan at 18:29:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><details><summary>1705 Say that max precision is implementation-defined</summary><div class="markup"><p>Applies to fn:round, fn:round-half-to-even, fn:divide-decimals</p>
<p>Fix #1705</p>
</div></details></div>
<div class="toot" id="created-1710"><h2>Pull request #1710 created<span class="toot-id"> #created-1710</span></h2><div class="pubdate">17 Jan at 23:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><details><summary>1709 Updated type diagrams</summary><div class="markup"><p>Added a few details to the type diagrams: user-defined array, map, and record types; enumeration types; untypedAtomic</p>
</div></details></div>
<div class="toot" id="created-1709"><h2>Issue #1709 created<span class="toot-id"> #created-1709</span></h2><div class="pubdate">17 Jan at 22:44:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><details><summary>Extend diagram of item types to include record types etc</summary><div class="markup"><p>I propose to extend the diagram of item types (common to DM and FO) to include more detail of the hierarchy below function types.</p>
</div></details></div>
<div class="toot" id="closed-1617"><h2>Issue #1617 closed<span class="toot-id"> #closed-1617</span></h2><div class="pubdate">17 Jan at 12:55:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1617">https://github.com/qt4cg/qtspecs/pull/1617</a></div><p>1606 Drop named item types, refine named record types, esp in XSLT</p></div>
<div class="toot" id="created-1708"><h2>Pull request #1708 created<span class="toot-id"> #created-1708</span></h2><div class="pubdate">17 Jan at 12:52:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><details><summary>1485 Add xsl:record-type declaration</summary><div class="markup"><p>Adds named record types to XSLT, with much the same spec as for XQuery, but some extra tweaks for handling visibility and overriding.</p>
<p>Fix #1485</p>
</div></details></div>
<div class="toot" id="closed-1707"><h2>Issue #1707 closed<span class="toot-id"> #closed-1707</span></h2><div class="pubdate">17 Jan at 08:58:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><p>Fix bug in build dependencies</p></div>
<div class="toot" id="created-1707"><h2>Pull request #1707 created<span class="toot-id"> #created-1707</span></h2><div class="pubdate">17 Jan at 08:58:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><details><summary>Fix bug in build dependencies</summary><div class="markup"><p>Changing <code>xslt.xml</code> didn't actually cause the HTML for the XSLT specification to be rebuilt. 👎</p>
</div></details></div>
<div class="toot" id="created-1706"><h2>Issue #1706 created<span class="toot-id"> #created-1706</span></h2><div class="pubdate">16 Jan at 21:08:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><details><summary>Ambiguous `if` syntax</summary><div class="markup"><p>The optional <code>else</code> in a braced <code>if</code> expression introduces an ambiguity in the XQuery 4.0 grammar.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>It can be parsed like this</p>
<pre><code class="language-xquery">if (A) then if (B) {C}                               else {}
       else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E}               else {}
       else if (F) {G} else {H}
</code></pre>
<p>The corresponding part of the grammar is</p>
<pre><code>IfExpr   ::= 'if' '(' Expr ')' ( UnbracedActions | BracedActions )
UnbracedActions
         ::= 'then' ExprSingle 'else' ExprSingle
BracedActions
         ::= ThenAction ElseIfAction* ElseAction?
ThenAction
         ::= EnclosedExpr
ElseIfAction
         ::= 'else' 'if' '(' Expr ')' EnclosedExpr
ElseAction
         ::= 'else' EnclosedExpr
</code></pre>
<p>The ambiguity could be resolved by making the <code>ElseAction</code> in <code>BracedActions</code> mandatory, i.e.:</p>
<pre><code>BracedActions
         ::= ThenAction ElseIfAction* ElseAction
</code></pre>
</div></details></div>
<div class="toot" id="created-1705"><h2>Issue #1705 created<span class="toot-id"> #created-1705</span></h2><div class="pubdate">16 Jan at 15:53:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><details><summary>fn:divide-decimals, fn:round: large precision values</summary><div class="markup"><p>We may need to specify what is going to happen if very large (positive and negative) precisions are specified:</p>
<pre><code class="language-xquery">divide-decimals(1, 1, 0x7FFFFFFF)
</code></pre>
<p>A simple implementation in Java to compute the quotient for this function returns an Overflow exception:</p>
<pre><code class="language-java">BigDecimal.ONE.divide(BigDecimal.ONE, 0x7FFFFFFF, RoundingMode.DOWN)
</code></pre>
<p>This also affects <code>fn:round</code>: The query <code>round(1, -0x80000000)</code> seems to behave unexpectedly in existing implementations.</p>
<p>In general, the computation gets very slow for large precision values, and it may not be simple to interrupt such low-level operations, so maybe (if it makes sense, I haven’t really thought about it) we could define precision limits.</p>
</div></details></div>
<div class="toot" id="created-1704"><h2>Issue #1704 created<span class="toot-id"> #created-1704</span></h2><div class="pubdate">16 Jan at 15:09:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1704">https://github.com/qt4cg/qtspecs/issues/1704</a></div><details><summary>Ignore the byte order mark more completely/globally</summary><div class="markup"><p>Following on a discussion with @line-o on the XML.com Slack, I took a peek at the way we deal with the byte order mark in Functions and Operators. We seem to be explicit about it in a couple of JSON functions but not elsewhere. I think we should assert that the byte order mark is explicitly ignored in all of the input functions (json-<em>, parse-</em>, unparsed-* etc.)</p>
</div></details></div>
<div class="toot" id="closed-1136"><h2>Issue #1136 closed<span class="toot-id"> #closed-1136</span></h2><div class="pubdate">15 Jan at 18:53:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1136">https://github.com/qt4cg/qtspecs/issues/1136</a></div><p>Defining names for parameters on typed function tests</p></div>
<div class="toot" id="closed-1696"><h2>Issue #1696 closed<span class="toot-id"> #closed-1696</span></h2><div class="pubdate">15 Jan at 18:53:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><p>1136 Optional names in typed function types</p></div>
<div class="toot" id="closed-1688"><h2>Issue #1688 closed<span class="toot-id"> #closed-1688</span></h2><div class="pubdate">15 Jan at 00:04:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><p>In rendered HTML, link to definition is missing its link text</p></div>
<div class="toot" id="created-1703"><h2>Pull request #1703 created<span class="toot-id"> #created-1703</span></h2><div class="pubdate">14 Jan at 22:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><details><summary>1651 ordered maps</summary><div class="markup"><p>Reopened pull request introducing ordered maps.</p>
<p>Fix #1651.</p>
</div></details></div>
<div class="toot" id="closed-1609"><h2>Issue #1609 closed<span class="toot-id"> #closed-1609</span></h2><div class="pubdate">14 Jan at 17:23:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1609">https://github.com/qt4cg/qtspecs/pull/1609</a></div><p>1651 Ordered Maps</p></div>
<div class="toot" id="minutes—01-14"><h2>QT4 CG meeting 105 draft minutes<span class="toot-id"> #minutes—01-14</span></h2><div class="pubdate">14 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-14">https://qt4cg.org/meeting/minutes/2025/01-14</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1632"><h2>Issue #1632 closed<span class="toot-id"> #closed-1632</span></h2><div class="pubdate">14 Jan at 17:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1632">https://github.com/qt4cg/qtspecs/issues/1632</a></div><p>Add xsl:map/@select</p></div>
<div class="toot" id="closed-1694"><h2>Issue #1694 closed<span class="toot-id"> #closed-1694</span></h2><div class="pubdate">14 Jan at 17:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><p>1632 Add xsl:map/@select</p></div>
<div class="toot" id="closed-1684"><h2>Issue #1684 closed<span class="toot-id"> #closed-1684</span></h2><div class="pubdate">14 Jan at 17:05:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><p>[XSLT] Composite merge keys</p></div>
<div class="toot" id="closed-1689"><h2>Issue #1689 closed<span class="toot-id"> #closed-1689</span></h2><div class="pubdate">14 Jan at 17:05:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><p>1684 Composite merge keys; current-merge-key-array function</p></div>
<div class="toot" id="closed-1680"><h2>Issue #1680 closed<span class="toot-id"> #closed-1680</span></h2><div class="pubdate">14 Jan at 17:03:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><p>Ambiguous `switch` syntax</p></div>
<div class="toot" id="closed-1692"><h2>Issue #1692 closed<span class="toot-id"> #closed-1692</span></h2><div class="pubdate">14 Jan at 17:02:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><p>1680 Fix switch syntax ambiguity</p></div>
<div class="toot" id="closed-1672"><h2>Issue #1672 closed<span class="toot-id"> #closed-1672</span></h2><div class="pubdate">14 Jan at 17:00:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><p>array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1687"><h2>Issue #1687 closed<span class="toot-id"> #closed-1687</span></h2><div class="pubdate">14 Jan at 17:00:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><p>1672 array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1006"><h2>Issue #1006 closed<span class="toot-id"> #closed-1006</span></h2><div class="pubdate">14 Jan at 16:59:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1006">https://github.com/qt4cg/qtspecs/issues/1006</a></div><p>regular expression addition - word boundaries</p></div>
<div class="toot" id="closed-490"><h2>Issue #490 closed<span class="toot-id"> #closed-490</span></h2><div class="pubdate">14 Jan at 16:59:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/490">https://github.com/qt4cg/qtspecs/issues/490</a></div><p>Control over schema validation in parse-xml(), doc(), etc.</p></div>
<div class="toot" id="closed-108"><h2>Issue #108 closed<span class="toot-id"> #closed-108</span></h2><div class="pubdate">14 Jan at 16:59:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/108">https://github.com/qt4cg/qtspecs/issues/108</a></div><p>Template match using values of [tunnel] parameters</p></div>
<div class="toot" id="closed-1284"><h2>Issue #1284 closed<span class="toot-id"> #closed-1284</span></h2><div class="pubdate">14 Jan at 16:58:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1284">https://github.com/qt4cg/qtspecs/issues/1284</a></div><p>Build issue: Unsupported specref to  [streamability-fn-distinct-ordered-nodes]</p></div>
<div class="toot" id="closed-1695"><h2>Issue #1695 closed<span class="toot-id"> #closed-1695</span></h2><div class="pubdate">14 Jan at 16:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><p>1284 Define streamability of distinct-ordered-nodes</p></div>
<div class="toot" id="closed-1693"><h2>Issue #1693 closed<span class="toot-id"> #closed-1693</span></h2><div class="pubdate">14 Jan at 16:56:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><p>1683 Extend xpath-functions schema with CSV components</p></div>
<div class="toot" id="closed-1690"><h2>Issue #1690 closed<span class="toot-id"> #closed-1690</span></h2><div class="pubdate">14 Jan at 16:54:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><p>1688 In "implementation-defined" appendix, fix absent generated link</p></div>
<div class="toot" id="created-1702"><h2>Issue #1702 created<span class="toot-id"> #created-1702</span></h2><div class="pubdate">14 Jan at 15:19:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1702">https://github.com/qt4cg/qtspecs/issues/1702</a></div><details><summary>Node Updates: Functions</summary><div class="markup"><p>In #1225, I have summarized some thoughts on generalizing updates for both nodes and structured items (maps/arrays).</p>
<p>XQuery Update is complex, as updates are in general, so we may still decide that it is too ambitious to introduce update features in the core language. If we want to give it a try, we could offer functions that are based on XQUF, but that only perform one update operation at a a time on a given input. This way, we could ignore the sophisticated <a href="https://www.w3.org/TR/xquery-update-30/#id-pending-update-lists">Pending Update List</a> semantics, which is only important when multiple updating expressions are specified and need to be checked and brought into order.</p>
<p>A function set that provides an equivalent functionality for all XQUF update operations could look as follows (the presented functions are valid XQuery Update code):</p>
<pre><code class="language-xquery">declare namespace update = 'http://www.w3.org/TR/xquery-update';

declare function update:delete(
  $node  as node(),
  $path  as fn(node()) as node()*
) as node() {
  copy $c := $node
  modify delete node $path($c)
  return $c
};

declare function update:rename(
  $node  as node(),
  $path  as fn(node()) as node()*,
  $name  as (xs:QName | xs:NCName | fn(node(), xs:integer) as (xs:QName | xs:NCName))
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := if($name instance of fn(*)) {
      $name($target, $pos)
    } else {
      $name
    }
    return rename node $target as $result
  )
  return $c
};

declare function update:replace(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as node()*)*,
  $options   as record(value? as xs:boolean)? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return if($options?value) {
      replace value of node $target with $result
    } else {
      replace node $target with $result
    }
  )
  return $c
};

declare function update:insert(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as (node() | xs:anyAtomicType))*,
  $options   as record(position? as enum('last', 'first', 'before', 'after'))? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return switch($options?position) {
      case 'before' return insert node $result before $target
      case 'after'  return insert node $result after $target
      case 'first'  return insert node $result as first into $target
      default       return insert node $result as last into $target
    }
  )
  return $c
};
</code></pre>
<p>Here are some exemplary function calls:</p>
<pre><code class="language-xquery">let $node := &lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
return (
  (: deletes all &lt;e/&gt; child nodes :)
  update:delete($node, fn { e }),
  (: renames the &lt;e/&gt; child nodes to &lt;f/&gt; :)
  update:rename($node, fn { e }, 'f'),
  (: replaces the &lt;e/&gt; child nodes with &lt;replaced/&gt; :)
  update:replace($node, fn { e }, &lt;replaced/&gt;),
  (: replaces the string value of the &lt;e/&gt; child nodes with 'text' :)
  update:replace($node, fn { e }, 'text', { 'value': true() }),
  (: inserts a 'text' text node into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, 'text'),
  (: inserts 'text1' and 'text2' text nodes into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, fn($node, $pos) { 'text' || $pos }),
  (: inserts an &lt;x/&gt; element after each &lt;e/&gt; child node :)
  update:insert($node, fn { e }, &lt;x/&gt;, { 'position': 'after' })
)
</code></pre>
<p>Multiple update operations can easily be chained:</p>
<pre><code class="language-xquery">(: rename &lt;e/&gt; child nodes to &lt;f/&gt;, insert 'x' text nodes :)
&lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
=&gt; update:rename(fn { e }, 'f')
=&gt; update:insert(fn { f }, 'x')
</code></pre>
<p>Ideally, we could offer a similar function set (or maybe even the same) for maps and arrays in a next step (see #77). The map/array syntax would be similar for deletions…</p>
<pre><code class="language-xquery">let $data := { 'a': [ 1, 2, 3 ] }
return update:delete($data, fn { ?a?2 })
</code></pre>
<p>…but it certainly gets trickier for other operations.</p>
<p>If some of you believe that the presented approach is something that we should pursue, I will be happy to add details. As an alternative, we could pursue the XQUF light approach that I have sketched in #1225, based on the existing XQUF update keywords.</p>
<p>Yet another solution could be to stick with what we have, but add map/array update features to XQUF.</p>
</div></details></div>
<div class="toot" id="created-1701"><h2>Pull request #1701 created<span class="toot-id"> #created-1701</span></h2><div class="pubdate">14 Jan at 14:07:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><details><summary>Add dedication to MSM (action QT4CG-088-01)</summary><div class="markup"><p>I've had this action on my plate for a while. Having written a dedication, there's a follow-up question of where to put it. Having it in only one specification isn't wrong, but it seems slightly odd given that MSM contributed to them all. In the end, I decided to put a full dedication in the XPath specification and link to it from the others.</p>
<p>My rationale for the XPath spec is that it's probaly one that everyone reads. Another possibility was the Data Model as it's "foundational" but I think it's less read than XPath.</p>
<p>The published PR won't be write because there are tooling changes required. I've attached a couple of screen shots, one of the full dedication in XPath:</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/d83aa982-b783-44c8-8fb7-25787200bf13" alt="Screenshot 2025-01-14 at 14-00-08 XML Path Language (XPath) 4 0 WG Review Draft"></h2>
<p>And another of the link from the other specs (from XSLT, I think, but they're all the same).</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/634de4b0-59cb-4898-8c16-ddff4ddd3876" alt="Screenshot 2025-01-14 at 13-59-08 XSL Transformations (XSLT) Version 4 0"></h2>
</div></details></div>
<div class="toot" id="created-1700"><h2>Pull request #1700 created<span class="toot-id"> #created-1700</span></h2><div class="pubdate">14 Jan at 14:01:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><details><summary>Remove some dead .DS_Store files</summary><div class="markup"><p>I'm not sure how these got checked in...</p>
</div></details></div>
<div class="toot" id="agenda-01-14"><h2>QT4 CG meeting 105 draft agenda<span class="toot-id"> #agenda-01-14</span></h2><div class="pubdate">14 Jan at 10:11:15 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-14">https://qt4cg.org/meeting/agenda/2025/01-14</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1699"><h2>Issue #1699 created<span class="toot-id"> #created-1699</span></h2><div class="pubdate">14 Jan at 03:48:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1699">https://github.com/qt4cg/qtspecs/issues/1699</a></div><details><summary>XPath function to calculate edit distance between two strings</summary><div class="markup"><p>I propose a new XPath function to calculate the edit distance between two strings. It could use a specific algorithm, for example <code>fn:levenshtein-distance(s1,s2)</code>.</p>
<p>The function could also be designed  more generic like <code>fn:edit-distance(s1, s2, algorithm)</code> where <em>algorithm</em> could be levenshtein, hamming, lcs ... (see <a href="https://en.wikipedia.org/wiki/Edit_distance">edit distance</a>).</p>
<p>Use Case: Schematron Quick Fix when checking <code>glossentry</code> elements against terms defined in <code>glossary</code>. <em>"Your term is not defined in Glossary, did you mean ...".</em></p>
<p>Thanks, Frank</p>
</div></details></div>
<div class="toot" id="closed-1407"><h2>Issue #1407 closed<span class="toot-id"> #closed-1407</span></h2><div class="pubdate">13 Jan at 17:53:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1407">https://github.com/qt4cg/qtspecs/issues/1407</a></div><p>Improve the spec prose and table of content layout for types</p></div>
<div class="toot" id="created-1698"><h2>Issue #1698 created<span class="toot-id"> #created-1698</span></h2><div class="pubdate">13 Jan at 13:53:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1698">https://github.com/qt4cg/qtspecs/issues/1698</a></div><details><summary>Allow select attribute for xsl:call-template instruction</summary><div class="markup"><p>The lack of the following feature is something that bothers me from time to time. I hope this is the right place here for my proposal.
And even though I did some search -- I am not sure if something similar was discussed before ...</p>
<p>I propose to allow a <code>select</code> attribute for <code>xsl:call-template</code> instructions. When the <code>select</code> attribute is set, then the named template is called for each selected item as context item.</p>
<p>When the empty sequence is selected, the template is not invoked.</p>
<p>When the <code>select</code> attribute is omitted, then the instruction works as before (Invoked once and <em>"[...] does not change focus [...]"</em>).</p>
<p>For extension instructions from named templates: May work the same with a prefixed attribute (e.g. <code>xsl:select</code>).</p>
<p>Benefits I see:</p>
<ul>
<li>Change the context without <code>xsl:apply-templates</code></li>
<li>Avoid template parameter with <code>current()</code> as default value (annoying when you have nested named template calls)</li>
<li>Avoid <code>xsl:for-each</code> workaround where context just must be adjusted for a single item (no such parameter available, see before)</li>
<li>Save an <code>xsl:for-each</code> instruction with this shorter form</li>
<li>Harmonize <code>xsl:call-template</code> with <code>xsl:apply-templates</code> concept a little bit</li>
</ul>
<p>Simple example:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:call-template name="t:make-something" select="child-elem"/&gt;
  &lt;!-- ... or as extension instruction: --&gt;
  &lt;t:make-something xsl:select="child-elem"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template name="t:make-something"&gt;
  &lt;xsl:context-item use="required" as="element(child-elem)"&gt;
  &lt;!-- ... --&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The call of <code>t:make-something</code> before is equivalent with:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:for-each select="child-elem"&gt;
    &lt;xsl:call-template name="t:make-something"/&gt;
  &lt;/xsl:for-each&gt;
&lt;/xsl:template&gt;
</code></pre>
</div></details></div>
<div class="toot" id="closed-1675"><h2>Issue #1675 closed<span class="toot-id"> #closed-1675</span></h2><div class="pubdate">13 Jan at 12:03:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="closed-1677"><h2>Issue #1677 closed<span class="toot-id"> #closed-1677</span></h2><div class="pubdate">13 Jan at 12:03:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><p>1675 Fixes for CSV parsing</p></div>
<div class="toot" id="closed-1673"><h2>Issue #1673 closed<span class="toot-id"> #closed-1673</span></h2><div class="pubdate">13 Jan at 11:55:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><p>1407 TOC structure for types</p></div>
<div class="toot" id="closed-1681"><h2>Issue #1681 closed<span class="toot-id"> #closed-1681</span></h2><div class="pubdate">13 Jan at 09:21:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><p> Δ in the table of contents</p></div>
<div class="toot" id="closed-1691"><h2>Issue #1691 closed<span class="toot-id"> #closed-1691</span></h2><div class="pubdate">13 Jan at 09:21:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><p>1681 - Delta marker in TOC</p></div>
<div class="toot" id="created-1697"><h2>Issue #1697 created<span class="toot-id"> #created-1697</span></h2><div class="pubdate">13 Jan at 00:17:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1697">https://github.com/qt4cg/qtspecs/issues/1697</a></div><details><summary>Add documentary names to callback function signatures</summary><div class="markup"><p>If PR #1696 is accepted we can add documentary names to the parameters of callback function signatures, for example <code>fn:filter</code> can become</p>
<pre><code>fn:filter(
  $input as&nbsp;item()*, | &nbsp;
  $predicate as&nbsp;fn($item as item(), $position as xs:integer) as xs:boolean? | &nbsp;
)&nbsp;as&nbsp;item()*

</code></pre>
<p>and we can (if we need to) use the parameter names in the prose</p>
</div></details></div>
<div class="toot" id="created-1696"><h2>Pull request #1696 created<span class="toot-id"> #created-1696</span></h2><div class="pubdate">13 Jan at 00:07:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><details><summary>1136 Optional names in typed function types</summary><div class="markup"><p>Fix #1136</p>
</div></details></div>
<div class="toot" id="created-1695"><h2>Pull request #1695 created<span class="toot-id"> #created-1695</span></h2><div class="pubdate">12 Jan at 23:36:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><details><summary>1284 Define streamability of distinct-ordered-nodes</summary><div class="markup"><p>Fix #1284</p>
</div></details></div>
<div class="toot" id="closed-1610"><h2>Issue #1610 closed<span class="toot-id"> #closed-1610</span></h2><div class="pubdate">11 Jan at 10:48:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1610">https://github.com/qt4cg/qtspecs/issues/1610</a></div><p>Some cross references are incorrect</p></div>
<div class="toot" id="closed-1683"><h2>Issue #1683 closed<span class="toot-id"> #closed-1683</span></h2><div class="pubdate">10 Jan at 09:35:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><p>There are validity errors in the function catalog related to csv elements</p></div>
<div class="toot" id="created-1694"><h2>Pull request #1694 created<span class="toot-id"> #created-1694</span></h2><div class="pubdate">09 Jan at 23:10:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><details><summary>1632 Add xsl:map/@select</summary><div class="markup"><p>Fix #1632</p>
</div></details></div>
<div class="toot" id="created-1693"><h2>Pull request #1693 created<span class="toot-id"> #created-1693</span></h2><div class="pubdate">09 Jan at 22:25:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><details><summary>1683 Extend xpath-functions schema with CSV components</summary><div class="markup"><p>This was an unsuccessful attempt to fix issue #1683, but the change is still worth making. It extends the aggregated schema for the XPath functions namespace to include definitions for the result of the csv-to-xml function.</p>
</div></details></div>
<div class="toot" id="created-1692"><h2>Pull request #1692 created<span class="toot-id"> #created-1692</span></h2><div class="pubdate">09 Jan at 21:55:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><details><summary>1680 Fix switch syntax ambiguity</summary><div class="markup"><p>Fix #1680 (as suggested in the issue)</p>
</div></details></div>
<div class="toot" id="created-1691"><h2>Pull request #1691 created<span class="toot-id"> #created-1691</span></h2><div class="pubdate">09 Jan at 21:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><details><summary>1681 - Delta marker in TOC</summary><div class="markup"><p>Fix #1681</p>
</div></details></div>
<div class="toot" id="created-1690"><h2>Pull request #1690 created<span class="toot-id"> #created-1690</span></h2><div class="pubdate">09 Jan at 20:28:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><details><summary>1688 In "implementation-defined" appendix, fix absent generated link</summary><div class="markup"><p>For F&amp;O the automatically-generated appendix of implementation-defined item should link each such item to the nearest containing section that has a <code>head</code> child as well as an id attribute.</p>
</div></details></div>
<div class="toot" id="created-1689"><h2>Pull request #1689 created<span class="toot-id"> #created-1689</span></h2><div class="pubdate">09 Jan at 18:10:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><details><summary>1684 Composite merge keys; current-merge-key-array function</summary><div class="markup"><p>Acknowledges that as a result of changes to <code>xsl:sort</code>, <code>xsl:merge</code> now accepts composite merge keys; introduces the <code>current-merge-key-array()</code> function to handle them.</p>
<p>Fix #1684</p>
</div></details></div>
<div class="toot" id="created-1688"><h2>Issue #1688 created<span class="toot-id"> #created-1688</span></h2><div class="pubdate">09 Jan at 17:39:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><details><summary>In rendered HTML, link to definition is missing its link text</summary><div class="markup"><p>https://qt4cg.org/specifications/xpath-functions-40/Overview.html#impl-def Item 6 contains a sentence that renders as "See ." In the raw HTML, there is a link <code>&lt;a href="#dt-nondeterministic-wrt-ordering"&gt;&lt;/a&gt;</code> with no link text.</p>
<p>I thought I might make this issue a little more substantive by reporting a second typo or broken link, but I can't find a second one at the moment. :)</p>
</div></details></div>
<div class="toot" id="created-1687"><h2>Pull request #1687 created<span class="toot-id"> #created-1687</span></h2><div class="pubdate">09 Jan at 12:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><details><summary>1672 array:values, map:values: Alternatives</summary><div class="markup"><p>Issue: #1672</p>
</div></details></div>
<div class="toot" id="created-1686"><h2>Pull request #1686 created<span class="toot-id"> #created-1686</span></h2><div class="pubdate">09 Jan at 11:46:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><details><summary>1685 Pipeline Operator</summary><div class="markup"><p>Issue: #1685</p>
<p>The PR introduces the pipeline operator <code>-&gt;</code>. If we decide to add it, we could drop <code>=!&gt;</code> in a second step and update various examples in the text.</p>
</div></details></div>
<div class="toot" id="created-1685"><h2>Issue #1685 created<span class="toot-id"> #created-1685</span></h2><div class="pubdate">09 Jan at 09:46:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><details><summary>Pipeline Operator</summary><div class="markup"><p>This is an attempt to find a solution for the discussion in #755, which was originally about defining an expression to bind the context value. It serves as a summary for an upcoming PR.</p>
<p>We have two operators in the language that can be used for pipelining:
&nbsp;&nbsp;1.&nbsp;With the simple map operator <code>!</code>, single items of an input can be bound to the context value.
&nbsp;&nbsp;2.&nbsp;With the arrow operator <code>=&gt;</code>, an input can be bound as first argument in a function call.</p>
<p>The current restrictions are:
&nbsp;&nbsp;A) There is no way to bind a sequence with 0 or more than 1 items to the context value.
&nbsp;&nbsp;B) We can only bind the input to the first function argument.</p>
<p>In addition, we have introduced the mapping arrow expression <code>=!&gt;</code> to bind single items of an input to the first function argument.</p>
<p>We could generalize and simplify the situation by introducing a dedicated and very basic pipeline operator: <code>A -&gt; B</code> evaluates <code>A</code> to a value, which is bound to the context value before evaluating <code>B</code>.</p>
<p>With the operator, restriction A) would be resolved. Restriction B) would be tackled indirectly, as <code>-&gt;</code> and <code>!</code> can often be combined. For example, the following examples from the specification could be simplified…</p>
<pre><code class="language-xquery">(: current vs. simplified syntax :)
$s =&gt; tokenize() =!&gt; fn { `"{.}"` }()
$s -&gt; tokenize(.) ! `"{.}"`

(: current vs. simplified syntax :)
(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() =!&gt; fn($a) { $a + 1 }() =&gt; sum()
(1 to 5) ! xs:double(.) ! math:sqrt(.) ! (. + 1) -&gt; sum(.)
</code></pre>
<p>…and we could drop <code>=!&gt;</code> in favor of the new operator.</p>
<p>An equivalent representation for the focus function <code>fn { E }</code> would be <code>fn($c) { $c -&gt; E }</code>.</p>
</div></details></div>
<div class="toot" id="created-1684"><h2>Issue #1684 created<span class="toot-id"> #created-1684</span></h2><div class="pubdate">08 Jan at 21:41:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><details><summary>[XSLT] Composite merge keys</summary><div class="markup"><p>The changes in PR #1674 to allow composite sort keys automatically propagate to <code>xsl:merge</code>, because the semantics of <code>xsl:merge-key</code> are defined entirely by reference to <code>xsl:sort</code>.</p>
<p>No immediate problem, except (1) we should acknowledge the fact and point out that composite merge keys are now allowed, and (2) the effect on the current-merge-key() function. This is the sequence-concatenation of the merge keys for multiple merge sources. The spec says:</p>
<blockquote>
<p>the [current merge key] will be a single atomic item if there is a single merge key, or a sequence of atomic items if there are multiple merge keys.</p>
</blockquote>
<p>Actually I think that's already wrong, because it forgets that an individual merge key may be an empty sequence. If that happens then the current-merge-key() function is somewhat useless. I suggest we simply document the fact: if there are multiple merge sources generating multiple merge keys and they are not all singletons, then the sequence concatenation of the merge keys may not be especially useful.</p>
<p>We could provide a variant current-merge-key-array() that returns an array of sort key values, one for each xsl:merge-key element, each one being a sequence of atomic items.</p>
</div></details></div>
<div class="toot" id="minutes—01-07"><h2>QT4 CG meeting 104 draft minutes<span class="toot-id"> #minutes—01-07</span></h2><div class="pubdate">07 Jan at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-07">https://qt4cg.org/meeting/minutes/2025/01-07</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1261"><h2>Issue #1261 closed<span class="toot-id"> #closed-1261</span></h2><div class="pubdate">07 Jan at 17:24:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1261">https://github.com/qt4cg/qtspecs/issues/1261</a></div><p>Add decimal-divide function</p></div>
<div class="toot" id="closed-1671"><h2>Issue #1671 closed<span class="toot-id"> #closed-1671</span></h2><div class="pubdate">07 Jan at 17:24:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><p>1261 New fn:divide-decimals() function</p></div>
<div class="toot" id="closed-1662"><h2>Issue #1662 closed<span class="toot-id"> #closed-1662</span></h2><div class="pubdate">07 Jan at 17:22:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1662">https://github.com/qt4cg/qtspecs/issues/1662</a></div><p>xsl:sort - add composite sort keys</p></div>
<div class="toot" id="closed-1674"><h2>Issue #1674 closed<span class="toot-id"> #closed-1674</span></h2><div class="pubdate">07 Jan at 17:22:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><p>1662 Allow composite sort keys in xsl:sort</p></div>
<div class="toot" id="closed-1621"><h2>Issue #1621 closed<span class="toot-id"> #closed-1621</span></h2><div class="pubdate">07 Jan at 17:20:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1621">https://github.com/qt4cg/qtspecs/issues/1621</a></div><p>compare() with collations that do not support ordering</p></div>
<div class="toot" id="closed-1676"><h2>Issue #1676 closed<span class="toot-id"> #closed-1676</span></h2><div class="pubdate">07 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><p>1621 Capabilities of Collations</p></div>
<div class="toot" id="closed-1678"><h2>Issue #1678 closed<span class="toot-id"> #closed-1678</span></h2><div class="pubdate">07 Jan at 17:17:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><p>Semantics of element(N, T) where T is a union type</p></div>
<div class="toot" id="closed-1679"><h2>Issue #1679 closed<span class="toot-id"> #closed-1679</span></h2><div class="pubdate">07 Jan at 17:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><p>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</p></div>
<div class="toot" id="closed-1670"><h2>Issue #1670 closed<span class="toot-id"> #closed-1670</span></h2><div class="pubdate">07 Jan at 17:11:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div>
<div class="toot" id="closed-1667"><h2>Issue #1667 closed<span class="toot-id"> #closed-1667</span></h2><div class="pubdate">07 Jan at 17:08:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1667">https://github.com/qt4cg/qtspecs/issues/1667</a></div><p>Invalid XML characters in JSON input</p></div>
<div class="toot" id="closed-1669"><h2>Issue #1669 closed<span class="toot-id"> #closed-1669</span></h2><div class="pubdate">07 Jan at 17:08:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1669">https://github.com/qt4cg/qtspecs/pull/1669</a></div><p>1667 Revise handling of non-XML characters in parse-json</p></div>
<div class="toot" id="closed-1668"><h2>Issue #1668 closed<span class="toot-id"> #closed-1668</span></h2><div class="pubdate">07 Jan at 17:05:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1668">https://github.com/qt4cg/qtspecs/pull/1668</a></div><p>Minor copy edits (no issue raised)</p></div>
<div class="toot" id="closed-1649"><h2>Issue #1649 closed<span class="toot-id"> #closed-1649</span></h2><div class="pubdate">07 Jan at 17:02:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1649">https://github.com/qt4cg/qtspecs/issues/1649</a></div><p>Result type of fn:function-annotations()</p></div>
<div class="toot" id="closed-1666"><h2>Issue #1666 closed<span class="toot-id"> #closed-1666</span></h2><div class="pubdate">07 Jan at 17:02:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1666">https://github.com/qt4cg/qtspecs/pull/1666</a></div><p>1649 result of function annotations</p></div>
<div class="toot" id="closed-1650"><h2>Issue #1650 closed<span class="toot-id"> #closed-1650</span></h2><div class="pubdate">07 Jan at 16:59:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1650">https://github.com/qt4cg/qtspecs/issues/1650</a></div><p>fn:node-kind, fn:type-of: Editorial</p></div>
<div class="toot" id="closed-1665"><h2>Issue #1665 closed<span class="toot-id"> #closed-1665</span></h2><div class="pubdate">07 Jan at 16:59:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1665">https://github.com/qt4cg/qtspecs/pull/1665</a></div><p>1650 Tidy up fn:type-of</p></div>
<div class="toot" id="closed-1663"><h2>Issue #1663 closed<span class="toot-id"> #closed-1663</span></h2><div class="pubdate">07 Jan at 16:57:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1663">https://github.com/qt4cg/qtspecs/pull/1663</a></div><p>Remove DTD/stylesheet distractions at the top of the schema</p></div>
<div class="toot" id="agenda-01-07"><h2>QT4 CG meeting 104 draft agenda<span class="toot-id"> #agenda-01-07</span></h2><div class="pubdate">07 Jan at 10:11:30 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-07">https://qt4cg.org/meeting/agenda/2025/01-07</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1683"><h2>Issue #1683 created<span class="toot-id"> #created-1683</span></h2><div class="pubdate">06 Jan at 11:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><details><summary>There are validity errors in the function catalog related to csv elements</summary><div class="markup"><p>The build reports:</p>
<pre><code>Processing file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Building tree for file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml using class net.sf.saxon.tree.tiny.TinyBuilder
Tree built in 215.684667ms
Tree size: 38655 nodes, 773635 characters, 7637 attributes
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-002
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 5 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-003
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-004
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 8 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-005
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 16 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-006
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 24 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-007
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 37 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-008
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 40 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-009
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 36 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-010
Execution time: 532.103792ms
Memory used: 98Mb
</code></pre>
</div></details></div>
<div class="toot" id="created-1682"><h2>Issue #1682 created<span class="toot-id"> #created-1682</span></h2><div class="pubdate">06 Jan at 11:05:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1682">https://github.com/qt4cg/qtspecs/issues/1682</a></div><details><summary>Type Promotion</summary><div class="markup"><p>The description of type promotion in Appendix B.1 has become outdated.</p>
<p>Firstly, the coercion rules no longer invoke type promotion; instead, they use a custom table of "implicit casts". So B.1 is wrong to say that type promotion is invoked by the coercion rules.</p>
<p>Secondly, for selecting an entry in the operator mapping table, I don't think type promotion comes into play.</p>
<ul>
<li>The rules for value comparisons do all the necessary type conversions of operands BEFORE invoking a search of the operator mapping table.</li>
<li>The rules for arithmetic operators don't require any type promotion: for numerics, they invoke a function such as op:numeric-add, and it is the definition of this function (not the selection of the function in the mapping table) that invokes type promotion.</li>
</ul>
<p>The statement in B.1 that "If the result type of an operator is listed as numeric, it means "the first type in the ordered list (xs:integer, xs:decimal, xs:float, xs:double) into which all operands can be converted by [subtype substitution] and [type promotion]" seems wrong in general: for example it doesn't cover <code>integer div integer</code>. The result type is actually defined by the rules of the selected function, e.g. op:numeric-divide, and not by the "result type" column of the operator mapping table. Perhaps it should say that if the result type is a subtype of numeric as defined by the particular function.</p>
<p>References to Type Promotion in F&amp;O section 1.6 are also outdated.</p>
<p>The sum() and avg() functions invoke "numeric promotion" to convert all values in the input to a common type, but the exact rules for doing this aren't exactly clear. For example, the equivalent expression given for sum() doesn't do what the prose says. For example, given sum() applied to a sequence (X as decimal, Y as decimal, Z as float), the prose says the result is float(X) + float(Y) + Z, whereas the equivalent expression gives float(decimal(X + Y)) + Z) which is not necessarily the same thing.</p>
</div></details></div>
<div class="toot" id="created-1681"><h2>Issue #1681 created<span class="toot-id"> #created-1681</span></h2><div class="pubdate">05 Jan at 23:38:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><details><summary> Δ in the table of contents</summary><div class="markup"><p>All the spec say in their first changes section:</p>
<blockquote>
<p>Sections with significant changes are marked Δ in the table of contents.</p>
</blockquote>
<p>However, these markers are present only in the F&amp;O specification.</p>
</div></details></div>
<div class="toot" id="created-1680"><h2>Issue #1680 created<span class="toot-id"> #created-1680</span></h2><div class="pubdate">05 Jan at 19:27:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><details><summary>Ambiguous `switch` syntax</summary><div class="markup"><p>Unless I am overlooking some constraint preventing this, an ambiguity has been introduced to the XQuery 4.0 grammar by allowing the <code>SwitchComparand</code> to be omitted per #671/#678.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">switch case A return switch case B return switch case C return D default return E default return F
</code></pre>
<p>It can be parsed along the lines of</p>
<pre><code class="language-xquery">switch
case A return SWITCH 
case B return switch
              case C return D 
              default return E 
default return F
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">switch
case A return switch
              case B return SWITCH
              case C return D
              default return E
default return F
</code></pre>
</div></details></div>
<div class="toot" id="created-1679"><h2>Pull request #1679 created<span class="toot-id"> #created-1679</span></h2><div class="pubdate">05 Jan at 14:28:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><details><summary>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</summary><div class="markup"><p>Fix #1678</p>
</div></details></div>
<div class="toot" id="created-1678"><h2>Issue #1678 created<span class="toot-id"> #created-1678</span></h2><div class="pubdate">05 Jan at 00:24:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><details><summary>Semantics of element(N, T) where T is a union type</summary><div class="markup"><p>The semantics of <code>element(N, T)</code> say that to get a match, the type annotation A of the element must be derived from T <em>by restriction</em>. This means you will never get a match if T is a union type.</p>
<p>Furthermore, if T is a complex type, there is no match if the type annotation is a complex type derived by extension from T.</p>
<p>I think this is a simple error in the spec. It should say that derived-from(A, T) must be true. The derived-from() relationship handles union types and derivation by extension correctly.</p>
<p>We do use <code>derived-from</code> when specifying subtyping. This means that an element E can be an instance of <code>element(E, xs:integer)</code>, and not be an instance of <code>element(E, xs:numeric)</code>, even though  <code>element(E, xs:integer)</code>, is a subtype of <code>element(E, xs:numeric)</code>.</p>
<p>The error seems to have crept in when the rules were redrafted for 4.0. Up to and including 3.1, the semantics of ElementTest and AttributeTest reference the derived-from() function.</p>
</div></details></div>
<div class="toot" id="created-1677"><h2>Pull request #1677 created<span class="toot-id"> #created-1677</span></h2><div class="pubdate">04 Jan at 18:32:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><details><summary>1675 Fixes for CSV parsing</summary><div class="markup"><p>Fix #1675</p>
</div></details></div>
<div class="toot" id="created-1676"><h2>Pull request #1676 created<span class="toot-id"> #created-1676</span></h2><div class="pubdate">03 Jan at 20:08:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><details><summary>1621 Capabilities of Collations</summary><div class="markup"><p>Fix #1621</p>
<p>This PR is largely editorial, except that it makes a substantive change to the <code>fn:collation-available</code> function.</p>
</div></details></div>
<div class="toot" id="created-1675"><h2>Issue #1675 created<span class="toot-id"> #created-1675</span></h2><div class="pubdate">03 Jan at 16:02:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="created-1674"><h2>Pull request #1674 created<span class="toot-id"> #created-1674</span></h2><div class="pubdate">03 Jan at 13:32:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><details><summary>1662 Allow composite sort keys in xsl:sort</summary><div class="markup"><p>Fix #1662</p>
</div></details></div>
<div class="toot" id="created-1673"><h2>Pull request #1673 created<span class="toot-id"> #created-1673</span></h2><div class="pubdate">03 Jan at 01:07:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><details><summary>1407 TOC structure for types</summary><div class="markup"><p>Addresses part of #1407:</p>
<ul>
<li>Improves the section headings and levels for the Types and Subtyping sections</li>
<li>Level-4 headings (and level-5 if there were any) are no longer omitted from the F&amp;O TOC.</li>
</ul>
<p>There are other suggestions in #1407 regarding the spec prose that are not (yet) implemented.</p>
<p>Changing the CSS to adjust presentation of level-4 and level-5 headings in the TOC is way above my level of CSS competence, there's some very elaborate logic in this area, and anyone who wants to tackle it is welcome.</p>
</div></details></div>
<div class="toot" id="created-1672"><h2>Issue #1672 created<span class="toot-id"> #created-1672</span></h2><div class="pubdate">02 Jan at 20:50:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><details><summary>array:values, map:values: Alternatives</summary><div class="markup"><p>We still have <code>array:values</code> and <code>map:values</code> in the spec, even though the names were considered suboptimal: When retrieving values of struct(ure(d item))s, one would expect to get not a flat, but a structured result.</p>
<p>A while ago, the <code>items</code> key specifier was introduced to mimic the classical wildcard lookup syntax (making <code>$A?*</code> and <code>$A?items::*</code> equivalent), and I suggest renaming our functions to <code>array:items</code> and <code>map:items</code>:</p>
<pre><code class="language-xquery">  $map?*
≍ map:items($map)

  $array?*
≍ array:items($array)
</code></pre>
<p>Plan&nbsp;B could be to extend the second argument of <code>map:get</code> (and <code>array:get</code>) to also accept predicate functions…</p>
<pre><code class="language-xquery">map:get(
  $map  as map(*),	
  $key  as (xs:anyAtomicType|fn(xs:anyAtomicType) as xs:boolean?)
) as item()*
</code></pre>
<p>…which would allow us to write:</p>
<pre><code class="language-xquery">  $map?a
≍ $map =&gt; map:get('a')
≍ $map =&gt; map:get(fn { . = 'a' })

  $map?(1 to 5)
≍ $map =&gt; map:get(fn { . = 1 to 5 })

  $map?*
≍ $map =&gt; map:get(true#0)

(: and things like :)
$map =&gt; map:get(fn { . mod 2 = 1 })
</code></pre>
</div></details></div>
<div class="toot" id="created-1671"><h2>Pull request #1671 created<span class="toot-id"> #created-1671</span></h2><div class="pubdate">01 Jan at 16:50:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><details><summary>1261 New fn:divide-decimals() function</summary><div class="markup"><p>Fix #1261</p>
</div></details></div>
<div class="toot" id="created-1670"><h2>Pull request #1670 created<span class="toot-id"> #created-1670</span></h2><div class="pubdate">01 Jan at 12:51:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div></div></article></main></body></html>
<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2025</title></head><body><main><article><h1>@qt4cg statuses in 2025</h1><p>This page displays status
              updates
              about the QT4 CG project from 2025.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="closed-1909"><h2>Issue #1909 closed<span class="toot-id"> #closed-1909</span></h2><div class="pubdate">06 Apr at 23:22:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1909">https://github.com/qt4cg/qtspecs/pull/1909</a></div><p>1902 bin unpack out of range</p></div>
<div class="toot" id="created-1915"><h2>Pull request #1915 created<span class="toot-id"> #created-1915</span></h2><div class="pubdate">06 Apr at 23:21:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1915">https://github.com/qt4cg/qtspecs/pull/1915</a></div><details><summary>1902b bin:unpack out of range error</summary><div class="markup"><p>Replaces PR #1909</p>
<p>Adds error conditions for unpacking an integer that is too large for the implementation</p>
</div></details></div>
<div class="toot" id="created-1914"><h2>Pull request #1914 created<span class="toot-id"> #created-1914</span></h2><div class="pubdate">04 Apr at 16:08:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1914">https://github.com/qt4cg/qtspecs/pull/1914</a></div><details><summary>501 Error handling: try/finally</summary><div class="markup"><p>Closes #501</p>
</div></details></div>
<div class="toot" id="created-1913"><h2>Pull request #1913 created<span class="toot-id"> #created-1913</span></h2><div class="pubdate">04 Apr at 15:08:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1913">https://github.com/qt4cg/qtspecs/pull/1913</a></div><details><summary>1911 Clarifications for regular expressions</summary><div class="markup"><ol>
<li>Reinstates the non-capturing group syntax <code>(?: xxx )</code></li>
<li>Clarifies that a zero-length matching segment does not overlap an immediately preceding adjacent (but non-zero-length) segment.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1912"><h2>Issue #1912 created<span class="toot-id"> #created-1912</span></h2><div class="pubdate">04 Apr at 14:05:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1912">https://github.com/qt4cg/qtspecs/issues/1912</a></div><details><summary>Error handling: `fn:throw`</summary><div class="markup"><p>Adopted from #501:</p>
<p>In https://github.com/qt4cg/qtspecs/pull/493, a function/expression was suggested to re-throw errors:</p>
<pre><code class="language-xquery">try {
  (: wild stuff :)
} catch * {
  module:log($err:description),
  fn:throw($err:map)
}
</code></pre>
<p>Existing errors map can be modified before rethrowing them:</p>
<pre><code class="language-xquery">try {
  1 div 0
} catch * {
  module:log($err:description),
  fn:throw($err:map =&gt; map:put('description', 'Arithmetic error'))
}
</code></pre>
</div></details></div>
<div class="toot" id="created-1911"><h2>Issue #1911 created<span class="toot-id"> #created-1911</span></h2><div class="pubdate">02 Apr at 13:45:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1911">https://github.com/qt4cg/qtspecs/issues/1911</a></div><details><summary>Remarks on recent changes to regular expression handling</summary><div class="markup"><p>I would like to share these observations that I made while working on recent changes of regular expression handling per #1856.</p>
<p>The section that mentions potential rewrites of <code>\b</code> and <code>\B</code> misses to consider the start and end of the string, as well as the empty string. It should rather read:</p>
<blockquote>
<p><code>\b</code> can be rewritten to an equivalent form in terms of lookbehind and lookahead assertions:</p>
<p><code>(?:(*positive_lookbehind:\w)(?:$|(*positive_lookahead:\W))|(?:^|(*positive_lookbehind:\W))(*positive_lookahead:\w))</code></p>
<p>A similar rewrite is possible for <code>\B</code>, but it must additionally take care of the empty string.</p>
</blockquote>
<p>For <code>fn:analyze-string</code>, it might be useful to add a clarifying remark about empty matches at the end of the result (see qt4cg/qt4tests#224).</p>
<p>The specification of <code>fn:analyze-string</code> contains a duplicated word, <code>the the</code>. The same also occurs in several other places in the documents.</p>
</div></details></div>
<div class="toot" id="created-1910"><h2>Pull request #1910 created<span class="toot-id"> #created-1910</span></h2><div class="pubdate">31 Mar at 16:50:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1910">https://github.com/qt4cg/qtspecs/pull/1910</a></div><details><summary>1021 (part 1) Add $options arg to doc() and doc-available()</summary><div class="markup"><p>To follow: options for collection() and uri-collection().</p>
</div></details></div>
<div class="toot" id="created-1909"><h2>Pull request #1909 created<span class="toot-id"> #created-1909</span></h2><div class="pubdate">31 Mar at 15:40:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1909">https://github.com/qt4cg/qtspecs/pull/1909</a></div><details><summary>1902 bin unpack out of range</summary><div class="markup"><p>Add error condition.</p>
<p>Fix #1902</p>
<p>I also did some work on removing errors and warnings from the EXPath binary build.  There are a couple of outstanding issues I'm not sure how to fix:</p>
<p>(a) The function bin:bin had the incorrect id value func-bin-binary instead of func-bin-bin. I've corrected it, but the database of section ids needs updating.</p>
<p>(b) In database.xml, the EXPath binary spec is identified as document-summary/@uri = "https://qt4cg.org/specifications/EXPath/binary-40/". But the actual location of the specification is "https://qt4cg.org/specifications/expath-binary-40/"</p>
<p>(c) There are tags such as <code>&lt;code&gt;bin:index-of-range&lt;/code&gt;</code> which the stylesheet is trying to interpret as function names rather than error codes. They actually refer to obsolete error codes so we can't use <code>&lt;errorref&gt;</code></p>
</div></details></div>
<div class="toot" id="created-1908"><h2>Pull request #1908 created<span class="toot-id"> #created-1908</span></h2><div class="pubdate">31 Mar at 11:32:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1908">https://github.com/qt4cg/qtspecs/pull/1908</a></div><details><summary>1520 Allow forwards references to named item types</summary><div class="markup"><p>Fix #1520</p>
</div></details></div>
<div class="toot" id="created-1907"><h2>Issue #1907 created<span class="toot-id"> #created-1907</span></h2><div class="pubdate">29 Mar at 17:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1907">https://github.com/qt4cg/qtspecs/issues/1907</a></div><details><summary>Method lookup: wildcards</summary><div class="markup"><p>We should ignore the <code>%method</code> annotation for wildcard lookups:</p>
<pre><code class="language-xquery">let $data := { 'fn': %method fn() { . } }
return $data?*
</code></pre>
<p>I cannot see when this makes sense as it only seems to work if the wildcard lookup returns a single item (→ “selects a key/value pair whose value part is a singleton method”). In addition, it makes streaming of wildcard results troublesome.</p>
<p>If we believe we should support context value bindings for wildcards, I think it would be better to apply it to each item of the returned value, instead of the value as a whole.</p>
</div></details></div>
<div class="toot" id="created-1906"><h2>Pull request #1906 created<span class="toot-id"> #created-1906</span></h2><div class="pubdate">28 Mar at 15:16:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1906">https://github.com/qt4cg/qtspecs/pull/1906</a></div><details><summary>1797 elements-to-maps-conversion-plan function</summary><div class="markup"><p>The PR drops the "uniform" option of <code>elements-to-maps</code> into a separate function <code>elements-to-maps-conversion-plan</code>, which can be used to analyze a corpus of data and generate a conversion plan for use by <code>elements-to-maps</code>. This is useful when the conversion is to be applied to documents that are not part of the corpus, for example when new documents arrive for conversion every day and need to be converted in a consistent way. It also provides a more general mechanism for users to override the system decisions on what layouts to use for what elements.</p>
<p>The PR is not entirely complete at this stage: the technical detail is all there, but examples need to be reviewed. Comments are welcome at this stage.</p>
<p>There are a few other minor changes. The most notable are:</p>
<ul>
<li>More consistent fallback when an inappropriate layout is chosen. If the layout does not allow attributes, then attributes are discarded; if there is any other mismatch, the converter falls back to serialized XML layout.</li>
<li>Better handling of boolean and numeric element and attribute content.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1905"><h2>Issue #1905 created<span class="toot-id"> #created-1905</span></h2><div class="pubdate">27 Mar at 15:40:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1905">https://github.com/qt4cg/qtspecs/issues/1905</a></div><details><summary>Editorial edits</summary><div class="markup"><p>XQFO:</p>
<ul>
<li>Buggy examples/results: <code>map:put</code>, <code>map:of-pairs</code>, <code>fn:scan-left</code></li>
<li>duplicates: <code>the the</code>, …</li>
</ul>
<p>…to be continued</p>
</div></details></div>
<div class="toot" id="created-1904"><h2>Pull request #1904 created<span class="toot-id"> #created-1904</span></h2><div class="pubdate">27 Mar at 11:42:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1904">https://github.com/qt4cg/qtspecs/pull/1904</a></div><details><summary>1832 Operator Associativity</summary><div class="markup"><p>Update the table and explanatory notes.</p>
<p>Fix #1832</p>
</div></details></div>
<div class="toot" id="created-1903"><h2>Issue #1903 created<span class="toot-id"> #created-1903</span></h2><div class="pubdate">27 Mar at 11:27:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1903">https://github.com/qt4cg/qtspecs/issues/1903</a></div><details><summary>`fn:scan-left`, `fn:scan-right`: missing steps</summary><div class="markup"><p>I have labeled #982 (which included position arguments) to be closed to focus on the remaining todos:</p>
<ol>
<li>The types of the <code>$action</code> parameters of <code>fn:fold-right</code> and <code>fn:scan-right</code> should be aligned. In particular, <code>item()*</code> and <code>item()</code> of the scan function should be swapped:</li>
</ol>
<pre><code class="language-xquery">fn:fold-right(
  $input   as item()*,	
  $init    as item()*,	
  $action  as fn(item(), item()*) as item()*	
) as item()*

fn:scan-right(
  $input   as item()*,	
  $init    as item()*,	
  $action  as fn(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<ol start="2">
<li>The result of the last example of <code>fn:scan-left</code> is syntactically wrong.</li>
<li>The equivalent array functions are still missing (if we still believe we want to include them).</li>
<li>We need tests.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1902"><h2>Issue #1902 created<span class="toot-id"> #created-1902</span></h2><div class="pubdate">27 Mar at 10:20:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1902">https://github.com/qt4cg/qtspecs/issues/1902</a></div><details><summary>`binary:unpack-integer`, overflow/underflow</summary><div class="markup"><p>If <code>binary:unpack-integer</code> or <code>binary:unpack-unsigned-integer</code> generates a value that exceeds the range supported by the implementation, <code>err:FOAR0002</code> should be raised.</p>
<p>Related: https://github.com/expath/expath-cg/issues/116</p>
</div></details></div>
<div class="toot" id="created-1901"><h2>Pull request #1901 created<span class="toot-id"> #created-1901</span></h2><div class="pubdate">27 Mar at 00:44:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1901">https://github.com/qt4cg/qtspecs/pull/1901</a></div><details><summary>1363 fallback becomes a value not a function</summary><div class="markup"><p>Issue #1363 generated a large amount of discussion on how to handle absent keys in map:get() and out-of-range indexes in array:get().</p>
<p>I felt that one of the simplest proposals was to change the $fallback argument to be a simple default value, rather than a function. This eliminates some of the more "clever" use cases, but these can always be achieved in other ways, as the discussion thread demonstrates. Meanwhile reducing <code>$fallback</code> to a simple default value makes life easier for the 90% of cases where this is all that is needed (especially for arrays, when the desire is to return a default value rather than throwing an error).</p>
<p>This PR therefore implements that simple proposal.</p>
<p>Fix #1363</p>
</div></details></div>
<div class="toot" id="closed-1766"><h2>Issue #1766 closed<span class="toot-id"> #closed-1766</span></h2><div class="pubdate">26 Mar at 15:26:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1766">https://github.com/qt4cg/qtspecs/pull/1766</a></div><p>1715 Drop array bound checking</p></div>
<div class="toot" id="created-1900"><h2>Issue #1900 created<span class="toot-id"> #created-1900</span></h2><div class="pubdate">26 Mar at 14:13:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1900">https://github.com/qt4cg/qtspecs/issues/1900</a></div><details><summary>Records: instance checks</summary><div class="markup"><p>Continues #1862:</p>
<p>In the last meeting, we discussed whether the order of record entries should be considered in instance checks. After further reflection and attempts to implement it, I believe this will make things much easier in the long term:</p>
<p>In <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-item-coercion-rules">3.4.1 Item Coercion Rules</a>, the coercion of records was added as a second exceptional case: The coercion may change the item in question even if the upstream instance check is succesful. This leads to additional action that I believe could simply be avoided if the successful instance means that no further action is required. I think it will also reduce possible cost that was indicated in https://github.com/qt4cg/qtspecs/issues/1862#issuecomment-2709104860.</p>
<p>Note: This issue clearly focuses on implications for the implementation. From a user perspective, I assume it will hardly ever make a difference whether we consider order or not. My assumption is that nearly all records will have the expected order anyway, or they will match the order once the first coercion has taken place.</p>
<p>All this takes time to specify. I will be glad to make an attempt and write the PR.</p>
</div></details></div>
<div class="toot" id="closed-1899"><h2>Issue #1899 closed<span class="toot-id"> #closed-1899</span></h2><div class="pubdate">26 Mar at 08:42:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1899">https://github.com/qt4cg/qtspecs/pull/1899</a></div><p>Superflous whitespace change to nudge CI; apologies for the noise.</p></div>
<div class="toot" id="created-1899"><h2>Pull request #1899 created<span class="toot-id"> #created-1899</span></h2><div class="pubdate">26 Mar at 08:26:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1899">https://github.com/qt4cg/qtspecs/pull/1899</a></div><p>Superflous whitespace change to nudge CI; apologies for the noise.</p></div>
<div class="toot" id="closed-1660"><h2>Issue #1660 closed<span class="toot-id"> #closed-1660</span></h2><div class="pubdate">25 Mar at 20:23:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1660">https://github.com/qt4cg/qtspecs/issues/1660</a></div><p>Further suggestions for fn:path</p></div>
<div class="toot" id="closed-1747"><h2>Issue #1747 closed<span class="toot-id"> #closed-1747</span></h2><div class="pubdate">25 Mar at 20:05:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1747">https://github.com/qt4cg/qtspecs/issues/1747</a></div><p>Function finder is broken</p></div>
<div class="toot" id="closed-1858"><h2>Issue #1858 closed<span class="toot-id"> #closed-1858</span></h2><div class="pubdate">25 Mar at 19:07:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1858">https://github.com/qt4cg/qtspecs/pull/1858</a></div><p>Initial xsl:record</p></div>
<div class="toot" id="closed-1870"><h2>Issue #1870 closed<span class="toot-id"> #closed-1870</span></h2><div class="pubdate">25 Mar at 19:00:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1870">https://github.com/qt4cg/qtspecs/issues/1870</a></div><p>Rename $zero keyword of fold-left and fold-right</p></div>
<div class="toot" id="closed-1887"><h2>Issue #1887 closed<span class="toot-id"> #closed-1887</span></h2><div class="pubdate">25 Mar at 18:59:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1887">https://github.com/qt4cg/qtspecs/pull/1887</a></div><p>1870 rename $zero keyword of fold functions</p></div>
<div class="toot" id="closed-1886"><h2>Issue #1886 closed<span class="toot-id"> #closed-1886</span></h2><div class="pubdate">25 Mar at 18:48:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1886">https://github.com/qt4cg/qtspecs/pull/1886</a></div><p>1660 Additional options for fn:path</p></div>
<div class="toot" id="closed-1862"><h2>Issue #1862 closed<span class="toot-id"> #closed-1862</span></h2><div class="pubdate">25 Mar at 18:47:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1862">https://github.com/qt4cg/qtspecs/issues/1862</a></div><p>Records: consider order</p></div>
<div class="toot" id="closed-1874"><h2>Issue #1874 closed<span class="toot-id"> #closed-1874</span></h2><div class="pubdate">25 Mar at 18:47:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1874">https://github.com/qt4cg/qtspecs/pull/1874</a></div><p>1862 Coercing to a record type changes map order</p></div>
<div class="toot" id="closed-1861"><h2>Issue #1861 closed<span class="toot-id"> #closed-1861</span></h2><div class="pubdate">25 Mar at 18:46:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1861">https://github.com/qt4cg/qtspecs/issues/1861</a></div><p>xsl:next-match with-all-params</p></div>
<div class="toot" id="closed-1875"><h2>Issue #1875 closed<span class="toot-id"> #closed-1875</span></h2><div class="pubdate">25 Mar at 18:46:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1875">https://github.com/qt4cg/qtspecs/pull/1875</a></div><p>1861 Params passed automatically through next-match</p></div>
<div class="toot" id="created-1898"><h2>Pull request #1898 created<span class="toot-id"> #created-1898</span></h2><div class="pubdate">25 Mar at 15:33:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1898">https://github.com/qt4cg/qtspecs/pull/1898</a></div><details><summary>1624b Expand rules for document node subtyping</summary><div class="markup"><p>Fix #1624</p>
</div></details></div>
<div class="toot" id="created-1897"><h2>Pull request #1897 created<span class="toot-id"> #created-1897</span></h2><div class="pubdate">25 Mar at 11:57:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1897">https://github.com/qt4cg/qtspecs/pull/1897</a></div><details><summary>1876 In fn:replace(), merge the $replacement and $action parameters</summary><div class="markup"><p>Fix #1876</p>
</div></details></div>
<div class="toot" id="closed-1884"><h2>Issue #1884 closed<span class="toot-id"> #closed-1884</span></h2><div class="pubdate">25 Mar at 11:10:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1884">https://github.com/qt4cg/qtspecs/issues/1884</a></div><p>Deep-equality keys</p></div>
<div class="toot" id="created-1896"><h2>Issue #1896 created<span class="toot-id"> #created-1896</span></h2><div class="pubdate">25 Mar at 10:59:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1896">https://github.com/qt4cg/qtspecs/issues/1896</a></div><details><summary>Drop "parameter names" as a property of a function item</summary><div class="markup"><p>One of the properties of function items is the parameter names.</p>
<p>This property is unused; there is nothing that depends on the value of this property, and no way of discovering the value, and it isn't defined for all function items, e.g. maps and arrays, or functions returned by functions such as fn:op. It causes complications, such as whether two functions can have the same identity if they have different parameter names. I propose to drop it.</p>
<p>Of course, there are open issues that suggest allowing parameter names to be used in dynamic function calls. But I see little chance of coming up with a design that achieves this, because in general when you're given a function item to call, you have no idea what the parameter names are, and the person supplying the function item has very little control over what the parameter names will be.</p>
</div></details></div>
<div class="toot" id="created-1895"><h2>Pull request #1895 created<span class="toot-id"> #created-1895</span></h2><div class="pubdate">25 Mar at 10:15:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1895">https://github.com/qt4cg/qtspecs/pull/1895</a></div><details><summary>1881 Function identity for maps and arrays</summary><div class="markup"><p>Supplies rules for how <code>fn:function-identity()</code> should handle maps and arrays.</p>
<p>Also makes the point that labels are ignored. There's a general statement to the effect in XDM that labels are ignored except where otherwise specified, but it's useful to avoid any doubt here.</p>
<p>Fix #1881</p>
</div></details></div>
<div class="toot" id="closed-1892"><h2>Issue #1892 closed<span class="toot-id"> #closed-1892</span></h2><div class="pubdate">24 Mar at 18:07:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1892">https://github.com/qt4cg/qtspecs/pull/1892</a></div><p>Dnovatchev dn examples (ignore this)</p></div>
<div class="toot" id="created-1894"><h2>Pull request #1894 created<span class="toot-id"> #created-1894</span></h2><div class="pubdate">24 Mar at 17:32:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1894">https://github.com/qt4cg/qtspecs/pull/1894</a></div><details><summary>Additional examples to fn:chain - in a new branch</summary><div class="markup"><p>Re-submitted the same as PR 1890.
Added some new examples to fn:chain.</p>
</div></details></div>
<div class="toot" id="closed-1890"><h2>Issue #1890 closed<span class="toot-id"> #closed-1890</span></h2><div class="pubdate">24 Mar at 17:11:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1890">https://github.com/qt4cg/qtspecs/pull/1890</a></div><p>More examples added to fn:chain</p></div>
<div class="toot" id="closed-1893"><h2>Issue #1893 closed<span class="toot-id"> #closed-1893</span></h2><div class="pubdate">24 Mar at 17:01:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1893">https://github.com/qt4cg/qtspecs/pull/1893</a></div><p>Fix broken markup</p></div>
<div class="toot" id="created-1893"><h2>Pull request #1893 created<span class="toot-id"> #created-1893</span></h2><div class="pubdate">24 Mar at 16:48:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1893">https://github.com/qt4cg/qtspecs/pull/1893</a></div><details><summary>Fix broken markup</summary><div class="markup"><p>I cannot imagine how we got a merged PR that included broken markup, but it's probably made a mess of the diffs recently.</p>
</div></details></div>
<div class="toot" id="created-1892"><h2>Pull request #1892 created<span class="toot-id"> #created-1892</span></h2><div class="pubdate">24 Mar at 15:56:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1892">https://github.com/qt4cg/qtspecs/pull/1892</a></div><details><summary>Dnovatchev dn examples (ignore this)</summary><div class="markup"><p>This PR #1890 rebased off master to test if it makes for cleaner diffs.</p>
</div></details></div>
<div class="toot" id="created-1891"><h2>Issue #1891 created<span class="toot-id"> #created-1891</span></h2><div class="pubdate">24 Mar at 12:26:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1891">https://github.com/qt4cg/qtspecs/issues/1891</a></div><details><summary>`fn:parse-html`: `html-version`</summary><div class="markup"><p>Maybe we can align the HTML versions that <code>fn:parse-html</code> needs to support with the remaining specification. It currently says:</p>
<blockquote>
<p>Valid values an implementation must support for the <code>html</code> method are:
<code>3</code>, <code>3.2</code> for HTML 3.2 W3C Recommendation, 14 January 1997
<code>4</code>, <code>4.01</code> for HTML 4.01 W3C Recommendation, 24 December 1999
<code>5.0</code> for HTML5 W3C Recommendation, 28 October 2014
<code>5.1</code> for HTML 5.1 W3C Recommendation, 1 November 2016
<code>5.2</code> for HTML 5.2 W3C Recommendation, 14 December 2017
<code>LS</code> for HTML Living Standard, WHATWG
<code>5</code> may be equivalent to any of <code>5.0</code>, <code>5.1</code>, <code>5.2</code>, or <code>LS</code></p>
</blockquote>
<p>In the XQFO and Serialization specs, only HTML 4.0/4.01 and HTML 5 are mentioned.</p>
<p>@rhdunn Do you have an opinion on this?</p>
<p>Related: #1889</p>
</div></details></div>
<div class="toot" id="created-1890"><h2>Pull request #1890 created<span class="toot-id"> #created-1890</span></h2><div class="pubdate">23 Mar at 22:34:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1890">https://github.com/qt4cg/qtspecs/pull/1890</a></div><details><summary>More examples added to fn:chain</summary><div class="markup"><p>Added 6 more examples and tests
All are correctly executed.</p>
</div></details></div>
<div class="toot" id="created-1889"><h2>Issue #1889 created<span class="toot-id"> #created-1889</span></h2><div class="pubdate">20 Mar at 15:32:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1889">https://github.com/qt4cg/qtspecs/issues/1889</a></div><details><summary>HTML serialization: `html-version` and `version` parameters; allowed values</summary><div class="markup"><p>The serialization spec says (<a href="https://qt4cg.org/specifications/xslt-xquery-serialization-40/Overview.html#HTML_VERSION">HTML Output Method: the version and html-version Parameters</a>):</p>
<blockquote>
<p>If the <code>html-version</code> serialization parameter is not absent, the requested HTML version is the value of the <code>html-version</code> serialization parameter; otherwise, it is the value of the <code>version</code> serialization parameter.</p>
</blockquote>
<p><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-serialize">fn:serialize</a> defines the following defaults:</p>
<ul>
<li><code>html-version</code>: <code>5</code></li>
<li><code>version</code>: <code>1.0</code></li>
</ul>
<p>I wonder whether these rules cover all possible cases:</p>
<ol>
<li>Is it correct that HTML will be serialized as HTML5 if no options are supplied?</li>
</ol>
<pre><code class="language-xquery">(: html-version=5 :) 
serialize(&lt;html/&gt;, { 'method': 'html' })
</code></pre>
<ol start="2">
<li>If only <code>version</code> is supplied, is it correct that it is ignored because of <code>html-version</code> defaulting to <code>5</code>?</li>
</ol>
<pre><code class="language-xquery">(: html-version=5 ? :) 
serialize(&lt;html/&gt;, { 'method': 'html', 'version': '4.01' })
</code></pre>
<ol start="3">
<li>If no, i.e., if <code>{ 'version': '4.01' }</code> is expected to overwrite the default for <code>html-version</code>, how can we know at which stage the default values are to be considered?</li>
</ol>
<p>In addition, the serialization specification mentions versions HTML 4.01 and HTML5 various times, but it seems to be up to the implementation to decide which HTML versions to support. However, we seem to have test cases for <code>4.0</code> and <code>5</code>. Would it make sense to define a miminum set of versions that need to be supported?</p>
<p>Finally, for some reason, the <code>html-version</code> parameter was defined to be a decimal, whereas <code>version</code> is defined as a string (since XQFO 3.1). Maybe this leads to the surprising result that Saxon seems to accept the option <code>{ 'version': '4.0' }</code>, but rejects <code>{ 'html-version': 4 }</code>.</p>
</div></details></div>
<div class="toot" id="created-1888"><h2>Pull request #1888 created<span class="toot-id"> #created-1888</span></h2><div class="pubdate">20 Mar at 04:57:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1888">https://github.com/qt4cg/qtspecs/pull/1888</a></div><details><summary>366 xsl:package-location</summary><div class="markup"><p>First draft, for initial feedback.</p>
<p>Notes:</p>
<ul>
<li>Because the CG has little energy/resources to develop the EXPath Zip module, I have situated the question of archive (compressed or not) in the URI scheme itself. There are dozens of archives, dozens of URI schemes. The only case where I have found overlap is in the <code>jar:</code> scheme/archive. Yes, I've seen <code>zip:</code> used as an alias for <code>jar:</code>, but it's not an official IANA URI scheme. This may need discussion.</li>
<li>I have opted to bind <code>@priority</code> to a non-zero integer. This is the first time the constraint for the union of positive and negative integers has been placed on an XSLT attribute, so I may not have correctly set up <code>element-catalog.xml</code>.</li>
<li>I have opted to not make attribute values <code>format</code>, <code>name</code>, and <code>version</code> as criteria for the priority package location (new term), so that developers can be warned when the package is at odds with the declaration. To make them criteria would mean that inconsistencies between the declaration and the referenced packages would remain undetected.</li>
<li>I adopted the terms "URL" and "entry" based upon the IANA nomenclature for the jar: scheme.</li>
<li>I may have overthought the distinction between archive and non-archive URIs. Feedback is appreciated.</li>
<li>Error code <code>3000</code> has been broken up into different possible errors.</li>
<li>Suggestions on the type and number of tests that need to be written for the test suite are welcome.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1887"><h2>Pull request #1887 created<span class="toot-id"> #created-1887</span></h2><div class="pubdate">18 Mar at 21:29:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1887">https://github.com/qt4cg/qtspecs/pull/1887</a></div><details><summary>1870 rename $zero keyword of fold functions</summary><div class="markup"><p>Fix #1870</p>
</div></details></div>
<div class="toot" id="closed-998"><h2>Issue #998 closed<span class="toot-id"> #closed-998</span></h2><div class="pubdate">18 Mar at 20:54:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/998">https://github.com/qt4cg/qtspecs/issues/998</a></div><p>regular expression addition - lookbehind assertions and lookahead assertions</p></div>
<div class="toot" id="closed-1848"><h2>Issue #1848 closed<span class="toot-id"> #closed-1848</span></h2><div class="pubdate">18 Mar at 20:53:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1848">https://github.com/qt4cg/qtspecs/issues/1848</a></div><p>Define regular expressions using XSD 1.1 as baseline</p></div>
<div class="toot" id="closed-1856"><h2>Issue #1856 closed<span class="toot-id"> #closed-1856</span></h2><div class="pubdate">18 Mar at 20:50:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1856">https://github.com/qt4cg/qtspecs/pull/1856</a></div><p>998 Add boundary and lookahead/behind assertions</p></div>
<div class="toot" id="created-1886"><h2>Pull request #1886 created<span class="toot-id"> #created-1886</span></h2><div class="pubdate">18 Mar at 18:33:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1886">https://github.com/qt4cg/qtspecs/pull/1886</a></div><p>1660 Additional options for fn:path</p></div>
<div class="toot" id="closed-1860"><h2>Issue #1860 closed<span class="toot-id"> #closed-1860</span></h2><div class="pubdate">18 Mar at 17:36:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1860">https://github.com/qt4cg/qtspecs/issues/1860</a></div><p>fn:parse-xml: DTDs, external resources</p></div>
<div class="toot" id="closed-1857"><h2>Issue #1857 closed<span class="toot-id"> #closed-1857</span></h2><div class="pubdate">18 Mar at 17:36:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1857">https://github.com/qt4cg/qtspecs/issues/1857</a></div><p>fn:parse-xml: `xinclude`</p></div>
<div class="toot" id="closed-1879"><h2>Issue #1879 closed<span class="toot-id"> #closed-1879</span></h2><div class="pubdate">18 Mar at 17:36:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1879">https://github.com/qt4cg/qtspecs/pull/1879</a></div><p>1857, 1860: Add more options to parse-xml</p></div>
<div class="toot" id="closed-1882"><h2>Issue #1882 closed<span class="toot-id"> #closed-1882</span></h2><div class="pubdate">18 Mar at 17:34:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1882">https://github.com/qt4cg/qtspecs/pull/1882</a></div><p>982 Editorial rewrite of scan-left and scan-right</p></div>
<div class="toot" id="closed-1866"><h2>Issue #1866 closed<span class="toot-id"> #closed-1866</span></h2><div class="pubdate">18 Mar at 17:32:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1866">https://github.com/qt4cg/qtspecs/issues/1866</a></div><p>Ambiguities introduced by #1864</p></div>
<div class="toot" id="closed-1877"><h2>Issue #1877 closed<span class="toot-id"> #closed-1877</span></h2><div class="pubdate">18 Mar at 17:32:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1877">https://github.com/qt4cg/qtspecs/pull/1877</a></div><p>1866 Disambiguate TypeSpecifier syntax</p></div>
<div class="toot" id="closed-1867"><h2>Issue #1867 closed<span class="toot-id"> #closed-1867</span></h2><div class="pubdate">18 Mar at 17:30:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1867">https://github.com/qt4cg/qtspecs/pull/1867</a></div><p>1341 Drop position from fold callbacks</p></div>
<div class="toot" id="closed-1869"><h2>Issue #1869 closed<span class="toot-id"> #closed-1869</span></h2><div class="pubdate">18 Mar at 17:28:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1869">https://github.com/qt4cg/qtspecs/issues/1869</a></div><p>`fn:duplicate-values`: Order of results</p></div>
<div class="toot" id="closed-1873"><h2>Issue #1873 closed<span class="toot-id"> #closed-1873</span></h2><div class="pubdate">18 Mar at 17:28:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1873">https://github.com/qt4cg/qtspecs/pull/1873</a></div><p>1869 duplicate values</p></div>
<div class="toot" id="closed-1851"><h2>Issue #1851 closed<span class="toot-id"> #closed-1851</span></h2><div class="pubdate">18 Mar at 17:26:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1851">https://github.com/qt4cg/qtspecs/issues/1851</a></div><p>Questions on `fn:atomic-type-annotation`</p></div>
<div class="toot" id="closed-1878"><h2>Issue #1878 closed<span class="toot-id"> #closed-1878</span></h2><div class="pubdate">18 Mar at 17:26:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1878">https://github.com/qt4cg/qtspecs/pull/1878</a></div><p>1851 Make ?variety optional; explain namespace-sensitive</p></div>
<div class="toot" id="closed-1863"><h2>Issue #1863 closed<span class="toot-id"> #closed-1863</span></h2><div class="pubdate">18 Mar at 17:24:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1863">https://github.com/qt4cg/qtspecs/issues/1863</a></div><p>add \U \u L \u \E to replace() (case conversion)</p></div>
<div class="toot" id="closed-1880"><h2>Issue #1880 closed<span class="toot-id"> #closed-1880</span></h2><div class="pubdate">18 Mar at 17:23:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1880">https://github.com/qt4cg/qtspecs/pull/1880</a></div><p>Editorial revision of fn:function-identity</p></div>
<div class="toot" id="created-1885"><h2>Issue #1885 created<span class="toot-id"> #created-1885</span></h2><div class="pubdate">18 Mar at 16:51:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1885">https://github.com/qt4cg/qtspecs/issues/1885</a></div><details><summary>Use the spcification grammar markup to define the regular expression grammar in F&amp;O</summary><div class="markup"><p>The grammar for regular expressions in the regular expression section of F&amp;O is currently defined as a code block. Making it use the grammar markup used to define the pattern, XPath, and XQuery grammars would:</p>
<ol>
<li>give the grammar a unified appearance with the other grammars;</li>
<li>allow grammar elements to be cross referenced and linked back to the grammar.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1884"><h2>Issue #1884 created<span class="toot-id"> #created-1884</span></h2><div class="pubdate">17 Mar at 18:18:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1884">https://github.com/qt4cg/qtspecs/issues/1884</a></div><details><summary>Deep-equality keys</summary><div class="markup"><p>Issue #119 proposes extending maps to allow arbitrary values as keys. This is very difficult to achieve, (a) because the fact that keys are atomic items is deeply embedded in the design of a number of functions and operations on maps, and (b) because it's very hard to define an equality function that suits everyone.</p>
<p>The way we tacked variable equality semantics for strings was via the collation-key() function, which takes a string and a collation as input and produces an opaque key value, which can be used as a key in maps, and which reflects the desired equality semantics.</p>
<p>We could extend the same idea to values other than strings. In particular, we could define a deep-equality-key() that can be calculated for any sequence, and that takes all the matching options of the deep-equal() function as a parameter. (We could then redefine <code>deep-equal(a, b, options)</code> to mean <code>deep-equality-key(a, options) eq deep-equality-key(b, options)</code>).</p>
<p>The main drawback is that the deep-equality-keys for large node trees or maps would be rather long strings. People might use the functionality without realising the expense.</p>
<p>Another problem is that one of our options in deep-equals() is a callback function for item equality, and we couldn't replicate this when computing a key. But this callback is the only way we have, for example, to compare nodes by identity rather than by content.</p>
<p>Note that an internal deep-equality-key concept (or at least a deep-equality hashcode) is needed anyway for efficient implementation of deep-equals where order is deemed irrelevant. Without it, the function becomes O(n^2). Quite independently of this proposal, we should perhaps have an explicit option on deep-equals() to compare nodes by identity.</p>
</div></details></div>
<div class="toot" id="closed-1296"><h2>Issue #1296 closed<span class="toot-id"> #closed-1296</span></h2><div class="pubdate">17 Mar at 09:47:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1296">https://github.com/qt4cg/qtspecs/pull/1296</a></div><p>982 Rewrite of scan-left and scan-right</p></div>
<div class="toot" id="created-1883"><h2>Pull request #1883 created<span class="toot-id"> #created-1883</span></h2><div class="pubdate">16 Mar at 18:19:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1883">https://github.com/qt4cg/qtspecs/pull/1883</a></div><details><summary>882 Replace fn:chain by fn:compose</summary><div class="markup"><p>Drops the existing fn:chain function and replaces it with a new fn:compose function.</p>
<p>This combines two separate changes:</p>
<p>(a) whereas fn:chain applies a sequence of functions to an input, fn:compose returns a composite function that can be used repeatedly with different inputs.</p>
<p>(b) the fn:compose function is restricted to arity-1 functions, which leads to a much simpler specification that still handles the vast majority of practical use cases.</p>
<p>In particular, note that if the sequence of functions to be applied is statically known, then it can always be written out explicitly; the real use case for this function is when the sequence of functions is constructed dynamically. And in this situation, fn:chain in its current form can easily fail because of problems with the arity of the functions included in the chain.</p>
</div></details></div>
<div class="toot" id="closed-1865"><h2>Issue #1865 closed<span class="toot-id"> #closed-1865</span></h2><div class="pubdate">16 Mar at 17:13:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><p>Callback functions, position argument: consistency</p></div>
<div class="toot" id="created-1882"><h2>Pull request #1882 created<span class="toot-id"> #created-1882</span></h2><div class="pubdate">16 Mar at 00:09:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1882">https://github.com/qt4cg/qtspecs/pull/1882</a></div><details><summary>982 Editorial rewrite of scan-left and scan-right</summary><div class="markup"><p>This is intended to be purely an editorial rewrite, it does not change the functionality.</p>
<p>Replaces #1296.</p>
<p>Addresses #982, but we still need to add corresponding functions for arrays.</p>
</div></details></div>
<div class="toot" id="created-1881"><h2>Issue #1881 created<span class="toot-id"> #created-1881</span></h2><div class="pubdate">15 Mar at 08:28:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1881">https://github.com/qt4cg/qtspecs/issues/1881</a></div><details><summary>fn:function-identity for maps and arrays</summary><div class="markup"><p>The data model spec says that function identity is not defined for maps and arrays.</p>
<p>The specification of fn:function-identity() fails to mention this fact.</p>
</div></details></div>
<div class="toot" id="created-1880"><h2>Pull request #1880 created<span class="toot-id"> #created-1880</span></h2><div class="pubdate">15 Mar at 01:16:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1880">https://github.com/qt4cg/qtspecs/pull/1880</a></div><details><summary>Editorial revision of fn:function-identity</summary><div class="markup"><p>Tidies up the text and adds examples</p>
</div></details></div>
<div class="toot" id="created-1879"><h2>Pull request #1879 created<span class="toot-id"> #created-1879</span></h2><div class="pubdate">14 Mar at 15:50:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1879">https://github.com/qt4cg/qtspecs/pull/1879</a></div><details><summary>1857, 1860: Add more options to parse-xml</summary><div class="markup"><p>Add options to control entity expansion and XInclude processing.</p>
<p>Fix #1857
Fix #1860</p>
</div></details></div>
<div class="toot" id="created-1878"><h2>Pull request #1878 created<span class="toot-id"> #created-1878</span></h2><div class="pubdate">14 Mar at 14:58:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1878">https://github.com/qt4cg/qtspecs/pull/1878</a></div><details><summary>1851 Make ?variety optional; explain namespace-sensitive</summary><div class="markup"><p>Fix #1851</p>
<p>Allow ?variety to be absent e.g. for xs:anySimpleType</p>
<p>Define namespace-sensitive by an xtermref to the definition in the XP/XQ spec.</p>
</div></details></div>
<div class="toot" id="created-1877"><h2>Pull request #1877 created<span class="toot-id"> #created-1877</span></h2><div class="pubdate">14 Mar at 14:38:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1877">https://github.com/qt4cg/qtspecs/pull/1877</a></div><details><summary>1866 Disambiguate TypeSpecifier syntax</summary><div class="markup"><p>Fix #1866</p>
</div></details></div>
<div class="toot" id="created-1876"><h2>Issue #1876 created<span class="toot-id"> #created-1876</span></h2><div class="pubdate">14 Mar at 13:10:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1876">https://github.com/qt4cg/qtspecs/issues/1876</a></div><details><summary>`fn:replace`:  Combine $replacement and $action parameters</summary><div class="markup"><p>We could combine the competing <code>$replacement</code> and <code>$action</code> parameters:</p>
<pre><code class="language-xquery">replace(
  'this is a test',
  '(\w)(\w+)?',
  fn($s, $g) { upper-case($g[1]) || lower-case($g[2]) }
)
</code></pre>
<p>Original comment: https://github.com/qt4cg/qtspecs/issues/1863#issuecomment-2711149296</p>
</div></details></div>
<div class="toot" id="created-1875"><h2>Pull request #1875 created<span class="toot-id"> #created-1875</span></h2><div class="pubdate">14 Mar at 11:27:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1875">https://github.com/qt4cg/qtspecs/pull/1875</a></div><details><summary>1861 Params passed automatically through next-match</summary><div class="markup"><p>Fix #1861</p>
</div></details></div>
<div class="toot" id="created-1874"><h2>Pull request #1874 created<span class="toot-id"> #created-1874</span></h2><div class="pubdate">14 Mar at 10:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1874">https://github.com/qt4cg/qtspecs/pull/1874</a></div><details><summary>1862 Coercing to a record type changes map order</summary><div class="markup"><p>Fix #1862</p>
</div></details></div>
<div class="toot" id="created-1873"><h2>Pull request #1873 created<span class="toot-id"> #created-1873</span></h2><div class="pubdate">14 Mar at 09:55:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1873">https://github.com/qt4cg/qtspecs/pull/1873</a></div><details><summary>1869 duplicate values</summary><div class="markup"><p>Fix #1869</p>
</div></details></div>
<div class="toot" id="created-1872"><h2>Issue #1872 created<span class="toot-id"> #created-1872</span></h2><div class="pubdate">13 Mar at 11:31:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1872">https://github.com/qt4cg/qtspecs/issues/1872</a></div><details><summary>Arrays: members → values / entries?</summary><div class="markup"><p>I am pretty sure the first reaction will be DONT!, but for the sake of consistency it seems important enough for me to bring this up:</p>
<p>Could we rename array “members” to “values”?</p>
<p>Some advantages that I would see:</p>
<ul>
<li>We could treat arrays and maps more similarly.</li>
<li>We already have a <code>values</code> lookup key specifier for arrays.</li>
<li>No 3.1 array function contains the string “member”, so we will not introduce any backward inconsistencies.</li>
<li>All 4.0 features that use this string could be safely renamed.</li>
</ul>
<p>Of course the term “values” is a very common one, but we have to decided to stick with “map values” – and arrays and maps are very similar.</p>
<p>Finally, I noticed that also the term “member” has different meanings in the spec and is not exclusively used for arrays (e.g. in the rules for <code>fn:innermost</code>, <code>fn:format-integer</code> or for members of union types).</p>
</div></details></div>
<div class="toot" id="closed-1338"><h2>Issue #1338 closed<span class="toot-id"> #closed-1338</span></h2><div class="pubdate">13 Mar at 10:40:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1338">https://github.com/qt4cg/qtspecs/issues/1338</a></div><p>Arrays and maps: Members, entries, values, contents, pairs, …</p></div>
<div class="toot" id="created-1871"><h2>Issue #1871 created<span class="toot-id"> #created-1871</span></h2><div class="pubdate">13 Mar at 10:39:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1871">https://github.com/qt4cg/qtspecs/issues/1871</a></div><details><summary>Arrays and maps: consistency</summary><div class="markup"><h3>Suggestions (based on #1338, related: #1868)</h3>
<ol>
<li>In symmetry with the <code>pairs</code> lookup specifier, we should add <code>array:pairs</code> and an inverse <code>array:of-pairs</code> function.</li>
<li>In symmetry with the <code>values</code> lookup specifier, we should add <code>array:values</code> and <code>map:values</code> functions, to retrieve the values of maps and the members of arrays in a sequence of arrays.</li>
<li>In return, <code>array:members</code> and <code>array:of-members</code> seem redundant, and we should drop them.</li>
<li>In analogy with the <code>keys</code> specifier and <code>map:keys</code>, we should add <code>array:keys</code> (which returns a dense integer range).</li>
</ol>
<h3>Background</h3>
<p>With version 4.0, we are adding a lot of promising and powerful new map and array features. This is a big step forward, compared to the obvious limitations of 3.1.</p>
<p>Some aspects of the 3.1 design have made it difficult (or impossible) to fully adjust array and maps, but (in my opinion) the old overall concept was impressively consistent – and it is definitely a big challenge to achieve a 4.0 design that is not too fragmented.</p>
<p>To me, this becomes particularly evident in the case of arrays. The following example sums up the items of all members of an array. For the cumbersome 3.1 solution…</p>
<pre><code class="language-xquery">for $pos in 1 to array:size($array)
return sum($array($pos))
</code></pre>
<p>…we now have several (roughly?) equivalent options to do this:</p>
<ol>
<li><code>for member $m in $array return sum($m)</code></li>
<li><code>array:members($array) ! sum(?value)</code></li>
<li><code>$array?pairs::* ! sum(?value)</code></li>
<li><code>$array?values::* ! sum(.)</code></li>
</ol>
<p>The examples above imply that:</p>
<ul>
<li>for 1., an <em>array member</em> is a sequence;</li>
<li>for 2., an <em>array member</em> is a map;</li>
<li>for 3., an <em>array</em> has pairs (but there is no <code>array:pairs</code>);</li>
<li>for 4., an <em>array</em> has values (but there is no <code>array:values</code>).</li>
</ul>
</div></details></div>
<div class="toot" id="created-1870"><h2>Issue #1870 created<span class="toot-id"> #created-1870</span></h2><div class="pubdate">12 Mar at 22:19:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1870">https://github.com/qt4cg/qtspecs/issues/1870</a></div><details><summary>Rename $zero keyword of fold-left and fold-right</summary><div class="markup"><p>I find the name $zero for this parameter unhelpful and confusing.</p>
<p>I suggest <code>$accum</code>, short for "accumulator" or "accumulated result".</p>
</div></details></div>
<div class="toot" id="created-1869"><h2>Issue #1869 created<span class="toot-id"> #created-1869</span></h2><div class="pubdate">12 Mar at 18:44:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1869">https://github.com/qt4cg/qtspecs/issues/1869</a></div><details><summary>`fn:duplicate-values`: Order of results</summary><div class="markup"><p>With https://github.com/qt4cg/qtspecs/pull/987, a rule was added to <code>fn:duplicate-values</code>:</p>
<blockquote>
<p>For any set of values that compare equal, the one that is returned is the one that appears first in $values.</p>
</blockquote>
<p>I think we should adapt the behavior to return the duplicates in the order they appear, not the original values:</p>
<ul>
<li>A common use case for this function is to find the first duplicate in a list.</li>
<li>If we return the original values in the correct order, we need to parse the full sequence before we can know which will be the first result. A worst-case example:</li>
</ul>
<pre><code class="language-xquery">(0x7FFFFFFFFFFFFFFF, 1, 1 to 0x7FFFFFFFFFFFFFFF)
=&gt; duplicate-values()
=&gt; head()
</code></pre>
</div></details></div>
<div class="toot" id="created-1868"><h2>Issue #1868 created<span class="toot-id"> #created-1868</span></h2><div class="pubdate">12 Mar at 18:19:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1868">https://github.com/qt4cg/qtspecs/issues/1868</a></div><details><summary>array:members() to include index position</summary><div class="markup"><p>Currently <code>array:members(["a", "b"])</code> returns</p>
<pre><code>{'value': "a"},
{'value': "b"}
</code></pre>
<p>I suggest that it should instead return</p>
<pre><code>{'key': 1, 'value': "a"},
{'key': 2, 'value': "b"}
</code></pre>
<p>The extra information is useful for any operation that wants to take account of positions as well as values. For example, rearranging an array into multiple columns. Using the names "key" and "value" also means that the data is suitable for converting an array to a map by means of <code>map:of-pairs</code>.</p>
<p>The function array:of-members() should change to accept <code>record('value', *)</code> (making the record type extensible) so that the key part is ignored if present.</p>
</div></details></div>
<div class="toot" id="created-1867"><h2>Pull request #1867 created<span class="toot-id"> #created-1867</span></h2><div class="pubdate">12 Mar at 18:02:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1867">https://github.com/qt4cg/qtspecs/pull/1867</a></div><details><summary>1341 Drop position from fold callbacks</summary><div class="markup"><p>Following up on issue 1341, we decided to drop the position argument from the 4 fold functions.</p>
<p>Most of the changes in this PR are dealing with the collateral damage - changes to "formal equivalents" of other functions that previously relied on fold-left having the position available to the callback function.</p>
</div></details></div>
<div class="toot" id="created-1866"><h2>Issue #1866 created<span class="toot-id"> #created-1866</span></h2><div class="pubdate">12 Mar at 08:15:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1866">https://github.com/qt4cg/qtspecs/issues/1866</a></div><details><summary>Ambiguities introduced by #1864</summary><div class="markup"><p>The grammar check done by <a href="https://github.com/GuntherRademacher/rex-parser-generator/tree/main/docs/sample-grammars/XQuery-40">RExification of XQuery and XPath 4.0 Grammars</a> has detected a bunch of LALR(2) conflicts caused by the recent addition of <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-TypeSpecifier"><code>TypeSpecifier</code></a> to the <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-UnaryLookup-KeySpecifier"><code>KeySpecifier</code></a> production.</p>
<p>In fact these are ambiguities between following being used as a <code>QName</code> (via <code>EQName</code>, <code>TypeName</code>), or as a keyword:</p>
<ul>
<li><code>array</code></li>
<li><code>attribute</code></li>
<li><code>comment</code></li>
<li><code>document-node</code></li>
<li><code>element</code></li>
<li><code>empty-sequence</code></li>
<li><code>enum</code></li>
<li><code>fn</code></li>
<li><code>function</code></li>
<li><code>item</code></li>
<li><code>map</code></li>
<li><code>namespace-node</code></li>
<li><code>node</code></li>
<li><code>processing-instruction</code></li>
<li><code>record</code></li>
<li><code>schema-attribute</code></li>
<li><code>schema-element</code></li>
<li><code>text</code></li>
</ul>
<p>E.g. <code>element</code> in</p>
<pre><code>$A?~element()
</code></pre>
<p>can be parsed as an element test, <code>element()</code>, or as a type name <code>element</code> followed by a <code>PositionalArgumentList</code>. This is similar to what the "reserved-function-names" constraint covers, but that does not apply here because there is no function name involved.</p>
<p>The <code>SequenceType</code> in <code>TypeSpecifier</code>, enclosed in extra parenthese, does not present a problem, so my proposal is to drop <code>ItemType</code> from <code>TypeSpecifier</code> and rewrite the production to</p>
<pre><code>TypeSpecifier
         ::= '~' '(' SequenceType ')' 
</code></pre>
</div></details></div>
<div class="toot" id="created-1865"><h2>Issue #1865 created<span class="toot-id"> #created-1865</span></h2><div class="pubdate">11 Mar at 20:37:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1865">https://github.com/qt4cg/qtspecs/issues/1865</a></div><details><summary>Callback functions, position argument: consistency</summary><div class="markup"><ul>
<li>In https://github.com/qt4cg/qtspecs/pull/1735#issuecomment-2715090198, it was decided to remove the position argument from <code>fn:fold-left</code> and <code>fn:fold-right</code>. → #1867</li>
<li>As maps are ordered now, we should add the position argument to iterative map functions (e.g., <code>map:for-each</code>; basically all functions for which equivalent sequence and array functions exist).</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1227"><h2>Issue #1227 closed<span class="toot-id"> #closed-1227</span></h2><div class="pubdate">11 Mar at 17:41:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1227">https://github.com/qt4cg/qtspecs/pull/1227</a></div><p>150 PR resubmission for fn ranks</p></div>
<div class="toot" id="closed-1456"><h2>Issue #1456 closed<span class="toot-id"> #closed-1456</span></h2><div class="pubdate">11 Mar at 17:04:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1456">https://github.com/qt4cg/qtspecs/issues/1456</a></div><p>Filtering by type in lookup expressions</p></div>
<div class="toot" id="closed-1864"><h2>Issue #1864 closed<span class="toot-id"> #closed-1864</span></h2><div class="pubdate">11 Mar at 17:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="closed-1740"><h2>Issue #1740 closed<span class="toot-id"> #closed-1740</span></h2><div class="pubdate">11 Mar at 17:02:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1740">https://github.com/qt4cg/qtspecs/pull/1740</a></div><p>1725b Further elaboration of duplicates handling in maps</p></div>
<div class="toot" id="closed-1735"><h2>Issue #1735 closed<span class="toot-id"> #closed-1735</span></h2><div class="pubdate">11 Mar at 17:02:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><p>1341 Drop $position callback from many functions</p></div>
<div class="toot" id="closed-1794"><h2>Issue #1794 closed<span class="toot-id"> #closed-1794</span></h2><div class="pubdate">11 Mar at 15:16:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1794">https://github.com/qt4cg/qtspecs/issues/1794</a></div><p>Lookup: select all except</p></div>
<div class="toot" id="closed-1778"><h2>Issue #1778 closed<span class="toot-id"> #closed-1778</span></h2><div class="pubdate">10 Mar at 16:22:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1778">https://github.com/qt4cg/qtspecs/pull/1778</a></div><p>1456 Lookup expressions filtered by type</p></div>
<div class="toot" id="created-1864"><h2>Pull request #1864 created<span class="toot-id"> #created-1864</span></h2><div class="pubdate">10 Mar at 16:21:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1864">https://github.com/qt4cg/qtspecs/pull/1864</a></div><details><summary>1456 Lookup expressions filtered by type</summary><div class="markup"><p>Fix #1456</p>
<p>Technically identical to PR #1778, but reworked because it had become impossible to resolve the merge conflicts.</p>
</div></details></div>
<div class="toot" id="created-1863"><h2>Issue #1863 created<span class="toot-id"> #created-1863</span></h2><div class="pubdate">10 Mar at 05:49:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1863">https://github.com/qt4cg/qtspecs/issues/1863</a></div><details><summary>add \U \u L \u \E to replace() (case conversion)</summary><div class="markup"><p>Many systems using regular expressions support case conversion in the replacement strings.</p>
<p>For example,</p>
<pre><code class="language-bash">sed -e 's/[aA]*/\L\u&amp;/'
</code></pre>
<p>given AAA as input, produces Aaa.</p>
<p>It’s not 100% clear to me its worth adding, since an action function can do the same thing with more or less work,
but for reference,</p>
<p>\U turns the replaced text into upper case until \E, \L, or the end of the replacement string
\L turns the replaces text to lower case in the same way
\u and \l affect the single next character and operate independently of \U, \L, \E.</p>
<p>I wrote up some more precise spec text and can make a pull request; the case in the sed example above is common in text conversion projects but slightly tricky to get right with a function,</p>
<pre><code>          fn { upper-case(substring(., 1, 1)) || lower-case(substring(., 2) }
</code></pre>
<p>This is simple, but consider <code>\2 \L\u\1\3</code> as a function, where <code>\1</code> may be empty.</p>
<p>Overall i don’t have strong feelings either way, except that supporting them may help people migrate from other systems or languages. \E feels uncomfortably procedural. In Perl and libpcre i think, \E also turns of \Q (which disables all metadata characters up until \E).</p>
<p>Like &lt; and &gt; in patterns, \L and friends can be emulated with some care, but that’s true of a lot of regular expression syntax, and one point of the shorthands (as i see it) is to move the feature towards being accessible by people with less of a programming background.</p>
</div></details></div>
<div class="toot" id="created-1862"><h2>Issue #1862 created<span class="toot-id"> #created-1862</span></h2><div class="pubdate">09 Mar at 18:55:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1862">https://github.com/qt4cg/qtspecs/issues/1862</a></div><details><summary>Records: consider order</summary><div class="markup"><p>I think we should make the order of record entries part of instance checks and coercion rules:</p>
<ol>
<li>It will be less confusing for users if records have a well-defined order (similar to objects in OOL), in particular if records are serialized.</li>
<li>It will be much easier for implementations to access record entries by their internal index if the order is statically known. There will still be opportunities for optimizing lookups in arbitrary maps (index-based access has generally become easier with maps being ordered).</li>
</ol>
</div></details></div>
<div class="toot" id="created-1861"><h2>Issue #1861 created<span class="toot-id"> #created-1861</span></h2><div class="pubdate">07 Mar at 08:27:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1861">https://github.com/qt4cg/qtspecs/issues/1861</a></div><details><summary>xsl:next-match with-all-params</summary><div class="markup"><h2>Problem</h2>
<p>The <code>&lt;xsl:next-match&gt;</code> instruction is useful when writing local templates to customize the behavior of an imported XSLT. Unfortunately, there is a limitation due to the fact that <code>&lt;xsl:next-match&gt;</code> does not pass along parameters unless the parameters are defined as tunneling or the parameters are explicitly coded using <code>&lt;xsl:with-param&gt;</code>.</p>
<p>The fact that <code>&lt;xsl:next-match&gt;</code> does not automatically pass along parameters can be surprising or lead to cumbersome workarounds, and limits how <code>&lt;xsl:next-match&gt;</code> can be used when writing local templates to customize the behavior of imported XSLT.</p>
<ul>
<li>
<p>In situations where parameters are defined in an imported XSLT it might not be feasible to change parameters to tunneling.</p>
</li>
<li>
<p>In situations where a variety of parameters might be in scope when a template that uses <code>&lt;xsl:next-match&gt;</code> is invoked, currently each parameter needs to be explicitly coded using <code>&lt;xsl:param&gt;</code> and <code>&lt;xsl:with-param&gt;</code> in <code>&lt;xsl:next-match&gt;</code>, even though the parameters might not be relevant to the purpose or logic of the template. This may lead to fragile and less maintainable code and increases the cognitive load for developers, especially when working with complex, multi-layered stylesheets.</p>
</li>
</ul>
<p>This proposal aims to simplify the use of the <code>&lt;xsl:next-match&gt;</code> instruction while being backwards compatible.</p>
<h2>Proposal</h2>
<ul>
<li>
<p>Add an option to <code>&lt;xsl:next-match&gt;</code> to enable passing along all parameters. This option might take the form of a new optional attribute on <code>&lt;xsl:next-match&gt;</code> named <code>with-all-params</code> (this name is similar to the existing element name <code>&lt;xsl:with-param&gt;</code>) that takes a yes/no (or Boolean) value and defaults to no (false).</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="no"/&gt;</code> would operate the same as <code>&lt;xsl:next-match/&gt;</code> currently does.</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="yes"/&gt;</code> would operate the same as <code>&lt;xsl:next-match/&gt;</code> currently does with the difference that all parameters that were in scope when the current template was invoked will remain in scope for the next matching template.</p>
</li>
<li>
<p>An instruction <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> that contains <code>&lt;xsl:with-param&gt;</code> should operate the same as described in the preceding paragraph with the difference that parameters defined by <code>&lt;xsl:with-param&gt;</code> will also be in scope for the next matching template.</p>
</li>
<li>
<p>If a parameter defined by <code>&lt;xsl:with-param&gt;</code> within <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> has the same name as a parameter that was in scope when the current template was invoked, then the effective value of that parameter should be the value defined by <code>&lt;xsl:with-param&gt;</code>. This will allow a template to override parameters when necessary.</p>
</li>
</ul>
<p>To summarize, <code>&lt;xsl:next-match with-all-params="yes"&gt;</code> should invoke the next matching template and automatically pass along all parameters that were in scope when the current template was invoked, and optionally allow using <code>&lt;xsl:with-param&gt;</code> to set additional parameters or modify parameter values.</p>
<h2>Example</h2>
<p>Given this input document:</p>
<pre><code class="language-xml">&lt;!-- input.xml --&gt;
&lt;section&gt;
    &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;

</code></pre>
<p>This stylesheet <code>import.xsl</code> provides a set of base templates. The template matching element "p" uses <code>&lt;xsl:next-match/&gt;</code> in it's current (default) operation.</p>
<pre><code class="language-xml">&lt;!-- import.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0" expand-text="yes"&gt;
    
    &lt;xsl:output indent="yes"/&gt;
    &lt;xsl:mode on-no-match="shallow-copy"/&gt;
    
    &lt;xsl:template match="section"&gt;
        &lt;section&gt;
            &lt;xsl:apply-templates&gt;
                &lt;xsl:with-param name="a" select="'a'"/&gt;
                &lt;xsl:with-param name="b" select="'b'"/&gt;
            &lt;/xsl:apply-templates&gt;
        &lt;/section&gt;
    &lt;/xsl:template&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;xsl:param name="a"/&gt;
        &lt;xsl:param name="b"/&gt;
        &lt;xsl:param name="c"/&gt;
        &lt;p&gt;a {$a}&lt;/p&gt;
        &lt;p&gt;b {$b}&lt;/p&gt;
        &lt;p&gt;c {$c}&lt;/p&gt;
        &lt;xsl:next-match/&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This is the output of the above stylesheet <code>import.xsl</code> and the input document:</p>
<pre><code class="language-xml">&lt;section&gt;
   &lt;p&gt;a a&lt;/p&gt;
   &lt;p&gt;b b&lt;/p&gt;
   &lt;p&gt;c &lt;/p&gt;
   &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;
</code></pre>
<p>This stylesheet <code>before.xsl</code> imports the stylesheet <code>import.xsl</code> and defines a template to customize how <code>&lt;p&gt;</code> elements are processed. The parameter <code>$a</code> needs to be intercepted and forwarded even though this template is not doing anything with <code>$a</code>. The parameter <code>$b</code> is overridden, and the parameter <code>$c</code> is added within <code>&lt;xsl:next-match&gt;</code>.</p>
<pre><code class="language-xml">&lt;!-- before.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0"&gt;
    
    &lt;xsl:import href="import.xsl"/&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;xsl:param name="a"/&gt;
        &lt;p&gt;customization&lt;/p&gt;
        &lt;xsl:next-match&gt;
            &lt;xsl:with-param name="a" select="$a"/&gt;
            &lt;xsl:with-param name="b" select="'buzz'"/&gt;
            &lt;xsl:with-param name="c" select="'c'"/&gt;
        &lt;/xsl:next-match&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This stylesheet <code>after.xsl</code> does the same thing as the previous stylesheet but uses <code>with-all-params="yes"</code>. The template does not need to intercept and forward the parameter <code>$a</code> because this is handled automatically by <code>with-all-params="yes"</code>. The parameter <code>$b</code> is overridden, and the parameter <code>$c</code> is added within <code>&lt;xsl:next-match&gt;</code> in the same way as the previous stylesheet. Although this is a small example in which the parameter <code>$a</code> is the only savings, the benefit of  <code>with-all-params="yes"</code> can be significant in scenarios where there are more parameters.</p>
<pre><code class="language-xml">&lt;!-- after.xsl --&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="4.0"&gt;
    
    &lt;xsl:import href="import.xsl"/&gt;
    
    &lt;xsl:template match="p"&gt;
        &lt;p&gt;customization&lt;/p&gt;
        &lt;xsl:next-match with-all-params="yes"&gt;
            &lt;xsl:with-param name="b" select="'buzz'"/&gt;
            &lt;xsl:with-param name="c" select="'c'"/&gt;
        &lt;/xsl:next-match&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>The two stylesheets above (<code>before.xsl</code> and <code>after.xsl</code>) should produce the same output.</p>
<pre><code class="language-xml">&lt;!-- output.xml --&gt;
&lt;section&gt;
   &lt;p&gt;customization&lt;/p&gt;
   &lt;p&gt;a a&lt;/p&gt;
   &lt;p&gt;b buzz&lt;/p&gt;
   &lt;p&gt;c c&lt;/p&gt;
   &lt;p&gt;hello&lt;/p&gt;
&lt;/section&gt;
</code></pre>
</div></details></div>
<div class="toot" id="closed-1801"><h2>Issue #1801 closed<span class="toot-id"> #closed-1801</span></h2><div class="pubdate">05 Mar at 19:07:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1801">https://github.com/qt4cg/qtspecs/pull/1801</a></div><p>1798 Function fn:function-identity</p></div>
<div class="toot" id="created-1860"><h2>Issue #1860 created<span class="toot-id"> #created-1860</span></h2><div class="pubdate">05 Mar at 17:51:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1860">https://github.com/qt4cg/qtspecs/issues/1860</a></div><details><summary>fn:parse-xml: DTDs, external resources</summary><div class="markup"><p>The text doesn’t say much about what DTD validation means. Is my assumption correct that it boils down to a <code>SAXParserFactory.setValidating</code> call in Java?</p>
<p>What about DTDs in general? Given the following snippets (using the default <code>false</code> for DTD validation)…</p>
<pre><code class="language-xquery">&lt;!-- xml.dtd --&gt;
&lt;!ENTITY arrow "→"&gt;

parse-xml(`
  &lt;!DOCTYPE xml SYSTEM 'xml.dtd'&gt;
  &lt;xml&gt;&amp;arrow;&lt;/xml&gt;`
)
</code></pre>
<p>…should the result be <code>&lt;xml/&gt;</code>, <code>&lt;xml&gt;→&lt;/xml&gt;</code>, or an error? In other words, should the (potentially external) <code>xml.dtd</code> resource be resolved and interpreted?</p>
<p>Maybe we should introduce an additional <code>DTD</code> option (or options?) to control the loading of external DTDs and the handling of entities, for example:</p>
<pre><code>http://apache.org/xml/features/nonvalidating/load-external-dtd
http://xml.org/sax/features/external-general-entities
http://xml.org/sax/features/external-parameter-entities
</code></pre>
<p>Thoughts are welcome.</p>
</div></details></div>
<div class="toot" id="created-1859"><h2>Issue #1859 created<span class="toot-id"> #created-1859</span></h2><div class="pubdate">05 Mar at 15:36:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1859">https://github.com/qt4cg/qtspecs/issues/1859</a></div><details><summary>Question on `fn:chain` and `err:FOAP0001`</summary><div class="markup"><p>Per #1280,  <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply"><code>fn:apply</code></a> has been changed to allow the number of arguments to be greater than the arity of the function.</p>
<p><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-chain"><code>fn:chain</code></a> is defined in terms of <code>fn:apply</code>, and it also refers to the error code <code>err:FOAP0001</code> which belongs to <code>fn:apply</code>.</p>
<p>However the condition for the error differs between the two:</p>
<ul>
<li>
<p><code>fn:chain</code></p>
<blockquote>
<p>An error [<a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#ERRFOAP0001">err:FOAP0001</a>] is raised if the arity of any function $f in $functions is different from the number of members in the array that is passed to <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply">fn:apply</a>.</p>
</blockquote>
</li>
<li>
<p><code>fn:apply</code></p>
<blockquote>
<p>A dynamic error is raised if the arity of the function $function is greater than the size of the array $arguments ([<a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#ERRFOAP0001">err:FOAP0001</a>]).</p>
</blockquote>
</li>
</ul>
<p>Also in <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#error-summary">B Error Codes</a>, <code>err:FOAP001</code> still asks for the arity to exaclty match the number of arguments:</p>
<blockquote>
<p>err:FOAP0001, Wrong number of arguments.</p>
<p>Raised when <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-apply">fn:apply</a> is called and the arity of the supplied function is not the same as the number of members in the supplied array.</p>
</blockquote>
<p>Should not the description of <code>fn:chain</code> and the error summary be adapted to the changed behaviour of <code>fn:apply</code>?</p>
</div></details></div>
<div class="toot" id="closed-1853"><h2>Issue #1853 closed<span class="toot-id"> #closed-1853</span></h2><div class="pubdate">04 Mar at 18:57:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1853">https://github.com/qt4cg/qtspecs/pull/1853</a></div><p>1845 Revised design of methods to use . rather than $this</p></div>
<div class="toot" id="closed-1845"><h2>Issue #1845 closed<span class="toot-id"> #closed-1845</span></h2><div class="pubdate">04 Mar at 18:14:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1845">https://github.com/qt4cg/qtspecs/issues/1845</a></div><p>Should we add additional syntactic sugar for use with %method functions?</p></div>
<div class="toot" id="closed-1820"><h2>Issue #1820 closed<span class="toot-id"> #closed-1820</span></h2><div class="pubdate">04 Mar at 17:21:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1820">https://github.com/qt4cg/qtspecs/issues/1820</a></div><p>Delta markers in collapsed TOC</p></div>
<div class="toot" id="closed-1838"><h2>Issue #1838 closed<span class="toot-id"> #closed-1838</span></h2><div class="pubdate">04 Mar at 17:21:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1838">https://github.com/qt4cg/qtspecs/pull/1838</a></div><p>1820 Attempt to add change markup in collapsed ToC</p></div>
<div class="toot" id="closed-1796"><h2>Issue #1796 closed<span class="toot-id"> #closed-1796</span></h2><div class="pubdate">04 Mar at 17:18:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1796">https://github.com/qt4cg/qtspecs/issues/1796</a></div><p>Allow fn:invisible-xml to return a function that returns an item()</p></div>
<div class="toot" id="closed-1839"><h2>Issue #1839 closed<span class="toot-id"> #closed-1839</span></h2><div class="pubdate">04 Mar at 17:18:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1839">https://github.com/qt4cg/qtspecs/pull/1839</a></div><p>Relax the return type of the Invisible XML parsing function</p></div>
<div class="toot" id="closed-1849"><h2>Issue #1849 closed<span class="toot-id"> #closed-1849</span></h2><div class="pubdate">04 Mar at 17:15:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1849">https://github.com/qt4cg/qtspecs/pull/1849</a></div><p>Reduce the indentation in the ToC</p></div>
<div class="toot" id="closed-1850"><h2>Issue #1850 closed<span class="toot-id"> #closed-1850</span></h2><div class="pubdate">04 Mar at 17:12:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1850">https://github.com/qt4cg/qtspecs/pull/1850</a></div><p>Actions from meeting 111</p></div>
<div class="toot" id="closed-1771"><h2>Issue #1771 closed<span class="toot-id"> #closed-1771</span></h2><div class="pubdate">04 Mar at 17:10:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1771">https://github.com/qt4cg/qtspecs/issues/1771</a></div><p>fn:deep-equal: map order</p></div>
<div class="toot" id="closed-1855"><h2>Issue #1855 closed<span class="toot-id"> #closed-1855</span></h2><div class="pubdate">04 Mar at 17:10:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1855">https://github.com/qt4cg/qtspecs/pull/1855</a></div><p>1771 Add option for deep-equal to consider map order</p></div>
<div class="toot" id="closed-1847"><h2>Issue #1847 closed<span class="toot-id"> #closed-1847</span></h2><div class="pubdate">04 Mar at 16:23:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1847">https://github.com/qt4cg/qtspecs/issues/1847</a></div><p>%method functions: explicit self reference?</p></div>
<div class="toot" id="created-1858"><h2>Pull request #1858 created<span class="toot-id"> #created-1858</span></h2><div class="pubdate">04 Mar at 12:04:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1858">https://github.com/qt4cg/qtspecs/pull/1858</a></div><details><summary>Initial xsl:record</summary><div class="markup"><p>An initial draft of the xsl:record instruction, for discussion</p>
</div></details></div>
<div class="toot" id="closed-1656"><h2>Issue #1656 closed<span class="toot-id"> #closed-1656</span></h2><div class="pubdate">03 Mar at 18:39:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1656">https://github.com/qt4cg/qtspecs/issues/1656</a></div><p>Ordered Maps: Updates</p></div>
<div class="toot" id="closed-1829"><h2>Issue #1829 closed<span class="toot-id"> #closed-1829</span></h2><div class="pubdate">03 Mar at 18:30:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1829">https://github.com/qt4cg/qtspecs/issues/1829</a></div><p>Problems with new arrow expression syntax</p></div>
<div class="toot" id="closed-1854"><h2>Issue #1854 closed<span class="toot-id"> #closed-1854</span></h2><div class="pubdate">03 Mar at 18:24:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1854">https://github.com/qt4cg/qtspecs/issues/1854</a></div><p>Can someone direct me to the motivating use case of objects?</p></div>
<div class="toot" id="created-1857"><h2>Issue #1857 created<span class="toot-id"> #created-1857</span></h2><div class="pubdate">03 Mar at 16:59:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1857">https://github.com/qt4cg/qtspecs/issues/1857</a></div><details><summary>fn:parse-xml: `xinclude`</summary><div class="markup"><p>We should allow XInclude processing to be enabled/disabled, as it can potentially lead to memory leaks.</p>
</div></details></div>
<div class="toot" id="closed-1835"><h2>Issue #1835 closed<span class="toot-id"> #closed-1835</span></h2><div class="pubdate">03 Mar at 12:38:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1835">https://github.com/qt4cg/qtspecs/pull/1835</a></div><p>add zero-width assertions to regular expressions</p></div>
<div class="toot" id="created-1856"><h2>Pull request #1856 created<span class="toot-id"> #created-1856</span></h2><div class="pubdate">03 Mar at 12:34:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1856">https://github.com/qt4cg/qtspecs/pull/1856</a></div><details><summary>998 Add boundary and lookahead/behind assertions</summary><div class="markup"><p>Incorporates and supersedes #1835</p>
</div></details></div>
<div class="toot" id="closed-1836"><h2>Issue #1836 closed<span class="toot-id"> #closed-1836</span></h2><div class="pubdate">02 Mar at 19:12:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1836">https://github.com/qt4cg/qtspecs/issues/1836</a></div><p>unparsed-text-lines() - line endings</p></div>
<div class="toot" id="created-1855"><h2>Pull request #1855 created<span class="toot-id"> #created-1855</span></h2><div class="pubdate">02 Mar at 19:06:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1855">https://github.com/qt4cg/qtspecs/pull/1855</a></div><details><summary>1771 Add option for deep-equal to consider map order</summary><div class="markup"><p>Adds an option for deep-equal to treat order of entries in a map as significant.</p>
<p>Fix #1771</p>
</div></details></div>
<div class="toot" id="created-1854"><h2>Issue #1854 created<span class="toot-id"> #created-1854</span></h2><div class="pubdate">28 Feb at 11:37:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1854">https://github.com/qt4cg/qtspecs/issues/1854</a></div><details><summary>Can someone direct me to the motivating use case of objects?</summary><div class="markup"><p>There's a LOT of conversations about "this" and methods and really quite complex syntax, but (despite writing OO software for about 30+ years), I cant think of a motivating use case in the context of XSLT/XQuery.</p>
<ul>
<li>in imperative languages with mutable state...yes</li>
<li>in very large code bases requiring some abstraction/encapsulation - well maybe...there are probably easier ways to do this without 'objects'.</li>
</ul>
<p>this is the sort of canonical example people use (to illustrate simple technical points)</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': fn(){?x * ?y}}</p>
</blockquote>
<p>but actually I would write</p>
<blockquote>
<p>$rect := {'x': 10, 'y': 7, 'area': 10 * 7}</p>
</blockquote>
<p>(and similarly write a data constructor for the record in that manner)</p>
<p>i.e.</p>
<blockquote>
<p>fn($x,$y){'x': $x, 'y': $y, 'area': $x * $y}</p>
</blockquote>
<p>I'm not sure at the moment its worth the effort.</p>
</div></details></div>
<div class="toot" id="created-1853"><h2>Pull request #1853 created<span class="toot-id"> #created-1853</span></h2><div class="pubdate">27 Feb at 10:38:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1853">https://github.com/qt4cg/qtspecs/pull/1853</a></div><details><summary>1845 Revised design of methods to use . rather than $this</summary><div class="markup"><p>Proposal is that in methods, the containing map should be bound to the context item rather than to the special variable $this, so fields of that map are referenced as <code>?x</code> rather than <code>$this?x</code>.</p>
</div></details></div>
<div class="toot" id="created-1852"><h2>Issue #1852 created<span class="toot-id"> #created-1852</span></h2><div class="pubdate">27 Feb at 08:56:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1852">https://github.com/qt4cg/qtspecs/issues/1852</a></div><details><summary>fn:values-except: Return atomic values that occur in A but not in B</summary><div class="markup"><p><code>fn:distinct-values</code> can be used to perform a <code>union</code> on atomic values:</p>
<pre><code class="language-xquery">(: returns 1 to 5 :)
let $one := 1 to 4, $two := 2 to 5
return distinct-values(($one, $two))
</code></pre>
<p><code>fn:duplicate-values</code> can be used for <code>intersect</code>:</p>
<pre><code class="language-xquery">(: returns 2 to 4 :)
let $one := 1 to 4, $two := 2 to 5
return duplicate-values(($one, $two))
</code></pre>
<p>A (roughly) equivalent alternative is <code>$one[. = $two]</code>.</p>
<p>I think we should add an equivalent for <code>except</code> (it requires 2 arguments instead of 1):</p>
<pre><code class="language-xquery">fn:values-except(
  $values     as xs:anyAtomicType*,
  $exclude    as xs:anyAtomicType*,
  $collation  as xs:string?         := fn:default-collation()
) as xs:anyAtomicType*
</code></pre>
<p>An example:</p>
<pre><code class="language-xquery">(: returns 1 :)
let $one := 1 to 4, $two := 2 to 5
return values-except($one, $two)
</code></pre>
<p>In principle, this function can also be written as <code>$one[not(. = $two)]</code>, but a dedicated function will be easier to understand for users and easier to optimize for processors.</p>
</div></details></div>
<div class="toot" id="closed-1247"><h2>Issue #1247 closed<span class="toot-id"> #closed-1247</span></h2><div class="pubdate">26 Feb at 23:55:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1247">https://github.com/qt4cg/qtspecs/issues/1247</a></div><p>`??type(T)` in lookup expressions - shortcuts</p></div>
<div class="toot" id="created-1851"><h2>Issue #1851 created<span class="toot-id"> #created-1851</span></h2><div class="pubdate">26 Feb at 15:42:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1851">https://github.com/qt4cg/qtspecs/issues/1851</a></div><details><summary>Questions on `fn:atomic-type-annotation`</summary><div class="markup"><p>These questions came up while working on <code>fn:atomic-type-annotation</code>:</p>
<ul>
<li>what is the <code>variety</code> of <code>xs:anySimpleType</code>?</li>
<li>should not <code>constructor</code> be absent in an <code>fn:schema-type-record</code> describing <code>xs:QName</code>?</li>
</ul>
<p>Here are the detailed observations:</p>
<h3><code>fn:schema-type-record?variety</code></h3>
<p>Consider the following query:</p>
<pre><code class="language-xquery">  (
    &lt;x&gt;42&lt;/x&gt;
    =&gt; fn:atomic-type-annotation()
  )
  ?base-type()
  ?base-type()
  ?variety
</code></pre>
<p>My interpretation is as follows:</p>
<ul>
<li>the <code>x</code> element node is atomized to a value of type <code>xs:untypedAtomic</code>,</li>
<li>so <code>fn:atomic-type-annotation</code> returns the information for <code>xs:untypedAtomic</code>,</li>
<li>the base type of that is <code>xs:anyAtomicType</code>,</li>
<li>the base type of that is <code>xs:anySimpleType</code>,</li>
<li>per <a href="https://www.w3.org/TR/xmlschema11-1/#sec-anySimpleType">XML schema 1.1, 3.16.7.1 xs:anySimpleType</a>, the <code>{variety}</code> of <code>xs:anySimpleType</code> is absent,</li>
<li>so <code>variety</code> should be absent in an <code>fn:schema-type-record</code> describing <code>xs:anySimpleType</code>,</li>
<li>the result thus should be an empty sequence.</li>
</ul>
<p>According to the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#schema-type-record">current spec</a>, <code>variety</code> must always be present with a value of type <code>enum("atomic", "list", "union", "empty", "simple", "element-only", "mixed")</code>, but also correspond to the <code>{variety}</code> of the simple type in the XSD component model.</p>
<p>Should not <code>variety</code> be optional, and omitted for <code>xs:anySimpleType</code>?</p>
<h3><code>fn:schema-type-record?constructor</code></h3>
<p>The spec says this about <code>constructor</code>:</p>
<blockquote>
<p>The field is absent for complex types and for the abstract types xs:anyAtomicType, xs:anySimpleType, and xs:NOTATION. It is also absent for all namespace-sensitive types, that is, types derived from xs:QName or xs:NOTATION.</p>
</blockquote>
<p>The formulation does not include <code>xs:QName</code>, but should not its constructor be absent for the same reasons as for the types derived from it?</p>
</div></details></div>
<div class="toot" id="created-1850"><h2>Pull request #1850 created<span class="toot-id"> #created-1850</span></h2><div class="pubdate">26 Feb at 12:36:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1850">https://github.com/qt4cg/qtspecs/pull/1850</a></div><details><summary>Actions from meeting 111</summary><div class="markup"><p>[ ] QT4CG-111-01: MK to review the editorial comments on PR #1837 and then merge the PR.</p>
<p>Done (along with a couple of other minor corrections noted in passing)</p>
<p>[ ] QT4CG-111-02: MK to fix the typo $in as xs:double+ and 1.3. 1.4 that middle “.” should be a “,”</p>
<p>Already done before the PR was merged</p>
<p>[ ] QT4CG-111-03: MK to add a %method example that uses the arrow syntax.</p>
<p>Done (though the example isn't especially convincing).</p>
<p>Also added another couple of examples and notes in passing.</p>
</div></details></div>
<div class="toot" id="created-1849"><h2>Pull request #1849 created<span class="toot-id"> #created-1849</span></h2><div class="pubdate">26 Feb at 09:57:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1849">https://github.com/qt4cg/qtspecs/pull/1849</a></div><p>Reduce the indentation in the ToC</p></div>
<div class="toot" id="created-1848"><h2>Issue #1848 created<span class="toot-id"> #created-1848</span></h2><div class="pubdate">26 Feb at 08:31:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1848">https://github.com/qt4cg/qtspecs/issues/1848</a></div><p>Define regular expressions using XSD 1.1 as baseline</p></div>
<div class="toot" id="closed-1800"><h2>Issue #1800 closed<span class="toot-id"> #closed-1800</span></h2><div class="pubdate">25 Feb at 21:17:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1800">https://github.com/qt4cg/qtspecs/issues/1800</a></div><p>The `=?&gt;` lookup arrow expression operator is weird, difficult to use, difficult to understand, difficult to read and unnatural</p></div>
<div class="toot" id="closed-1817"><h2>Issue #1817 closed<span class="toot-id"> #closed-1817</span></h2><div class="pubdate">25 Feb at 21:17:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1817">https://github.com/qt4cg/qtspecs/pull/1817</a></div><p>1800 Methods</p></div>
<div class="toot" id="closed-1843"><h2>Issue #1843 closed<span class="toot-id"> #closed-1843</span></h2><div class="pubdate">25 Feb at 18:20:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1843">https://github.com/qt4cg/qtspecs/issues/1843</a></div><p>XQFO: TOC texts</p></div>
<div class="toot" id="created-1847"><h2>Issue #1847 created<span class="toot-id"> #created-1847</span></h2><div class="pubdate">25 Feb at 18:14:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1847">https://github.com/qt4cg/qtspecs/issues/1847</a></div><details><summary>%method functions: explicit self reference?</summary><div class="markup"><p>This is a discussion issue; I am torn and would be interested in feedback:</p>
<p>With the just added <code>%method</code> annotation, basically two things happen:</p>
<ol>
<li>An implicit <code>$this</code> parameter is preprended to the remaining parameters of a function.</li>
<li>The current map will be bound to the first parameter by the lookup operator.</li>
</ol>
<p>The inner workings of the example in the spec were not entierly obvious in today’s meeting…</p>
<pre><code class="language-xquery">let $area := %method fn() { $this?x * $this?y }
return $area({ 'x': 3, 'y': 4 })
</code></pre>
<p>…and I am wondering if we are not more flexible by making the self-referencing parameter explicit. This way, it would be up to the user to decide how the parameter is called…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn($self) { $self?value + 1 } }
return $number?inc()
</code></pre>
<p>…the focus function syntax could be used alternatively…</p>
<pre><code class="language-xquery">let $number := { 'value': 3, 'inc': %method fn { ?value + 1 } }
return $number?inc()
</code></pre>
<p>…and it would allow for a stricter typing (<code>$this as map(*)</code> is not very specific), and thus for better error reporting:</p>
<pre><code class="language-xquery">declare record coord(
  x as xs:double,
  y as xs:double,
  product := %method fn($coord as coord) { $coord?x * $coord?y }
);
coord(3, 4)?product()
</code></pre>
<p>Obviously, it would cause new issues:</p>
<ul>
<li><code>%method fn() {}</code> would need to be made illegal</li>
<li>The type of the first argument would need to be <code>map(*)</code> or a subtype of it.</li>
<li>Users may be led to write…</li>
</ul>
<pre><code class="language-xquery">let $map := { 'fn': %method fn($a, $b) { $a * $b } }
return $map?fn(2, 3)
</code></pre>
<p>On the other hand, the existence of the <code>%method</code> annotation should indicate that this function type differs from others.</p>
<p>If we stick with the invisible <code>$this</code> parameter, I wonder what <code>function-arity(%method fn() {})</code> is supposed to return?</p>
</div></details></div>
<div class="toot" id="created-1846"><h2>Issue #1846 created<span class="toot-id"> #created-1846</span></h2><div class="pubdate">25 Feb at 17:48:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1846">https://github.com/qt4cg/qtspecs/issues/1846</a></div><details><summary>%method functions, dynamic function calls</summary><div class="markup"><p>With the #1817, the <code>%method</code> annotation was introduced for functions. It is interpreted by the lookup operator:</p>
<pre><code class="language-xquery">let $number := { 'value': -3, 'abs': %method fn() { abs($this?value) } }
return $number?abs()
</code></pre>
<p>I think we should extend this mechanism to dynamic function calls, as many people use the constructs interchangeably:</p>
<pre><code class="language-xquery">return $number('abs')()
</code></pre>
<p>I agree that the binding mechanism should not apply for <code>map:get</code> or any other map functions and iterations.</p>
</div></details></div>
<div class="toot" id="closed-1830"><h2>Issue #1830 closed<span class="toot-id"> #closed-1830</span></h2><div class="pubdate">25 Feb at 17:32:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1830">https://github.com/qt4cg/qtspecs/pull/1830</a></div><p>1829 Reintroduce restrictions on RHS of `=&gt;`</p></div>
<div class="toot" id="closed-1815"><h2>Issue #1815 closed<span class="toot-id"> #closed-1815</span></h2><div class="pubdate">25 Feb at 17:29:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1815">https://github.com/qt4cg/qtspecs/issues/1815</a></div><p>Function annotations on function items</p></div>
<div class="toot" id="closed-1828"><h2>Issue #1828 closed<span class="toot-id"> #closed-1828</span></h2><div class="pubdate">25 Feb at 17:29:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1828">https://github.com/qt4cg/qtspecs/pull/1828</a></div><p>1815 Add more detail on annotations of function items</p></div>
<div class="toot" id="closed-1834"><h2>Issue #1834 closed<span class="toot-id"> #closed-1834</span></h2><div class="pubdate">25 Feb at 17:27:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1834">https://github.com/qt4cg/qtspecs/issues/1834</a></div><p>json-lines - refinement</p></div>
<div class="toot" id="closed-1837"><h2>Issue #1837 closed<span class="toot-id"> #closed-1837</span></h2><div class="pubdate">25 Feb at 17:27:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1837">https://github.com/qt4cg/qtspecs/pull/1837</a></div><p>1834 Additional clarification on JSON lines</p></div>
<div class="toot" id="closed-583"><h2>Issue #583 closed<span class="toot-id"> #closed-583</span></h2><div class="pubdate">25 Feb at 17:24:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/583">https://github.com/qt4cg/qtspecs/issues/583</a></div><p>(array|map):replace → *:substitute or *:change</p></div>
<div class="toot" id="closed-1833"><h2>Issue #1833 closed<span class="toot-id"> #closed-1833</span></h2><div class="pubdate">25 Feb at 17:24:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1833">https://github.com/qt4cg/qtspecs/pull/1833</a></div><p>583 Drop map:replace and array:replace</p></div>
<div class="toot" id="closed-1816"><h2>Issue #1816 closed<span class="toot-id"> #closed-1816</span></h2><div class="pubdate">25 Feb at 17:21:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1816">https://github.com/qt4cg/qtspecs/issues/1816</a></div><p>Programmatic partial application</p></div>
<div class="toot" id="closed-1825"><h2>Issue #1825 closed<span class="toot-id"> #closed-1825</span></h2><div class="pubdate">25 Feb at 17:21:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1825">https://github.com/qt4cg/qtspecs/pull/1825</a></div><p>1816 New function fn:partial-apply</p></div>
<div class="toot" id="closed-1818"><h2>Issue #1818 closed<span class="toot-id"> #closed-1818</span></h2><div class="pubdate">25 Feb at 17:18:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1818">https://github.com/qt4cg/qtspecs/issues/1818</a></div><p>Grammar problem introduced by #1802</p></div>
<div class="toot" id="closed-1826"><h2>Issue #1826 closed<span class="toot-id"> #closed-1826</span></h2><div class="pubdate">25 Feb at 17:18:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1826">https://github.com/qt4cg/qtspecs/pull/1826</a></div><p>Fix grammar bug #1818</p></div>
<div class="toot" id="closed-1823"><h2>Issue #1823 closed<span class="toot-id"> #closed-1823</span></h2><div class="pubdate">25 Feb at 17:15:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1823">https://github.com/qt4cg/qtspecs/issues/1823</a></div><p>Clearer top-level section headings in F+O</p></div>
<div class="toot" id="closed-1824"><h2>Issue #1824 closed<span class="toot-id"> #closed-1824</span></h2><div class="pubdate">25 Feb at 17:15:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1824">https://github.com/qt4cg/qtspecs/pull/1824</a></div><p>1823 Revise top-level headings in F+O spec</p></div>
<div class="toot" id="created-1845"><h2>Issue #1845 created<span class="toot-id"> #created-1845</span></h2><div class="pubdate">25 Feb at 17:14:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1845">https://github.com/qt4cg/qtspecs/issues/1845</a></div><details><summary>Should we add additional syntactic sugar for use with %method functions?</summary><div class="markup"><p>During <a href="https://qt4cg.org/meeting/minutes/2025/02-25.html">meeting 111</a>, DN was arguing for additional syntactic sugar when his connection to the call ended abruptly. This issue is to make sure we come back to those discussions.</p>
<p>Specifically, should we allow <code>^x</code> as an abbreviation for <code>$this?x</code> ?</p>
</div></details></div>
<div class="toot" id="closed-1813"><h2>Issue #1813 closed<span class="toot-id"> #closed-1813</span></h2><div class="pubdate">25 Feb at 17:12:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1813">https://github.com/qt4cg/qtspecs/issues/1813</a></div><p>Reorganise top-level sections in XDM</p></div>
<div class="toot" id="closed-1814"><h2>Issue #1814 closed<span class="toot-id"> #closed-1814</span></h2><div class="pubdate">25 Feb at 17:12:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1814">https://github.com/qt4cg/qtspecs/pull/1814</a></div><p>1813 Reorganise the XDM spec at top level</p></div>
<div class="toot" id="closed-1811"><h2>Issue #1811 closed<span class="toot-id"> #closed-1811</span></h2><div class="pubdate">25 Feb at 17:09:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1811">https://github.com/qt4cg/qtspecs/issues/1811</a></div><p>Add note concerning non-XML characters in character maps</p></div>
<div class="toot" id="closed-1812"><h2>Issue #1812 closed<span class="toot-id"> #closed-1812</span></h2><div class="pubdate">25 Feb at 17:09:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1812">https://github.com/qt4cg/qtspecs/pull/1812</a></div><p>1811 Add note regarding non-XML chars in xsl:output-character</p></div>
<div class="toot" id="created-1844"><h2>Issue #1844 created<span class="toot-id"> #created-1844</span></h2><div class="pubdate">25 Feb at 16:18:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1844">https://github.com/qt4cg/qtspecs/issues/1844</a></div><details><summary>Drop mapping arrow operator</summary><div class="markup"><p>To reduce the number of new operators, I suggest removing the mapping arrow operator <code>=!&gt;</code>, in favor of the recently added <code>-&gt;</code> operator (which now allows us to arbitrarily create chains for single items and sequences).</p>
<p>Related: https://github.com/qt4cg/qtspecs/issues/1685</p>
</div></details></div>
<div class="toot" id="created-1843"><h2>Issue #1843 created<span class="toot-id"> #created-1843</span></h2><div class="pubdate">25 Feb at 15:35:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1843">https://github.com/qt4cg/qtspecs/issues/1843</a></div><details><summary>XQFO: TOC texts</summary><div class="markup"><p>The XQFO TOC is overly verbose, and inconsistent nevertheless. With the addition of arrows and symbols, many headers stretch across several lines.</p>
<p>If no one objects, I will remove all the redundant "Functions ..." strings:</p>
<p>Current:</p>
<ol>
<li>Introduction</li>
<li>Functions on nodes and node sequences</li>
<li>Errors and diagnostics</li>
<li>Functions and operators on numerics</li>
<li>Functions on strings</li>
<li>Functions that manipulate URIs</li>
<li>Functions and operators on Boolean values</li>
<li>Functions and operators on durations</li>
<li>Functions and operators on dates and times</li>
<li>Functions related to QNames
...</li>
</ol>
<p>Proposed:</p>
<ol>
<li>Introduction</li>
<li>Nodes</li>
<li>Errors and diagnostics</li>
<li>Numerics</li>
<li>Strings</li>
<li>URIs</li>
<li>Boolean values</li>
<li>Durations</li>
<li>Dates and times</li>
<li>QNames
...</li>
</ol>
</div></details></div>
<div class="toot" id="closed-1842"><h2>Issue #1842 closed<span class="toot-id"> #closed-1842</span></h2><div class="pubdate">25 Feb at 09:14:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1842">https://github.com/qt4cg/qtspecs/issues/1842</a></div><p>This is a test of the emergency broadcast system. This is only a test.</p></div>
<div class="toot" id="created-1842"><h2>Issue #1842 created<span class="toot-id"> #created-1842</span></h2><div class="pubdate">25 Feb at 09:13:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1842">https://github.com/qt4cg/qtspecs/issues/1842</a></div><details><summary>This is a test of the emergency broadcast system. This is only a test.</summary><div class="markup"><p>Had this been a real emergency, we would have fled in terror and you would not have been informed.</p>
</div></details></div>
<div class="toot" id="closed-1840"><h2>Issue #1840 closed<span class="toot-id"> #closed-1840</span></h2><div class="pubdate">25 Feb at 09:13:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1840">https://github.com/qt4cg/qtspecs/pull/1840</a></div><p>GH action remove-label-on-reopen.yml</p></div>
<div class="toot" id="closed-1841"><h2>Issue #1841 closed<span class="toot-id"> #closed-1841</span></h2><div class="pubdate">25 Feb at 09:13:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1841">https://github.com/qt4cg/qtspecs/pull/1841</a></div><p>Action to remove label on reopen</p></div>
<div class="toot" id="created-1841"><h2>Pull request #1841 created<span class="toot-id"> #created-1841</span></h2><div class="pubdate">25 Feb at 09:12:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1841">https://github.com/qt4cg/qtspecs/pull/1841</a></div><details><summary>Action to remove label on reopen</summary><div class="markup"><p>Close #1840</p>
</div></details></div>
<div class="toot" id="created-1840"><h2>Pull request #1840 created<span class="toot-id"> #created-1840</span></h2><div class="pubdate">24 Feb at 21:03:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1840">https://github.com/qt4cg/qtspecs/pull/1840</a></div><details><summary>GH action remove-label-on-reopen.yml</summary><div class="markup"><p>In response to the mailing list post by @ndw: https://lists.w3.org/Archives/Public/public-xslt-40/2025Feb/0024.html</p>
<p>This is untested, but it might at least serve as an inspiration how to avoid the unwanted tag in an automated manner.</p>
</div></details></div>
<div class="toot" id="created-1839"><h2>Pull request #1839 created<span class="toot-id"> #created-1839</span></h2><div class="pubdate">24 Feb at 17:09:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1839">https://github.com/qt4cg/qtspecs/pull/1839</a></div><details><summary>Relax the return type of the Invisible XML parsing function</summary><div class="markup"><p>Fix #1796</p>
<p>This change does not appear to change any test results. (In other words, none of our tests checked that the return type was explicitly a document node.)</p>
</div></details></div>
<div class="toot" id="created-1838"><h2>Pull request #1838 created<span class="toot-id"> #created-1838</span></h2><div class="pubdate">24 Feb at 15:59:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1838">https://github.com/qt4cg/qtspecs/pull/1838</a></div><details><summary>1820 Attempt to add change markup in collapsed ToC</summary><div class="markup"><p>Fix #1820</p>
<p>This PR updates the styling so that a small "Δ" is added to the expand arrow when there are changes or additions in the concealed subsections. It's smaller and not blue. I could argue that this is on purpose so that the marking is different and perhaps more subtle. But the truth is, it was just easier to add the Δ without any markup that would make it larger or blue.</p>
<p>I've opted to conceal the Δ when the ToC is "open" on the grounds that you can see what is or isn't marked new on the revealed subsctions.</p>
</div></details></div>
<div class="toot" id="closed-1827"><h2>Issue #1827 closed<span class="toot-id"> #closed-1827</span></h2><div class="pubdate">24 Feb at 11:24:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1827">https://github.com/qt4cg/qtspecs/issues/1827</a></div><p>XPath TOC: For and Let Expressions: whitespace</p></div>
<div class="toot" id="closed-1831"><h2>Issue #1831 closed<span class="toot-id"> #closed-1831</span></h2><div class="pubdate">24 Feb at 11:24:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1831">https://github.com/qt4cg/qtspecs/pull/1831</a></div><p>1827 Fix excess whitespace in TOC</p></div>
<div class="toot" id="created-1837"><h2>Pull request #1837 created<span class="toot-id"> #created-1837</span></h2><div class="pubdate">24 Feb at 10:07:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1837">https://github.com/qt4cg/qtspecs/pull/1837</a></div><details><summary>1834 Additional clarification on JSON lines</summary><div class="markup"><p>Fix #1834</p>
</div></details></div>
<div class="toot" id="created-1836"><h2>Issue #1836 created<span class="toot-id"> #created-1836</span></h2><div class="pubdate">24 Feb at 09:42:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1836">https://github.com/qt4cg/qtspecs/issues/1836</a></div><details><summary>unparsed-text-lines() - line endings</summary><div class="markup"><p>The description of the unparsed-text-lines function contradicts itself regarding line endings.</p>
<p>First it says that the function is equivalent to calling <code>unparsed-text()</code> and applying <code>tokenize(., '\n')</code> to the result.</p>
<p>Then it says that it accepts x0A, x0D, or x0D0A as line endings.</p>
</div></details></div>
<div class="toot" id="created-1835"><h2>Pull request #1835 created<span class="toot-id"> #created-1835</span></h2><div class="pubdate">24 Feb at 08:15:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1835">https://github.com/qt4cg/qtspecs/pull/1835</a></div><details><summary>add zero-width assertions to regular expressions</summary><div class="markup"><p>Proposal for issues !998 and !1006 to add zero-width assertions - lookahead, lookbehind, and word boundary.</p>
<p>Word boundaries use the already-defined \w and \W from XML Schema.</p>
<p>The syntax for lookahead and lookbehind assertions supports the two most common variants, one using &lt; and &gt; and the other using <code>(*positive_lookahead:expr)</code>, which is at least amenable to Web searches, and doesn’t need escaping in XSLT or XQuery.</p>
<p>Note that word boundary &lt; \b \B &gt; assertions can be rewritten in terms of lookahead and lookbehind assertions.</p>
<p>Perl has a more powerful form of \b and \B that can match grapheme clusters, the Unicode linebreaking algorithm, and more, but supporting that would require language and script based mechanisms; if the graphemes() function is added, it would be worth considering. For now, i made it an error to write \b{...} so that the support could be added later if wanted, and also so that copying regular expressions into XPath would raise an error for the unsupported feature.</p>
<p>I will reopen !998 - if this is accepted i can produce test cases. Of course, i’m also happy to edit/rewrite etc.  The syntax is widely supported, although \K is i think not in libpcre (but, libpcre has looser restrictions on negative backward assertions).</p>
</div></details></div>
<div class="toot" id="created-1834"><h2>Issue #1834 created<span class="toot-id"> #created-1834</span></h2><div class="pubdate">23 Feb at 17:42:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1834">https://github.com/qt4cg/qtspecs/issues/1834</a></div><details><summary>json-lines - refinement</summary><div class="markup"><p>Some suggestions regarding support for json-lines:</p>
<p>(a) The json-lines spec has no official standing. It might therefore be a good idea if we summarize its essentials, just in case it disappears off the web.
(b) The spec makes the final newline optional. Our test cases assume no final newline. We should probably mandate this for interoperability.
(c) We should tell people how to read files in json-lines format - specifically <code>unparsed-text-lines() ! parse-json()</code></p>
</div></details></div>
<div class="toot" id="created-1833"><h2>Pull request #1833 created<span class="toot-id"> #created-1833</span></h2><div class="pubdate">21 Feb at 09:32:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1833">https://github.com/qt4cg/qtspecs/pull/1833</a></div><details><summary>583 Drop map:replace and array:replace</summary><div class="markup"><p>Fix #583</p>
</div></details></div>
<div class="toot" id="created-1832"><h2>Issue #1832 created<span class="toot-id"> #created-1832</span></h2><div class="pubdate">21 Feb at 00:22:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1832">https://github.com/qt4cg/qtspecs/issues/1832</a></div><details><summary>Associativity of Operators, especially "||" (Appendix A.5)</summary><div class="markup"><p>The associativity of the <code>||</code> operator is given as "left-to-right" - it should surely be "either" (like comma, "or", and  "union").</p>
<p>Other aspects of this table are questionable.</p>
<ul>
<li>The operator <code>?[]</code> for filtering a map or array should probably be included.</li>
<li>Arguably <code>=&gt;</code> and <code>?</code> should be omitted because the RHS is not actually an expression, though it's true that if <code>A =&gt; B =&gt; C</code> is allowed, then it means <code>(A =&gt; B) =&gt; C</code>.</li>
<li><code>+</code> and <code>*</code> are associative, it's only in conjunction with other operators that they aren't.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1831"><h2>Pull request #1831 created<span class="toot-id"> #created-1831</span></h2><div class="pubdate">20 Feb at 21:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1831">https://github.com/qt4cg/qtspecs/pull/1831</a></div><details><summary>1827 Fix excess whitespace in TOC</summary><div class="markup"><p>Fix #1827</p>
</div></details></div>
<div class="toot" id="created-1830"><h2>Pull request #1830 created<span class="toot-id"> #created-1830</span></h2><div class="pubdate">20 Feb at 12:41:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1830">https://github.com/qt4cg/qtspecs/pull/1830</a></div><details><summary>1829 Reintroduce restrictions on RHS of `=&gt;`</summary><div class="markup"><p>Partial reversion of PR #1763</p>
</div></details></div>
<div class="toot" id="created-1829"><h2>Issue #1829 created<span class="toot-id"> #created-1829</span></h2><div class="pubdate">20 Feb at 11:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1829">https://github.com/qt4cg/qtspecs/issues/1829</a></div><details><summary>Problems with new arrow expression syntax</summary><div class="markup"><p>I'm hitting problems with implementing the changes in PR #1763</p>
<p>The problem is that the <code>=&gt;</code> can now be followed by either a static function call or a dynamic function call, and I think we need unbounded lookahead to distinguish them.</p>
<p>Consider</p>
<p><code>3 =&gt; function-lookup(xs:QName('fn:abs'), 1)()</code></p>
<p>at first sight the arrow appears to be followed by a static function call, <code>function-lookup(xs:QName('fn:abs'), 1)</code>. But treating it as such causes a parsing error when we get to the <code>()</code> - what we actually have here is a dynamic function call that starts with a static function call.</p>
<p>I propose that we revert to allowing a dynamic function call only in the form</p>
<p>a =&gt; x ( argument-list )</p>
<p>where x is a variable reference, a parenthesized expression, an inline function expression, or a map or array constructor.</p>
</div></details></div>
<div class="toot" id="created-1828"><h2>Pull request #1828 created<span class="toot-id"> #created-1828</span></h2><div class="pubdate">20 Feb at 11:25:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1828">https://github.com/qt4cg/qtspecs/pull/1828</a></div><details><summary>1815 Add more detail on annotations of function items</summary><div class="markup"><p>Fix #1815</p>
</div></details></div>
<div class="toot" id="created-1827"><h2>Issue #1827 created<span class="toot-id"> #created-1827</span></h2><div class="pubdate">20 Feb at 10:11:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1827">https://github.com/qt4cg/qtspecs/issues/1827</a></div><details><summary>XPath TOC: For and Let Expressions: whitespace</summary><div class="markup"><p>The table of contents for XPath, section 4.12, "For and Let Expressions", contains spurious whitespace. The whitespace appears to be present in the HTML, but it is not there in the source XML. In the actual section heading, there are two <code>&lt;a&gt;</code> elements before and after the heading text, each having as content a single space character.</p>
<p>The problem is also there in the equivalent section heading "FLWOR Expressions" in the XQuery spec.</p>
<p>In the "xpath-assembled" document, the heading appears as</p>
<pre><code>            &lt;head&gt;
               &lt;phrase role="xpath"&gt;For and Let Expressions&lt;/phrase&gt;
            &lt;/head&gt;
</code></pre>
<p>It seems to be the <code>phrase</code> element that's causing the trouble: or more likely, the whitespace text nodes that surround it.</p>
</div></details></div>
<div class="toot" id="created-1826"><h2>Pull request #1826 created<span class="toot-id"> #created-1826</span></h2><div class="pubdate">20 Feb at 09:55:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1826">https://github.com/qt4cg/qtspecs/pull/1826</a></div><details><summary>Fix grammar bug #1818</summary><div class="markup"><p>Fix #1818</p>
</div></details></div>
<div class="toot" id="created-1825"><h2>Pull request #1825 created<span class="toot-id"> #created-1825</span></h2><div class="pubdate">20 Feb at 09:01:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1825">https://github.com/qt4cg/qtspecs/pull/1825</a></div><details><summary>1816 New function fn:partial-apply</summary><div class="markup"><p>Fix #1816</p>
</div></details></div>
<div class="toot" id="created-1824"><h2>Pull request #1824 created<span class="toot-id"> #created-1824</span></h2><div class="pubdate">19 Feb at 21:05:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1824">https://github.com/qt4cg/qtspecs/pull/1824</a></div><details><summary>1823 Revise top-level headings in F+O spec</summary><div class="markup"><p>Revises the headings for consistency and brevity, to make the ToC easier to navigate at a glance</p>
<p>Fix #1823</p>
</div></details></div>
<div class="toot" id="created-1823"><h2>Issue #1823 created<span class="toot-id"> #created-1823</span></h2><div class="pubdate">19 Feb at 20:52:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1823">https://github.com/qt4cg/qtspecs/issues/1823</a></div><details><summary>Clearer top-level section headings in F+O</summary><div class="markup"><p>The improved rendition of the table of contents makes it apparent that the top-level sections headings in F+O are inconsistent and unnecessarily verbose.</p>
</div></details></div>
<div class="toot" id="closed-1821"><h2>Issue #1821 closed<span class="toot-id"> #closed-1821</span></h2><div class="pubdate">19 Feb at 17:53:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1821">https://github.com/qt4cg/qtspecs/issues/1821</a></div><p>Generated appendices in XDM</p></div>
<div class="toot" id="closed-1822"><h2>Issue #1822 closed<span class="toot-id"> #closed-1822</span></h2><div class="pubdate">19 Feb at 17:53:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1822">https://github.com/qt4cg/qtspecs/pull/1822</a></div><p>1821 Fix the generated appendixes in the Data Model</p></div>
<div class="toot" id="created-1822"><h2>Pull request #1822 created<span class="toot-id"> #created-1822</span></h2><div class="pubdate">19 Feb at 17:25:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1822">https://github.com/qt4cg/qtspecs/pull/1822</a></div><details><summary>1821 Fix the generated appendixes in the Data Model</summary><div class="markup"><p>Fix #1821</p>
</div></details></div>
<div class="toot" id="created-1821"><h2>Issue #1821 created<span class="toot-id"> #created-1821</span></h2><div class="pubdate">19 Feb at 09:21:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1821">https://github.com/qt4cg/qtspecs/issues/1821</a></div><details><summary>Generated appendices in XDM</summary><div class="markup"><p>The last four appendices in XDM are stylesheet-generated, and their TOC entries are added "by hand", and as a result they are incorrectly rendered.</p>
<p>I suggest using the same process for these appendices as other specs use: they should have a skeletal presence in the XML master, with a processing instruction to direct the stylesheet to expand the content; there is then no need for special machinery in the stylesheet to generate the TOC.</p>
</div></details></div>
<div class="toot" id="closed-1808"><h2>Issue #1808 closed<span class="toot-id"> #closed-1808</span></h2><div class="pubdate">18 Feb at 22:07:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1808">https://github.com/qt4cg/qtspecs/issues/1808</a></div><p>Add pipeline operator to list of tokens using '&lt;' and '&gt;' characters</p></div>
<div class="toot" id="created-1820"><h2>Issue #1820 created<span class="toot-id"> #created-1820</span></h2><div class="pubdate">18 Feb at 22:05:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1820">https://github.com/qt4cg/qtspecs/issues/1820</a></div><details><summary>Delta markers in collapsed TOC</summary><div class="markup"><p>When the TOC is shown in collapsed mode, it would be nice to promote the Δ change markers to the level where they become visible.</p>
</div></details></div>
<div class="toot" id="created-1819"><h2>Pull request #1819 created<span class="toot-id"> #created-1819</span></h2><div class="pubdate">18 Feb at 21:23:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1819">https://github.com/qt4cg/qtspecs/pull/1819</a></div><details><summary>451 Multiple schemas in XSLT</summary><div class="markup"><p>Fix #451</p>
</div></details></div>
<div class="toot" id="created-1818"><h2>Issue #1818 created<span class="toot-id"> #created-1818</span></h2><div class="pubdate">18 Feb at 20:10:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1818">https://github.com/qt4cg/qtspecs/issues/1818</a></div><details><summary>Grammar problem introduced by #1802</summary><div class="markup"><p>The recent merge of #1802 has incorrectly changed production <code>ArrowExpr</code> from</p>
<pre><code class="language-xquery">ArrowExpr
          ::= UnaryExpr ( SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget )
</code></pre>
<p>to</p>
<pre><code class="language-xquery">ArrowExpr
          ::= UnaryExpr ( SequenceArrowTarget MappingArrowTarget LookupArrowTarget )*
</code></pre>
<p>It has changed a <code>g:choice</code> operator to a <code>g:zeroOrMore</code> operator, while it should have added a <code>g:zeroOrMore</code> around the <code>g:choice</code>.</p>
</div></details></div>
<div class="toot" id="closed-1716"><h2>Issue #1716 closed<span class="toot-id"> #closed-1716</span></h2><div class="pubdate">18 Feb at 18:37:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1716">https://github.com/qt4cg/qtspecs/issues/1716</a></div><p>Variable lookahead needed for `ArrowTarget`</p></div>
<div class="toot" id="closed-1763"><h2>Issue #1763 closed<span class="toot-id"> #closed-1763</span></h2><div class="pubdate">18 Feb at 18:37:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1763">https://github.com/qt4cg/qtspecs/pull/1763</a></div><p>1716 Generalize syntax of arrow expressions</p></div>
<div class="toot" id="closed-1789"><h2>Issue #1789 closed<span class="toot-id"> #closed-1789</span></h2><div class="pubdate">18 Feb at 17:32:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1789">https://github.com/qt4cg/qtspecs/issues/1789</a></div><p>Terminology: "singleton map"</p></div>
<div class="toot" id="closed-1791"><h2>Issue #1791 closed<span class="toot-id"> #closed-1791</span></h2><div class="pubdate">18 Feb at 17:32:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1791">https://github.com/qt4cg/qtspecs/pull/1791</a></div><p>1789 Fix singleton terminology</p></div>
<div class="toot" id="minutes—02-18"><h2>QT4 CG meeting 110 draft minutes<span class="toot-id"> #minutes—02-18</span></h2><div class="pubdate">18 Feb at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-18">https://qt4cg.org/meeting/minutes/2025/02-18</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1769"><h2>Issue #1769 closed<span class="toot-id"> #closed-1769</span></h2><div class="pubdate">18 Feb at 17:17:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1769">https://github.com/qt4cg/qtspecs/pull/1769</a></div><p>Add links from processing model diagrams</p></div>
<div class="toot" id="closed-1788"><h2>Issue #1788 closed<span class="toot-id"> #closed-1788</span></h2><div class="pubdate">18 Feb at 17:14:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1788">https://github.com/qt4cg/qtspecs/issues/1788</a></div><p>Drop reference to maps being unordered</p></div>
<div class="toot" id="closed-1790"><h2>Issue #1790 closed<span class="toot-id"> #closed-1790</span></h2><div class="pubdate">18 Feb at 17:14:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1790">https://github.com/qt4cg/qtspecs/pull/1790</a></div><p>1788 Replace statement that maps are unordered</p></div>
<div class="toot" id="closed-1785"><h2>Issue #1785 closed<span class="toot-id"> #closed-1785</span></h2><div class="pubdate">18 Feb at 17:11:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1785">https://github.com/qt4cg/qtspecs/issues/1785</a></div><p>XQuery 4.0 grammar: `ArrowExpr` target, `ReverseAxis`</p></div>
<div class="toot" id="closed-1802"><h2>Issue #1802 closed<span class="toot-id"> #closed-1802</span></h2><div class="pubdate">18 Feb at 17:11:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1802">https://github.com/qt4cg/qtspecs/pull/1802</a></div><p>1785 Fix two simple grammar bugs</p></div>
<div class="toot" id="closed-1803"><h2>Issue #1803 closed<span class="toot-id"> #closed-1803</span></h2><div class="pubdate">18 Feb at 17:08:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1803">https://github.com/qt4cg/qtspecs/issues/1803</a></div><p>Drop "(Non-Normative)" from table of contents</p></div>
<div class="toot" id="closed-1804"><h2>Issue #1804 closed<span class="toot-id"> #closed-1804</span></h2><div class="pubdate">18 Feb at 17:08:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1804">https://github.com/qt4cg/qtspecs/pull/1804</a></div><p>Drop "(Non-Normative)" from ToC</p></div>
<div class="toot" id="closed-1805"><h2>Issue #1805 closed<span class="toot-id"> #closed-1805</span></h2><div class="pubdate">18 Feb at 17:05:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1805">https://github.com/qt4cg/qtspecs/issues/1805</a></div><p>Drop middle dots from term references in F&amp;O</p></div>
<div class="toot" id="closed-1806"><h2>Issue #1806 closed<span class="toot-id"> #closed-1806</span></h2><div class="pubdate">18 Feb at 17:05:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1806">https://github.com/qt4cg/qtspecs/pull/1806</a></div><p>1805 Drop middle dots from termref rendition in F+O</p></div>
<div class="toot" id="closed-1807"><h2>Issue #1807 closed<span class="toot-id"> #closed-1807</span></h2><div class="pubdate">18 Feb at 17:02:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1807">https://github.com/qt4cg/qtspecs/issues/1807</a></div><p>Two exceptions or three?</p></div>
<div class="toot" id="closed-1809"><h2>Issue #1809 closed<span class="toot-id"> #closed-1809</span></h2><div class="pubdate">18 Feb at 17:02:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1809">https://github.com/qt4cg/qtspecs/pull/1809</a></div><p>1807 Two exceptions to the rule, not three</p></div>
<div class="toot" id="closed-1631"><h2>Issue #1631 closed<span class="toot-id"> #closed-1631</span></h2><div class="pubdate">18 Feb at 17:00:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1631">https://github.com/qt4cg/qtspecs/issues/1631</a></div><p>xsl:apply-templates (without select) should allow inline content</p></div>
<div class="toot" id="closed-119"><h2>Issue #119 closed<span class="toot-id"> #closed-119</span></h2><div class="pubdate">18 Feb at 17:00:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/119">https://github.com/qt4cg/qtspecs/issues/119</a></div><p>Allow a map's key value to be any sequence</p></div>
<div class="toot" id="closed-1810"><h2>Issue #1810 closed<span class="toot-id"> #closed-1810</span></h2><div class="pubdate">18 Feb at 16:59:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1810">https://github.com/qt4cg/qtspecs/pull/1810</a></div><p>1808 Add -&gt; to list of tokens using lt and gt characters</p></div>
<div class="toot" id="created-1817"><h2>Pull request #1817 created<span class="toot-id"> #created-1817</span></h2><div class="pubdate">18 Feb at 15:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1817">https://github.com/qt4cg/qtspecs/pull/1817</a></div><details><summary>1800 Methods</summary><div class="markup"><p>Fix #1800</p>
</div></details></div>
<div class="toot" id="created-1816"><h2>Issue #1816 created<span class="toot-id"> #created-1816</span></h2><div class="pubdate">18 Feb at 15:33:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1816">https://github.com/qt4cg/qtspecs/issues/1816</a></div><details><summary>Programmatic partial application</summary><div class="markup"><p>We don't have a programmatic way of doing partial function application, in particular it's very difficult to to a partial application supplying the first argument of a function item without knowing statically how many other arguments there are.</p>
<p>I suggest extending fn:apply so that the second argument can be a map with integer keys; it can supply some or all of the arguments to a function, and arguments that aren't supplied are retained in the returned partially-applied function item. For the example cited where only the first argument is to be supplied, supplying an array of length one would be equivalent.</p>
</div></details></div>
<div class="toot" id="created-1815"><h2>Issue #1815 created<span class="toot-id"> #created-1815</span></h2><div class="pubdate">18 Feb at 15:29:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1815">https://github.com/qt4cg/qtspecs/issues/1815</a></div><details><summary>Function annotations on function items</summary><div class="markup"><p>We say very little about function annotations on function items.</p>
<p>For example,</p>
<ul>
<li>
<p>we don't say that the function item constructed by a named function reference inherits the function annotations of the function declaration</p>
</li>
<li>
<p>we don't say whether a function item constructed by partial application (whether static or dynamic) has any function annotations, and if so what they are.</p>
</li>
<li>
<p>we don't mention them in function-lookup().</p>
</li>
</ul>
</div></details></div>
<div class="toot" id="created-1814"><h2>Pull request #1814 created<span class="toot-id"> #created-1814</span></h2><div class="pubdate">17 Feb at 12:51:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1814">https://github.com/qt4cg/qtspecs/pull/1814</a></div><details><summary>1813 Reorganise the XDM spec at top level</summary><div class="markup"><p>Fix #1813</p>
<p>The diff version is probably not too useful because a lot of material has moved around. Very little text has actually changed, and none of it substantively.</p>
</div></details></div>
<div class="toot" id="agenda-02-18"><h2>QT4 CG meeting 110 draft agenda<span class="toot-id"> #agenda-02-18</span></h2><div class="pubdate">17 Feb at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-18">https://qt4cg.org/meeting/agenda/2025/02-18</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1813"><h2>Issue #1813 created<span class="toot-id"> #created-1813</span></h2><div class="pubdate">17 Feb at 11:15:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1813">https://github.com/qt4cg/qtspecs/issues/1813</a></div><details><summary>Reorganise top-level sections in XDM</summary><div class="markup"><p>The improved presentation of the TOC for our specs makes it rather obvious that the structure of the XDM spec has become unbalanced. Most of the spec is about node trees; information about atomic values, maps, functions etc is hard to find, and sometimes appears in strange places such as "Terminology".</p>
<p>In addition, the way the spec is assembled from multiple entities serves little purpose. It makes it harder for editors to find the text that needs to be edited and to locate markup errors introduced in the course of editing.</p>
</div></details></div>
<div class="toot" id="created-1812"><h2>Pull request #1812 created<span class="toot-id"> #created-1812</span></h2><div class="pubdate">17 Feb at 10:51:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1812">https://github.com/qt4cg/qtspecs/pull/1812</a></div><details><summary>1811 Add note regarding non-XML chars in xsl:output-character</summary><div class="markup"><p>Fix #1811</p>
</div></details></div>
<div class="toot" id="created-1811"><h2>Issue #1811 created<span class="toot-id"> #created-1811</span></h2><div class="pubdate">17 Feb at 10:12:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1811">https://github.com/qt4cg/qtspecs/issues/1811</a></div><details><summary>Add note concerning non-XML characters in character maps</summary><div class="markup"><p>We have relaxed the rules for using non-XML characters in strings. It would be useful to explain how to take advantage of this in character maps.</p>
</div></details></div>
<div class="toot" id="created-1810"><h2>Pull request #1810 created<span class="toot-id"> #created-1810</span></h2><div class="pubdate">17 Feb at 09:33:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1810">https://github.com/qt4cg/qtspecs/pull/1810</a></div><p>1808 Add -&gt; to list of tokens using lt and gt characters</p></div>
<div class="toot" id="created-1809"><h2>Pull request #1809 created<span class="toot-id"> #created-1809</span></h2><div class="pubdate">17 Feb at 09:23:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1809">https://github.com/qt4cg/qtspecs/pull/1809</a></div><details><summary>1807 Two exceptions to the rule, not three</summary><div class="markup"><p>Fix #1807</p>
</div></details></div>
<div class="toot" id="created-1808"><h2>Issue #1808 created<span class="toot-id"> #created-1808</span></h2><div class="pubdate">16 Feb at 23:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1808">https://github.com/qt4cg/qtspecs/issues/1808</a></div><details><summary>Add pipeline operator to list of tokens using '&lt;' and '&gt;' characters</summary><div class="markup"><p>Add the operator <code>-&gt;</code> to the list of tokens in XPath A3.3.</p>
</div></details></div>
<div class="toot" id="created-1807"><h2>Issue #1807 created<span class="toot-id"> #created-1807</span></h2><div class="pubdate">16 Feb at 22:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1807">https://github.com/qt4cg/qtspecs/issues/1807</a></div><details><summary>Two exceptions or three?</summary><div class="markup"><p>XPath 4.5.2.7 on function identity says "There are two exceptions to this rule:" and then lists three.</p>
</div></details></div>
<div class="toot" id="created-1806"><h2>Pull request #1806 created<span class="toot-id"> #created-1806</span></h2><div class="pubdate">16 Feb at 22:44:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1806">https://github.com/qt4cg/qtspecs/pull/1806</a></div><details><summary>1805 Drop middle dots from termref rendition in F+O</summary><div class="markup"><p>Brings F+O into line with the other specs.</p>
<p>Fix #1805</p>
</div></details></div>
<div class="toot" id="created-1805"><h2>Issue #1805 created<span class="toot-id"> #created-1805</span></h2><div class="pubdate">16 Feb at 22:36:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1805">https://github.com/qt4cg/qtspecs/issues/1805</a></div><details><summary>Drop middle dots from term references in F&amp;O</summary><div class="markup"><p>The F&amp;O spec renders termref links between middle dots. None of the other specs use this convention.</p>
</div></details></div>
<div class="toot" id="created-1804"><h2>Pull request #1804 created<span class="toot-id"> #created-1804</span></h2><div class="pubdate">16 Feb at 22:05:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1804">https://github.com/qt4cg/qtspecs/pull/1804</a></div><details><summary>Drop "(Non-Normative)" from ToC</summary><div class="markup"><p>Fix #1803</p>
</div></details></div>
<div class="toot" id="created-1803"><h2>Issue #1803 created<span class="toot-id"> #created-1803</span></h2><div class="pubdate">16 Feb at 21:54:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1803">https://github.com/qt4cg/qtspecs/issues/1803</a></div><details><summary>Drop "(Non-Normative)" from table of contents</summary><div class="markup"><p>Proposal - drop the phrase "(Non-Normative)" from section titles in the table of contents (but not in the body of the document).</p>
<p>In several of the specs this phrase disrupts the indentation and formatting of the ToC, and it adds very little value.</p>
</div></details></div>
<div class="toot" id="created-1802"><h2>Pull request #1802 created<span class="toot-id"> #created-1802</span></h2><div class="pubdate">16 Feb at 19:16:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1802">https://github.com/qt4cg/qtspecs/pull/1802</a></div><details><summary>1785 Fix two simple grammar bugs</summary><div class="markup"><p>Fix #1785</p>
</div></details></div>
<div class="toot" id="created-1801"><h2>Pull request #1801 created<span class="toot-id"> #created-1801</span></h2><div class="pubdate">15 Feb at 23:08:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1801">https://github.com/qt4cg/qtspecs/pull/1801</a></div><details><summary>1798 Function fn:function-identity</summary><div class="markup"><p>The function fn:identity as already described and discussed in #1798</p>
</div></details></div>
<div class="toot" id="created-1800"><h2>Issue #1800 created<span class="toot-id"> #created-1800</span></h2><div class="pubdate">14 Feb at 20:17:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1800">https://github.com/qt4cg/qtspecs/issues/1800</a></div><details><summary>The `=?&gt;` lookup arrow expression operator is weird, difficult to use, difficult to understand, difficult to read and unnatural</summary><div class="markup"><p>The XPath 4.0 language now includes a way for a function defined as a member of a map to easily access other members (siblings) that belong to the same map instance. Special syntax, the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#lookup-arrow-expression"><strong><code>=?&gt;</code> operator</strong></a>, was introduced to call such a function. As a whole this is a huge step forward providing the user with a new, powerful mechanism to conveniently express relationships and calculations over several member-values of a map instance.</p>
<p>I am raising this issue with the goal of further improving and simplifying for the user the way to define and call a member function of a map/record, giving it a convenient way to access the values of other members of the instance of the map, on which the call has been issued.</p>
<p>In my work, I have been trying to define a number of functions that must belong to a map/record and that should be able to access other members of the same map/record to which these functions belong.</p>
<p>The experience was far from satisfying and here I describe the main problems I encountered when trying to use the <strong><code>=?&gt;</code></strong> operator, and some obvious suggestions how we can further simplify the syntax for calling any member function of a map or record.</p>
<h1>1. Problems trying to use the <strong><code>=?&gt;</code></strong> operator</h1>
<p>Here are the main problems I ran into.</p>
<p><strong>Problem1</strong>. The <strong><code>=?&gt;</code></strong> operator was:</p>
<ul>
<li>weird-looking;</li>
<li>difficult to use;</li>
<li>difficult to understand;</li>
<li>difficult to read;</li>
<li>feeling unnatural.
It would be much better if we didn't have to use any special operator at all in order to call a member function "<strong><em><code>myFunction</code></em></strong>" of a map <strong><em><code>$m</code></em></strong> by simply:
<strong><em><code>$m?myFunction(&lt;tuple of any arguments defined in the signature of the function&gt;)</code></em></strong></li>
</ul>
<p><strong>Problem2</strong>. There is no example, in the sections that describe the record type (<strong><em><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#lookup-arrow-expression">3.2.8.3</a></em></strong>), showing a record member-function that accesses the values of other members of the same instance of the record.
<strong>Thus, the new feature is effectively hidden</strong> for people who want to work with records.
We need such an example for a record, so that we don't forget that any record is also a map and possesses all functionality a map has to offer. And a statement to this effect must be added to the description of records.</p>
<p><strong>Problem 3</strong>.  This syntax is overcomplicated and difficult to use and remember, resulting in unnecessarily long and complex expressions:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn($this) { $this?width * $this?height }
} 
return $rectangle =?&gt; area()
</code></pre>
<p>It would be significantly better to use a much simplified syntax such as:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn() { ?width * ?height }
} 
return $rectangle ? area()
</code></pre>
<p>Recognizing that <strong><em><code>?name</code></em></strong> is already used since XPath 3.1 as <strong><a href="https://www.w3.org/TR/2017/REC-xpath-31-20170321/#id-unary-lookup">Unary Lookup Operator</a></strong>, and to avoid the unlikely case of collision, when a member function accesses other members of the map-owner-instance that happen to have identically the same names as expected constituents of the current context item (upon which the function is applied), we can introduce a special character to denote the current map-owner-instance, thus the above example could look like this:</p>
<pre><code class="language-xq">let $rectangle := {
  "width": 20,
  "height": 12,
  "area": fn() { ^width * ^height }
} 
return $rectangle ? area()
</code></pre>
<h1>Solutions</h1>
<p><strong>Solution for Problem 1</strong> above (weirdness of the <strong><em><code>=?&gt;</code></em></strong> operator:<br>
<em>Do not introduce any special operator</em>. Just use <code>?</code> to invoke the member-function.</p>
<p><strong>Solution for Problem 2</strong> above (lack of example of a record having a member-function that accesses other members of the same map-owner-instance).
Obviously, <em>provide such an example</em>. Also <em>reiterate there that all features and functionality of a map continue to be available for records</em>.</p>
<p><strong>Solution for Problem 3</strong> above (overcomplicated syntax:</p>
<ul>
<li>Get rid of the <strong><em><code>=?&gt;</code></em></strong> operator. Use <strong><code>?</code></strong> for all references to member-functions.</li>
<li>Don't use any special variable like <strong><em><code>$this</code></em></strong>. For example, the current example in the documentation:
<code>"area": fn($this) { $this?width * $this?height }</code>
should instead be:
<code>"area": fn() { ^width * ^height }</code></li>
<li>use the <strong><code>^</code></strong> character to denote <em>owner-map-instance</em> membership. Thus <strong><em><code>^width</code></em></strong> means: "<em>The member named <strong>"width"</strong> of the map instance upon which the current function was invoked</em>"</li>
</ul>
<h1>Conclusion</h1>
<p>I will issue a PR with the solutions, provided there are not any substantial comments hilighting problems with this proposal.</p>
</div></details></div>
<div class="toot" id="created-1799"><h2>Issue #1799 created<span class="toot-id"> #created-1799</span></h2><div class="pubdate">13 Feb at 20:43:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1799">https://github.com/qt4cg/qtspecs/issues/1799</a></div><details><summary>"well-formed HTML document"?</summary><div class="markup"><p>There is an apparent ambiguity in the XPath Functions specification as to whether <code>fn:parse-html</code> raises dynamic error err:FODC0011 when <code>html-version</code> is set to one of the HTML5 versions <em>and</em> the content of <code>$html</code> is not well-formed, given the general expectation that HTML5 parsers can always parse an input string regardless of syntactic validity.</p>
<p>The HTML5 standard, for its part, has actually always allowed the parser to be aborted upon encountering a parse error (though no browser does this), so the function definition would seem to require that <code>parse-html("&lt;p&gt;Hello&lt;/p&gt;", { "method": "html", "html-version": 5 })</code> invariably raises an error, given that the input is invalid (missing opening <code>&lt;html&gt;</code> tag, etc.).</p>
<p>I don't think this is the intended behavior; my suggestion is to either have it be explicitly implementation-defined as to which parse errors cause err:FODC0011 to be raised, or require that it is never raised for HTML5.</p>
</div></details></div>
<div class="toot" id="closed-1238"><h2>Issue #1238 closed<span class="toot-id"> #closed-1238</span></h2><div class="pubdate">12 Feb at 23:39:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1238">https://github.com/qt4cg/qtspecs/issues/1238</a></div><p>XSLT on-no-match="shallow-copy-all" - revised rules</p></div>
<div class="toot" id="created-1798"><h2>Issue #1798 created<span class="toot-id"> #created-1798</span></h2><div class="pubdate">12 Feb at 20:37:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1798">https://github.com/qt4cg/qtspecs/issues/1798</a></div><details><summary>Getting the value of the new identity-(DM)property of a function. `fn:function-identity`</summary><div class="markup"><p>The current set of <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions">Functions on Functions</a></strong>: at <strong>(https://qt4cg.org/specifications/xpath-functions-40/Overview.html#functions-on-functions)</strong> was recently updated with a new function to produce all annotations for a given function: <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-function-annotations">fn:function-annotations</a></strong>.
However we are still missing the ability to reference another important, newly-added property of a function: the <strong>function identity: <a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items">in DM</a></strong> and <strong><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-function-identity">in XPath</a></strong>.</p>
<hr>
<h1><strong>fn:function-identity</strong></h1>
<p><strong>Summary</strong>
Returns <strong><em><a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html#function-items">the identity of the function item</a></em></strong>.</p>
<p><strong>Signature</strong></p>
<blockquote>
<p><strong>fn:function-identity(
&nbsp;&nbsp;$function	as fn(*)	
) as xs:string</strong></p>
</blockquote>
<p><strong>Properties</strong>
This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<p><strong>Notes</strong></p>
<ol>
<li>This function can be useful  in any scenario, where the evaluation of a function call requires repeated evaluation of this same, or other functions. Often in such cases, the algorithm needs access to a general structure, containing the cached results of executing possibly many different functions applied on specific arguments-tuples.
What <strong>unique key</strong> is needed under which to group all invocations of a specific function and then the mapping between their function-call arguments and the result of the call? Remarkably, the identity of a function fits exactly the requirements (uniqueness / one per function) for such a key.
As we already have a function-identity property in the Data Model for each function-item, it is straightforward to provide this identity, and the <strong><code>fn:function-identity</code></strong> does exactly that.</li>
<li>The function identity, by definition, is generated upon the creation of a function and has meaning throughout of the life of that function. It is not meaningful to store this value across different executions, because the identity given to a function in <em>execution1</em> will generally be different from the identity, given to it in <em>execution2</em>. However, the definitions of system functions (functions defined in the specifications under the system namespaces - with standard prefixes: <strong><em><code>xs</code>, <code>fn</code>, <code>map</code>, <code>array</code>, <code>math</code>, <code>err</code>, <code>output</code></em></strong>) can be assigned permanent identities in the official Specs documents, requiring every implementation to use exactly this published identity value for the official, system functions, thus achieving efficiency and convenience during debugging.</li>
<li>The function identity, being a string, can be used as a key in a map, thus making it possible to map a particular function to a sequence of items. It becomes possible to allow function items as map-keys by extending the definition of <strong><em><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-same-key">same-keys</a></em></strong> with: "If both keys are function items: <code>$f1</code> and <code>$f2</code>, then they are <strong>the same</strong> if and only if:
<strong><em><code>function-identity($f1) eq function-identity($f2)</code></em></strong></li>
</ol>
</div></details></div>
<div class="toot" id="created-1797"><h2>Issue #1797 created<span class="toot-id"> #created-1797</span></h2><div class="pubdate">12 Feb at 16:20:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1797">https://github.com/qt4cg/qtspecs/issues/1797</a></div><details><summary>elements-to-maps: separate function to construct a plan</summary><div class="markup"><p>I propose separating out the <code>uniform=true</code> option of <code>elements-to-maps()</code> into a separate function. This function analyses the data and produces a conversion plan, which can be supplied to the "layouts" option (perhaps renamed) of the main function.</p>
<p>The benefits are:</p>
<ul>
<li>The plan can be tweaked after it is created by manual adjustment, for example if the user wants to use "empty-plus" layout wherever the system's choice would be "empty", or to take account of anticipated future changes in the structure.</li>
<li>The plan can be used to process documents that did not exist at the time it was created, thus ensuring that future documents are all converted in the same way, and avoiding the overhead of rebuilding the plan each time.</li>
<li>The plan can be created from a small sample of the documents to be converted.</li>
<li>The plan can be created from a large collection of documents including documents that don't need to be converted but which may contain structural elements that are not revealed by the documents that need converting now.</li>
<li>The user can examine the plan to see what it is doing, which is useful for diagnostics.</li>
</ul>
<p>We should define the format of the plan (a map from element names to layouts) so that it can conveniently be serialized as a JSON document.</p>
</div></details></div>
<div class="toot" id="created-1796"><h2>Issue #1796 created<span class="toot-id"> #created-1796</span></h2><div class="pubdate">12 Feb at 14:46:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1796">https://github.com/qt4cg/qtspecs/issues/1796</a></div><details><summary>Allow fn:invisible-xml to return a function that returns an item()</summary><div class="markup"><p>Our current <code>fn:invisible-xml</code> function returns a document node. That makes perfect sense when held up against the Invisible XML specification. But I wonder if we should leave the door open to some extensibility. I can imagine, for example, an implementation of an Invisible XML processor that has the ability to return a map or even a CSV structure instead of XML. (XML is the required, standard result in 1.0 but implementors have been known to offer user options to produce other serializations and one area of potential change in the future is other serialization formats.)</p>
<p>Pro: more extensible. Con: less type information about the result.</p>
</div></details></div>
<div class="toot" id="created-1795"><h2>Issue #1795 created<span class="toot-id"> #created-1795</span></h2><div class="pubdate">12 Feb at 12:51:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1795">https://github.com/qt4cg/qtspecs/issues/1795</a></div><details><summary>XSLT templates: Matching values in a map by key</summary><div class="markup"><p>The simplest coding pattern for template rule processing for JSON structures would be to take a structure like this:</p>
<pre><code>[
   {"name": "John", "address": { .... }, job-history: [ { .... }, {....} ]},
   {"name": "Jane", "address": { .... }, job-history: [ { .... }, {....} ]}
]

and to process it using template rules of the form:

&lt;xsl:template match="record(name, address, job-history)"&gt;
    &lt;xsl:apply-templates select="?*"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'name')"&gt;...&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'address')"&gt;...&lt;/xsl:template&gt;

&lt;xsl:template match="(pattern matching key 'job-history')"&gt;...&lt;/xsl:template&gt;
</code></pre>
<p>We have nearly all the ingredients in place for this. In particular, we can ensure that the <code>select="?*"</code> selects values that are labelled with the relevant key, making it technically possible to match values according to that key: <code>select="?*"</code> might select an xs:string value "John", but the string is labelled with the property key="name", so it can in principle match a template rule designed to process the "name" value.</p>
<p>The only piece that's missing is how to write the match patterns. We can write <code>match=".[label()?key = 'name']"</code>, but that's hopelessly long-winded.</p>
<p>I propose that we use the syntax <code>match="?name"</code> to match a value that is labelled with the key "name". This feels intuitive and natural, and 99% of users won't trouble with the complex underlying semantics.</p>
<p>We can extend this by borrowing other parts of the Lookup expression syntax, for example <code>match="?('X', 'Y', 'Z')"</code> to match several keys.</p>
<p>I would also suggest promoting the operators "union", "intersect" and "except" so they can be used to combine any patterns (not just node patterns) so this could be written <code>match="?X | ?X | ?Z"</code>, or we could write <code>match="?* except ?X"</code>. But note that this would create an expectation that users can also write <code>select="?* except ?X"</code> in an XPath expression; and that's quite hard to achieve: see also #1794.</p>
</div></details></div>
<div class="toot" id="created-1794"><h2>Issue #1794 created<span class="toot-id"> #created-1794</span></h2><div class="pubdate">12 Feb at 12:03:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1794">https://github.com/qt4cg/qtspecs/issues/1794</a></div><details><summary>Lookup: select all except</summary><div class="markup"><p>In lookup expressions we have <code>?*</code> to select all entries, and <code>?X</code> to select a specific entry. There is frequently a requirement to select all entries with specific exceptions.</p>
<p>One way of doing this is <code>$map =&gt; map:remove('X')?*</code></p>
<p>Another is to do <code>$map?pairs::*[?key != 'X']?value</code></p>
<p>A third option is <code>$map?[?key != 'X']?*</code></p>
<p>Or <code>$map =&gt; map:filter(($k, $v){$k != 'X'})?*</code></p>
<p>Or <code>for key $k value $v in $map where $k != 'X' return $v</code></p>
<p>None of these feels particularly user-friendly.</p>
<p>A possible syntax might be <code>$map?-X</code> or more generally <code>"?" "-" KeySpecifier</code> to select all entries that are not selected by the <code>KeySpecifier</code>. For example this would allow <code>$map?-('X', 'Y')</code> to exclude <code>X</code> and <code>Y</code>,</p>
</div></details></div>
<div class="toot" id="closed-1782"><h2>Issue #1782 closed<span class="toot-id"> #closed-1782</span></h2><div class="pubdate">12 Feb at 11:42:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1782">https://github.com/qt4cg/qtspecs/pull/1782</a></div><p>1776 Add lookup patterns using ? and ??</p></div>
<div class="toot" id="closed-1781"><h2>Issue #1781 closed<span class="toot-id"> #closed-1781</span></h2><div class="pubdate">11 Feb at 21:52:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1781">https://github.com/qt4cg/qtspecs/issues/1781</a></div><p>XSLT: drop section 23 (Processing JSON Data) and Appendix B</p></div>
<div class="toot" id="closed-1792"><h2>Issue #1792 closed<span class="toot-id"> #closed-1792</span></h2><div class="pubdate">11 Feb at 17:34:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1792">https://github.com/qt4cg/qtspecs/issues/1792</a></div><p>Schema validation errors on function catalog for EXPath binary spec</p></div>
<div class="toot" id="closed-1793"><h2>Issue #1793 closed<span class="toot-id"> #closed-1793</span></h2><div class="pubdate">11 Feb at 17:34:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1793">https://github.com/qt4cg/qtspecs/pull/1793</a></div><p>1792 Make function-catalog file schema-valid</p></div>
<div class="toot" id="created-1793"><h2>Pull request #1793 created<span class="toot-id"> #created-1793</span></h2><div class="pubdate">11 Feb at 17:34:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1793">https://github.com/qt4cg/qtspecs/pull/1793</a></div><details><summary>1792 Make function-catalog file schema-valid</summary><div class="markup"><p>Fix #1792</p>
</div></details></div>
<div class="toot" id="created-1792"><h2>Issue #1792 created<span class="toot-id"> #created-1792</span></h2><div class="pubdate">11 Feb at 17:29:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1792">https://github.com/qt4cg/qtspecs/issues/1792</a></div><details><summary>Schema validation errors on function catalog for EXPath binary spec</summary><div class="markup"><p>I'm seeing schema validation errors after rebasing, it looks like PR #1765 introduced lines like</p>
<p><code>&lt;fos:changes issue="1751"&gt;</code></p>
<p>when the @issue attribute should be on the child fos:change element.</p>
<p>Perhaps the validation done by the build has improved.</p>
<p>I'll fix this in a separate PR to be emergency-applied.</p>
</div></details></div>
<div class="toot" id="minutes—02-11"><h2>QT4 CG meeting 109 draft minutes<span class="toot-id"> #minutes—02-11</span></h2><div class="pubdate">11 Feb at 17:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-11">https://qt4cg.org/meeting/minutes/2025/02-11</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1779"><h2>Issue #1779 closed<span class="toot-id"> #closed-1779</span></h2><div class="pubdate">11 Feb at 17:04:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1779">https://github.com/qt4cg/qtspecs/issues/1779</a></div><p>XPath 4.0 EBNF grammar</p></div>
<div class="toot" id="closed-1783"><h2>Issue #1783 closed<span class="toot-id"> #closed-1783</span></h2><div class="pubdate">11 Feb at 17:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1783">https://github.com/qt4cg/qtspecs/pull/1783</a></div><p>1779 Make CharRef XQuery-only</p></div>
<div class="toot" id="closed-1752"><h2>Issue #1752 closed<span class="toot-id"> #closed-1752</span></h2><div class="pubdate">11 Feb at 17:02:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1752">https://github.com/qt4cg/qtspecs/issues/1752</a></div><p>Return type of fn:partition()</p></div>
<div class="toot" id="closed-1761"><h2>Issue #1761 closed<span class="toot-id"> #closed-1761</span></h2><div class="pubdate">11 Feb at 17:02:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1761">https://github.com/qt4cg/qtspecs/pull/1761</a></div><p>1752 Correct return type of fn:partition()</p></div>
<div class="toot" id="closed-1751"><h2>Issue #1751 closed<span class="toot-id"> #closed-1751</span></h2><div class="pubdate">11 Feb at 17:00:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1751">https://github.com/qt4cg/qtspecs/issues/1751</a></div><p>bin:encode-string - should the result have a BOM?</p></div>
<div class="toot" id="closed-1765"><h2>Issue #1765 closed<span class="toot-id"> #closed-1765</span></h2><div class="pubdate">11 Feb at 17:00:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1765">https://github.com/qt4cg/qtspecs/pull/1765</a></div><p>1751 Clarify BOM handling</p></div>
<div class="toot" id="closed-1770"><h2>Issue #1770 closed<span class="toot-id"> #closed-1770</span></h2><div class="pubdate">11 Feb at 16:58:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1770">https://github.com/qt4cg/qtspecs/issues/1770</a></div><p>Union patterns in XSLT</p></div>
<div class="toot" id="closed-1772"><h2>Issue #1772 closed<span class="toot-id"> #closed-1772</span></h2><div class="pubdate">11 Feb at 16:58:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1772">https://github.com/qt4cg/qtspecs/pull/1772</a></div><p>1770 Default priority of rules with a union pattern</p></div>
<div class="toot" id="closed-402"><h2>Issue #402 closed<span class="toot-id"> #closed-402</span></h2><div class="pubdate">11 Feb at 16:56:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/402">https://github.com/qt4cg/qtspecs/issues/402</a></div><p>XSLT patterns: intersect and except</p></div>
<div class="toot" id="closed-1773"><h2>Issue #1773 closed<span class="toot-id"> #closed-1773</span></h2><div class="pubdate">11 Feb at 16:56:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1773">https://github.com/qt4cg/qtspecs/pull/1773</a></div><p>402 Change the semantics of intersect and except in patterns</p></div>
<div class="toot" id="closed-1784"><h2>Issue #1784 closed<span class="toot-id"> #closed-1784</span></h2><div class="pubdate">11 Feb at 16:53:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1784">https://github.com/qt4cg/qtspecs/pull/1784</a></div><p>1781 Drop obsolete material from XSLT spec</p></div>
<div class="toot" id="closed-755"><h2>Issue #755 closed<span class="toot-id"> #closed-755</span></h2><div class="pubdate">11 Feb at 16:51:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/755">https://github.com/qt4cg/qtspecs/issues/755</a></div><p>with expression; chaining and concatenation</p></div>
<div class="toot" id="closed-877"><h2>Issue #877 closed<span class="toot-id"> #closed-877</span></h2><div class="pubdate">11 Feb at 16:51:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/877">https://github.com/qt4cg/qtspecs/issues/877</a></div><p>Inconsistency in XQFO comparator functions/operators with recursive rules</p></div>
<div class="toot" id="closed-1729"><h2>Issue #1729 closed<span class="toot-id"> #closed-1729</span></h2><div class="pubdate">11 Feb at 16:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1729">https://github.com/qt4cg/qtspecs/issues/1729</a></div><p>Grammar problems introduced by #1721</p></div>
<div class="toot" id="closed-1767"><h2>Issue #1767 closed<span class="toot-id"> #closed-1767</span></h2><div class="pubdate">11 Feb at 16:50:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1767">https://github.com/qt4cg/qtspecs/pull/1767</a></div><p>1729/1737 Fix grammar for "declare record"</p></div>
<div class="toot" id="created-1791"><h2>Pull request #1791 created<span class="toot-id"> #created-1791</span></h2><div class="pubdate">11 Feb at 11:12:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1791">https://github.com/qt4cg/qtspecs/pull/1791</a></div><details><summary>1789 Fix singleton terminology</summary><div class="markup"><p>Replaces "singleton map" with "single-entry map" and "singleton array" with "single-member array"; the term "singleton" now always means count()=1, not size()=1.</p>
<p>Fix #1789</p>
</div></details></div>
<div class="toot" id="created-1790"><h2>Pull request #1790 created<span class="toot-id"> #created-1790</span></h2><div class="pubdate">11 Feb at 10:04:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1790">https://github.com/qt4cg/qtspecs/pull/1790</a></div><details><summary>1788 Replace statement that maps are unordered</summary><div class="markup"><p>Fix #1788</p>
</div></details></div>
<div class="toot" id="created-1789"><h2>Issue #1789 created<span class="toot-id"> #created-1789</span></h2><div class="pubdate">11 Feb at 09:00:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1789">https://github.com/qt4cg/qtspecs/issues/1789</a></div><details><summary>Terminology: "singleton map"</summary><div class="markup"><p>We often use the term "singleton map" to mean a map containing a single entry (key-value pair).</p>
<p>But in XQ 4.14.3.1 we use the same term to mean "a sequence containing a single map".</p>
</div></details></div>
<div class="toot" id="created-1788"><h2>Issue #1788 created<span class="toot-id"> #created-1788</span></h2><div class="pubdate">10 Feb at 14:50:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1788">https://github.com/qt4cg/qtspecs/issues/1788</a></div><details><summary>Drop reference to maps being unordered</summary><div class="markup"><p>In F&amp;O 17.5.1.5 elements-to-maps record layout, mapping rules, delete</p>
<blockquote>
<p>Because the child elements are converted to a map, their order is not retained.</p>
</blockquote>
<p>Substitute a rule that the entries in the map will correspond with "order of first appearance".</p>
</div></details></div>
<div class="toot" id="agenda-02-11"><h2>QT4 CG meeting 109 draft agenda<span class="toot-id"> #agenda-02-11</span></h2><div class="pubdate">10 Feb at 14:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-11">https://qt4cg.org/meeting/agenda/2025/02-11</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1787"><h2>Issue #1787 created<span class="toot-id"> #created-1787</span></h2><div class="pubdate">10 Feb at 10:47:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1787">https://github.com/qt4cg/qtspecs/issues/1787</a></div><details><summary>Sorted maps revisited</summary><div class="markup"><p>Now that we have ordered maps established, I'd like to make another attempt to introduce sorted maps - that is, maps whose ordering is by key value. The entries in such a map would be sorted by key, but there's no attempt to maintain sort order in subsequent put() operations.</p>
<p>We introduce map:sort($m) essentially as a convenient shorthand for <code>map:of-pairs(sort(map:pairs($m), fn{?key}))</code>.</p>
<p>And then we introduce something like <code>map:get-range($from, $to)</code> which returns the keys (or pairs, or entries) whose keys are in a given range -- which the implementation can optimize if it knows the map has been sorted.</p>
</div></details></div>
<div class="toot" id="created-1786"><h2>Issue #1786 created<span class="toot-id"> #created-1786</span></h2><div class="pubdate">09 Feb at 09:38:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1786">https://github.com/qt4cg/qtspecs/issues/1786</a></div><details><summary>A case study for XSLT transformation of JSON: the transpiler</summary><div class="markup"><p>One of the design aims of XSLT 4.0 is that it should be easier to transform JSON. Back in 2016 I published a paper at XML Prague (https://www.saxonica.com/papers/xmlprague-2016mhk.pdf) with the rather disappointing result that for a couple of non-trivial JSON transformation tasks, the easiest solution was to convert the JSON to XML, transform the XML, and then convert it back. In many ways it was that discovery that motivated the whole XSLT 4.0 project. So I want to review to what extent we have solved that problem, and what remains to be done. In particular, I have recently raised a number of open issues related to how we transform JSON-derived trees of maps and arrays using template rules, and I'm not sure we can resolve those issues without testing the proposals against real use cases.</p>
<p>I'm proposing to take as a case study the Java-to-C# transpiler which we described in a 2021 paper at https://www.saxonica.com/papers/markupuk-2021mhk.pdf. This is a real XSLT application in daily use. It invokes the (open source) JavaParser to emit an XML representation of Java source code, it performs various transformations of that XML, and then finally spits out equivalent C# source code. My basic question is: suppose the JavaParser had chosen to emit JSON instead of XML (as it might perfectly reasonably have chosen to do). Would we be able to write the transpiler in XSLT 4.0 to work entirely within the JSON space, avoiding all use of XML?</p>
<p>I chose this case study for several reasons:</p>
<ul>
<li>It's entirely plausible that the input might have been JSON rather than XML</li>
<li>The application relies very heavily (and successfully) on rule-based processing: if we didn't have template rules, then it would be dominated by large xsl:choose statements with hundreds of branches.</li>
<li>At around 5000 lines of XSLT, it's large enough to be non-trivial, yet small enough to be tractable as a case study.</li>
</ul>
<p>I looked at a couple of other candidates, and found they were things that could be readily done in XSLT 3.0 without any enhancements. For example we have production XSLT 3.0 code that takes a JSON data feed from our online shop at saxonica.com and uses it to update our sales database and to generate license keys. The JSON is voluminous but the structure is simple, and the constructs in XSLT 3.0 for handling maps and arrays are entirely up to the job. The transpiler differs in that the JSON has a much more interesting recursive structure, making rule-based transformation a natural fit to the task.</p>
<p>I'm not proposing to actually produce a complete replacement of the current transpiler, only to explore the task of doing so in enough detail to get some useful insights. I propose to use this issue tracker to capture my working notes as the study proceeds, but if there are recommendations affecting the 4.0 specs (as seems likely), then I will extract those into separate issues. Perhaps at the end of the process I will write up the case study as a conference paper.</p>
<p>My rough plan is as follows:</p>
<ol>
<li>Explore conversion of the current XML output by JavaParser to JSON using the new elements-to-maps() function. We have a number of open issues on the usability of this function and it will be interesting to see whether we encounter similar difficulties to those that have already been raised, and whether the suggested solutions are appropriate.</li>
<li>Convert the xml-to-java stylesheet to work on this JSON input. This stylesheet is not actually a working part of the transpiler, rather it's something we built as a stepping stone; before attempting to convert the XML syntax tree to C#, we felt it would be instructive to write code that converted it back to Java. This is an 820-line stylesheet and it should be feasible to convert it completely.</li>
<li>The transpiler currently produces, as an intermediate output, a "digest" file containing summary information about all the classes and methods found in the Java code, and their subtyping/override relationships. We then have a process that augments this digest with attributes that are needed by the C# generation, for example which methods to label with "virtual" or "override" modifiers. I propose to experiment with producing (and transforming) this digest in JSON rather than XML format.</li>
<li>Examine the XSLT code that generates C# output to look for features that appear to be tricky to convert, for example anything that uses the parent or ancestor axis, and study to what extent we now have the capability in XSLT 4.0 to handle those situations.</li>
</ol>
<p>Using this format (a GitHub issue) to record progress carries a risk that there will be comments that take things off at a tangent. Please help by resisting that temptation: if there are interesting issues raised in your mind, please take those up as separate issues.</p>
</div></details></div>
<div class="toot" id="created-1785"><h2>Issue #1785 created<span class="toot-id"> #created-1785</span></h2><div class="pubdate">08 Feb at 08:57:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1785">https://github.com/qt4cg/qtspecs/issues/1785</a></div><details><summary>XQuery 4.0 grammar: `ArrowExpr` target, `ReverseAxis`</summary><div class="markup"><p>While testing the parser generated from the specification grammar, I encountered two issues.</p>
<h3>1. <code>ArrowExpr</code> target must be optional</h3>
<p>The current definition in the specification is as follows:</p>
<pre><code>ArrowExpr ::= UnaryExpr (SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget)
</code></pre>
<p>However, the target part must at least be optional, or better zero-or-more:</p>
<pre><code>ArrowExpr ::= UnaryExpr (SequenceArrowTarget | MappingArrowTarget | LookupArrowTarget)*
</code></pre>
<p>Otherwise arrow targets are expected almost everywhere. Making it zero-or-more allows parsing of</p>
<pre><code>a =&gt; b() =&gt; c()
</code></pre>
<p>which would not be possible without extra parentheses if it was optional.</p>
<h3>2. Missing <code>preceding-sibling</code> in <code>ReverseAxis</code></h3>
<p>The <code>ReverseAxis</code> production currently appears as:</p>
<pre><code>ReverseAxis ::= ( "ancestor"
                | "ancestor-or-self"
                | "parent"
                | "preceding"
                | "preceding-or-self"
                | "preceding-sibling-or-self" ) "::"
</code></pre>
<p>It is missing the <code>prededing-sibling</code> axis.</p>
</div></details></div>
<div class="toot" id="created-1784"><h2>Pull request #1784 created<span class="toot-id"> #created-1784</span></h2><div class="pubdate">07 Feb at 21:45:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1784">https://github.com/qt4cg/qtspecs/pull/1784</a></div><details><summary>1781 Drop obsolete material from XSLT spec</summary><div class="markup"><p>Drops material mainly deriving from when XSLT 3.0 had to work with both XPath 3.0 and 3.1. Includes non-normative exposition and some obsolete conformance statements.</p>
</div></details></div>
<div class="toot" id="created-1783"><h2>Pull request #1783 created<span class="toot-id"> #created-1783</span></h2><div class="pubdate">07 Feb at 21:03:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1783">https://github.com/qt4cg/qtspecs/pull/1783</a></div><details><summary>1779 Make CharRef XQuery-only</summary><div class="markup"><p>Fix #1779</p>
<p>Makes the CharRef token XQuery-only.</p>
</div></details></div>
<div class="toot" id="created-1782"><h2>Pull request #1782 created<span class="toot-id"> #created-1782</span></h2><div class="pubdate">07 Feb at 12:46:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1782">https://github.com/qt4cg/qtspecs/pull/1782</a></div><details><summary>1776 Add lookup patterns using ? and ??</summary><div class="markup"><p>Fix #1776</p>
</div></details></div>
<div class="toot" id="closed-1026"><h2>Issue #1026 closed<span class="toot-id"> #closed-1026</span></h2><div class="pubdate">07 Feb at 12:44:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1026">https://github.com/qt4cg/qtspecs/issues/1026</a></div><p>XSLT match patterns on pinned maps and arrays</p></div>
<div class="toot" id="created-1781"><h2>Issue #1781 created<span class="toot-id"> #created-1781</span></h2><div class="pubdate">07 Feb at 12:15:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1781">https://github.com/qt4cg/qtspecs/issues/1781</a></div><details><summary>XSLT: drop section 23 (Processing JSON Data) and Appendix B</summary><div class="markup"><p>Section 23 Processing JSON data at one time contained the specification of maps, before this moved into XPath 3.1. This has now gone, and what's left is pretty much content-free.</p>
<p>Appendix B contains a stylesheet for converting XML to JSON. It has some educational value, but not much, and I think it can go.</p>
</div></details></div>
<div class="toot" id="created-1780"><h2>Issue #1780 created<span class="toot-id"> #created-1780</span></h2><div class="pubdate">07 Feb at 11:49:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1780">https://github.com/qt4cg/qtspecs/issues/1780</a></div><details><summary>xsl:for-each optional variable introduction</summary><div class="markup"><p>I spend quite a lot of time writing</p>
<pre><code>&lt;xsl:for-each select="foo"&gt;
   &lt;xsl:variable name="foo" select="." as="element(foo)"/&gt;
   &lt;xsl:for-each select="$foo/bar"&gt;
      &lt;xsl:variable name="bar" select="." as="element(bar)"/&gt;
      .... do some stuff with $foo and $bar
   &lt;/xsl:for-each&gt;
&lt;/xsl:for-each&gt;
</code></pre>
<p>I'd prefer to go (much like xquery)</p>
<pre><code>&lt;xsl:for-each name="foo" as="element(foo)" select="foo"&gt;
   &lt;xsl:for-each name="bar" as="element(bar)" select="$foo/bar"&gt;
      .... do some stuff with $foo and $bar
   &lt;/xsl:for-each&gt;
&lt;/xsl:for-each&gt;
</code></pre>
</div></details></div>
<div class="toot" id="created-1779"><h2>Issue #1779 created<span class="toot-id"> #created-1779</span></h2><div class="pubdate">07 Feb at 11:44:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1779">https://github.com/qt4cg/qtspecs/issues/1779</a></div><details><summary>XPath 4.0 EBNF grammar</summary><div class="markup"><p>The grammar extraction and transformation in <a href="https://github.com/GuntherRademacher/rex-parser-generator/actions/workflows/rexify-xquery-40.yml">RExify XQuery 4.0 grammar</a> has been extended to cover the XPath 4.0 specification document, resulting in an LALR(1) grammar for XPath 4.0 that is suitable for REx.</p>
<p>This update revealed a minor issue: section <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#terminal-symbols">A.3.1 Terminal Symbols</a> lists <code>CharRef</code>, which is unreferenced:</p>
<pre><code>CharRef       ::= [http://www.w3.org/TR/REC-xml#NT-CharRef]
                                                         /* xgc: xml-version */
</code></pre>
<p>Currently, the transformation process includes a rule that removes this production. The rules will be adjusted as the grammar evolves.</p>
</div></details></div>
<div class="toot" id="created-1778"><h2>Pull request #1778 created<span class="toot-id"> #created-1778</span></h2><div class="pubdate">07 Feb at 10:31:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1778">https://github.com/qt4cg/qtspecs/pull/1778</a></div><details><summary>1456 Lookup expressions filtered by type</summary><div class="markup"><p>Fix #1456</p>
<p>Allows selection of records by type within a JSON tree, for example <code>$json ?? ~record(first, last) ? last</code>.</p>
<p>I'm aware that the use of the tilde here is controversial but I think this kind of query is going to be very common; it needs something simple and I think people will get used to it. No-one has suggested anything that is obviously better, and I propose to also use <code>~</code> in other similar contexts, for example type patterns in XSLT, which will increase familiarity.</p>
<p>I suggest reading <code>~</code> as "of type".</p>
</div></details></div>
<div class="toot" id="created-1777"><h2>Issue #1777 created<span class="toot-id"> #created-1777</span></h2><div class="pubdate">06 Feb at 18:35:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1777">https://github.com/qt4cg/qtspecs/issues/1777</a></div><details><summary>Shallow copy in XSLT with maps and arrays</summary><div class="markup"><p>Currently the <code>xsl:copy</code> instruction, if applied to a map or array, does a deep copy, and ignores the content of the contained sequence constructor.</p>
<p>I propose that if the contained sequence constructor is non-empty then instead of ignoring it, we should use it to create the content of the new map or array. Specifically, for maps xsl:copy will behave essentially like xsl:map, and for arrays it will behave essentially like xsl:array.</p>
<p>This is an incompatibility with 3.1, but since a contained sequence constructor is currently totally useless in this situation, it doesn't seem likely to cause any trouble.</p>
<p>I also propose that rather than using the new built-in <code>on-no-match="shallow-copy-all</code>, we should extend the semantics of <code>shallow-copy</code> to cover maps and arrays (as currently defined for <code>shallow-copy-all</code>). Again, there is an incompatibility, but the current rules are so unhelpful that it's unlikely people are relying on them.</p>
<p>I also propose that when apply-templates is applied to a map or array, it should be automatically pinned if it is not pinned already. The means that match patterns can be used with a lot more context to match the deep contents of the map or array and override the processing of the built-in templates.</p>
<p>And I propose that when apply-templates is applied to a map or array and there is no <code>select</code> attribute, it should "do the right thing" by applying templates to the map or array contents, rather than using the useless default of <code>child::node()</code>.</p>
</div></details></div>
<div class="toot" id="created-1776"><h2>Issue #1776 created<span class="toot-id"> #created-1776</span></h2><div class="pubdate">06 Feb at 18:24:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1776">https://github.com/qt4cg/qtspecs/issues/1776</a></div><details><summary>Using `?` and `??` in XSLT patterns</summary><div class="markup"><p>I propose that the pattern <code>P1 ? P2</code>, where <code>P1</code> and <code>P2</code> are patterns, should match any labelled item $L provided that $L matches P2, and <code>$L?..</code> (that is, <code>($L =&gt; label())?parent</code> ) matches <code>P1</code>.</p>
<p>Similarly, the pattern <code>P1 ?? P2</code>, where <code>P1</code> and <code>P2</code> are patterns, should match any labelled item $L provided that $L matches P2, and <code>$L?...</code> (that is, <code>($L =&gt; label())?ancestors()</code> ) matches <code>P1</code>.</p>
<p>Note that neither the syntax nor the semantics are directly related to the lookup operator in XPath. In particular, P2 is a pattern, not a KeySpecifier. But there is a strong analogy, both with the use of <code>?</code> and <code>??</code> in XPath expressions, and with the use of <code>/</code> and <code>//</code> in patterns.</p>
</div></details></div>
<div class="toot" id="created-1775"><h2>Issue #1775 created<span class="toot-id"> #created-1775</span></h2><div class="pubdate">06 Feb at 18:11:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1775">https://github.com/qt4cg/qtspecs/issues/1775</a></div><details><summary>Navigation in JSON trees</summary><div class="markup"><p>I propose that the parse-json function should create a pinned tree, so that upwards navigation to parent and ancestor j-nodes becomes possible.</p>
<p>I propose introducing the key specifier <code>..</code>, with <code>$M?..</code> being a shorthand for <code>($M =&gt; label())?parent</code>, giving a convenient and familiar way to navigate from a j-node to its parent in a pinned tree. For example, <code>$M?..?name</code> gives the value of the <code>name</code> property in the immediately containing map.</p>
<p>Similarly, I propose introducing the key specifier <code>...</code> to navigate to ancestors, so <code>$M?...</code> becomes a shorthand for <code>($M =&gt; label())?ancestors()</code>, and <code>$M?...?name</code> returns the <code>name</code> property of all containing maps.</p>
<p>For symmetry I suggest we also provide <code>...</code> as an abbreviated axis step, short for <code>ancestor::node()</code>.</p>
<p>I'd like to find a better name for "pinned". Perhaps "tracked" better captures that what it does is to track downward navigation steps and make them reversible.</p>
<p>I'd also like to introduce the terms <code>j-tree</code> and <code>j-node</code>. A j-tree is a map or array, recursively expanded to include its entries or members. A j-node is a value in a j-tree. Perhaps confine the usage to maps and arrays that have been pinned/tracked.</p>
</div></details></div>
<div class="toot" id="created-1774"><h2>Issue #1774 created<span class="toot-id"> #created-1774</span></h2><div class="pubdate">06 Feb at 17:55:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1774">https://github.com/qt4cg/qtspecs/issues/1774</a></div><details><summary>Nomenclature: relabelling</summary><div class="markup"><p>The term <code>relabelling</code> - used when we are down-casting, for example when an <code>xs:integer</code> is supplied and the required type is <code>xs:unsignedByte</code> - is easily confused with the concept of a label, being a set of properties that can be associated with any item in XDM 4.0, and which is accessible through the <code>fn:label</code> function.</p>
<p>I suggest we rename <code>relabelling</code> as <code>rebadging</code>.</p>
<p>Apart from anything else, this has the virtue that my spell-checker won't auto-correct it...</p>
</div></details></div>
<div class="toot" id="closed-1713"><h2>Issue #1713 closed<span class="toot-id"> #closed-1713</span></h2><div class="pubdate">06 Feb at 12:18:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1713">https://github.com/qt4cg/qtspecs/issues/1713</a></div><p>Patchy exposition of XSLT type pattern syntax</p></div>
<div class="toot" id="created-1773"><h2>Pull request #1773 created<span class="toot-id"> #created-1773</span></h2><div class="pubdate">05 Feb at 17:49:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1773">https://github.com/qt4cg/qtspecs/pull/1773</a></div><details><summary>402 Change the semantics of intersect and except in patterns</summary><div class="markup"><p>Fixes a bug in the 3.0 spec whereby the <code>intersect</code> and <code>except</code> operators in a pattern have counter-intuitive semantics.</p>
<p>Fix #402</p>
</div></details></div>
<div class="toot" id="created-1772"><h2>Pull request #1772 created<span class="toot-id"> #created-1772</span></h2><div class="pubdate">05 Feb at 16:50:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1772">https://github.com/qt4cg/qtspecs/pull/1772</a></div><details><summary>1770 Default priority of rules with a union pattern</summary><div class="markup"><p>Scraps the increasingly-complicated rules for handling priority of rules with a union pattern.</p>
<p>Fix #1770</p>
</div></details></div>
<div class="toot" id="created-1771"><h2>Issue #1771 created<span class="toot-id"> #created-1771</span></h2><div class="pubdate">05 Feb at 16:09:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1771">https://github.com/qt4cg/qtspecs/issues/1771</a></div><details><summary>fn:deep-equal: map order</summary><div class="markup"><p>It may not come as a big surprise: A first feature request we received for ordered maps was to be able to take the order into account when comparing maps.</p>
<p>I would propose to add an <code>ordered-map</code> option to <code>fn:deep-equal</code>, which defaults to false:</p>
<pre><code class="language-xquery">(: returns false :)
deep-equal(
  { 1: 'one', 2: 'two' },
  { 2: 'two', 1: 'one' },
  { 'ordered-map': true() }
)
</code></pre>
<p>It should be simple to use and easy to implement.</p>
</div></details></div>
<div class="toot" id="created-1770"><h2>Issue #1770 created<span class="toot-id"> #created-1770</span></h2><div class="pubdate">05 Feb at 16:07:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1770">https://github.com/qt4cg/qtspecs/issues/1770</a></div><details><summary>Union patterns in XSLT</summary><div class="markup"><p>The original XSLT 1.0 rule for union patterns such as <code>match="A|B"</code> said that the default priority was calculated as if there were two separate template rules with <code>match="A"</code> and <code>match="B"</code>. This became more complicated with the introduction of <code>xsl:next-match</code> in XSLT 2.0 - what should happen if the item matches both branches? It became more complicated again in XSLT 3.0 with the introduction of <code>on-multiple-match</code> - is it a multiple match if an item matches both branches? And in 4.0 it's complicated further by the introduction of constructs like <code>match="element(A|B)"</code> which is deemed equivalent to <code>match=A|B</code>.</p>
<p>I would like to break this cycle with a backwards-incompatible change. The default priority of a union pattern should be the numeric maximum of the default priorities of its branches; the treatment as being somewhat-equivalent to two separate template rules should go. We should encourage implementations to issue a compatibility warning if a union pattern appears with no explicit priority, and with multiple branches having different default priority.</p>
</div></details></div>
<div class="toot" id="created-1769"><h2>Pull request #1769 created<span class="toot-id"> #created-1769</span></h2><div class="pubdate">05 Feb at 15:56:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1769">https://github.com/qt4cg/qtspecs/pull/1769</a></div><details><summary>Add links from processing model diagrams</summary><div class="markup"><p>Completes action QT4CG-108-02</p>
<p>I’ve added link targets where necessary. I didn’t try to link closer than that paragraph level, partly because I think that’s the context the reader needs, but also partly because we don’t copy ID values from all elements.</p>
<p>There’s no definition of DM4.</p>
<p>(Review of the link targets and comments on what (if anything) the remaining boxes and labels should link to most appreciated.)</p>
</div></details></div>
<div class="toot" id="closed-1768"><h2>Issue #1768 closed<span class="toot-id"> #closed-1768</span></h2><div class="pubdate">05 Feb at 15:21:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1768">https://github.com/qt4cg/qtspecs/pull/1768</a></div><p>Inline SVG images</p></div>
<div class="toot" id="created-1768"><h2>Pull request #1768 created<span class="toot-id"> #created-1768</span></h2><div class="pubdate">05 Feb at 15:21:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1768">https://github.com/qt4cg/qtspecs/pull/1768</a></div><details><summary>Inline SVG images</summary><div class="markup"><p>In order for links to work in the browser, the SVG has to be inline, not loaded from a separate file. For self-document links, I guess this makes sense.</p>
<p>This is a tools-only change.</p>
</div></details></div>
<div class="toot" id="created-1767"><h2>Pull request #1767 created<span class="toot-id"> #created-1767</span></h2><div class="pubdate">05 Feb at 15:20:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1767">https://github.com/qt4cg/qtspecs/pull/1767</a></div><details><summary>1729/1737 Fix grammar for "declare record"</summary><div class="markup"><p>Fix #1729</p>
<ul>
<li>The syntax should be "declare record", not "declare type record".</li>
<li>All the declarations using annotations should allow multiple annotations.</li>
<li>Added a note about refactoring the grammar to avoid unbounded lookahead.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1766"><h2>Pull request #1766 created<span class="toot-id"> #created-1766</span></h2><div class="pubdate">05 Feb at 12:51:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1766">https://github.com/qt4cg/qtspecs/pull/1766</a></div><details><summary>1715 Drop array bound checking</summary><div class="markup"><p>Fix #1715</p>
<p>Drops array bound checking from <code>array:get</code>, arrays-as-functions, and array lookup. Returns () instead of an error FOAY0001 when the index is out of bounds. This brings arrays and maps into closer alignment.</p>
<p>Drops the <code>$fallback</code> argument of <code>array:get()</code></p>
<p>Adds a new function <code>array:get-if-present()</code> which replicates the old behaviour of <code>array:get()</code>.</p>
<p>Functions such as <code>array:put</code>, <code>array:replace</code>, <code>array:insert-before</code>, <code>array:head</code>, <code>array:tail</code> continue to perform bound checking.</p>
</div></details></div>
<div class="toot" id="closed-1738"><h2>Issue #1738 closed<span class="toot-id"> #closed-1738</span></h2><div class="pubdate">05 Feb at 11:41:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1738">https://github.com/qt4cg/qtspecs/issues/1738</a></div><p>Formatting of lists within notes</p></div>
<div class="toot" id="created-1765"><h2>Pull request #1765 created<span class="toot-id"> #created-1765</span></h2><div class="pubdate">05 Feb at 11:36:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1765">https://github.com/qt4cg/qtspecs/pull/1765</a></div><details><summary>1751 Clarify BOM handling</summary><div class="markup"><p>Fix #1751</p>
<p>Clarifies BOM handling (and byte order generally) in <code>bin:encode-string</code> and <code>bin:decode-string</code>.</p>
<p>Also adds a note to <code>bin:octal</code> for the prevention of possible misunderstanding.</p>
</div></details></div>
<div class="toot" id="closed-1758"><h2>Issue #1758 closed<span class="toot-id"> #closed-1758</span></h2><div class="pubdate">05 Feb at 09:43:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1758">https://github.com/qt4cg/qtspecs/issues/1758</a></div><p>EXPath specification validation problems</p></div>
<div class="toot" id="closed-1759"><h2>Issue #1759 closed<span class="toot-id"> #closed-1759</span></h2><div class="pubdate">05 Feb at 09:43:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1759">https://github.com/qt4cg/qtspecs/pull/1759</a></div><p>Fix validation issues in the EXPath module function catalogs</p></div>
<div class="toot" id="closed-1739"><h2>Issue #1739 closed<span class="toot-id"> #closed-1739</span></h2><div class="pubdate">04 Feb at 23:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1739">https://github.com/qt4cg/qtspecs/issues/1739</a></div><p>Obsolete references to ordering mode</p></div>
<div class="toot" id="closed-1741"><h2>Issue #1741 closed<span class="toot-id"> #closed-1741</span></h2><div class="pubdate">04 Feb at 23:50:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1741">https://github.com/qt4cg/qtspecs/pull/1741</a></div><p>1739 drop references to ordering mode in the static context</p></div>
<div class="toot" id="minutes—02-04"><h2>QT4 CG meeting 108 draft minutes<span class="toot-id"> #minutes—02-04</span></h2><div class="pubdate">04 Feb at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/02-04">https://qt4cg.org/meeting/minutes/2025/02-04</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1757"><h2>Issue #1757 closed<span class="toot-id"> #closed-1757</span></h2><div class="pubdate">04 Feb at 17:10:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1757">https://github.com/qt4cg/qtspecs/issues/1757</a></div><p>Build cleanup: remove the "by hand" diffs</p></div>
<div class="toot" id="closed-1760"><h2>Issue #1760 closed<span class="toot-id"> #closed-1760</span></h2><div class="pubdate">04 Feb at 17:10:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1760">https://github.com/qt4cg/qtspecs/pull/1760</a></div><p>Remove hand-generated diffs from the builds</p></div>
<div class="toot" id="closed-1743"><h2>Issue #1743 closed<span class="toot-id"> #closed-1743</span></h2><div class="pubdate">04 Feb at 17:07:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1743">https://github.com/qt4cg/qtspecs/pull/1743</a></div><p>1738 Formatting of Notes in F&amp;O</p></div>
<div class="toot" id="closed-1733"><h2>Issue #1733 closed<span class="toot-id"> #closed-1733</span></h2><div class="pubdate">04 Feb at 17:05:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1733">https://github.com/qt4cg/qtspecs/issues/1733</a></div><p>ACTION QT4CG-088-04, reworking the processing model diagram</p></div>
<div class="toot" id="closed-1746"><h2>Issue #1746 closed<span class="toot-id"> #closed-1746</span></h2><div class="pubdate">04 Feb at 17:05:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1746">https://github.com/qt4cg/qtspecs/pull/1746</a></div><p>Replace processing model diagrams</p></div>
<div class="toot" id="closed-1750"><h2>Issue #1750 closed<span class="toot-id"> #closed-1750</span></h2><div class="pubdate">04 Feb at 17:03:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1750">https://github.com/qt4cg/qtspecs/issues/1750</a></div><p>EXPath Binary : copy-edits and minor enhancements</p></div>
<div class="toot" id="closed-1753"><h2>Issue #1753 closed<span class="toot-id"> #closed-1753</span></h2><div class="pubdate">04 Feb at 17:03:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1753">https://github.com/qt4cg/qtspecs/pull/1753</a></div><p>1750 Overhaul of EXPath binary spec</p></div>
<div class="toot" id="closed-1571"><h2>Issue #1571 closed<span class="toot-id"> #closed-1571</span></h2><div class="pubdate">04 Feb at 17:03:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1571">https://github.com/qt4cg/qtspecs/issues/1571</a></div><p>Discussion: On the implementability of the specs and helping implementors</p></div>
<div class="toot" id="closed-1699"><h2>Issue #1699 closed<span class="toot-id"> #closed-1699</span></h2><div class="pubdate">04 Feb at 17:02:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1699">https://github.com/qt4cg/qtspecs/issues/1699</a></div><p>XPath function to calculate edit distance between two strings</p></div>
<div class="toot" id="closed-1682"><h2>Issue #1682 closed<span class="toot-id"> #closed-1682</span></h2><div class="pubdate">04 Feb at 17:01:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1682">https://github.com/qt4cg/qtspecs/issues/1682</a></div><p>Type Promotion</p></div>
<div class="toot" id="closed-1734"><h2>Issue #1734 closed<span class="toot-id"> #closed-1734</span></h2><div class="pubdate">04 Feb at 17:01:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1734">https://github.com/qt4cg/qtspecs/pull/1734</a></div><p>1682 Type promotion and operator mapping</p></div>
<div class="toot" id="closed-1764"><h2>Issue #1764 closed<span class="toot-id"> #closed-1764</span></h2><div class="pubdate">04 Feb at 09:18:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1764">https://github.com/qt4cg/qtspecs/issues/1764</a></div><p>Remove the BOM from unparsed text input?</p></div>
<div class="toot" id="created-1764"><h2>Issue #1764 created<span class="toot-id"> #created-1764</span></h2><div class="pubdate">04 Feb at 08:49:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1764">https://github.com/qt4cg/qtspecs/issues/1764</a></div><details><summary>Remove the BOM from unparsed text input?</summary><div class="markup"><p>XML parsing handles the BOM for us, and we say something explicit about the BOM when parsing JSON, but we're silent about the BOM when loading unparsed text. I think the right answer is to discard the BOM and return the text that follows it...</p>
</div></details></div>
<div class="toot" id="closed-1762"><h2>Issue #1762 closed<span class="toot-id"> #closed-1762</span></h2><div class="pubdate">03 Feb at 15:36:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1762">https://github.com/qt4cg/qtspecs/issues/1762</a></div><p>Combining different kinds of arrow</p></div>
<div class="toot" id="created-1763"><h2>Pull request #1763 created<span class="toot-id"> #created-1763</span></h2><div class="pubdate">03 Feb at 15:35:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1763">https://github.com/qt4cg/qtspecs/pull/1763</a></div><details><summary>1716 Generalize syntax of arrow expressions</summary><div class="markup"><p>Fix #1716</p>
</div></details></div>
<div class="toot" id="agenda-02-04"><h2>QT4 CG meeting 108 draft agenda<span class="toot-id"> #agenda-02-04</span></h2><div class="pubdate">03 Feb at 11:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/02-04">https://qt4cg.org/meeting/agenda/2025/02-04</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1762"><h2>Issue #1762 created<span class="toot-id"> #created-1762</span></h2><div class="pubdate">03 Feb at 10:44:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1762">https://github.com/qt4cg/qtspecs/issues/1762</a></div><details><summary>Combining different kinds of arrow</summary><div class="markup"><p>In the spec, under arrow expressions, we have this example:</p>
<p><code>(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() =!&gt; fn($a) { $a + 1 }() =&gt; sum()</code></p>
<p>That use of an inline function is pretty clumsy, and it would be nice to think we could eliminate it using the new <code>-&gt;</code> operator. But it ain't easy.</p>
<p>We can't do</p>
<p><code>(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() -&gt; .+1 =&gt; sum()</code></p>
<p>because the precedence is wrong.</p>
<p>We can't do</p>
<p><code>(1 to 5) =!&gt; (xs:double() =&gt; math:sqrt() -&gt; .+1 ) =&gt; sum()</code></p>
<p>because we can't have a parenthesised construct on the RHS of the mapping arrow.</p>
<p>We can use the bang operator but the parentheses are awkward:</p>
<p><code>((1 to 5) ! (xs:double(.) =&gt; math:sqrt() -&gt; (.+1) )) =&gt; sum()</code></p>
<p>If we changed the precedences we could allow</p>
<p><code>(1 to 5) ! xs:double(.) ! math:sqrt(.) ! (.+1)  -&gt; sum(.)</code></p>
<p>Which would require moving <code>-&gt;</code> so it has lower precedence than <code>!</code>. But this would disrupt its relationship with <code>=&gt;</code>.</p>
</div></details></div>
<div class="toot" id="created-1761"><h2>Pull request #1761 created<span class="toot-id"> #created-1761</span></h2><div class="pubdate">03 Feb at 10:01:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1761">https://github.com/qt4cg/qtspecs/pull/1761</a></div><details><summary>1752 Correct return type of fn:partition()</summary><div class="markup"><p>Fix #1752</p>
</div></details></div>
<div class="toot" id="created-1760"><h2>Pull request #1760 created<span class="toot-id"> #created-1760</span></h2><div class="pubdate">03 Feb at 09:44:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1760">https://github.com/qt4cg/qtspecs/pull/1760</a></div><details><summary>Remove hand-generated diffs from the builds</summary><div class="markup"><p>Fix #1757</p>
<p>The PR build isn't going to be very informative, but I'll leave this one open in case anyone wants to review the source code diffs.</p>
<p>I did not attempt to remove the XML markup from the specs. Perhaps we should, but I think we'd want to manage that carefully to avoid an absolute mountain of merge conflicts.</p>
</div></details></div>
<div class="toot" id="closed-1744"><h2>Issue #1744 closed<span class="toot-id"> #closed-1744</span></h2><div class="pubdate">03 Feb at 09:15:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1744">https://github.com/qt4cg/qtspecs/pull/1744</a></div><p>Remove dead wood re: SVG diagrams from the XSLT build</p></div>
<div class="toot" id="created-1759"><h2>Pull request #1759 created<span class="toot-id"> #created-1759</span></h2><div class="pubdate">03 Feb at 09:01:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1759">https://github.com/qt4cg/qtspecs/pull/1759</a></div><details><summary>Fix validation issues in the EXPath module function catalogs</summary><div class="markup"><p>Fix #1758</p>
</div></details></div>
<div class="toot" id="created-1758"><h2>Issue #1758 created<span class="toot-id"> #created-1758</span></h2><div class="pubdate">03 Feb at 08:50:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1758">https://github.com/qt4cg/qtspecs/issues/1758</a></div><details><summary>EXPath specification validation problems</summary><div class="markup"><p>As @michaelhkay noted in email, the function catalogs for the EXPath specifications are not being validated.</p>
<p>That validation only occurs during test generation ¯_(ツ)_/¯</p>
<ol>
<li>Add an example to the EXPath file specification so that it's possible to run test generation</li>
<li>Add test generation for EXPath file and binary to the build</li>
<li>Fix the validation errors in the function catalog</li>
</ol>
</div></details></div>
<div class="toot" id="closed-1756"><h2>Issue #1756 closed<span class="toot-id"> #closed-1756</span></h2><div class="pubdate">03 Feb at 08:43:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1756">https://github.com/qt4cg/qtspecs/pull/1756</a></div><p>Make DeltaXML diffs on the main build too</p></div>
<div class="toot" id="created-1757"><h2>Issue #1757 created<span class="toot-id"> #created-1757</span></h2><div class="pubdate">03 Feb at 08:20:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1757">https://github.com/qt4cg/qtspecs/issues/1757</a></div><details><summary>Build cleanup: remove the "by hand" diffs</summary><div class="markup"><p>Unless I'm mistaken, the 'by hand' diffs, the ones that are created from explicit diff markup added by the editors, have not been consistently maintained for some time.</p>
<p>We still have places that point to them, and I think this could be confusing.</p>
<p>I propose that we pull all of that machinery out and remove references to them.</p>
</div></details></div>
<div class="toot" id="created-1756"><h2>Pull request #1756 created<span class="toot-id"> #created-1756</span></h2><div class="pubdate">03 Feb at 07:18:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1756">https://github.com/qt4cg/qtspecs/pull/1756</a></div><details><summary>Make DeltaXML diffs on the main build too</summary><div class="markup"><p>This PR should build DeltaXML diffs of the EXPath specs...and when merged, should build them on the main build as well.</p>
</div></details></div>
<div class="toot" id="closed-1755"><h2>Issue #1755 closed<span class="toot-id"> #closed-1755</span></h2><div class="pubdate">03 Feb at 07:02:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1755">https://github.com/qt4cg/qtspecs/pull/1755</a></div><p>Attempt to make DeltaXML diffs for EXPath specs</p></div>
<div class="toot" id="created-1755"><h2>Pull request #1755 created<span class="toot-id"> #created-1755</span></h2><div class="pubdate">03 Feb at 07:02:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1755">https://github.com/qt4cg/qtspecs/pull/1755</a></div><p>Attempt to make DeltaXML diffs for EXPath specs</p></div>
<div class="toot" id="created-1754"><h2>Issue #1754 created<span class="toot-id"> #created-1754</span></h2><div class="pubdate">02 Feb at 23:57:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1754">https://github.com/qt4cg/qtspecs/issues/1754</a></div><details><summary>Inverse functions to bin:hex, bin:bin, and bin:octal</summary><div class="markup"><p>In writing formal equivalents for the functions in the binary EXPath module, I found that while we have bin:bin() which turns a string of 0s and 1s into a binary value, we don't have any convenient way of doing the inverse. The same is true for octal. For hex we can cast to hexBinary and then cast to string, but that's a bit of a circumlocution.</p>
<p>I propose functions bin:to-bin, bin:to-octal and bin:to-hex that convert a binary value to a string of binary, octal, or hexadecimal digits respectively. Perhaps with an options parameter that allows a grouping separator and grouping size to be specified.</p>
</div></details></div>
<div class="toot" id="created-1753"><h2>Pull request #1753 created<span class="toot-id"> #created-1753</span></h2><div class="pubdate">02 Feb at 21:13:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1753">https://github.com/qt4cg/qtspecs/pull/1753</a></div><details><summary>1750 Overhaul of EXPath binary spec</summary><div class="markup"><p>Apart from general copy-editing, the main changes are:</p>
<ul>
<li>A lot more examples, presented in executable markup format (though they are not yet tested)</li>
<li>Many functions now have formal equivalents (again, currently untested)</li>
<li>Allow underscores and spaces in input to bin:hex, bin:octal, and bin:bin</li>
<li>Use type xs:unsignedByte for octet arguments</li>
<li>Use an enum() type for the octet-order argument</li>
</ul>
<p>Fix #1750</p>
</div></details></div>
<div class="toot" id="created-1752"><h2>Issue #1752 created<span class="toot-id"> #created-1752</span></h2><div class="pubdate">02 Feb at 19:18:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1752">https://github.com/qt4cg/qtspecs/issues/1752</a></div><details><summary>Return type of fn:partition()</summary><div class="markup"><p>The return type of <code>fn:partition</code> should be <code>array(item()*)*</code> not <code>array(item())*</code>.</p>
</div></details></div>
<div class="toot" id="created-1751"><h2>Issue #1751 created<span class="toot-id"> #created-1751</span></h2><div class="pubdate">02 Feb at 00:28:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1751">https://github.com/qt4cg/qtspecs/issues/1751</a></div><details><summary>bin:encode-string - should the result have a BOM?</summary><div class="markup"><p>Test cases in the EXPath test suite using <code>bin:encode-string</code> with encoding=utf-16 include a BOM at the start of the output, but the spec says nothing about this. It's probably useful for some use case but a nuisance for others.</p>
</div></details></div>
<div class="toot" id="created-1750"><h2>Issue #1750 created<span class="toot-id"> #created-1750</span></h2><div class="pubdate">01 Feb at 00:44:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1750">https://github.com/qt4cg/qtspecs/issues/1750</a></div><details><summary>EXPath Binary : copy-edits and minor enhancements</summary><div class="markup"><p>Suggested minor enhancements:</p>
<ul>
<li>Allow underscores and whitespace in strings of binary, octal, or hex digits supplied as strings.</li>
<li>Use type <code>xs:unsignedByte</code> rather than xs:integer for octet values</li>
<li>Use an enum type for params like "little-endian".</li>
</ul>
<p>The following are some suggested copy-edits:</p>
<p>Abstract para 4 - link to XQuery 4.1. The last sentence of the para ("The signatures and summaries of functions defined in this document...") makes no sense.</p>
<p>1.1 para 1, twice, ".)" should be ").".</p>
<p>1.2 Mention that the coercion rules in 4.0 mean that wherever a function accepts xs:base64Binary, it also accepts xs:hexBinary (but we've changed the signature to allow either, anyway).</p>
<p>para 2. " if the result return"?</p>
<p>The Note is ineleganty worded.</p>
<p>1.3 I guess we should integrate the test suite into QT4.</p>
<p>1.5 para 2 "In accordance with current practice" eh?</p>
<p>2.1 Example would benefit from reformatting.</p>
<p>2.2 Example, similarly. Could use underscores in the long integers. "and the examples from above reverse"??</p>
<ol start="3">
<li>
<p>"fn:fn:binary-resource" does not yet exist and is triple-barrelled.</p>
</li>
<li>
<p>Avoid "apologetic quotes" in 'constants'. And elsewhere. If it doesn't work as plain English without quotes, then it needs to be a defined term.</p>
</li>
</ol>
<p>4.1 and throughout, in Examples, use the F&amp;O rendition rather than the right arrow. Also, add these functions to the example checking mechanism.</p>
<p>4.1 Notes, be more precise than "similarly". Define formal equivalent. Non-editorial enhancement: allow underscores in the string.</p>
<p>4.2 There must be a more elegant way of saying "(8-wise) (ASCII) binary digits ([01])". Allow underscores.</p>
<p>4.2 "a xs:base64Binary with no embedded data" - use the term "zero-length".</p>
<p>4.3 similarly. Allow underscores.</p>
<p>Function properties: I think all these functions are pure functions so it's a waste of space to say this explicitly for each function.</p>
<p>4.4, 4.5 Use <code>xs:unsignedByte</code> to represent octets now that we have implicit downcasting. (Changes error code [[bin:octet-out-of-range]to XPTY0004).</p>
<p>5.6 "blank octets"?</p>
<p>7.1.2 "or assumed to be represented"</p>
<p>7.1.3 "Care should be taken" - what does this mean?</p>
<p>"Positive and negative infinities are supported" - who or what is doing the supporting?</p>
<p>Use underscore rather than space as separators between digits.</p>
<p>'quiet' NaN - avoid apologetic quotes.</p>
<p>7.4 - I find the note regarding signed/unsigned integers very confusing.</p>
<p>8.1: "bitwise or" - avoid apologetic quotes. For these three functions we should say what they do rather than assuming the reader will guess from the names. bin:shift could do with more precision. Perhaps the functions could be explained more formally by a mapping from a binary value to a sequence of booleans, then for example bin:and becomes something like for-each-pair(op:from-bits($a), op:from-bits($b), op('and') ) =&gt; op:to-bits().</p>
<p>8.5: avoid the notation <code>|$by|</code> for absolute value. Not all of us remember our schooldays. (And when I was at school, <code>by</code> meant <code>b × y</code>, and $ meant dollars.)</p>
</div></details></div>
<div class="toot" id="closed-1749"><h2>Issue #1749 closed<span class="toot-id"> #closed-1749</span></h2><div class="pubdate">31 Jan at 12:56:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1749">https://github.com/qt4cg/qtspecs/pull/1749</a></div><p>Don't set the function finder position to 'fixed' on small devices</p></div>
<div class="toot" id="created-1749"><h2>Pull request #1749 created<span class="toot-id"> #created-1749</span></h2><div class="pubdate">31 Jan at 12:56:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1749">https://github.com/qt4cg/qtspecs/pull/1749</a></div><details><summary>Don't set the function finder position to 'fixed' on small devices</summary><div class="markup"><p>This is also related to 1747. It "fixes" the problem that @ChristianGruen reported where the function finder obscured content on mobile (narrow) devices. I've changed things so that it isn't at a fixed location on narrow devices. It still appears above the ToC, but it scrolls as normal.</p>
</div></details></div>
<div class="toot" id="closed-1748"><h2>Issue #1748 closed<span class="toot-id"> #closed-1748</span></h2><div class="pubdate">31 Jan at 09:41:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1748">https://github.com/qt4cg/qtspecs/pull/1748</a></div><p>Fix 'window.onload' bug in ToC JS</p></div>
<div class="toot" id="created-1748"><h2>Pull request #1748 created<span class="toot-id"> #created-1748</span></h2><div class="pubdate">31 Jan at 09:40:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1748">https://github.com/qt4cg/qtspecs/pull/1748</a></div><details><summary>Fix 'window.onload' bug in ToC JS</summary><div class="markup"><p>This fixes 1747 so I'm going to push it immediately.</p>
<p>I'm leaving the bug open because I'll also look at @ChristianGruen 's report that it is problematic on mobile.</p>
</div></details></div>
<div class="toot" id="created-1747"><h2>Issue #1747 created<span class="toot-id"> #created-1747</span></h2><div class="pubdate">31 Jan at 07:16:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1747">https://github.com/qt4cg/qtspecs/issues/1747</a></div><details><summary>Function finder is broken</summary><div class="markup"><p>The function finder in F&amp;O (and elsewhere) is broken. I believe that it uses the ToC to find the link target and now that the ToC structure has changed, it's failing.</p>
</div></details></div>
<div class="toot" id="closed-1745"><h2>Issue #1745 closed<span class="toot-id"> #closed-1745</span></h2><div class="pubdate">30 Jan at 15:50:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1745">https://github.com/qt4cg/qtspecs/pull/1745</a></div><p>Implement expanding/collapsing ToC</p></div>
<div class="toot" id="created-1746"><h2>Pull request #1746 created<span class="toot-id"> #created-1746</span></h2><div class="pubdate">30 Jan at 15:49:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1746">https://github.com/qt4cg/qtspecs/pull/1746</a></div><details><summary>Replace processing model diagrams</summary><div class="markup"><p>Fix #1733</p>
</div></details></div>
<div class="toot" id="created-1745"><h2>Pull request #1745 created<span class="toot-id"> #created-1745</span></h2><div class="pubdate">30 Jan at 13:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1745">https://github.com/qt4cg/qtspecs/pull/1745</a></div><details><summary>Implement expanding/collapsing ToC</summary><div class="markup"><p>I'm just going to merge this one because</p>
<ol>
<li>The CG agreed they wanted this</li>
<li>All of the changes are presentational, there are no technical changes</li>
<li>The PR build won't work anyway</li>
</ol>
<p>I did make a couple of executive decisions.</p>
<p>The use of "..." as the target to click on didn't seem like a practical affordance. It's not a common use of ellipsis and it looked too much like it simply meant that part of the title was elided. I went with right and down triangles instead. And I added the few lines of JS required to make them "turn".</p>
<p>I added a top-level expand/collapse that does all of the sections. I wasn't happy that with the new UI, there was no way to get an overview of the document by seeing all of the section titles.</p>
<p>I tinkered with the CSS. I'm not uniformly happy with it, especially with the treatment of long titles, but I think the aesthetic failings are infrequent.</p>
<p>We need to review accessibility before we try to publish as a CG Report.</p>
</div></details></div>
<div class="toot" id="created-1744"><h2>Pull request #1744 created<span class="toot-id"> #created-1744</span></h2><div class="pubdate">30 Jan at 10:47:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1744">https://github.com/qt4cg/qtspecs/pull/1744</a></div><details><summary>Remove dead wood re: SVG diagrams from the XSLT build</summary><div class="markup"><p>Completes action QT4CG-106-01</p>
</div></details></div>
<div class="toot" id="created-1743"><h2>Pull request #1743 created<span class="toot-id"> #created-1743</span></h2><div class="pubdate">30 Jan at 10:11:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1743">https://github.com/qt4cg/qtspecs/pull/1743</a></div><details><summary>1738 Formatting of Notes in F&amp;O</summary><div class="markup"><ol>
<li>Improves the stylesheets and CSS so that Notes sections in the F&amp;O spec are rendered with a single continuous green stripe, rather than a separate (and sometimes indented) stripe per paragraph or list item.</li>
<li>Makes some other markup changes identified in passing, especially using <code>&lt;char&gt;</code> to mark up individual characters.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1742"><h2>Issue #1742 created<span class="toot-id"> #created-1742</span></h2><div class="pubdate">29 Jan at 20:20:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1742">https://github.com/qt4cg/qtspecs/issues/1742</a></div><details><summary>Maps constructed using streamed xsl:fork instruction should not be ordered</summary><div class="markup"><p>One of the techniques used in XSLT streaming is to build multiple outputs during a single streamed pass of the input, and the multiple outputs can be captured in different entries in a map (in different prongs of an <code>xsl:fork</code> instruction). The ordering of such a map should be implementation-dependent, in order to allow construction in parallel threads.</p>
<p>Furthermore, I think that an xsl:map instruction used in this way should probably not allow duplicate keys. In principle we could collect key/value pairs during the streamed processing and then resolve duplicates at the end, but it's extra complexity.</p>
</div></details></div>
<div class="toot" id="created-1741"><h2>Pull request #1741 created<span class="toot-id"> #created-1741</span></h2><div class="pubdate">29 Jan at 11:08:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1741">https://github.com/qt4cg/qtspecs/pull/1741</a></div><details><summary>1739 drop references to ordering mode in the static context</summary><div class="markup"><p>Fix #1739</p>
</div></details></div>
<div class="toot" id="created-1740"><h2>Pull request #1740 created<span class="toot-id"> #created-1740</span></h2><div class="pubdate">29 Jan at 10:22:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1740">https://github.com/qt4cg/qtspecs/pull/1740</a></div><details><summary>1725b Further elaboration of duplicates handling in maps</summary><div class="markup"><p>Actions QT4CG-107-02 and QT4CG-107-03.</p>
<p>The three functions map:build, map:of-pairs, and map:merge now all have the same options parameters, and avoid duplication in the specification. The xsl:map instruction is defined by reference to map:merge.</p>
<p>Although the action suggested specifying these functions to use the first key from a set of duplicates, I found this was not possible because of the way map:put is defined. They therefore use the last key from the set of duplicates.</p>
<p>Fix #1725</p>
</div></details></div>
<div class="toot" id="created-1739"><h2>Issue #1739 created<span class="toot-id"> #created-1739</span></h2><div class="pubdate">29 Jan at 09:45:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1739">https://github.com/qt4cg/qtspecs/issues/1739</a></div><details><summary>Obsolete references to ordering mode</summary><div class="markup"><p>The functions <code>fn:distinct-values</code> and <code>fn:duplicate-values</code> refer to the ordering mode in the static context, a concept that we have abolished.</p>
</div></details></div>
<div class="toot" id="created-1738"><h2>Issue #1738 created<span class="toot-id"> #created-1738</span></h2><div class="pubdate">29 Jan at 00:20:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1738">https://github.com/qt4cg/qtspecs/issues/1738</a></div><details><summary>Formatting of lists within notes</summary><div class="markup"><p>The formatting of lists within notes in F&amp;O is weird: see for example the math:atan2 function.</p>
</div></details></div>
<div class="toot" id="created-1737"><h2>Issue #1737 created<span class="toot-id"> #created-1737</span></h2><div class="pubdate">28 Jan at 21:25:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1737">https://github.com/qt4cg/qtspecs/issues/1737</a></div><details><summary>Grammar problems introduced by #1732</summary><div class="markup"><p>Today's merge of #1732 has introduced two problems to the grammar as now shown in the spec:</p>
<ul>
<li>
<p><code>ValueExpr</code> has changed from</p>
<pre><code>ValueExpr ::= ValidateExpr | ExtensionExpr | SimpleMapExpr
</code></pre>
<p>to</p>
<pre><code>ValueExpr ::= SimpleMapExpr
</code></pre>
<p>This disconnects <code>ValidateExpr</code> and <code>ExtensionExpr</code> from the rest of the grammar.</p>
</li>
<li>
<p><code>AnnotatedDecl</code> has been added without being referenced. Also it describes something that would look like</p>
<pre><code class="language-xquery">declare declare variable $x external
</code></pre>
</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1722"><h2>Issue #1722 closed<span class="toot-id"> #closed-1722</span></h2><div class="pubdate">28 Jan at 19:40:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1722">https://github.com/qt4cg/qtspecs/pull/1722</a></div><p>1717 define focus functions using pipeline operator</p></div>
<div class="toot" id="closed-1717"><h2>Issue #1717 closed<span class="toot-id"> #closed-1717</span></h2><div class="pubdate">28 Jan at 19:40:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1717">https://github.com/qt4cg/qtspecs/issues/1717</a></div><p>Define focus functions in terms of the pipeline operator</p></div>
<div class="toot" id="created-1736"><h2>Issue #1736 created<span class="toot-id"> #created-1736</span></h2><div class="pubdate">28 Jan at 18:14:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1736">https://github.com/qt4cg/qtspecs/issues/1736</a></div><details><summary>Add option retain-order=false when constructing maps</summary><div class="markup"><p>I would like to provide an option on functions that potentially create large maps, including</p>
<pre><code>xsl:map
map:build
map:merge
map:of-pairs
parse-json
json-doc
</code></pre>
<p>If retain-option=false is specified, the user declares to the processor that they don't require the resulting map to be in any particular order. An implementation is of course free to ignore this and deliver an ordered map anyway, but if the implementation can save time or space by not retaining order then it is free to do so.</p>
<p>I propose to provide some data quantifying the potential benefits of this option. I realise that some optimisation hints provided in the past, for example the <code>unordered{}</code> expression, have been ineffective, but I think there is a difference here because changing maps to be ordered may result in a performance regression for people moving from 3.1 to 4.0.</p>
</div></details></div>
<div class="toot" id="minutes—01-28"><h2>QT4 CG meeting 107 draft minutes<span class="toot-id"> #minutes—01-28</span></h2><div class="pubdate">28 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-28">https://qt4cg.org/meeting/minutes/2025/01-28</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1719"><h2>Issue #1719 closed<span class="toot-id"> #closed-1719</span></h2><div class="pubdate">28 Jan at 17:13:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1719">https://github.com/qt4cg/qtspecs/issues/1719</a></div><p>Purging dead build code</p></div>
<div class="toot" id="closed-1731"><h2>Issue #1731 closed<span class="toot-id"> #closed-1731</span></h2><div class="pubdate">28 Jan at 17:13:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1731">https://github.com/qt4cg/qtspecs/pull/1731</a></div><p>1719 drop shared spec from build</p></div>
<div class="toot" id="closed-1725"><h2>Issue #1725 closed<span class="toot-id"> #closed-1725</span></h2><div class="pubdate">28 Jan at 17:10:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><p>Position of duplicates in ordered maps</p></div>
<div class="toot" id="closed-1727"><h2>Issue #1727 closed<span class="toot-id"> #closed-1727</span></h2><div class="pubdate">28 Jan at 17:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><p>1725 Define more detailed rules for duplicates in maps</p></div>
<div class="toot" id="closed-1485"><h2>Issue #1485 closed<span class="toot-id"> #closed-1485</span></h2><div class="pubdate">28 Jan at 17:07:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1485">https://github.com/qt4cg/qtspecs/issues/1485</a></div><p>Record declarations in XSLT</p></div>
<div class="toot" id="closed-1708"><h2>Issue #1708 closed<span class="toot-id"> #closed-1708</span></h2><div class="pubdate">28 Jan at 17:07:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><p>1485 Add xsl:record-type declaration</p></div>
<div class="toot" id="closed-76"><h2>Issue #76 closed<span class="toot-id"> #closed-76</span></h2><div class="pubdate">28 Jan at 17:06:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/76">https://github.com/qt4cg/qtspecs/issues/76</a></div><p>non-deterministic time</p></div>
<div class="toot" id="closed-747"><h2>Issue #747 closed<span class="toot-id"> #closed-747</span></h2><div class="pubdate">28 Jan at 17:06:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/747">https://github.com/qt4cg/qtspecs/issues/747</a></div><p>QName literals</p></div>
<div class="toot" id="closed-885"><h2>Issue #885 closed<span class="toot-id"> #closed-885</span></h2><div class="pubdate">28 Jan at 17:06:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/885">https://github.com/qt4cg/qtspecs/issues/885</a></div><p>fn:uuid</p></div>
<div class="toot" id="closed-981"><h2>Issue #981 closed<span class="toot-id"> #closed-981</span></h2><div class="pubdate">28 Jan at 17:05:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/981">https://github.com/qt4cg/qtspecs/issues/981</a></div><p>Identify optional arguments in callback functions</p></div>
<div class="toot" id="closed-1720"><h2>Issue #1720 closed<span class="toot-id"> #closed-1720</span></h2><div class="pubdate">28 Jan at 17:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><p>Grammar overhaul</p></div>
<div class="toot" id="closed-1732"><h2>Issue #1732 closed<span class="toot-id"> #closed-1732</span></h2><div class="pubdate">28 Jan at 17:04:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><p>1720 grammar simplification</p></div>
<div class="toot" id="closed-1069"><h2>Issue #1069 closed<span class="toot-id"> #closed-1069</span></h2><div class="pubdate">28 Jan at 17:03:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1069">https://github.com/qt4cg/qtspecs/issues/1069</a></div><p>fn:ucd</p></div>
<div class="toot" id="closed-1124"><h2>Issue #1124 closed<span class="toot-id"> #closed-1124</span></h2><div class="pubdate">28 Jan at 17:03:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1124">https://github.com/qt4cg/qtspecs/issues/1124</a></div><p>Formatting XPath/XQuery: Preferences, Conventions</p></div>
<div class="toot" id="closed-1252"><h2>Issue #1252 closed<span class="toot-id"> #closed-1252</span></h2><div class="pubdate">28 Jan at 17:03:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1252">https://github.com/qt4cg/qtspecs/issues/1252</a></div><p>Add a new function `fn:html-doc`</p></div>
<div class="toot" id="closed-1728"><h2>Issue #1728 closed<span class="toot-id"> #closed-1728</span></h2><div class="pubdate">28 Jan at 17:01:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><p>Fix CSS for production tables</p></div>
<div class="toot" id="created-1735"><h2>Pull request #1735 created<span class="toot-id"> #created-1735</span></h2><div class="pubdate">27 Jan at 17:09:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><details><summary>1341 Drop $position callback from many functions</summary><div class="markup"><p>Responding to the discussion in #1341, this (somewhat experimental) PR explores the possibility of dropping the optional
$position argument to the callback of many higher-order functions such as some(), every(), filter(), for-each(), fold-left(), fold-right(). Instead, it provides the option to wrap the input sequence in a call of numbered-items() which replaces each item in the input with an (item, position) pair.</p>
<p>I've done this only (so far) for higher-order sequence functions, but the intent is that the same could be done for arrays and (potentially) maps.</p>
<p>I left the position argument in place for a few functions where losing it seemed to cause genuine inconvenience:</p>
<ul>
<li>partition(), where the function wraps the supplied items into arrays, and you don't want to have to remove the positions afterwards</li>
<li>subsequence-where(), where many use cases are likely to use positional information</li>
<li>for-each-pair(), where there are two input sequences and it seems clumsy to associate position information with one or the other</li>
</ul>
<p>The main benefit is that we provide one basic mechanism which is automatically available everywhere, which means we don't have to have debates about whether or not there is a use case for adding position information to (say) fold-left or scan-right.</p>
<p>A further benefit is that the functions defined for sequences automatically become available for arrays and maps. I haven't yet explored the impact on maps and arrays; I will wait first to see what the reaction is to this proposal.</p>
</div></details></div>
<div class="toot" id="closed-1730"><h2>Issue #1730 closed<span class="toot-id"> #closed-1730</span></h2><div class="pubdate">27 Jan at 15:12:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><p>Consistency in default handling of map duplicates</p></div>
<div class="toot" id="created-1734"><h2>Pull request #1734 created<span class="toot-id"> #created-1734</span></h2><div class="pubdate">27 Jan at 13:05:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1734">https://github.com/qt4cg/qtspecs/pull/1734</a></div><details><summary>1682 Type promotion and operator mapping</summary><div class="markup"><p>Fix #1682</p>
<p>Moves the relevant parts of the operator mapping table into the sections for Arithmetic Expressions and Value Comparisons. Adds links to the op: functions in F&amp;O.</p>
<p>Drops the Type Promotion appendix, moving the rules inline; and drops the term "type promotion"</p>
<p>Adjusts the specs for sum() and avg() so they are now defined directly in terms of pairwise addition of values.</p>
</div></details></div>
<div class="toot" id="created-1733"><h2>Issue #1733 created<span class="toot-id"> #created-1733</span></h2><div class="pubdate">27 Jan at 10:17:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1733">https://github.com/qt4cg/qtspecs/issues/1733</a></div><details><summary>ACTION QT4CG-088-04, reworking the processing model diagram</summary><div class="markup"><p>I have no idea what tool was used to create the current <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-processing-model">processing model diagram</a>. We know it needs to be updated, but I've no particular skill with drawing programs, so I spent half an hour constructing a Graphviz diagram:</p>
<pre><code>digraph Processing_Model {
    subgraph clusterQT4 {
        Exec [label="Execution\nEngine" ];
        XDM [label="XPath Data\nModel"; shape="note" ];
        AST [label="Abstract\nSyntax Tree" ];
        Static [label="Static\nContext"; shape="box3d" ];
        Dynamic [label="Dynamic\nContext"; shape="box3d" ];
        Schema [label="Schema\nDefinitions"; shape="note" ];

        XPath -&gt; AST [label="&nbsp;SQ1" ];
        AST -&gt; AST [label="&nbsp;SQ5" ];
        AST -&gt; Exec [label="&nbsp;DQ1" ];
        Schema -&gt; Static;
        Static -&gt; AST [label="&nbsp;SQ4" ];
        Static -&gt; Dynamic [label="&nbsp;DQ2" ];
        Dynamic -&gt; Exec [ dir="both"; label="&nbsp;DQ5" ];
        Exec -&gt; XDM [ dir="both"; label="&nbsp;DQ4" ];
    }
    XML [ shape="note" ];
    PSVI [ shape="note" ];
    XML -&gt; PSVI [ label="&nbsp;DM1" ];
    PSVI -&gt; XDM  [ label="&nbsp;DM2" ];
    XML -&gt; XDM [ label="&nbsp;DM1" ];

    Direct [ label="&nbsp;Direct\nGeneration" ];
    Direct -&gt; XDM [ label="&nbsp;DM3" ];

    Host [label="Host\nEnvironment" ];
    Host -&gt; Schema [label="&nbsp;SI1" ];
    Host -&gt; Static [label="&nbsp;SQ2" ];
    Host -&gt; Dynamic [label="&nbsp;DQ3" ];

    Serialize [ shape="note" ];
    XDM -&gt; Serialize [ label="&nbsp;DM4" ];
}
</code></pre>
<p>It looks something like this:</p>
<p><img src="https://github.com/user-attachments/assets/7ae82045-2e28-4db2-afdc-b69cb0f72bdb" alt="Image"></p>
<p>Is this worth pursuing, or is that just half an hour of my life I'll never get back?</p>
</div></details></div>
<div class="toot" id="agenda-01-28"><h2>QT4 CG meeting 107 draft agenda<span class="toot-id"> #agenda-01-28</span></h2><div class="pubdate">27 Jan at 09:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-28">https://qt4cg.org/meeting/agenda/2025/01-28</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1732"><h2>Pull request #1732 created<span class="toot-id"> #created-1732</span></h2><div class="pubdate">26 Jan at 22:12:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><details><summary>1720 grammar simplification</summary><div class="markup"><p>This PR primarily affects the grammar file, simplifying it to remove most of the material that is only there to support the generation of a JavaCC parser (which has probably not been achievable since XPath/XQuery 2.0).</p>
<p>The section of the grammar that defines the binary operators starting with <code>OrExpr</code> is now expressed using conventional production rules, rather than the precedence-based grammar previously used. This allows deletion of some convoluted code in grammar2spec.xsl.</p>
<p>The DTD for the grammar file is revised to exclude many constructs that are no longer used.</p>
<p>Many simple token definitions (especially those that consist of a simple constant string) have been inlined.</p>
<p>Fix #1720</p>
</div></details></div>
<div class="toot" id="created-1731"><h2>Pull request #1731 created<span class="toot-id"> #created-1731</span></h2><div class="pubdate">25 Jan at 23:20:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1731">https://github.com/qt4cg/qtspecs/pull/1731</a></div><details><summary>1719 drop shared spec from build</summary><div class="markup"><p>Removes tasks from the gradle build, and associated stylesheets, that are there only to construct the "shared XPath/XQuery specification" which is no longer used by the editors or made visible to readers.</p>
<p>Also fixes a couple of link errors/warnings in the build.</p>
<p>Fix #1719</p>
</div></details></div>
<div class="toot" id="created-1730"><h2>Issue #1730 created<span class="toot-id"> #created-1730</span></h2><div class="pubdate">25 Jan at 18:03:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><details><summary>Consistency in default handling of map duplicates</summary><div class="markup"><p>In 3.1:</p>
<ul>
<li><code>map:merge()</code> defaults to duplicates = use-first</li>
<li><code>xsl:map</code> defaults to duplicates = reject</li>
</ul>
<p>In 4.0</p>
<ul>
<li><code>map:build</code> defaults to duplicates = combine</li>
<li><code>map:of-pairs</code> defaults to duplicates = combine</li>
</ul>
<p>Should we try to align the defaults?</p>
</div></details></div>
<div class="toot" id="created-1729"><h2>Issue #1729 created<span class="toot-id"> #created-1729</span></h2><div class="pubdate">24 Jan at 22:04:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1729">https://github.com/qt4cg/qtspecs/issues/1729</a></div><details><summary>Grammar problems introduced by #1721</summary><div class="markup"><p>Some productions of the XQuery 4.0 grammar were made obsolete by recent changes, but still occur in the document:</p>
<ul>
<li><code>StringConstructorStart</code></li>
<li><code>StringInterpolationStart</code></li>
<li><code>StringInterpolationEnd</code></li>
<li><code>StringConstructorEnd</code></li>
<li><code>TagQName</code></li>
<li><code>EndTagQName</code></li>
<li><code>ProcessingInstructionStart</code></li>
<li><code>ProcessingInstructionEnd</code></li>
<li><code>DirCommentContentChar</code></li>
<li><code>DirCommentContentDashChar</code></li>
</ul>
<p>Also, the replacement of <code>declare record</code> by <code>declare type record</code> has intoduced a new ambiguity. For example, with the input</p>
<pre><code class="language-xquery">declare type A as xs:integer;
declare type record as (A);
</code></pre>
<p>it remains unclear whether the second line declares a  type named "record", in which case</p>
<pre><code class="language-xquery">42 instance of record
</code></pre>
<p>or a type named "as", where</p>
<pre><code class="language-xquery">{'A': 42} instance of as
</code></pre>
<p>My proposal would be return to <code>declare record</code>. There are also 13 examples in the document using <code>declare record</code>.</p>
</div></details></div>
<div class="toot" id="closed-1723"><h2>Issue #1723 closed<span class="toot-id"> #closed-1723</span></h2><div class="pubdate">24 Jan at 21:00:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><p>`ThenAction` left over after removal of `BracedActions`</p></div>
<div class="toot" id="created-1728"><h2>Pull request #1728 created<span class="toot-id"> #created-1728</span></h2><div class="pubdate">24 Jan at 13:15:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><details><summary>Fix CSS for production tables</summary><div class="markup"><p>This PR removes some extraneous space between the rows and columns in the production tables (cellspacing) and turns off the odd grey background on comments. (I don't think the grey backbround was helping any, but if you disagree...)</p>
</div></details></div>
<div class="toot" id="closed-1721"><h2>Issue #1721 closed<span class="toot-id"> #closed-1721</span></h2><div class="pubdate">24 Jan at 13:01:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><p>1713 Revise code for generating production rules</p></div>
<div class="toot" id="created-1727"><h2>Pull request #1727 created<span class="toot-id"> #created-1727</span></h2><div class="pubdate">23 Jan at 17:58:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><details><summary>1725 Define more detailed rules for duplicates in maps</summary><div class="markup"><p>Clarifies the rules for how duplicates are handled by map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>Introduces a callback option for map:merge that is compatible with map:build and map:of-pairs, to increase commonality between all four functions/instructions.</p>
<p>Fix #1725</p>
</div></details></div>
<div class="toot" id="closed-1726"><h2>Issue #1726 closed<span class="toot-id"> #closed-1726</span></h2><div class="pubdate">23 Jan at 16:50:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1726"><h2>Pull request #1726 created<span class="toot-id"> #created-1726</span></h2><div class="pubdate">23 Jan at 12:54:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1725"><h2>Issue #1725 created<span class="toot-id"> #created-1725</span></h2><div class="pubdate">23 Jan at 11:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><details><summary>Position of duplicates in ordered maps</summary><div class="markup"><p>It became clear to me when writing test cases that the specs aren't entirely clear about what happens when building a map from an input sequence that contains duplicate keys. It says clearly what entry should be created for the duplicated key, but it doesn't say clearly where this entry should appear in the result.</p>
<p>There are four functions/instructions that this applies to: map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>I propose that in each case, the position of the entry for the duplicated key in the resulting map should correspond to the position of the first occurrence of that key in the input sequence. That is, "order of first appearance": the effect should be the same as if new entries are always created using a map:put() operation.</p>
<p>This might be slightly unexpected in the case of <code>map:merge()</code> with the option <code>duplicates=use-last</code>. It means the value will be that of the last duplicate, but its position will be that of the first duplicate. However, the other three functions/instructions achieve the effect of use-last with the callback <code>on-duplicates=fn{$a, $b){$a}</code> which only controls the value of the entry, and cannot be used to control its position, and I think it makes sense for <code>map:merge</code> with <code>duplicates=use-last</code> to behave in the same way.</p>
<p>Of course we could introduce a separate option to control the position of the combined entry, but I think that would be overkill. <code>xsl:for-each-group</code> and <code>distinct-values</code> both use the "order of first appearance" rule and this has never caused any problems. (<code>group-by</code> in XQuery delivers groups in implementation-dependent order, however).</p>
</div></details></div>
<div class="toot" id="created-1724"><h2>Issue #1724 created<span class="toot-id"> #created-1724</span></h2><div class="pubdate">22 Jan at 23:54:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1724">https://github.com/qt4cg/qtspecs/issues/1724</a></div><details><summary>Allow @copy-namespaces on &lt;xsl:mode&gt;?</summary><div class="markup"><p>As part of an XSLT transformation I need to remove an unused (anywhere) namespace declaration and <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> doesn’t appear to accept a <code>@copy-namespaces</code> attribute where I can tell it not to copy unused namespaces. The unused namespace was used on a single attribute on the input document, but I’m removing the attribute entirely as part of the transformation, so nothing will remain in the output document that uses the namespace in question. With <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> the namespace declaration is copied into the result, even though it is not used. If I use the old identity template and set the value of <code>@copy-namespaces</code> on it to something falsy, I get the result I want, that is, no unneeded namespace declaration.</p>
<p>Insofar as <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> has come to fill the role formerly occupied by the identity template, would it be reasonable to allow it also to declare that unused namespaces should not be copied? If that request is reasonable, is it reasonable to think of it as a bug fix, rather than a new-feature request?</p>
</div></details></div>
<div class="toot" id="created-1723"><h2>Issue #1723 created<span class="toot-id"> #created-1723</span></h2><div class="pubdate">22 Jan at 22:07:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><details><summary>`ThenAction` left over after removal of `BracedActions`</summary><div class="markup"><p>Thanks for fixing the <code>IfExpr</code> ambiguity.</p>
<p>In #1712, <code>BracedAction</code> was introduced to replace the previous rules for braced actions. Of these, <code>ThenAction</code> still appears in the EBNF summary, but it is no longer referenced.</p>
</div></details></div>
<div class="toot" id="closed-1651"><h2>Issue #1651 closed<span class="toot-id"> #closed-1651</span></h2><div class="pubdate">22 Jan at 17:27:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1651">https://github.com/qt4cg/qtspecs/issues/1651</a></div><p>Ordered Maps: maps that retain insertion order</p></div>
<div class="toot" id="closed-1703"><h2>Issue #1703 closed<span class="toot-id"> #closed-1703</span></h2><div class="pubdate">22 Jan at 17:27:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><p>1651 ordered maps</p></div>
<div class="toot" id="closed-1709"><h2>Issue #1709 closed<span class="toot-id"> #closed-1709</span></h2><div class="pubdate">22 Jan at 11:55:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><p>Extend diagram of item types to include record types etc</p></div>
<div class="toot" id="created-1722"><h2>Pull request #1722 created<span class="toot-id"> #created-1722</span></h2><div class="pubdate">22 Jan at 11:46:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1722">https://github.com/qt4cg/qtspecs/pull/1722</a></div><details><summary>1717 define focus functions using pipeline operator</summary><div class="markup"><p>Fix #1717</p>
<p>Provides a formal definition of focus functions making use of the new pipeline operator.</p>
</div></details></div>
<div class="toot" id="created-1721"><h2>Pull request #1721 created<span class="toot-id"> #created-1721</span></h2><div class="pubdate">22 Jan at 11:27:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><details><summary>1713 Revise code for generating production rules</summary><div class="markup"><p>The main change here is to change the way "scraps" are expanded: these are the local collections of production rules that appear inline within the spec. These are now driven by a single <code>prodrecap</code> element naming the rule to be expanded, and the logic is now automated for deciding (a) which subsidiary production rules to include in the scrap, and (b) which occurrence of a production rule to use as the target for a hyperlinked reference to that rule, depending on where the reference appears.</p>
<p>Along with this there has been a fair bit of deletion of legacy code and general modernisation (e.g using XSLT 2.0 and 3.0 constructs where appropriate).</p>
</div></details></div>
<div class="toot" id="created-1720"><h2>Issue #1720 created<span class="toot-id"> #created-1720</span></h2><div class="pubdate">22 Jan at 10:50:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><details><summary>Grammar overhaul</summary><div class="markup"><p>There is a lot of dead wood in the xpath-grammar.xml file. This issue is raised to capture some observations and suggestions about how it can be simplified.</p>
<ul>
<li>The DTD lists 19 attributes that can appear on g:token, and documents the meaning of 5 of them (very briefly). I suspect that many of the attributes are never used. Many of them were probably intended primarily for use by the JavaCC parser generator.</li>
<li>As if that weren't enough, the grammar2spec stylesheet has logic that looks for additional attributes (an example is <code>@alias-for</code>) which are not even allowed by the DTD let alone being in active use.</li>
<li>The "if" logic to assign productions to different languages (xpath, xquery, XSLT patterns) is hard to maintain and could be automated: just search for productions that are reachable from the top-level production for each language. This could be done by a preprocessing stylesheet that generates a grammar file for each language.</li>
<li>The switch into a precedence-based grammar for binary operators (g:exprProduction name="OperatorExpr") doesn't really help anyone. For generating production rules in the spec, it just complicates the generation logic. The same is true for anyone else writing applications that use the grammar as input. It doesn't really make life easier for maintainers of the grammar, because it means there is more to learn.</li>
</ul>
<p>All the JavaCC machinery is still in the repo and I think it could probably go. Leaving stuff like that lying around makes things more difficult when you need to search filestore for references to things.</p>
</div></details></div>
<div class="toot" id="created-1719"><h2>Issue #1719 created<span class="toot-id"> #created-1719</span></h2><div class="pubdate">21 Jan at 22:57:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1719">https://github.com/qt4cg/qtspecs/issues/1719</a></div><details><summary>Purging dead build code</summary><div class="markup"><p>In the course of working on #1713 I've been exploring some dark corners of the build system. There's a lot of dead code. Some of it might come in useful in the future (e.g. code supporting XQuery Update) but most will be very hard to revive. For example there's a lot of grammar machinery which is there only to allow generation of a JavaCC parser.</p>
<p>The main purpose of this issue is to capture notes that might lead to some reduction of technical debt.</p>
<p>The gradle build is currently giving me</p>
<blockquote>
<p>Warning: link-text-with-check was unable to make a link for $ref-id="doc-shared40-Prolog"</p>
</blockquote>
<p>That message comes from <code>xmlspec-override.xsl</code>. This stylesheet looks like dead code because it has lots of references to XPath30 and XQuery30. But it can't be completely dead if we're getting errors from it. It's imported from two places: xpath-functions-30.xsl in the F&amp;O tree and shared.xsl in the xquery40 tree. The message comes from gradle task <code>xquery_shared_html</code>. As far as I can see the build system is constructing an XPath specification, an XQuery specification, and a "shared" specification which is a union of the two. (It starts off "XQuery 4.0 and XPath 4.0 is an expression language that allows..."). Presumably this was intended to allow editors and WG members to review a single document rather than reviewing XPath and XQuery separately. But I don't think it's used today, I think we could kill it off.</p>
<p>shared.xsl is referenced only from build.gradle when building the shared specification.</p>
<p>xpath-functions-30.xsl doesn't appear to be referenced from anywhere, and it carries a comment saying</p>
<pre><code> Created 17 Dec 2008 by MHK.
 No longer used 16 Feb 2009?
</code></pre>
<p>In the short term I've deleted the code in xmlspec-override.xsl starting with the comment "Our inability to create a link for $ref-id may be a sign of something wrong, so...". This gets rid of the warning messages. In the longer term, subject to confirmation, I think we can delete the build targets associated with the "shared" language spec, and delete the stylesheets xmlspec-override.xsl, xpath-functions-30.xsl, and shared.xsl.</p>
</div></details></div>
<div class="toot" id="created-1718"><h2>Issue #1718 created<span class="toot-id"> #created-1718</span></h2><div class="pubdate">21 Jan at 17:45:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1718">https://github.com/qt4cg/qtspecs/issues/1718</a></div><details><summary>Ordered Maps: positions in callback functions</summary><div class="markup"><p>Now that maps have a defined order, we should add the position to HOF parameters in map functions (in alignment with sequence and array functions). Examples:</p>
<pre><code class="language-xquery">map:for-each(
  $map     as map(*),	
  $action  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as item()*	
) as item()*

map:filter(
  $map        as map(*),	
  $predicate  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as xs:boolean?	
) as map(*)
</code></pre>
</div></details></div>
<div class="toot" id="minutes—01-21"><h2>QT4 CG meeting 106 draft minutes<span class="toot-id"> #minutes—01-21</span></h2><div class="pubdate">21 Jan at 17:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-21">https://qt4cg.org/meeting/minutes/2025/01-21</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1706"><h2>Issue #1706 closed<span class="toot-id"> #closed-1706</span></h2><div class="pubdate">21 Jan at 17:22:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><p>Ambiguous `if` syntax</p></div>
<div class="toot" id="closed-1712"><h2>Issue #1712 closed<span class="toot-id"> #closed-1712</span></h2><div class="pubdate">21 Jan at 17:22:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><p>1706 Drop "else if" and "else" clauses from braced conditionals</p></div>
<div class="toot" id="closed-1685"><h2>Issue #1685 closed<span class="toot-id"> #closed-1685</span></h2><div class="pubdate">21 Jan at 17:20:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><p>Pipeline Operator</p></div>
<div class="toot" id="closed-1686"><h2>Issue #1686 closed<span class="toot-id"> #closed-1686</span></h2><div class="pubdate">21 Jan at 17:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><p>1685 Pipeline Operator</p></div>
<div class="toot" id="closed-1701"><h2>Issue #1701 closed<span class="toot-id"> #closed-1701</span></h2><div class="pubdate">21 Jan at 17:18:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><p>Add dedication to MSM (action QT4CG-088-01)</p></div>
<div class="toot" id="closed-1705"><h2>Issue #1705 closed<span class="toot-id"> #closed-1705</span></h2><div class="pubdate">21 Jan at 17:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><p>fn:divide-decimals, fn:round: large precision values</p></div>
<div class="toot" id="closed-1711"><h2>Issue #1711 closed<span class="toot-id"> #closed-1711</span></h2><div class="pubdate">21 Jan at 17:16:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><p>1705 Say that max precision is implementation-defined</p></div>
<div class="toot" id="closed-1710"><h2>Issue #1710 closed<span class="toot-id"> #closed-1710</span></h2><div class="pubdate">21 Jan at 17:14:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><p>1709 Updated type diagrams</p></div>
<div class="toot" id="closed-1606"><h2>Issue #1606 closed<span class="toot-id"> #closed-1606</span></h2><div class="pubdate">21 Jan at 17:13:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1606">https://github.com/qt4cg/qtspecs/issues/1606</a></div><p>Drop named item types other than named record types</p></div>
<div class="toot" id="closed-1494"><h2>Issue #1494 closed<span class="toot-id"> #closed-1494</span></h2><div class="pubdate">21 Jan at 17:13:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1494">https://github.com/qt4cg/qtspecs/issues/1494</a></div><p>Records: Introduction?</p></div>
<div class="toot" id="closed-1176"><h2>Issue #1176 closed<span class="toot-id"> #closed-1176</span></h2><div class="pubdate">21 Jan at 17:13:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1176">https://github.com/qt4cg/qtspecs/issues/1176</a></div><p>Use fn:parse-uri to check whether a filepath is relative or absolute</p></div>
<div class="toot" id="closed-1700"><h2>Issue #1700 closed<span class="toot-id"> #closed-1700</span></h2><div class="pubdate">21 Jan at 17:11:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><p>Remove some dead .DS_Store files</p></div>
<div class="toot" id="created-1717"><h2>Issue #1717 created<span class="toot-id"> #created-1717</span></h2><div class="pubdate">21 Jan at 16:59:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1717">https://github.com/qt4cg/qtspecs/issues/1717</a></div><details><summary>Define focus functions in terms of the pipeline operator</summary><div class="markup"><p>Now that we have accepted the pipeline operator into the language, we can define the semantics of focus functions to take advantage of them, specifically, <code>fn() { EXPR }</code> can be defined to be equivalent to <code>fn($v) { $v -&gt; EXPR }</code> where $v is an otherwise-unused variable name.</p>
</div></details></div>
<div class="toot" id="agenda-01-21"><h2>QT4 CG meeting 106 draft agenda<span class="toot-id"> #agenda-01-21</span></h2><div class="pubdate">21 Jan at 10:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-21">https://qt4cg.org/meeting/agenda/2025/01-21</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1716"><h2>Issue #1716 created<span class="toot-id"> #created-1716</span></h2><div class="pubdate">20 Jan at 21:13:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1716">https://github.com/qt4cg/qtspecs/issues/1716</a></div><details><summary>Variable lookahead needed for `ArrowTarget`</summary><div class="markup"><p>The current grammar definition allows any <code>QName</code> (via <code>EQName</code>) as an <code>ArrowStaticFunction</code>:</p>
<pre><code>ArrowTarget
         ::= ArrowStaticFunction ArgumentList
           | ArrowDynamicFunction PositionalArgumentList
ArrowStaticFunction
         ::= EQName
ArrowDynamicFunction
         ::= VarRef
           | InlineFunctionExpr
           | ParenthesizedExpr 
</code></pre>
<p>This complicates the distinction of the static and dynamic variants of <code>ArrowTarget</code>, as it cannot be done with a fixed number of lookahead tokens. E.g. in an expression starting like this</p>
<pre><code class="language-xquery">A =&gt; fn ( $A, $B, $C, (: ... :) $Z ) { } ( 
</code></pre>
<p>the distinction cannot be made before the left brace is seen. While constructing an LR parser, there is a shift-reduce conflict between shifting <code>fn</code> as a keyword of an <code>InlineFunctionExpr</code>, or reducing <code>fn</code> to the <code>QName</code> of <code>EQName</code>.</p>
<p>This can easily be fixed by adding <code>xgc: reserved-function-names</code> to <code>ArrowStaticFunction</code>, which would also be consistent with other function calls in disallowing reserved function names:</p>
<pre><code>ArrowStaticFunction
         ::= EQName
                          /* xgc: reserved-function-names */		 
</code></pre>
<p>But could not <code>ArrowTarget</code> also be written like the following?</p>
<pre><code>ArrowTarget
         ::= FunctionCall
           | DynamicFunctionCall
</code></pre>
<p>In this case, the <code>xgc: reserved-function-names</code> constraint would be inherited from <code>FunctionCall</code>. It eliminates <code>ArrowStaticFunction</code> and <code>ArrowDynamicFunction</code> and at the same time lifts some restrictions imposed by the current <code>ArrowTarget</code>. It does not cause any LALR(2) conflicts.</p>
</div></details></div>
<div class="toot" id="created-1715"><h2>Issue #1715 created<span class="toot-id"> #created-1715</span></h2><div class="pubdate">20 Jan at 13:59:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1715">https://github.com/qt4cg/qtspecs/issues/1715</a></div><details><summary>Array Lookups: partial removal of out-of-bounds checks</summary><div class="markup"><p>Various QT4 tests imply that the out-of-bounds check for arrays have been removed. An example:</p>
<pre><code class="language-xml">&lt;test-case name="UnaryLookup-005a"&gt;
  &lt;description&gt;Integer subscript into an array: array index too low&lt;/description&gt;
  &lt;created by="Michael Kay" on="2014-11-27"/&gt;
  &lt;modified by="Michael Kay" on="2024-07-22" change="returns () in 4.0"/&gt;
  &lt;dependency type="spec" value="XP40+ XQ40+"/&gt;
  &lt;test&gt;(['a', 'b'], ['c', 'd'])[ ?0 eq 'c']&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-empty/&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
</code></pre>
<p>I believe this is not reflected in the spec yet, or at least it includes examples that need to be updated:</p>
<blockquote>
<p><code>[ "a", "b" ]?3</code> raises a dynamic error <code>err:FOAY0001</code>.</p>
</blockquote>
<p>I guess that #832 would have been the PR with the relevant changes (we have already observed in another issue that some changes of this PR need to survive; see https://github.com/qt4cg/qtspecs/pull/1283#issuecomment-2568330191).</p>
<p>That leads me to the original reason for creating this issue:</p>
<ul>
<li>I think it’s a good idea to drop the range check for array lookups, and it would seem consistent to me to also drop it for dynamic function calls.</li>
<li>As map/array lookups and dynamic function calls are often used interchangeably, <code>$array?0</code> and <code>$array(0)</code> should behave identically.</li>
<li>The <code>FOAY0001</code> error would (and should) still be raised by the array functions, including <code>array:get</code>, <code>array:put</code>, <code>array:remove</code>, or <code>array:insert-before</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1714"><h2>Issue #1714 created<span class="toot-id"> #created-1714</span></h2><div class="pubdate">19 Jan at 23:34:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1714">https://github.com/qt4cg/qtspecs/issues/1714</a></div><details><summary>sibling:: axis. Action Item QT4CG-097-03</summary><div class="markup"><p>This issue is a reflection of the following Action Item:</p>
<p><strong>QT4CG-097-03</strong>: DN to proposal an axis for accessing the siblings of a node.</p>
<p>I have prepared a pdf file that contains the updated relevant updated sections from the "<strong><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html">Xpath 4.0</a></strong>" document:</p>
<ul>
<li>There are no deletions or conflicting changes.</li>
<li>The additions to the text are highlighted in turquoise.</li>
<li>The file that contains all relevant updated sections of the document is at:
https://github.com/dnovatchev/qtspecs/blob/dn-siblings/sibling-axis.pdf</li>
</ul>
<p><strong>If the  above doesn't work</strong>, please try:
https://github.com/dnovatchev/MathPuzzles/blob/master/sibling-axis.pdf</p>
</div></details></div>
<div class="toot" id="created-1713"><h2>Issue #1713 created<span class="toot-id"> #created-1713</span></h2><div class="pubdate">19 Jan at 11:49:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1713">https://github.com/qt4cg/qtspecs/issues/1713</a></div><details><summary>Patchy exposition of XSLT type pattern syntax</summary><div class="markup"><p>In XSLT §5.4.2.2 Type Patterns, the exposition of the grammar is "patchy" - it includes some production rules such as <code>FieldDeclaration</code> that are in the subtree of the main production rule (<code>TypePattern</code>) without giving all the intermediate rules that connect this rule to the root.</p>
<p>It's easy enough to correct this by hand, but it would be nice to prevent this happening by automating the generation of these families of grammar rules, perhaps by including all rules in the subtree up to a depth of 3, say. It would also be nice to simply list the productions to be included without having to decide manually which of them should be the principal target of <code>termref</code> references (by being marked with an ID).</p>
</div></details></div>
<div class="toot" id="created-1712"><h2>Pull request #1712 created<span class="toot-id"> #created-1712</span></h2><div class="pubdate">18 Jan at 18:51:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><details><summary>1706 Drop "else if" and "else" clauses from braced conditionals</summary><div class="markup"><p>Fix #1706</p>
</div></details></div>
<div class="toot" id="created-1711"><h2>Pull request #1711 created<span class="toot-id"> #created-1711</span></h2><div class="pubdate">18 Jan at 18:29:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><details><summary>1705 Say that max precision is implementation-defined</summary><div class="markup"><p>Applies to fn:round, fn:round-half-to-even, fn:divide-decimals</p>
<p>Fix #1705</p>
</div></details></div>
<div class="toot" id="created-1710"><h2>Pull request #1710 created<span class="toot-id"> #created-1710</span></h2><div class="pubdate">17 Jan at 23:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><details><summary>1709 Updated type diagrams</summary><div class="markup"><p>Added a few details to the type diagrams: user-defined array, map, and record types; enumeration types; untypedAtomic</p>
</div></details></div>
<div class="toot" id="created-1709"><h2>Issue #1709 created<span class="toot-id"> #created-1709</span></h2><div class="pubdate">17 Jan at 22:44:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><details><summary>Extend diagram of item types to include record types etc</summary><div class="markup"><p>I propose to extend the diagram of item types (common to DM and FO) to include more detail of the hierarchy below function types.</p>
</div></details></div>
<div class="toot" id="closed-1617"><h2>Issue #1617 closed<span class="toot-id"> #closed-1617</span></h2><div class="pubdate">17 Jan at 12:55:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1617">https://github.com/qt4cg/qtspecs/pull/1617</a></div><p>1606 Drop named item types, refine named record types, esp in XSLT</p></div>
<div class="toot" id="created-1708"><h2>Pull request #1708 created<span class="toot-id"> #created-1708</span></h2><div class="pubdate">17 Jan at 12:52:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><details><summary>1485 Add xsl:record-type declaration</summary><div class="markup"><p>Adds named record types to XSLT, with much the same spec as for XQuery, but some extra tweaks for handling visibility and overriding.</p>
<p>Fix #1485</p>
</div></details></div>
<div class="toot" id="closed-1707"><h2>Issue #1707 closed<span class="toot-id"> #closed-1707</span></h2><div class="pubdate">17 Jan at 08:58:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><p>Fix bug in build dependencies</p></div>
<div class="toot" id="created-1707"><h2>Pull request #1707 created<span class="toot-id"> #created-1707</span></h2><div class="pubdate">17 Jan at 08:58:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><details><summary>Fix bug in build dependencies</summary><div class="markup"><p>Changing <code>xslt.xml</code> didn't actually cause the HTML for the XSLT specification to be rebuilt. 👎</p>
</div></details></div>
<div class="toot" id="created-1706"><h2>Issue #1706 created<span class="toot-id"> #created-1706</span></h2><div class="pubdate">16 Jan at 21:08:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><details><summary>Ambiguous `if` syntax</summary><div class="markup"><p>The optional <code>else</code> in a braced <code>if</code> expression introduces an ambiguity in the XQuery 4.0 grammar.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>It can be parsed like this</p>
<pre><code class="language-xquery">if (A) then if (B) {C}                               else {}
       else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E}               else {}
       else if (F) {G} else {H}
</code></pre>
<p>The corresponding part of the grammar is</p>
<pre><code>IfExpr   ::= 'if' '(' Expr ')' ( UnbracedActions | BracedActions )
UnbracedActions
         ::= 'then' ExprSingle 'else' ExprSingle
BracedActions
         ::= ThenAction ElseIfAction* ElseAction?
ThenAction
         ::= EnclosedExpr
ElseIfAction
         ::= 'else' 'if' '(' Expr ')' EnclosedExpr
ElseAction
         ::= 'else' EnclosedExpr
</code></pre>
<p>The ambiguity could be resolved by making the <code>ElseAction</code> in <code>BracedActions</code> mandatory, i.e.:</p>
<pre><code>BracedActions
         ::= ThenAction ElseIfAction* ElseAction
</code></pre>
</div></details></div>
<div class="toot" id="created-1705"><h2>Issue #1705 created<span class="toot-id"> #created-1705</span></h2><div class="pubdate">16 Jan at 15:53:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><details><summary>fn:divide-decimals, fn:round: large precision values</summary><div class="markup"><p>We may need to specify what is going to happen if very large (positive and negative) precisions are specified:</p>
<pre><code class="language-xquery">divide-decimals(1, 1, 0x7FFFFFFF)
</code></pre>
<p>A simple implementation in Java to compute the quotient for this function returns an Overflow exception:</p>
<pre><code class="language-java">BigDecimal.ONE.divide(BigDecimal.ONE, 0x7FFFFFFF, RoundingMode.DOWN)
</code></pre>
<p>This also affects <code>fn:round</code>: The query <code>round(1, -0x80000000)</code> seems to behave unexpectedly in existing implementations.</p>
<p>In general, the computation gets very slow for large precision values, and it may not be simple to interrupt such low-level operations, so maybe (if it makes sense, I haven’t really thought about it) we could define precision limits.</p>
</div></details></div>
<div class="toot" id="created-1704"><h2>Issue #1704 created<span class="toot-id"> #created-1704</span></h2><div class="pubdate">16 Jan at 15:09:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1704">https://github.com/qt4cg/qtspecs/issues/1704</a></div><details><summary>Ignore the byte order mark more completely/globally</summary><div class="markup"><p>Following on a discussion with @line-o on the XML.com Slack, I took a peek at the way we deal with the byte order mark in Functions and Operators. We seem to be explicit about it in a couple of JSON functions but not elsewhere. I think we should assert that the byte order mark is explicitly ignored in all of the input functions (json-<em>, parse-</em>, unparsed-* etc.)</p>
</div></details></div>
<div class="toot" id="closed-1136"><h2>Issue #1136 closed<span class="toot-id"> #closed-1136</span></h2><div class="pubdate">15 Jan at 18:53:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1136">https://github.com/qt4cg/qtspecs/issues/1136</a></div><p>Defining names for parameters on typed function tests</p></div>
<div class="toot" id="closed-1696"><h2>Issue #1696 closed<span class="toot-id"> #closed-1696</span></h2><div class="pubdate">15 Jan at 18:53:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><p>1136 Optional names in typed function types</p></div>
<div class="toot" id="closed-1688"><h2>Issue #1688 closed<span class="toot-id"> #closed-1688</span></h2><div class="pubdate">15 Jan at 00:04:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><p>In rendered HTML, link to definition is missing its link text</p></div>
<div class="toot" id="created-1703"><h2>Pull request #1703 created<span class="toot-id"> #created-1703</span></h2><div class="pubdate">14 Jan at 22:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><details><summary>1651 ordered maps</summary><div class="markup"><p>Reopened pull request introducing ordered maps.</p>
<p>Fix #1651.</p>
</div></details></div>
<div class="toot" id="closed-1609"><h2>Issue #1609 closed<span class="toot-id"> #closed-1609</span></h2><div class="pubdate">14 Jan at 17:23:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1609">https://github.com/qt4cg/qtspecs/pull/1609</a></div><p>1651 Ordered Maps</p></div>
<div class="toot" id="minutes—01-14"><h2>QT4 CG meeting 105 draft minutes<span class="toot-id"> #minutes—01-14</span></h2><div class="pubdate">14 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-14">https://qt4cg.org/meeting/minutes/2025/01-14</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1632"><h2>Issue #1632 closed<span class="toot-id"> #closed-1632</span></h2><div class="pubdate">14 Jan at 17:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1632">https://github.com/qt4cg/qtspecs/issues/1632</a></div><p>Add xsl:map/@select</p></div>
<div class="toot" id="closed-1694"><h2>Issue #1694 closed<span class="toot-id"> #closed-1694</span></h2><div class="pubdate">14 Jan at 17:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><p>1632 Add xsl:map/@select</p></div>
<div class="toot" id="closed-1684"><h2>Issue #1684 closed<span class="toot-id"> #closed-1684</span></h2><div class="pubdate">14 Jan at 17:05:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><p>[XSLT] Composite merge keys</p></div>
<div class="toot" id="closed-1689"><h2>Issue #1689 closed<span class="toot-id"> #closed-1689</span></h2><div class="pubdate">14 Jan at 17:05:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><p>1684 Composite merge keys; current-merge-key-array function</p></div>
<div class="toot" id="closed-1680"><h2>Issue #1680 closed<span class="toot-id"> #closed-1680</span></h2><div class="pubdate">14 Jan at 17:03:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><p>Ambiguous `switch` syntax</p></div>
<div class="toot" id="closed-1692"><h2>Issue #1692 closed<span class="toot-id"> #closed-1692</span></h2><div class="pubdate">14 Jan at 17:02:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><p>1680 Fix switch syntax ambiguity</p></div>
<div class="toot" id="closed-1672"><h2>Issue #1672 closed<span class="toot-id"> #closed-1672</span></h2><div class="pubdate">14 Jan at 17:00:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><p>array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1687"><h2>Issue #1687 closed<span class="toot-id"> #closed-1687</span></h2><div class="pubdate">14 Jan at 17:00:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><p>1672 array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1006"><h2>Issue #1006 closed<span class="toot-id"> #closed-1006</span></h2><div class="pubdate">14 Jan at 16:59:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1006">https://github.com/qt4cg/qtspecs/issues/1006</a></div><p>regular expression addition - word boundaries</p></div>
<div class="toot" id="closed-490"><h2>Issue #490 closed<span class="toot-id"> #closed-490</span></h2><div class="pubdate">14 Jan at 16:59:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/490">https://github.com/qt4cg/qtspecs/issues/490</a></div><p>Control over schema validation in parse-xml(), doc(), etc.</p></div>
<div class="toot" id="closed-108"><h2>Issue #108 closed<span class="toot-id"> #closed-108</span></h2><div class="pubdate">14 Jan at 16:59:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/108">https://github.com/qt4cg/qtspecs/issues/108</a></div><p>Template match using values of [tunnel] parameters</p></div>
<div class="toot" id="closed-1284"><h2>Issue #1284 closed<span class="toot-id"> #closed-1284</span></h2><div class="pubdate">14 Jan at 16:58:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1284">https://github.com/qt4cg/qtspecs/issues/1284</a></div><p>Build issue: Unsupported specref to  [streamability-fn-distinct-ordered-nodes]</p></div>
<div class="toot" id="closed-1695"><h2>Issue #1695 closed<span class="toot-id"> #closed-1695</span></h2><div class="pubdate">14 Jan at 16:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><p>1284 Define streamability of distinct-ordered-nodes</p></div>
<div class="toot" id="closed-1693"><h2>Issue #1693 closed<span class="toot-id"> #closed-1693</span></h2><div class="pubdate">14 Jan at 16:56:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><p>1683 Extend xpath-functions schema with CSV components</p></div>
<div class="toot" id="closed-1690"><h2>Issue #1690 closed<span class="toot-id"> #closed-1690</span></h2><div class="pubdate">14 Jan at 16:54:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><p>1688 In "implementation-defined" appendix, fix absent generated link</p></div>
<div class="toot" id="created-1702"><h2>Issue #1702 created<span class="toot-id"> #created-1702</span></h2><div class="pubdate">14 Jan at 15:19:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1702">https://github.com/qt4cg/qtspecs/issues/1702</a></div><details><summary>Node Updates: Functions</summary><div class="markup"><p>In #1225, I have summarized some thoughts on generalizing updates for both nodes and structured items (maps/arrays).</p>
<p>XQuery Update is complex, as updates are in general, so we may still decide that it is too ambitious to introduce update features in the core language. If we want to give it a try, we could offer functions that are based on XQUF, but that only perform one update operation at a a time on a given input. This way, we could ignore the sophisticated <a href="https://www.w3.org/TR/xquery-update-30/#id-pending-update-lists">Pending Update List</a> semantics, which is only important when multiple updating expressions are specified and need to be checked and brought into order.</p>
<p>A function set that provides an equivalent functionality for all XQUF update operations could look as follows (the presented functions are valid XQuery Update code):</p>
<pre><code class="language-xquery">declare namespace update = 'http://www.w3.org/TR/xquery-update';

declare function update:delete(
  $node  as node(),
  $path  as fn(node()) as node()*
) as node() {
  copy $c := $node
  modify delete node $path($c)
  return $c
};

declare function update:rename(
  $node  as node(),
  $path  as fn(node()) as node()*,
  $name  as (xs:QName | xs:NCName | fn(node(), xs:integer) as (xs:QName | xs:NCName))
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := if($name instance of fn(*)) {
      $name($target, $pos)
    } else {
      $name
    }
    return rename node $target as $result
  )
  return $c
};

declare function update:replace(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as node()*)*,
  $options   as record(value? as xs:boolean)? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return if($options?value) {
      replace value of node $target with $result
    } else {
      replace node $target with $result
    }
  )
  return $c
};

declare function update:insert(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as (node() | xs:anyAtomicType))*,
  $options   as record(position? as enum('last', 'first', 'before', 'after'))? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return switch($options?position) {
      case 'before' return insert node $result before $target
      case 'after'  return insert node $result after $target
      case 'first'  return insert node $result as first into $target
      default       return insert node $result as last into $target
    }
  )
  return $c
};
</code></pre>
<p>Here are some exemplary function calls:</p>
<pre><code class="language-xquery">let $node := &lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
return (
  (: deletes all &lt;e/&gt; child nodes :)
  update:delete($node, fn { e }),
  (: renames the &lt;e/&gt; child nodes to &lt;f/&gt; :)
  update:rename($node, fn { e }, 'f'),
  (: replaces the &lt;e/&gt; child nodes with &lt;replaced/&gt; :)
  update:replace($node, fn { e }, &lt;replaced/&gt;),
  (: replaces the string value of the &lt;e/&gt; child nodes with 'text' :)
  update:replace($node, fn { e }, 'text', { 'value': true() }),
  (: inserts a 'text' text node into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, 'text'),
  (: inserts 'text1' and 'text2' text nodes into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, fn($node, $pos) { 'text' || $pos }),
  (: inserts an &lt;x/&gt; element after each &lt;e/&gt; child node :)
  update:insert($node, fn { e }, &lt;x/&gt;, { 'position': 'after' })
)
</code></pre>
<p>Multiple update operations can easily be chained:</p>
<pre><code class="language-xquery">(: rename &lt;e/&gt; child nodes to &lt;f/&gt;, insert 'x' text nodes :)
&lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
=&gt; update:rename(fn { e }, 'f')
=&gt; update:insert(fn { f }, 'x')
</code></pre>
<p>Ideally, we could offer a similar function set (or maybe even the same) for maps and arrays in a next step (see #77). The map/array syntax would be similar for deletions…</p>
<pre><code class="language-xquery">let $data := { 'a': [ 1, 2, 3 ] }
return update:delete($data, fn { ?a?2 })
</code></pre>
<p>…but it certainly gets trickier for other operations.</p>
<p>If some of you believe that the presented approach is something that we should pursue, I will be happy to add details. As an alternative, we could pursue the XQUF light approach that I have sketched in #1225, based on the existing XQUF update keywords.</p>
<p>Yet another solution could be to stick with what we have, but add map/array update features to XQUF.</p>
</div></details></div>
<div class="toot" id="created-1701"><h2>Pull request #1701 created<span class="toot-id"> #created-1701</span></h2><div class="pubdate">14 Jan at 14:07:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><details><summary>Add dedication to MSM (action QT4CG-088-01)</summary><div class="markup"><p>I've had this action on my plate for a while. Having written a dedication, there's a follow-up question of where to put it. Having it in only one specification isn't wrong, but it seems slightly odd given that MSM contributed to them all. In the end, I decided to put a full dedication in the XPath specification and link to it from the others.</p>
<p>My rationale for the XPath spec is that it's probaly one that everyone reads. Another possibility was the Data Model as it's "foundational" but I think it's less read than XPath.</p>
<p>The published PR won't be write because there are tooling changes required. I've attached a couple of screen shots, one of the full dedication in XPath:</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/d83aa982-b783-44c8-8fb7-25787200bf13" alt="Screenshot 2025-01-14 at 14-00-08 XML Path Language (XPath) 4 0 WG Review Draft"></h2>
<p>And another of the link from the other specs (from XSLT, I think, but they're all the same).</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/634de4b0-59cb-4898-8c16-ddff4ddd3876" alt="Screenshot 2025-01-14 at 13-59-08 XSL Transformations (XSLT) Version 4 0"></h2>
</div></details></div>
<div class="toot" id="created-1700"><h2>Pull request #1700 created<span class="toot-id"> #created-1700</span></h2><div class="pubdate">14 Jan at 14:01:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><details><summary>Remove some dead .DS_Store files</summary><div class="markup"><p>I'm not sure how these got checked in...</p>
</div></details></div>
<div class="toot" id="agenda-01-14"><h2>QT4 CG meeting 105 draft agenda<span class="toot-id"> #agenda-01-14</span></h2><div class="pubdate">14 Jan at 10:11:15 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-14">https://qt4cg.org/meeting/agenda/2025/01-14</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1699"><h2>Issue #1699 created<span class="toot-id"> #created-1699</span></h2><div class="pubdate">14 Jan at 03:48:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1699">https://github.com/qt4cg/qtspecs/issues/1699</a></div><details><summary>XPath function to calculate edit distance between two strings</summary><div class="markup"><p>I propose a new XPath function to calculate the edit distance between two strings. It could use a specific algorithm, for example <code>fn:levenshtein-distance(s1,s2)</code>.</p>
<p>The function could also be designed  more generic like <code>fn:edit-distance(s1, s2, algorithm)</code> where <em>algorithm</em> could be levenshtein, hamming, lcs ... (see <a href="https://en.wikipedia.org/wiki/Edit_distance">edit distance</a>).</p>
<p>Use Case: Schematron Quick Fix when checking <code>glossentry</code> elements against terms defined in <code>glossary</code>. <em>"Your term is not defined in Glossary, did you mean ...".</em></p>
<p>Thanks, Frank</p>
</div></details></div>
<div class="toot" id="closed-1407"><h2>Issue #1407 closed<span class="toot-id"> #closed-1407</span></h2><div class="pubdate">13 Jan at 17:53:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1407">https://github.com/qt4cg/qtspecs/issues/1407</a></div><p>Improve the spec prose and table of content layout for types</p></div>
<div class="toot" id="created-1698"><h2>Issue #1698 created<span class="toot-id"> #created-1698</span></h2><div class="pubdate">13 Jan at 13:53:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1698">https://github.com/qt4cg/qtspecs/issues/1698</a></div><details><summary>Allow select attribute for xsl:call-template instruction</summary><div class="markup"><p>The lack of the following feature is something that bothers me from time to time. I hope this is the right place here for my proposal.
And even though I did some search -- I am not sure if something similar was discussed before ...</p>
<p>I propose to allow a <code>select</code> attribute for <code>xsl:call-template</code> instructions. When the <code>select</code> attribute is set, then the named template is called for each selected item as context item.</p>
<p>When the empty sequence is selected, the template is not invoked.</p>
<p>When the <code>select</code> attribute is omitted, then the instruction works as before (Invoked once and <em>"[...] does not change focus [...]"</em>).</p>
<p>For extension instructions from named templates: May work the same with a prefixed attribute (e.g. <code>xsl:select</code>).</p>
<p>Benefits I see:</p>
<ul>
<li>Change the context without <code>xsl:apply-templates</code></li>
<li>Avoid template parameter with <code>current()</code> as default value (annoying when you have nested named template calls)</li>
<li>Avoid <code>xsl:for-each</code> workaround where context just must be adjusted for a single item (no such parameter available, see before)</li>
<li>Save an <code>xsl:for-each</code> instruction with this shorter form</li>
<li>Harmonize <code>xsl:call-template</code> with <code>xsl:apply-templates</code> concept a little bit</li>
</ul>
<p>Simple example:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:call-template name="t:make-something" select="child-elem"/&gt;
  &lt;!-- ... or as extension instruction: --&gt;
  &lt;t:make-something xsl:select="child-elem"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template name="t:make-something"&gt;
  &lt;xsl:context-item use="required" as="element(child-elem)"&gt;
  &lt;!-- ... --&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The call of <code>t:make-something</code> before is equivalent with:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:for-each select="child-elem"&gt;
    &lt;xsl:call-template name="t:make-something"/&gt;
  &lt;/xsl:for-each&gt;
&lt;/xsl:template&gt;
</code></pre>
</div></details></div>
<div class="toot" id="closed-1675"><h2>Issue #1675 closed<span class="toot-id"> #closed-1675</span></h2><div class="pubdate">13 Jan at 12:03:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="closed-1677"><h2>Issue #1677 closed<span class="toot-id"> #closed-1677</span></h2><div class="pubdate">13 Jan at 12:03:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><p>1675 Fixes for CSV parsing</p></div>
<div class="toot" id="closed-1673"><h2>Issue #1673 closed<span class="toot-id"> #closed-1673</span></h2><div class="pubdate">13 Jan at 11:55:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><p>1407 TOC structure for types</p></div>
<div class="toot" id="closed-1681"><h2>Issue #1681 closed<span class="toot-id"> #closed-1681</span></h2><div class="pubdate">13 Jan at 09:21:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><p> Δ in the table of contents</p></div>
<div class="toot" id="closed-1691"><h2>Issue #1691 closed<span class="toot-id"> #closed-1691</span></h2><div class="pubdate">13 Jan at 09:21:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><p>1681 - Delta marker in TOC</p></div>
<div class="toot" id="created-1697"><h2>Issue #1697 created<span class="toot-id"> #created-1697</span></h2><div class="pubdate">13 Jan at 00:17:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1697">https://github.com/qt4cg/qtspecs/issues/1697</a></div><details><summary>Add documentary names to callback function signatures</summary><div class="markup"><p>If PR #1696 is accepted we can add documentary names to the parameters of callback function signatures, for example <code>fn:filter</code> can become</p>
<pre><code>fn:filter(
  $input as&nbsp;item()*, | &nbsp;
  $predicate as&nbsp;fn($item as item(), $position as xs:integer) as xs:boolean? | &nbsp;
)&nbsp;as&nbsp;item()*

</code></pre>
<p>and we can (if we need to) use the parameter names in the prose</p>
</div></details></div>
<div class="toot" id="created-1696"><h2>Pull request #1696 created<span class="toot-id"> #created-1696</span></h2><div class="pubdate">13 Jan at 00:07:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><details><summary>1136 Optional names in typed function types</summary><div class="markup"><p>Fix #1136</p>
</div></details></div>
<div class="toot" id="created-1695"><h2>Pull request #1695 created<span class="toot-id"> #created-1695</span></h2><div class="pubdate">12 Jan at 23:36:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><details><summary>1284 Define streamability of distinct-ordered-nodes</summary><div class="markup"><p>Fix #1284</p>
</div></details></div>
<div class="toot" id="closed-1610"><h2>Issue #1610 closed<span class="toot-id"> #closed-1610</span></h2><div class="pubdate">11 Jan at 10:48:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1610">https://github.com/qt4cg/qtspecs/issues/1610</a></div><p>Some cross references are incorrect</p></div>
<div class="toot" id="closed-1683"><h2>Issue #1683 closed<span class="toot-id"> #closed-1683</span></h2><div class="pubdate">10 Jan at 09:35:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><p>There are validity errors in the function catalog related to csv elements</p></div>
<div class="toot" id="created-1694"><h2>Pull request #1694 created<span class="toot-id"> #created-1694</span></h2><div class="pubdate">09 Jan at 23:10:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><details><summary>1632 Add xsl:map/@select</summary><div class="markup"><p>Fix #1632</p>
</div></details></div>
<div class="toot" id="created-1693"><h2>Pull request #1693 created<span class="toot-id"> #created-1693</span></h2><div class="pubdate">09 Jan at 22:25:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><details><summary>1683 Extend xpath-functions schema with CSV components</summary><div class="markup"><p>This was an unsuccessful attempt to fix issue #1683, but the change is still worth making. It extends the aggregated schema for the XPath functions namespace to include definitions for the result of the csv-to-xml function.</p>
</div></details></div>
<div class="toot" id="created-1692"><h2>Pull request #1692 created<span class="toot-id"> #created-1692</span></h2><div class="pubdate">09 Jan at 21:55:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><details><summary>1680 Fix switch syntax ambiguity</summary><div class="markup"><p>Fix #1680 (as suggested in the issue)</p>
</div></details></div>
<div class="toot" id="created-1691"><h2>Pull request #1691 created<span class="toot-id"> #created-1691</span></h2><div class="pubdate">09 Jan at 21:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><details><summary>1681 - Delta marker in TOC</summary><div class="markup"><p>Fix #1681</p>
</div></details></div>
<div class="toot" id="created-1690"><h2>Pull request #1690 created<span class="toot-id"> #created-1690</span></h2><div class="pubdate">09 Jan at 20:28:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><details><summary>1688 In "implementation-defined" appendix, fix absent generated link</summary><div class="markup"><p>For F&amp;O the automatically-generated appendix of implementation-defined item should link each such item to the nearest containing section that has a <code>head</code> child as well as an id attribute.</p>
</div></details></div>
<div class="toot" id="created-1689"><h2>Pull request #1689 created<span class="toot-id"> #created-1689</span></h2><div class="pubdate">09 Jan at 18:10:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><details><summary>1684 Composite merge keys; current-merge-key-array function</summary><div class="markup"><p>Acknowledges that as a result of changes to <code>xsl:sort</code>, <code>xsl:merge</code> now accepts composite merge keys; introduces the <code>current-merge-key-array()</code> function to handle them.</p>
<p>Fix #1684</p>
</div></details></div>
<div class="toot" id="created-1688"><h2>Issue #1688 created<span class="toot-id"> #created-1688</span></h2><div class="pubdate">09 Jan at 17:39:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><details><summary>In rendered HTML, link to definition is missing its link text</summary><div class="markup"><p>https://qt4cg.org/specifications/xpath-functions-40/Overview.html#impl-def Item 6 contains a sentence that renders as "See ." In the raw HTML, there is a link <code>&lt;a href="#dt-nondeterministic-wrt-ordering"&gt;&lt;/a&gt;</code> with no link text.</p>
<p>I thought I might make this issue a little more substantive by reporting a second typo or broken link, but I can't find a second one at the moment. :)</p>
</div></details></div>
<div class="toot" id="created-1687"><h2>Pull request #1687 created<span class="toot-id"> #created-1687</span></h2><div class="pubdate">09 Jan at 12:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><details><summary>1672 array:values, map:values: Alternatives</summary><div class="markup"><p>Issue: #1672</p>
</div></details></div>
<div class="toot" id="created-1686"><h2>Pull request #1686 created<span class="toot-id"> #created-1686</span></h2><div class="pubdate">09 Jan at 11:46:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><details><summary>1685 Pipeline Operator</summary><div class="markup"><p>Issue: #1685</p>
<p>The PR introduces the pipeline operator <code>-&gt;</code>. If we decide to add it, we could drop <code>=!&gt;</code> in a second step and update various examples in the text.</p>
</div></details></div>
<div class="toot" id="created-1685"><h2>Issue #1685 created<span class="toot-id"> #created-1685</span></h2><div class="pubdate">09 Jan at 09:46:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><details><summary>Pipeline Operator</summary><div class="markup"><p>This is an attempt to find a solution for the discussion in #755, which was originally about defining an expression to bind the context value. It serves as a summary for an upcoming PR.</p>
<p>We have two operators in the language that can be used for pipelining:
&nbsp;&nbsp;1.&nbsp;With the simple map operator <code>!</code>, single items of an input can be bound to the context value.
&nbsp;&nbsp;2.&nbsp;With the arrow operator <code>=&gt;</code>, an input can be bound as first argument in a function call.</p>
<p>The current restrictions are:
&nbsp;&nbsp;A) There is no way to bind a sequence with 0 or more than 1 items to the context value.
&nbsp;&nbsp;B) We can only bind the input to the first function argument.</p>
<p>In addition, we have introduced the mapping arrow expression <code>=!&gt;</code> to bind single items of an input to the first function argument.</p>
<p>We could generalize and simplify the situation by introducing a dedicated and very basic pipeline operator: <code>A -&gt; B</code> evaluates <code>A</code> to a value, which is bound to the context value before evaluating <code>B</code>.</p>
<p>With the operator, restriction A) would be resolved. Restriction B) would be tackled indirectly, as <code>-&gt;</code> and <code>!</code> can often be combined. For example, the following examples from the specification could be simplified…</p>
<pre><code class="language-xquery">(: current vs. simplified syntax :)
$s =&gt; tokenize() =!&gt; fn { `"{.}"` }()
$s -&gt; tokenize(.) ! `"{.}"`

(: current vs. simplified syntax :)
(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() =!&gt; fn($a) { $a + 1 }() =&gt; sum()
(1 to 5) ! xs:double(.) ! math:sqrt(.) ! (. + 1) -&gt; sum(.)
</code></pre>
<p>…and we could drop <code>=!&gt;</code> in favor of the new operator.</p>
<p>An equivalent representation for the focus function <code>fn { E }</code> would be <code>fn($c) { $c -&gt; E }</code>.</p>
</div></details></div>
<div class="toot" id="created-1684"><h2>Issue #1684 created<span class="toot-id"> #created-1684</span></h2><div class="pubdate">08 Jan at 21:41:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><details><summary>[XSLT] Composite merge keys</summary><div class="markup"><p>The changes in PR #1674 to allow composite sort keys automatically propagate to <code>xsl:merge</code>, because the semantics of <code>xsl:merge-key</code> are defined entirely by reference to <code>xsl:sort</code>.</p>
<p>No immediate problem, except (1) we should acknowledge the fact and point out that composite merge keys are now allowed, and (2) the effect on the current-merge-key() function. This is the sequence-concatenation of the merge keys for multiple merge sources. The spec says:</p>
<blockquote>
<p>the [current merge key] will be a single atomic item if there is a single merge key, or a sequence of atomic items if there are multiple merge keys.</p>
</blockquote>
<p>Actually I think that's already wrong, because it forgets that an individual merge key may be an empty sequence. If that happens then the current-merge-key() function is somewhat useless. I suggest we simply document the fact: if there are multiple merge sources generating multiple merge keys and they are not all singletons, then the sequence concatenation of the merge keys may not be especially useful.</p>
<p>We could provide a variant current-merge-key-array() that returns an array of sort key values, one for each xsl:merge-key element, each one being a sequence of atomic items.</p>
</div></details></div>
<div class="toot" id="minutes—01-07"><h2>QT4 CG meeting 104 draft minutes<span class="toot-id"> #minutes—01-07</span></h2><div class="pubdate">07 Jan at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-07">https://qt4cg.org/meeting/minutes/2025/01-07</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1261"><h2>Issue #1261 closed<span class="toot-id"> #closed-1261</span></h2><div class="pubdate">07 Jan at 17:24:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1261">https://github.com/qt4cg/qtspecs/issues/1261</a></div><p>Add decimal-divide function</p></div>
<div class="toot" id="closed-1671"><h2>Issue #1671 closed<span class="toot-id"> #closed-1671</span></h2><div class="pubdate">07 Jan at 17:24:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><p>1261 New fn:divide-decimals() function</p></div>
<div class="toot" id="closed-1662"><h2>Issue #1662 closed<span class="toot-id"> #closed-1662</span></h2><div class="pubdate">07 Jan at 17:22:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1662">https://github.com/qt4cg/qtspecs/issues/1662</a></div><p>xsl:sort - add composite sort keys</p></div>
<div class="toot" id="closed-1674"><h2>Issue #1674 closed<span class="toot-id"> #closed-1674</span></h2><div class="pubdate">07 Jan at 17:22:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><p>1662 Allow composite sort keys in xsl:sort</p></div>
<div class="toot" id="closed-1621"><h2>Issue #1621 closed<span class="toot-id"> #closed-1621</span></h2><div class="pubdate">07 Jan at 17:20:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1621">https://github.com/qt4cg/qtspecs/issues/1621</a></div><p>compare() with collations that do not support ordering</p></div>
<div class="toot" id="closed-1676"><h2>Issue #1676 closed<span class="toot-id"> #closed-1676</span></h2><div class="pubdate">07 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><p>1621 Capabilities of Collations</p></div>
<div class="toot" id="closed-1678"><h2>Issue #1678 closed<span class="toot-id"> #closed-1678</span></h2><div class="pubdate">07 Jan at 17:17:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><p>Semantics of element(N, T) where T is a union type</p></div>
<div class="toot" id="closed-1679"><h2>Issue #1679 closed<span class="toot-id"> #closed-1679</span></h2><div class="pubdate">07 Jan at 17:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><p>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</p></div>
<div class="toot" id="closed-1670"><h2>Issue #1670 closed<span class="toot-id"> #closed-1670</span></h2><div class="pubdate">07 Jan at 17:11:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div>
<div class="toot" id="closed-1667"><h2>Issue #1667 closed<span class="toot-id"> #closed-1667</span></h2><div class="pubdate">07 Jan at 17:08:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1667">https://github.com/qt4cg/qtspecs/issues/1667</a></div><p>Invalid XML characters in JSON input</p></div>
<div class="toot" id="closed-1669"><h2>Issue #1669 closed<span class="toot-id"> #closed-1669</span></h2><div class="pubdate">07 Jan at 17:08:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1669">https://github.com/qt4cg/qtspecs/pull/1669</a></div><p>1667 Revise handling of non-XML characters in parse-json</p></div>
<div class="toot" id="closed-1668"><h2>Issue #1668 closed<span class="toot-id"> #closed-1668</span></h2><div class="pubdate">07 Jan at 17:05:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1668">https://github.com/qt4cg/qtspecs/pull/1668</a></div><p>Minor copy edits (no issue raised)</p></div>
<div class="toot" id="closed-1649"><h2>Issue #1649 closed<span class="toot-id"> #closed-1649</span></h2><div class="pubdate">07 Jan at 17:02:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1649">https://github.com/qt4cg/qtspecs/issues/1649</a></div><p>Result type of fn:function-annotations()</p></div>
<div class="toot" id="closed-1666"><h2>Issue #1666 closed<span class="toot-id"> #closed-1666</span></h2><div class="pubdate">07 Jan at 17:02:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1666">https://github.com/qt4cg/qtspecs/pull/1666</a></div><p>1649 result of function annotations</p></div>
<div class="toot" id="closed-1650"><h2>Issue #1650 closed<span class="toot-id"> #closed-1650</span></h2><div class="pubdate">07 Jan at 16:59:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1650">https://github.com/qt4cg/qtspecs/issues/1650</a></div><p>fn:node-kind, fn:type-of: Editorial</p></div>
<div class="toot" id="closed-1665"><h2>Issue #1665 closed<span class="toot-id"> #closed-1665</span></h2><div class="pubdate">07 Jan at 16:59:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1665">https://github.com/qt4cg/qtspecs/pull/1665</a></div><p>1650 Tidy up fn:type-of</p></div>
<div class="toot" id="closed-1663"><h2>Issue #1663 closed<span class="toot-id"> #closed-1663</span></h2><div class="pubdate">07 Jan at 16:57:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1663">https://github.com/qt4cg/qtspecs/pull/1663</a></div><p>Remove DTD/stylesheet distractions at the top of the schema</p></div>
<div class="toot" id="agenda-01-07"><h2>QT4 CG meeting 104 draft agenda<span class="toot-id"> #agenda-01-07</span></h2><div class="pubdate">07 Jan at 10:11:30 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-07">https://qt4cg.org/meeting/agenda/2025/01-07</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1683"><h2>Issue #1683 created<span class="toot-id"> #created-1683</span></h2><div class="pubdate">06 Jan at 11:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><details><summary>There are validity errors in the function catalog related to csv elements</summary><div class="markup"><p>The build reports:</p>
<pre><code>Processing file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Building tree for file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml using class net.sf.saxon.tree.tiny.TinyBuilder
Tree built in 215.684667ms
Tree size: 38655 nodes, 773635 characters, 7637 attributes
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-002
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 5 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-003
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-004
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 8 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-005
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 16 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-006
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 24 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-007
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 37 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-008
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 40 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-009
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 36 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-010
Execution time: 532.103792ms
Memory used: 98Mb
</code></pre>
</div></details></div>
<div class="toot" id="created-1682"><h2>Issue #1682 created<span class="toot-id"> #created-1682</span></h2><div class="pubdate">06 Jan at 11:05:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1682">https://github.com/qt4cg/qtspecs/issues/1682</a></div><details><summary>Type Promotion</summary><div class="markup"><p>The description of type promotion in Appendix B.1 has become outdated.</p>
<p>Firstly, the coercion rules no longer invoke type promotion; instead, they use a custom table of "implicit casts". So B.1 is wrong to say that type promotion is invoked by the coercion rules.</p>
<p>Secondly, for selecting an entry in the operator mapping table, I don't think type promotion comes into play.</p>
<ul>
<li>The rules for value comparisons do all the necessary type conversions of operands BEFORE invoking a search of the operator mapping table.</li>
<li>The rules for arithmetic operators don't require any type promotion: for numerics, they invoke a function such as op:numeric-add, and it is the definition of this function (not the selection of the function in the mapping table) that invokes type promotion.</li>
</ul>
<p>The statement in B.1 that "If the result type of an operator is listed as numeric, it means "the first type in the ordered list (xs:integer, xs:decimal, xs:float, xs:double) into which all operands can be converted by [subtype substitution] and [type promotion]" seems wrong in general: for example it doesn't cover <code>integer div integer</code>. The result type is actually defined by the rules of the selected function, e.g. op:numeric-divide, and not by the "result type" column of the operator mapping table. Perhaps it should say that if the result type is a subtype of numeric as defined by the particular function.</p>
<p>References to Type Promotion in F&amp;O section 1.6 are also outdated.</p>
<p>The sum() and avg() functions invoke "numeric promotion" to convert all values in the input to a common type, but the exact rules for doing this aren't exactly clear. For example, the equivalent expression given for sum() doesn't do what the prose says. For example, given sum() applied to a sequence (X as decimal, Y as decimal, Z as float), the prose says the result is float(X) + float(Y) + Z, whereas the equivalent expression gives float(decimal(X + Y)) + Z) which is not necessarily the same thing.</p>
</div></details></div>
<div class="toot" id="created-1681"><h2>Issue #1681 created<span class="toot-id"> #created-1681</span></h2><div class="pubdate">05 Jan at 23:38:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><details><summary> Δ in the table of contents</summary><div class="markup"><p>All the spec say in their first changes section:</p>
<blockquote>
<p>Sections with significant changes are marked Δ in the table of contents.</p>
</blockquote>
<p>However, these markers are present only in the F&amp;O specification.</p>
</div></details></div>
<div class="toot" id="created-1680"><h2>Issue #1680 created<span class="toot-id"> #created-1680</span></h2><div class="pubdate">05 Jan at 19:27:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><details><summary>Ambiguous `switch` syntax</summary><div class="markup"><p>Unless I am overlooking some constraint preventing this, an ambiguity has been introduced to the XQuery 4.0 grammar by allowing the <code>SwitchComparand</code> to be omitted per #671/#678.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">switch case A return switch case B return switch case C return D default return E default return F
</code></pre>
<p>It can be parsed along the lines of</p>
<pre><code class="language-xquery">switch
case A return SWITCH 
case B return switch
              case C return D 
              default return E 
default return F
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">switch
case A return switch
              case B return SWITCH
              case C return D
              default return E
default return F
</code></pre>
</div></details></div>
<div class="toot" id="created-1679"><h2>Pull request #1679 created<span class="toot-id"> #created-1679</span></h2><div class="pubdate">05 Jan at 14:28:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><details><summary>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</summary><div class="markup"><p>Fix #1678</p>
</div></details></div>
<div class="toot" id="created-1678"><h2>Issue #1678 created<span class="toot-id"> #created-1678</span></h2><div class="pubdate">05 Jan at 00:24:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><details><summary>Semantics of element(N, T) where T is a union type</summary><div class="markup"><p>The semantics of <code>element(N, T)</code> say that to get a match, the type annotation A of the element must be derived from T <em>by restriction</em>. This means you will never get a match if T is a union type.</p>
<p>Furthermore, if T is a complex type, there is no match if the type annotation is a complex type derived by extension from T.</p>
<p>I think this is a simple error in the spec. It should say that derived-from(A, T) must be true. The derived-from() relationship handles union types and derivation by extension correctly.</p>
<p>We do use <code>derived-from</code> when specifying subtyping. This means that an element E can be an instance of <code>element(E, xs:integer)</code>, and not be an instance of <code>element(E, xs:numeric)</code>, even though  <code>element(E, xs:integer)</code>, is a subtype of <code>element(E, xs:numeric)</code>.</p>
<p>The error seems to have crept in when the rules were redrafted for 4.0. Up to and including 3.1, the semantics of ElementTest and AttributeTest reference the derived-from() function.</p>
</div></details></div>
<div class="toot" id="created-1677"><h2>Pull request #1677 created<span class="toot-id"> #created-1677</span></h2><div class="pubdate">04 Jan at 18:32:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><details><summary>1675 Fixes for CSV parsing</summary><div class="markup"><p>Fix #1675</p>
</div></details></div>
<div class="toot" id="created-1676"><h2>Pull request #1676 created<span class="toot-id"> #created-1676</span></h2><div class="pubdate">03 Jan at 20:08:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><details><summary>1621 Capabilities of Collations</summary><div class="markup"><p>Fix #1621</p>
<p>This PR is largely editorial, except that it makes a substantive change to the <code>fn:collation-available</code> function.</p>
</div></details></div>
<div class="toot" id="created-1675"><h2>Issue #1675 created<span class="toot-id"> #created-1675</span></h2><div class="pubdate">03 Jan at 16:02:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="created-1674"><h2>Pull request #1674 created<span class="toot-id"> #created-1674</span></h2><div class="pubdate">03 Jan at 13:32:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><details><summary>1662 Allow composite sort keys in xsl:sort</summary><div class="markup"><p>Fix #1662</p>
</div></details></div>
<div class="toot" id="created-1673"><h2>Pull request #1673 created<span class="toot-id"> #created-1673</span></h2><div class="pubdate">03 Jan at 01:07:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><details><summary>1407 TOC structure for types</summary><div class="markup"><p>Addresses part of #1407:</p>
<ul>
<li>Improves the section headings and levels for the Types and Subtyping sections</li>
<li>Level-4 headings (and level-5 if there were any) are no longer omitted from the F&amp;O TOC.</li>
</ul>
<p>There are other suggestions in #1407 regarding the spec prose that are not (yet) implemented.</p>
<p>Changing the CSS to adjust presentation of level-4 and level-5 headings in the TOC is way above my level of CSS competence, there's some very elaborate logic in this area, and anyone who wants to tackle it is welcome.</p>
</div></details></div>
<div class="toot" id="created-1672"><h2>Issue #1672 created<span class="toot-id"> #created-1672</span></h2><div class="pubdate">02 Jan at 20:50:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><details><summary>array:values, map:values: Alternatives</summary><div class="markup"><p>We still have <code>array:values</code> and <code>map:values</code> in the spec, even though the names were considered suboptimal: When retrieving values of struct(ure(d item))s, one would expect to get not a flat, but a structured result.</p>
<p>A while ago, the <code>items</code> key specifier was introduced to mimic the classical wildcard lookup syntax (making <code>$A?*</code> and <code>$A?items::*</code> equivalent), and I suggest renaming our functions to <code>array:items</code> and <code>map:items</code>:</p>
<pre><code class="language-xquery">  $map?*
≍ map:items($map)

  $array?*
≍ array:items($array)
</code></pre>
<p>Plan&nbsp;B could be to extend the second argument of <code>map:get</code> (and <code>array:get</code>) to also accept predicate functions…</p>
<pre><code class="language-xquery">map:get(
  $map  as map(*),	
  $key  as (xs:anyAtomicType|fn(xs:anyAtomicType) as xs:boolean?)
) as item()*
</code></pre>
<p>…which would allow us to write:</p>
<pre><code class="language-xquery">  $map?a
≍ $map =&gt; map:get('a')
≍ $map =&gt; map:get(fn { . = 'a' })

  $map?(1 to 5)
≍ $map =&gt; map:get(fn { . = 1 to 5 })

  $map?*
≍ $map =&gt; map:get(true#0)

(: and things like :)
$map =&gt; map:get(fn { . mod 2 = 1 })
</code></pre>
</div></details></div>
<div class="toot" id="created-1671"><h2>Pull request #1671 created<span class="toot-id"> #created-1671</span></h2><div class="pubdate">01 Jan at 16:50:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><details><summary>1261 New fn:divide-decimals() function</summary><div class="markup"><p>Fix #1261</p>
</div></details></div>
<div class="toot" id="created-1670"><h2>Pull request #1670 created<span class="toot-id"> #created-1670</span></h2><div class="pubdate">01 Jan at 12:51:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div></div></article></main></body></html>
<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2025</title></head><body><main><article><h1>@qt4cg statuses in 2025</h1><p>This page displays status
              updates
              about the QT4 CG project from 2025.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="minutesâ€”01-28"><h2>QT4 CG meeting 107 draft minutes<span class="toot-id"> #minutesâ€”01-28</span></h2><div class="pubdate">28 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-28">https://qt4cg.org/meeting/minutes/2025/01-28</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1725"><h2>Issue #1725 closed<span class="toot-id"> #closed-1725</span></h2><div class="pubdate">28 Jan at 17:10:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><p>Position of duplicates in ordered maps</p></div>
<div class="toot" id="closed-1727"><h2>Issue #1727 closed<span class="toot-id"> #closed-1727</span></h2><div class="pubdate">28 Jan at 17:10:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><p>1725 Define more detailed rules for duplicates in maps</p></div>
<div class="toot" id="closed-1485"><h2>Issue #1485 closed<span class="toot-id"> #closed-1485</span></h2><div class="pubdate">28 Jan at 17:07:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1485">https://github.com/qt4cg/qtspecs/issues/1485</a></div><p>Record declarations in XSLT</p></div>
<div class="toot" id="closed-1708"><h2>Issue #1708 closed<span class="toot-id"> #closed-1708</span></h2><div class="pubdate">28 Jan at 17:07:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><p>1485 Add xsl:record-type declaration</p></div>
<div class="toot" id="closed-76"><h2>Issue #76 closed<span class="toot-id"> #closed-76</span></h2><div class="pubdate">28 Jan at 17:06:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/76">https://github.com/qt4cg/qtspecs/issues/76</a></div><p>non-deterministic time</p></div>
<div class="toot" id="closed-747"><h2>Issue #747 closed<span class="toot-id"> #closed-747</span></h2><div class="pubdate">28 Jan at 17:06:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/747">https://github.com/qt4cg/qtspecs/issues/747</a></div><p>QName literals</p></div>
<div class="toot" id="closed-885"><h2>Issue #885 closed<span class="toot-id"> #closed-885</span></h2><div class="pubdate">28 Jan at 17:06:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/885">https://github.com/qt4cg/qtspecs/issues/885</a></div><p>fn:uuid</p></div>
<div class="toot" id="closed-981"><h2>Issue #981 closed<span class="toot-id"> #closed-981</span></h2><div class="pubdate">28 Jan at 17:05:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/981">https://github.com/qt4cg/qtspecs/issues/981</a></div><p>Identify optional arguments in callback functions</p></div>
<div class="toot" id="closed-998"><h2>Issue #998 closed<span class="toot-id"> #closed-998</span></h2><div class="pubdate">28 Jan at 17:05:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/998">https://github.com/qt4cg/qtspecs/issues/998</a></div><p>regular expression addition - lookbehind assertions and lookahead assertions</p></div>
<div class="toot" id="closed-1720"><h2>Issue #1720 closed<span class="toot-id"> #closed-1720</span></h2><div class="pubdate">28 Jan at 17:04:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><p>Grammar overhaul</p></div>
<div class="toot" id="closed-1732"><h2>Issue #1732 closed<span class="toot-id"> #closed-1732</span></h2><div class="pubdate">28 Jan at 17:04:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><p>1720 grammar simplification</p></div>
<div class="toot" id="closed-1069"><h2>Issue #1069 closed<span class="toot-id"> #closed-1069</span></h2><div class="pubdate">28 Jan at 17:03:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1069">https://github.com/qt4cg/qtspecs/issues/1069</a></div><p>fn:ucd</p></div>
<div class="toot" id="closed-1124"><h2>Issue #1124 closed<span class="toot-id"> #closed-1124</span></h2><div class="pubdate">28 Jan at 17:03:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1124">https://github.com/qt4cg/qtspecs/issues/1124</a></div><p>Formatting XPath/XQuery: Preferences, Conventions</p></div>
<div class="toot" id="closed-1252"><h2>Issue #1252 closed<span class="toot-id"> #closed-1252</span></h2><div class="pubdate">28 Jan at 17:03:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1252">https://github.com/qt4cg/qtspecs/issues/1252</a></div><p>Add a new function `fn:html-doc`</p></div>
<div class="toot" id="closed-1728"><h2>Issue #1728 closed<span class="toot-id"> #closed-1728</span></h2><div class="pubdate">28 Jan at 17:01:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><p>Fix CSS for production tables</p></div>
<div class="toot" id="created-1735"><h2>Pull request #1735 created<span class="toot-id"> #created-1735</span></h2><div class="pubdate">27 Jan at 17:09:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1735">https://github.com/qt4cg/qtspecs/pull/1735</a></div><details><summary>1341 Drop $position callback from many functions</summary><div class="markup"><p>Responding to the discussion in #1341, this (somewhat experimental) PR explores the possibility of dropping the optional
$position argument to the callback of many higher-order functions such as some(), every(), filter(), for-each(), fold-left(), fold-right(). Instead, it provides the option to wrap the input sequence in a call of numbered-items() which replaces each item in the input with an (item, position) pair.</p>
<p>I've done this only (so far) for higher-order sequence functions, but the intent is that the same could be done for arrays and (potentially) maps.</p>
<p>I left the position argument in place for a few functions where losing it seemed to cause genuine inconvenience:</p>
<ul>
<li>partition(), where the function wraps the supplied items into arrays, and you don't want to have to remove the positions afterwards</li>
<li>subsequence-where(), where many use cases are likely to use positional information</li>
<li>for-each-pair(), where there are two input sequences and it seems clumsy to associate position information with one or the other</li>
</ul>
<p>The main benefit is that we provide one basic mechanism which is automatically available everywhere, which means we don't have to have debates about whether or not there is a use case for adding position information to (say) fold-left or scan-right.</p>
<p>A further benefit is that the functions defined for sequences automatically become available for arrays and maps. I haven't yet explored the impact on maps and arrays; I will wait first to see what the reaction is to this proposal.</p>
</div></details></div>
<div class="toot" id="closed-1730"><h2>Issue #1730 closed<span class="toot-id"> #closed-1730</span></h2><div class="pubdate">27 Jan at 15:12:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><p>Consistency in default handling of map duplicates</p></div>
<div class="toot" id="created-1734"><h2>Pull request #1734 created<span class="toot-id"> #created-1734</span></h2><div class="pubdate">27 Jan at 13:05:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1734">https://github.com/qt4cg/qtspecs/pull/1734</a></div><details><summary>1682 Type promotion and operator mapping</summary><div class="markup"><p>Fix #1682</p>
<p>Moves the relevant parts of the operator mapping table into the sections for Arithmetic Expressions and Value Comparisons. Adds links to the op: functions in F&amp;O.</p>
<p>Drops the Type Promotion appendix, moving the rules inline; and drops the term "type promotion"</p>
<p>Adjusts the specs for sum() and avg() so they are now defined directly in terms of pairwise addition of values.</p>
</div></details></div>
<div class="toot" id="created-1733"><h2>Issue #1733 created<span class="toot-id"> #created-1733</span></h2><div class="pubdate">27 Jan at 10:17:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1733">https://github.com/qt4cg/qtspecs/issues/1733</a></div><details><summary>ACTION QT4CG-088-04, reworking the processing model diagram</summary><div class="markup"><p>I have no idea what tool was used to create the current <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-processing-model">processing model diagram</a>. We know it needs to be updated, but I've no particular skill with drawing programs, so I spent half an hour constructing a Graphviz diagram:</p>
<pre><code>digraph Processing_Model {
    subgraph clusterQT4 {
        Exec [label="Execution\nEngine" ];
        XDM [label="XPath Data\nModel"; shape="note" ];
        AST [label="Abstract\nSyntax Tree" ];
        Static [label="Static\nContext"; shape="box3d" ];
        Dynamic [label="Dynamic\nContext"; shape="box3d" ];
        Schema [label="Schema\nDefinitions"; shape="note" ];

        XPath -&gt; AST [label="&nbsp;SQ1" ];
        AST -&gt; AST [label="&nbsp;SQ5" ];
        AST -&gt; Exec [label="&nbsp;DQ1" ];
        Schema -&gt; Static;
        Static -&gt; AST [label="&nbsp;SQ4" ];
        Static -&gt; Dynamic [label="&nbsp;DQ2" ];
        Dynamic -&gt; Exec [ dir="both"; label="&nbsp;DQ5" ];
        Exec -&gt; XDM [ dir="both"; label="&nbsp;DQ4" ];
    }
    XML [ shape="note" ];
    PSVI [ shape="note" ];
    XML -&gt; PSVI [ label="&nbsp;DM1" ];
    PSVI -&gt; XDM  [ label="&nbsp;DM2" ];
    XML -&gt; XDM [ label="&nbsp;DM1" ];

    Direct [ label="&nbsp;Direct\nGeneration" ];
    Direct -&gt; XDM [ label="&nbsp;DM3" ];

    Host [label="Host\nEnvironment" ];
    Host -&gt; Schema [label="&nbsp;SI1" ];
    Host -&gt; Static [label="&nbsp;SQ2" ];
    Host -&gt; Dynamic [label="&nbsp;DQ3" ];

    Serialize [ shape="note" ];
    XDM -&gt; Serialize [ label="&nbsp;DM4" ];
}
</code></pre>
<p>It looks something like this:</p>
<p><img src="https://github.com/user-attachments/assets/7ae82045-2e28-4db2-afdc-b69cb0f72bdb" alt="Image"></p>
<p>Is this worth pursuing, or is that just half an hour of my life I'll never get back?</p>
</div></details></div>
<div class="toot" id="agenda-01-28"><h2>QT4 CG meeting 107 draft agenda<span class="toot-id"> #agenda-01-28</span></h2><div class="pubdate">27 Jan at 09:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-28">https://qt4cg.org/meeting/agenda/2025/01-28</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1732"><h2>Pull request #1732 created<span class="toot-id"> #created-1732</span></h2><div class="pubdate">26 Jan at 22:12:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1732">https://github.com/qt4cg/qtspecs/pull/1732</a></div><details><summary>1720 grammar simplification</summary><div class="markup"><p>This PR primarily affects the grammar file, simplifying it to remove most of the material that is only there to support the generation of a JavaCC parser (which has probably not been achievable since XPath/XQuery 2.0).</p>
<p>The section of the grammar that defines the binary operators starting with <code>OrExpr</code> is now expressed using conventional production rules, rather than the precedence-based grammar previously used. This allows deletion of some convoluted code in grammar2spec.xsl.</p>
<p>The DTD for the grammar file is revised to exclude many constructs that are no longer used.</p>
<p>Many simple token definitions (especially those that consist of a simple constant string) have been inlined.</p>
<p>Fix #1720</p>
</div></details></div>
<div class="toot" id="created-1731"><h2>Pull request #1731 created<span class="toot-id"> #created-1731</span></h2><div class="pubdate">25 Jan at 23:20:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1731">https://github.com/qt4cg/qtspecs/pull/1731</a></div><details><summary>1719 drop shared spec from build</summary><div class="markup"><p>Removes tasks from the gradle build, and associated stylesheets, that are there only to construct the "shared XPath/XQuery specification" which is no longer used by the editors or made visible to readers.</p>
<p>Also fixes a couple of link errors/warnings in the build.</p>
<p>Fix #1719</p>
</div></details></div>
<div class="toot" id="created-1730"><h2>Issue #1730 created<span class="toot-id"> #created-1730</span></h2><div class="pubdate">25 Jan at 18:03:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1730">https://github.com/qt4cg/qtspecs/issues/1730</a></div><details><summary>Consistency in default handling of map duplicates</summary><div class="markup"><p>In 3.1:</p>
<ul>
<li><code>map:merge()</code> defaults to duplicates = use-first</li>
<li><code>xsl:map</code> defaults to duplicates = reject</li>
</ul>
<p>In 4.0</p>
<ul>
<li><code>map:build</code> defaults to duplicates = combine</li>
<li><code>map:of-pairs</code> defaults to duplicates = combine</li>
</ul>
<p>Should we try to align the defaults?</p>
</div></details></div>
<div class="toot" id="created-1729"><h2>Issue #1729 created<span class="toot-id"> #created-1729</span></h2><div class="pubdate">24 Jan at 22:04:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1729">https://github.com/qt4cg/qtspecs/issues/1729</a></div><details><summary>Grammar problems introduced by #1721</summary><div class="markup"><p>Some productions of the XQuery 4.0 grammar were made obsolete by recent changes, but still occur in the document:</p>
<ul>
<li><code>StringConstructorStart</code></li>
<li><code>StringInterpolationStart</code></li>
<li><code>StringInterpolationEnd</code></li>
<li><code>StringConstructorEnd</code></li>
<li><code>TagQName</code></li>
<li><code>EndTagQName</code></li>
<li><code>ProcessingInstructionStart</code></li>
<li><code>ProcessingInstructionEnd</code></li>
<li><code>DirCommentContentChar</code></li>
<li><code>DirCommentContentDashChar</code></li>
</ul>
<p>Also, the replacement of <code>declare record</code> by <code>declare type record</code> has intoduced a new ambiguity. For example, with the input</p>
<pre><code class="language-xquery">declare type A as xs:integer;
declare type record as (A);
</code></pre>
<p>it remains unclear whether the second line declares a  type named "record", in which case</p>
<pre><code class="language-xquery">42 instance of record
</code></pre>
<p>or a type named "as", where</p>
<pre><code class="language-xquery">{'A': 42} instance of as
</code></pre>
<p>My proposal would be return to <code>declare record</code>. There are also 13 examples in the document using <code>declare record</code>.</p>
</div></details></div>
<div class="toot" id="closed-1723"><h2>Issue #1723 closed<span class="toot-id"> #closed-1723</span></h2><div class="pubdate">24 Jan at 21:00:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><p>`ThenAction` left over after removal of `BracedActions`</p></div>
<div class="toot" id="created-1728"><h2>Pull request #1728 created<span class="toot-id"> #created-1728</span></h2><div class="pubdate">24 Jan at 13:15:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1728">https://github.com/qt4cg/qtspecs/pull/1728</a></div><details><summary>Fix CSS for production tables</summary><div class="markup"><p>This PR removes some extraneous space between the rows and columns in the production tables (cellspacing) and turns off the odd grey background on comments. (I don't think the grey backbround was helping any, but if you disagree...)</p>
</div></details></div>
<div class="toot" id="closed-1721"><h2>Issue #1721 closed<span class="toot-id"> #closed-1721</span></h2><div class="pubdate">24 Jan at 13:01:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><p>1713 Revise code for generating production rules</p></div>
<div class="toot" id="created-1727"><h2>Pull request #1727 created<span class="toot-id"> #created-1727</span></h2><div class="pubdate">23 Jan at 17:58:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1727">https://github.com/qt4cg/qtspecs/pull/1727</a></div><details><summary>1725 Define more detailed rules for duplicates in maps</summary><div class="markup"><p>Clarifies the rules for how duplicates are handled by map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>Introduces a callback option for map:merge that is compatible with map:build and map:of-pairs, to increase commonality between all four functions/instructions.</p>
<p>Fix #1725</p>
</div></details></div>
<div class="toot" id="closed-1726"><h2>Issue #1726 closed<span class="toot-id"> #closed-1726</span></h2><div class="pubdate">23 Jan at 16:50:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1726"><h2>Pull request #1726 created<span class="toot-id"> #created-1726</span></h2><div class="pubdate">23 Jan at 12:54:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1726">https://github.com/qt4cg/qtspecs/pull/1726</a></div><p>1726 Control order when map input has duplicate keys</p></div>
<div class="toot" id="created-1725"><h2>Issue #1725 created<span class="toot-id"> #created-1725</span></h2><div class="pubdate">23 Jan at 11:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1725">https://github.com/qt4cg/qtspecs/issues/1725</a></div><details><summary>Position of duplicates in ordered maps</summary><div class="markup"><p>It became clear to me when writing test cases that the specs aren't entirely clear about what happens when building a map from an input sequence that contains duplicate keys. It says clearly what entry should be created for the duplicated key, but it doesn't say clearly where this entry should appear in the result.</p>
<p>There are four functions/instructions that this applies to: map:merge, map:build, map:of-pairs, and xsl:map.</p>
<p>I propose that in each case, the position of the entry for the duplicated key in the resulting map should correspond to the position of the first occurrence of that key in the input sequence. That is, "order of first appearance": the effect should be the same as if new entries are always created using a map:put() operation.</p>
<p>This might be slightly unexpected in the case of <code>map:merge()</code> with the option <code>duplicates=use-last</code>. It means the value will be that of the last duplicate, but its position will be that of the first duplicate. However, the other three functions/instructions achieve the effect of use-last with the callback <code>on-duplicates=fn{$a, $b){$a}</code> which only controls the value of the entry, and cannot be used to control its position, and I think it makes sense for <code>map:merge</code> with <code>duplicates=use-last</code> to behave in the same way.</p>
<p>Of course we could introduce a separate option to control the position of the combined entry, but I think that would be overkill. <code>xsl:for-each-group</code> and <code>distinct-values</code> both use the "order of first appearance" rule and this has never caused any problems. (<code>group-by</code> in XQuery delivers groups in implementation-dependent order, however).</p>
</div></details></div>
<div class="toot" id="created-1724"><h2>Issue #1724 created<span class="toot-id"> #created-1724</span></h2><div class="pubdate">22 Jan at 23:54:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1724">https://github.com/qt4cg/qtspecs/issues/1724</a></div><details><summary>Allow @copy-namespaces on &lt;xsl:mode&gt;?</summary><div class="markup"><p>As part of an XSLT transformation I need to remove an unused (anywhere) namespace declaration and <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> doesnâ€™t appear to accept a <code>@copy-namespaces</code> attribute where I can tell it not to copy unused namespaces. The unused namespace was used on a single attribute on the input document, but Iâ€™m removing the attribute entirely as part of the transformation, so nothing will remain in the output document that uses the namespace in question. With <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> the namespace declaration is copied into the result, even though it is not used. If I use the old identity template and set the value of <code>@copy-namespaces</code> on it to something falsy, I get the result I want, that is, no unneeded namespace declaration.</p>
<p>Insofar as <code>&lt;xsl:mode on-no-match="shallow-copy"/&gt;</code> has come to fill the role formerly occupied by the identity template, would it be reasonable to allow it also to declare that unused namespaces should not be copied? If that request is reasonable, is it reasonable to think of it as a bug fix, rather than a new-feature request?</p>
</div></details></div>
<div class="toot" id="created-1723"><h2>Issue #1723 created<span class="toot-id"> #created-1723</span></h2><div class="pubdate">22 Jan at 22:07:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1723">https://github.com/qt4cg/qtspecs/issues/1723</a></div><details><summary>`ThenAction` left over after removal of `BracedActions`</summary><div class="markup"><p>Thanks for fixing the <code>IfExpr</code> ambiguity.</p>
<p>In #1712, <code>BracedAction</code> was introduced to replace the previous rules for braced actions. Of these, <code>ThenAction</code> still appears in the EBNF summary, but it is no longer referenced.</p>
</div></details></div>
<div class="toot" id="closed-1651"><h2>Issue #1651 closed<span class="toot-id"> #closed-1651</span></h2><div class="pubdate">22 Jan at 17:27:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1651">https://github.com/qt4cg/qtspecs/issues/1651</a></div><p>Ordered Maps: maps that retain insertion order</p></div>
<div class="toot" id="closed-1703"><h2>Issue #1703 closed<span class="toot-id"> #closed-1703</span></h2><div class="pubdate">22 Jan at 17:27:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><p>1651 ordered maps</p></div>
<div class="toot" id="closed-1709"><h2>Issue #1709 closed<span class="toot-id"> #closed-1709</span></h2><div class="pubdate">22 Jan at 11:55:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><p>Extend diagram of item types to include record types etc</p></div>
<div class="toot" id="created-1722"><h2>Pull request #1722 created<span class="toot-id"> #created-1722</span></h2><div class="pubdate">22 Jan at 11:46:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1722">https://github.com/qt4cg/qtspecs/pull/1722</a></div><details><summary>1717 define focus functions using pipeline operator</summary><div class="markup"><p>Fix #1717</p>
<p>Provides a formal definition of focus functions making use of the new pipeline operator.</p>
</div></details></div>
<div class="toot" id="created-1721"><h2>Pull request #1721 created<span class="toot-id"> #created-1721</span></h2><div class="pubdate">22 Jan at 11:27:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1721">https://github.com/qt4cg/qtspecs/pull/1721</a></div><details><summary>1713 Revise code for generating production rules</summary><div class="markup"><p>The main change here is to change the way "scraps" are expanded: these are the local collections of production rules that appear inline within the spec. These are now driven by a single <code>prodrecap</code> element naming the rule to be expanded, and the logic is now automated for deciding (a) which subsidiary production rules to include in the scrap, and (b) which occurrence of a production rule to use as the target for a hyperlinked reference to that rule, depending on where the reference appears.</p>
<p>Along with this there has been a fair bit of deletion of legacy code and general modernisation (e.g using XSLT 2.0 and 3.0 constructs where appropriate).</p>
</div></details></div>
<div class="toot" id="created-1720"><h2>Issue #1720 created<span class="toot-id"> #created-1720</span></h2><div class="pubdate">22 Jan at 10:50:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1720">https://github.com/qt4cg/qtspecs/issues/1720</a></div><details><summary>Grammar overhaul</summary><div class="markup"><p>There is a lot of dead wood in the xpath-grammar.xml file. This issue is raised to capture some observations and suggestions about how it can be simplified.</p>
<ul>
<li>The DTD lists 19 attributes that can appear on g:token, and documents the meaning of 5 of them (very briefly). I suspect that many of the attributes are never used. Many of them were probably intended primarily for use by the JavaCC parser generator.</li>
<li>As if that weren't enough, the grammar2spec stylesheet has logic that looks for additional attributes (an example is <code>@alias-for</code>) which are not even allowed by the DTD let alone being in active use.</li>
<li>The "if" logic to assign productions to different languages (xpath, xquery, XSLT patterns) is hard to maintain and could be automated: just search for productions that are reachable from the top-level production for each language. This could be done by a preprocessing stylesheet that generates a grammar file for each language.</li>
<li>The switch into a precedence-based grammar for binary operators (g:exprProduction name="OperatorExpr") doesn't really help anyone. For generating production rules in the spec, it just complicates the generation logic. The same is true for anyone else writing applications that use the grammar as input. It doesn't really make life easier for maintainers of the grammar, because it means there is more to learn.</li>
</ul>
<p>All the JavaCC machinery is still in the repo and I think it could probably go. Leaving stuff like that lying around makes things more difficult when you need to search filestore for references to things.</p>
</div></details></div>
<div class="toot" id="created-1719"><h2>Issue #1719 created<span class="toot-id"> #created-1719</span></h2><div class="pubdate">21 Jan at 22:57:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1719">https://github.com/qt4cg/qtspecs/issues/1719</a></div><details><summary>Purging dead build code</summary><div class="markup"><p>In the course of working on #1713 I've been exploring some dark corners of the build system. There's a lot of dead code. Some of it might come in useful in the future (e.g. code supporting XQuery Update) but most will be very hard to revive. For example there's a lot of grammar machinery which is there only to allow generation of a JavaCC parser.</p>
<p>The main purpose of this issue is to capture notes that might lead to some reduction of technical debt.</p>
<p>The gradle build is currently giving me</p>
<blockquote>
<p>Warning: link-text-with-check was unable to make a link for $ref-id="doc-shared40-Prolog"</p>
</blockquote>
<p>That message comes from <code>xmlspec-override.xsl</code>. This stylesheet looks like dead code because it has lots of references to XPath30 and XQuery30. But it can't be completely dead if we're getting errors from it. It's imported from two places: xpath-functions-30.xsl in the F&amp;O tree and shared.xsl in the xquery40 tree. The message comes from gradle task <code>xquery_shared_html</code>. As far as I can see the build system is constructing an XPath specification, an XQuery specification, and a "shared" specification which is a union of the two. (It starts off "XQuery 4.0 and XPath 4.0 is an expression language that allows..."). Presumably this was intended to allow editors and WG members to review a single document rather than reviewing XPath and XQuery separately. But I don't think it's used today, I think we could kill it off.</p>
<p>shared.xsl is referenced only from build.gradle when building the shared specification.</p>
<p>xpath-functions-30.xsl doesn't appear to be referenced from anywhere, and it carries a comment saying</p>
<pre><code> Created 17 Dec 2008 by MHK.
 No longer used 16 Feb 2009?
</code></pre>
<p>In the short term I've deleted the code in xmlspec-override.xsl starting with the comment "Our inability to create a link for $ref-id may be a sign of something wrong, so...". This gets rid of the warning messages. In the longer term, subject to confirmation, I think we can delete the build targets associated with the "shared" language spec, and delete the stylesheets xmlspec-override.xsl, xpath-functions-30.xsl, and shared.xsl.</p>
</div></details></div>
<div class="toot" id="created-1718"><h2>Issue #1718 created<span class="toot-id"> #created-1718</span></h2><div class="pubdate">21 Jan at 17:45:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1718">https://github.com/qt4cg/qtspecs/issues/1718</a></div><details><summary>Ordered Maps: positions in callback functions</summary><div class="markup"><p>Now that maps have a defined order, we should add the position to HOF parameters in map functions (in alignment with sequence and array functions). Examples:</p>
<pre><code class="language-xquery">map:for-each(
  $map     as map(*),	
  $action  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as item()*	
) as item()*

map:filter(
  $map        as map(*),	
  $predicate  as fn($key as xs:anyAtomicType, $value as item()*, $pos as xs:integer) as xs:boolean?	
) as map(*)
</code></pre>
</div></details></div>
<div class="toot" id="minutesâ€”01-21"><h2>QT4 CG meeting 106 draft minutes<span class="toot-id"> #minutesâ€”01-21</span></h2><div class="pubdate">21 Jan at 17:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-21">https://qt4cg.org/meeting/minutes/2025/01-21</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1706"><h2>Issue #1706 closed<span class="toot-id"> #closed-1706</span></h2><div class="pubdate">21 Jan at 17:22:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><p>Ambiguous `if` syntax</p></div>
<div class="toot" id="closed-1712"><h2>Issue #1712 closed<span class="toot-id"> #closed-1712</span></h2><div class="pubdate">21 Jan at 17:22:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><p>1706 Drop "else if" and "else" clauses from braced conditionals</p></div>
<div class="toot" id="closed-1685"><h2>Issue #1685 closed<span class="toot-id"> #closed-1685</span></h2><div class="pubdate">21 Jan at 17:20:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><p>Pipeline Operator</p></div>
<div class="toot" id="closed-1686"><h2>Issue #1686 closed<span class="toot-id"> #closed-1686</span></h2><div class="pubdate">21 Jan at 17:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><p>1685 Pipeline Operator</p></div>
<div class="toot" id="closed-1701"><h2>Issue #1701 closed<span class="toot-id"> #closed-1701</span></h2><div class="pubdate">21 Jan at 17:18:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><p>Add dedication to MSM (action QT4CG-088-01)</p></div>
<div class="toot" id="closed-1705"><h2>Issue #1705 closed<span class="toot-id"> #closed-1705</span></h2><div class="pubdate">21 Jan at 17:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><p>fn:divide-decimals, fn:round: large precision values</p></div>
<div class="toot" id="closed-1711"><h2>Issue #1711 closed<span class="toot-id"> #closed-1711</span></h2><div class="pubdate">21 Jan at 17:16:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><p>1705 Say that max precision is implementation-defined</p></div>
<div class="toot" id="closed-1710"><h2>Issue #1710 closed<span class="toot-id"> #closed-1710</span></h2><div class="pubdate">21 Jan at 17:14:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><p>1709 Updated type diagrams</p></div>
<div class="toot" id="closed-1606"><h2>Issue #1606 closed<span class="toot-id"> #closed-1606</span></h2><div class="pubdate">21 Jan at 17:13:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1606">https://github.com/qt4cg/qtspecs/issues/1606</a></div><p>Drop named item types other than named record types</p></div>
<div class="toot" id="closed-1494"><h2>Issue #1494 closed<span class="toot-id"> #closed-1494</span></h2><div class="pubdate">21 Jan at 17:13:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1494">https://github.com/qt4cg/qtspecs/issues/1494</a></div><p>Records: Introduction?</p></div>
<div class="toot" id="closed-1176"><h2>Issue #1176 closed<span class="toot-id"> #closed-1176</span></h2><div class="pubdate">21 Jan at 17:13:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1176">https://github.com/qt4cg/qtspecs/issues/1176</a></div><p>Use fn:parse-uri to check whether a filepath is relative or absolute</p></div>
<div class="toot" id="closed-1700"><h2>Issue #1700 closed<span class="toot-id"> #closed-1700</span></h2><div class="pubdate">21 Jan at 17:11:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><p>Remove some dead .DS_Store files</p></div>
<div class="toot" id="created-1717"><h2>Issue #1717 created<span class="toot-id"> #created-1717</span></h2><div class="pubdate">21 Jan at 16:59:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1717">https://github.com/qt4cg/qtspecs/issues/1717</a></div><details><summary>Define focus functions in terms of the pipeline operator</summary><div class="markup"><p>Now that we have accepted the pipeline operator into the language, we can define the semantics of focus functions to take advantage of them, specifically, <code>fn() { EXPR }</code> can be defined to be equivalent to <code>fn($v) { $v -&gt; EXPR }</code> where $v is an otherwise-unused variable name.</p>
</div></details></div>
<div class="toot" id="agenda-01-21"><h2>QT4 CG meeting 106 draft agenda<span class="toot-id"> #agenda-01-21</span></h2><div class="pubdate">21 Jan at 10:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-21">https://qt4cg.org/meeting/agenda/2025/01-21</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1716"><h2>Issue #1716 created<span class="toot-id"> #created-1716</span></h2><div class="pubdate">20 Jan at 21:13:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1716">https://github.com/qt4cg/qtspecs/issues/1716</a></div><details><summary>Variable lookahead needed for `ArrowTarget`</summary><div class="markup"><p>The current grammar definition allows any <code>QName</code> (via <code>EQName</code>) as an <code>ArrowStaticFunction</code>:</p>
<pre><code>ArrowTarget
         ::= ArrowStaticFunction ArgumentList
           | ArrowDynamicFunction PositionalArgumentList
ArrowStaticFunction
         ::= EQName
ArrowDynamicFunction
         ::= VarRef
           | InlineFunctionExpr
           | ParenthesizedExpr 
</code></pre>
<p>This complicates the distinction of the static and dynamic variants of <code>ArrowTarget</code>, as it cannot be done with a fixed number of lookahead tokens. E.g. in an expression starting like this</p>
<pre><code class="language-xquery">A =&gt; fn ( $A, $B, $C, (: ... :) $Z ) { } ( 
</code></pre>
<p>the distinction cannot be made before the left brace is seen. While constructing an LR parser, there is a shift-reduce conflict between shifting <code>fn</code> as a keyword of an <code>InlineFunctionExpr</code>, or reducing <code>fn</code> to the <code>QName</code> of <code>EQName</code>.</p>
<p>This can easily be fixed by adding <code>xgc: reserved-function-names</code> to <code>ArrowStaticFunction</code>, which would also be consistent with other function calls in disallowing reserved function names:</p>
<pre><code>ArrowStaticFunction
         ::= EQName
                          /* xgc: reserved-function-names */		 
</code></pre>
<p>But could not <code>ArrowTarget</code> also be written like the following?</p>
<pre><code>ArrowTarget
         ::= FunctionCall
           | DynamicFunctionCall
</code></pre>
<p>In this case, the <code>xgc: reserved-function-names</code> constraint would be inherited from <code>FunctionCall</code>. It eliminates <code>ArrowStaticFunction</code> and <code>ArrowDynamicFunction</code> and at the same time lifts some restrictions imposed by the current <code>ArrowTarget</code>. It does not cause any LALR(2) conflicts.</p>
</div></details></div>
<div class="toot" id="created-1715"><h2>Issue #1715 created<span class="toot-id"> #created-1715</span></h2><div class="pubdate">20 Jan at 13:59:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1715">https://github.com/qt4cg/qtspecs/issues/1715</a></div><details><summary>Array Lookups: partial removal of out-of-bounds checks</summary><div class="markup"><p>Various QT4 tests imply that the out-of-bounds check for arrays have been removed. An example:</p>
<pre><code class="language-xml">&lt;test-case name="UnaryLookup-005a"&gt;
  &lt;description&gt;Integer subscript into an array: array index too low&lt;/description&gt;
  &lt;created by="Michael Kay" on="2014-11-27"/&gt;
  &lt;modified by="Michael Kay" on="2024-07-22" change="returns () in 4.0"/&gt;
  &lt;dependency type="spec" value="XP40+ XQ40+"/&gt;
  &lt;test&gt;(['a', 'b'], ['c', 'd'])[ ?0 eq 'c']&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-empty/&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
</code></pre>
<p>I believe this is not reflected in the spec yet, or at least it includes examples that need to be updated:</p>
<blockquote>
<p><code>[ "a", "b" ]?3</code> raises a dynamic error <code>err:FOAY0001</code>.</p>
</blockquote>
<p>I guess that #832 would have been the PR with the relevant changes (we have already observed in another issue that some changes of this PR need to survive; see https://github.com/qt4cg/qtspecs/pull/1283#issuecomment-2568330191).</p>
<p>That leads me to the original reason for creating this issue:</p>
<ul>
<li>I think itâ€™s a good idea to drop the range check for array lookups, and it would seem consistent to me to also drop it for dynamic function calls.</li>
<li>As map/array lookups and dynamic function calls are often used interchangeably, <code>$array?0</code> and <code>$array(0)</code> should behave identically.</li>
<li>The <code>FOAY0001</code> error would (and should) still be raised by the array functions, including <code>array:get</code>, <code>array:put</code>, <code>array:remove</code>, or <code>array:insert-before</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1714"><h2>Issue #1714 created<span class="toot-id"> #created-1714</span></h2><div class="pubdate">19 Jan at 23:34:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1714">https://github.com/qt4cg/qtspecs/issues/1714</a></div><details><summary>sibling:: axis. Action Item QT4CG-097-03</summary><div class="markup"><p>This issue is a reflection of the following Action Item:</p>
<p><strong>QT4CG-097-03</strong>: DN to proposal an axis for accessing the siblings of a node.</p>
<p>I have prepared a pdf file that contains the updated relevant updated sections from the "<strong><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html">Xpath 4.0</a></strong>" document:</p>
<ul>
<li>There are no deletions or conflicting changes.</li>
<li>The additions to the text are highlighted in turquoise.</li>
<li>The file that contains all relevant updated sections of the document is at:
https://github.com/dnovatchev/qtspecs/blob/dn-siblings/sibling-axis.pdf</li>
</ul>
<p><strong>If the  above doesn't work</strong>, please try:
https://github.com/dnovatchev/MathPuzzles/blob/master/sibling-axis.pdf</p>
</div></details></div>
<div class="toot" id="created-1713"><h2>Issue #1713 created<span class="toot-id"> #created-1713</span></h2><div class="pubdate">19 Jan at 11:49:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1713">https://github.com/qt4cg/qtspecs/issues/1713</a></div><details><summary>Patchy exposition of XSLT type pattern syntax</summary><div class="markup"><p>In XSLT Â§5.4.2.2 Type Patterns, the exposition of the grammar is "patchy" - it includes some production rules such as <code>FieldDeclaration</code> that are in the subtree of the main production rule (<code>TypePattern</code>) without giving all the intermediate rules that connect this rule to the root.</p>
<p>It's easy enough to correct this by hand, but it would be nice to prevent this happening by automating the generation of these families of grammar rules, perhaps by including all rules in the subtree up to a depth of 3, say. It would also be nice to simply list the productions to be included without having to decide manually which of them should be the principal target of <code>termref</code> references (by being marked with an ID).</p>
</div></details></div>
<div class="toot" id="created-1712"><h2>Pull request #1712 created<span class="toot-id"> #created-1712</span></h2><div class="pubdate">18 Jan at 18:51:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1712">https://github.com/qt4cg/qtspecs/pull/1712</a></div><details><summary>1706 Drop "else if" and "else" clauses from braced conditionals</summary><div class="markup"><p>Fix #1706</p>
</div></details></div>
<div class="toot" id="created-1711"><h2>Pull request #1711 created<span class="toot-id"> #created-1711</span></h2><div class="pubdate">18 Jan at 18:29:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1711">https://github.com/qt4cg/qtspecs/pull/1711</a></div><details><summary>1705 Say that max precision is implementation-defined</summary><div class="markup"><p>Applies to fn:round, fn:round-half-to-even, fn:divide-decimals</p>
<p>Fix #1705</p>
</div></details></div>
<div class="toot" id="created-1710"><h2>Pull request #1710 created<span class="toot-id"> #created-1710</span></h2><div class="pubdate">17 Jan at 23:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1710">https://github.com/qt4cg/qtspecs/pull/1710</a></div><details><summary>1709 Updated type diagrams</summary><div class="markup"><p>Added a few details to the type diagrams: user-defined array, map, and record types; enumeration types; untypedAtomic</p>
</div></details></div>
<div class="toot" id="created-1709"><h2>Issue #1709 created<span class="toot-id"> #created-1709</span></h2><div class="pubdate">17 Jan at 22:44:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1709">https://github.com/qt4cg/qtspecs/issues/1709</a></div><details><summary>Extend diagram of item types to include record types etc</summary><div class="markup"><p>I propose to extend the diagram of item types (common to DM and FO) to include more detail of the hierarchy below function types.</p>
</div></details></div>
<div class="toot" id="closed-1617"><h2>Issue #1617 closed<span class="toot-id"> #closed-1617</span></h2><div class="pubdate">17 Jan at 12:55:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1617">https://github.com/qt4cg/qtspecs/pull/1617</a></div><p>1606 Drop named item types, refine named record types, esp in XSLT</p></div>
<div class="toot" id="created-1708"><h2>Pull request #1708 created<span class="toot-id"> #created-1708</span></h2><div class="pubdate">17 Jan at 12:52:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1708">https://github.com/qt4cg/qtspecs/pull/1708</a></div><details><summary>1485 Add xsl:record-type declaration</summary><div class="markup"><p>Adds named record types to XSLT, with much the same spec as for XQuery, but some extra tweaks for handling visibility and overriding.</p>
<p>Fix #1485</p>
</div></details></div>
<div class="toot" id="closed-1707"><h2>Issue #1707 closed<span class="toot-id"> #closed-1707</span></h2><div class="pubdate">17 Jan at 08:58:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><p>Fix bug in build dependencies</p></div>
<div class="toot" id="created-1707"><h2>Pull request #1707 created<span class="toot-id"> #created-1707</span></h2><div class="pubdate">17 Jan at 08:58:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1707">https://github.com/qt4cg/qtspecs/pull/1707</a></div><details><summary>Fix bug in build dependencies</summary><div class="markup"><p>Changing <code>xslt.xml</code> didn't actually cause the HTML for the XSLT specification to be rebuilt. ðŸ‘Ž</p>
</div></details></div>
<div class="toot" id="created-1706"><h2>Issue #1706 created<span class="toot-id"> #created-1706</span></h2><div class="pubdate">16 Jan at 21:08:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1706">https://github.com/qt4cg/qtspecs/issues/1706</a></div><details><summary>Ambiguous `if` syntax</summary><div class="markup"><p>The optional <code>else</code> in a braced <code>if</code> expression introduces an ambiguity in the XQuery 4.0 grammar.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>It can be parsed like this</p>
<pre><code class="language-xquery">if (A) then if (B) {C}                               else {}
       else if (D) {E} else if (F) {G} else {H}
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">if (A) then if (B) {C} else if (D) {E}               else {}
       else if (F) {G} else {H}
</code></pre>
<p>The corresponding part of the grammar is</p>
<pre><code>IfExpr   ::= 'if' '(' Expr ')' ( UnbracedActions | BracedActions )
UnbracedActions
         ::= 'then' ExprSingle 'else' ExprSingle
BracedActions
         ::= ThenAction ElseIfAction* ElseAction?
ThenAction
         ::= EnclosedExpr
ElseIfAction
         ::= 'else' 'if' '(' Expr ')' EnclosedExpr
ElseAction
         ::= 'else' EnclosedExpr
</code></pre>
<p>The ambiguity could be resolved by making the <code>ElseAction</code> in <code>BracedActions</code> mandatory, i.e.:</p>
<pre><code>BracedActions
         ::= ThenAction ElseIfAction* ElseAction
</code></pre>
</div></details></div>
<div class="toot" id="created-1705"><h2>Issue #1705 created<span class="toot-id"> #created-1705</span></h2><div class="pubdate">16 Jan at 15:53:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1705">https://github.com/qt4cg/qtspecs/issues/1705</a></div><details><summary>fn:divide-decimals, fn:round: large precision values</summary><div class="markup"><p>We may need to specify what is going to happen if very large (positive and negative) precisions are specified:</p>
<pre><code class="language-xquery">divide-decimals(1, 1, 0x7FFFFFFF)
</code></pre>
<p>A simple implementation in Java to compute the quotient for this function returns an Overflow exception:</p>
<pre><code class="language-java">BigDecimal.ONE.divide(BigDecimal.ONE, 0x7FFFFFFF, RoundingMode.DOWN)
</code></pre>
<p>This also affects <code>fn:round</code>: The query <code>round(1, -0x80000000)</code> seems to behave unexpectedly in existing implementations.</p>
<p>In general, the computation gets very slow for large precision values, and it may not be simple to interrupt such low-level operations, so maybe (if it makes sense, I havenâ€™t really thought about it) we could define precision limits.</p>
</div></details></div>
<div class="toot" id="created-1704"><h2>Issue #1704 created<span class="toot-id"> #created-1704</span></h2><div class="pubdate">16 Jan at 15:09:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1704">https://github.com/qt4cg/qtspecs/issues/1704</a></div><details><summary>Ignore the byte order mark more completely/globally</summary><div class="markup"><p>Following on a discussion with @line-o on the XML.com Slack, I took a peek at the way we deal with the byte order mark in Functions and Operators. We seem to be explicit about it in a couple of JSON functions but not elsewhere. I think we should assert that the byte order mark is explicitly ignored in all of the input functions (json-<em>, parse-</em>, unparsed-* etc.)</p>
</div></details></div>
<div class="toot" id="closed-1136"><h2>Issue #1136 closed<span class="toot-id"> #closed-1136</span></h2><div class="pubdate">15 Jan at 18:53:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1136">https://github.com/qt4cg/qtspecs/issues/1136</a></div><p>Defining names for parameters on typed function tests</p></div>
<div class="toot" id="closed-1696"><h2>Issue #1696 closed<span class="toot-id"> #closed-1696</span></h2><div class="pubdate">15 Jan at 18:53:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><p>1136 Optional names in typed function types</p></div>
<div class="toot" id="closed-1688"><h2>Issue #1688 closed<span class="toot-id"> #closed-1688</span></h2><div class="pubdate">15 Jan at 00:04:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><p>In rendered HTML, link to definition is missing its link text</p></div>
<div class="toot" id="created-1703"><h2>Pull request #1703 created<span class="toot-id"> #created-1703</span></h2><div class="pubdate">14 Jan at 22:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1703">https://github.com/qt4cg/qtspecs/pull/1703</a></div><details><summary>1651 ordered maps</summary><div class="markup"><p>Reopened pull request introducing ordered maps.</p>
<p>Fix #1651.</p>
</div></details></div>
<div class="toot" id="closed-1609"><h2>Issue #1609 closed<span class="toot-id"> #closed-1609</span></h2><div class="pubdate">14 Jan at 17:23:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1609">https://github.com/qt4cg/qtspecs/pull/1609</a></div><p>1651 Ordered Maps</p></div>
<div class="toot" id="minutesâ€”01-14"><h2>QT4 CG meeting 105 draft minutes<span class="toot-id"> #minutesâ€”01-14</span></h2><div class="pubdate">14 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-14">https://qt4cg.org/meeting/minutes/2025/01-14</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1632"><h2>Issue #1632 closed<span class="toot-id"> #closed-1632</span></h2><div class="pubdate">14 Jan at 17:06:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1632">https://github.com/qt4cg/qtspecs/issues/1632</a></div><p>Add xsl:map/@select</p></div>
<div class="toot" id="closed-1694"><h2>Issue #1694 closed<span class="toot-id"> #closed-1694</span></h2><div class="pubdate">14 Jan at 17:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><p>1632 Add xsl:map/@select</p></div>
<div class="toot" id="closed-1684"><h2>Issue #1684 closed<span class="toot-id"> #closed-1684</span></h2><div class="pubdate">14 Jan at 17:05:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><p>[XSLT] Composite merge keys</p></div>
<div class="toot" id="closed-1689"><h2>Issue #1689 closed<span class="toot-id"> #closed-1689</span></h2><div class="pubdate">14 Jan at 17:05:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><p>1684 Composite merge keys; current-merge-key-array function</p></div>
<div class="toot" id="closed-1680"><h2>Issue #1680 closed<span class="toot-id"> #closed-1680</span></h2><div class="pubdate">14 Jan at 17:03:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><p>Ambiguous `switch` syntax</p></div>
<div class="toot" id="closed-1692"><h2>Issue #1692 closed<span class="toot-id"> #closed-1692</span></h2><div class="pubdate">14 Jan at 17:02:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><p>1680 Fix switch syntax ambiguity</p></div>
<div class="toot" id="closed-1672"><h2>Issue #1672 closed<span class="toot-id"> #closed-1672</span></h2><div class="pubdate">14 Jan at 17:00:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><p>array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1687"><h2>Issue #1687 closed<span class="toot-id"> #closed-1687</span></h2><div class="pubdate">14 Jan at 17:00:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><p>1672 array:values, map:values: Alternatives</p></div>
<div class="toot" id="closed-1006"><h2>Issue #1006 closed<span class="toot-id"> #closed-1006</span></h2><div class="pubdate">14 Jan at 16:59:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1006">https://github.com/qt4cg/qtspecs/issues/1006</a></div><p>regular expression addition - word boundaries</p></div>
<div class="toot" id="closed-490"><h2>Issue #490 closed<span class="toot-id"> #closed-490</span></h2><div class="pubdate">14 Jan at 16:59:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/490">https://github.com/qt4cg/qtspecs/issues/490</a></div><p>Control over schema validation in parse-xml(), doc(), etc.</p></div>
<div class="toot" id="closed-108"><h2>Issue #108 closed<span class="toot-id"> #closed-108</span></h2><div class="pubdate">14 Jan at 16:59:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/108">https://github.com/qt4cg/qtspecs/issues/108</a></div><p>Template match using values of [tunnel] parameters</p></div>
<div class="toot" id="closed-1284"><h2>Issue #1284 closed<span class="toot-id"> #closed-1284</span></h2><div class="pubdate">14 Jan at 16:58:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1284">https://github.com/qt4cg/qtspecs/issues/1284</a></div><p>Build issue: Unsupported specref to  [streamability-fn-distinct-ordered-nodes]</p></div>
<div class="toot" id="closed-1695"><h2>Issue #1695 closed<span class="toot-id"> #closed-1695</span></h2><div class="pubdate">14 Jan at 16:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><p>1284 Define streamability of distinct-ordered-nodes</p></div>
<div class="toot" id="closed-1693"><h2>Issue #1693 closed<span class="toot-id"> #closed-1693</span></h2><div class="pubdate">14 Jan at 16:56:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><p>1683 Extend xpath-functions schema with CSV components</p></div>
<div class="toot" id="closed-1690"><h2>Issue #1690 closed<span class="toot-id"> #closed-1690</span></h2><div class="pubdate">14 Jan at 16:54:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><p>1688 In "implementation-defined" appendix, fix absent generated link</p></div>
<div class="toot" id="created-1702"><h2>Issue #1702 created<span class="toot-id"> #created-1702</span></h2><div class="pubdate">14 Jan at 15:19:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1702">https://github.com/qt4cg/qtspecs/issues/1702</a></div><details><summary>Node Updates: Functions</summary><div class="markup"><p>In #1225, I have summarized some thoughts on generalizing updates for both nodes and structured items (maps/arrays).</p>
<p>XQuery Update is complex, as updates are in general, so we may still decide that it is too ambitious to introduce update features in the core language. If we want to give it a try, we could offer functions that are based on XQUF, but that only perform one update operation at a a time on a given input. This way, we could ignore the sophisticated <a href="https://www.w3.org/TR/xquery-update-30/#id-pending-update-lists">Pending Update List</a> semantics, which is only important when multiple updating expressions are specified and need to be checked and brought into order.</p>
<p>A function set that provides an equivalent functionality for all XQUF update operations could look as follows (the presented functions are valid XQuery Update code):</p>
<pre><code class="language-xquery">declare namespace update = 'http://www.w3.org/TR/xquery-update';

declare function update:delete(
  $node  as node(),
  $path  as fn(node()) as node()*
) as node() {
  copy $c := $node
  modify delete node $path($c)
  return $c
};

declare function update:rename(
  $node  as node(),
  $path  as fn(node()) as node()*,
  $name  as (xs:QName | xs:NCName | fn(node(), xs:integer) as (xs:QName | xs:NCName))
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := if($name instance of fn(*)) {
      $name($target, $pos)
    } else {
      $name
    }
    return rename node $target as $result
  )
  return $c
};

declare function update:replace(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as node()*)*,
  $options   as record(value? as xs:boolean)? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return if($options?value) {
      replace value of node $target with $result
    } else {
      replace node $target with $result
    }
  )
  return $c
};

declare function update:insert(
  $node      as node(),
  $path      as fn(node()) as node()*,
  $contents  as (node() | xs:anyAtomicType | fn(node(), xs:integer) as (node() | xs:anyAtomicType))*,
  $options   as record(position? as enum('last', 'first', 'before', 'after'))? := {}
) as node() {
  copy $c := $node
  modify (
    for $target at $pos in $path($c)
    let $result := (
      for $content in $contents
      return if($content instance of fn(*)) {
        $content($target, $pos)
      } else {
        $content
      }
    )
    return switch($options?position) {
      case 'before' return insert node $result before $target
      case 'after'  return insert node $result after $target
      case 'first'  return insert node $result as first into $target
      default       return insert node $result as last into $target
    }
  )
  return $c
};
</code></pre>
<p>Here are some exemplary function calls:</p>
<pre><code class="language-xquery">let $node := &lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
return (
  (: deletes all &lt;e/&gt; child nodes :)
  update:delete($node, fn { e }),
  (: renames the &lt;e/&gt; child nodes to &lt;f/&gt; :)
  update:rename($node, fn { e }, 'f'),
  (: replaces the &lt;e/&gt; child nodes with &lt;replaced/&gt; :)
  update:replace($node, fn { e }, &lt;replaced/&gt;),
  (: replaces the string value of the &lt;e/&gt; child nodes with 'text' :)
  update:replace($node, fn { e }, 'text', { 'value': true() }),
  (: inserts a 'text' text node into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, 'text'),
  (: inserts 'text1' and 'text2' text nodes into the &lt;e/&gt; child nodes :)
  update:insert($node, fn { e }, fn($node, $pos) { 'text' || $pos }),
  (: inserts an &lt;x/&gt; element after each &lt;e/&gt; child node :)
  update:insert($node, fn { e }, &lt;x/&gt;, { 'position': 'after' })
)
</code></pre>
<p>Multiple update operations can easily be chained:</p>
<pre><code class="language-xquery">(: rename &lt;e/&gt; child nodes to &lt;f/&gt;, insert 'x' text nodes :)
&lt;xml&gt;&lt;e/&gt;&lt;e/&gt;&lt;/xml&gt;
=&gt; update:rename(fn { e }, 'f')
=&gt; update:insert(fn { f }, 'x')
</code></pre>
<p>Ideally, we could offer a similar function set (or maybe even the same) for maps and arrays in a next step (see #77). The map/array syntax would be similar for deletionsâ€¦</p>
<pre><code class="language-xquery">let $data := { 'a': [ 1, 2, 3 ] }
return update:delete($data, fn { ?a?2 })
</code></pre>
<p>â€¦but it certainly gets trickier for other operations.</p>
<p>If some of you believe that the presented approach is something that we should pursue, I will be happy to add details. As an alternative, we could pursue the XQUF light approach that I have sketched in #1225, based on the existing XQUF update keywords.</p>
<p>Yet another solution could be to stick with what we have, but add map/array update features to XQUF.</p>
</div></details></div>
<div class="toot" id="created-1701"><h2>Pull request #1701 created<span class="toot-id"> #created-1701</span></h2><div class="pubdate">14 Jan at 14:07:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1701">https://github.com/qt4cg/qtspecs/pull/1701</a></div><details><summary>Add dedication to MSM (action QT4CG-088-01)</summary><div class="markup"><p>I've had this action on my plate for a while. Having written a dedication, there's a follow-up question of where to put it. Having it in only one specification isn't wrong, but it seems slightly odd given that MSM contributed to them all. In the end, I decided to put a full dedication in the XPath specification and link to it from the others.</p>
<p>My rationale for the XPath spec is that it's probaly one that everyone reads. Another possibility was the Data Model as it's "foundational" but I think it's less read than XPath.</p>
<p>The published PR won't be write because there are tooling changes required. I've attached a couple of screen shots, one of the full dedication in XPath:</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/d83aa982-b783-44c8-8fb7-25787200bf13" alt="Screenshot 2025-01-14 at 14-00-08 XML Path Language (XPath) 4 0 WG Review Draft"></h2>
<p>And another of the link from the other specs (from XSLT, I think, but they're all the same).</p>
<hr>
<h2><img src="https://github.com/user-attachments/assets/634de4b0-59cb-4898-8c16-ddff4ddd3876" alt="Screenshot 2025-01-14 at 13-59-08 XSL Transformations (XSLT) Version 4 0"></h2>
</div></details></div>
<div class="toot" id="created-1700"><h2>Pull request #1700 created<span class="toot-id"> #created-1700</span></h2><div class="pubdate">14 Jan at 14:01:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1700">https://github.com/qt4cg/qtspecs/pull/1700</a></div><details><summary>Remove some dead .DS_Store files</summary><div class="markup"><p>I'm not sure how these got checked in...</p>
</div></details></div>
<div class="toot" id="agenda-01-14"><h2>QT4 CG meeting 105 draft agenda<span class="toot-id"> #agenda-01-14</span></h2><div class="pubdate">14 Jan at 10:11:15 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-14">https://qt4cg.org/meeting/agenda/2025/01-14</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1699"><h2>Issue #1699 created<span class="toot-id"> #created-1699</span></h2><div class="pubdate">14 Jan at 03:48:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1699">https://github.com/qt4cg/qtspecs/issues/1699</a></div><details><summary>XPath function to calculate edit distance between two strings</summary><div class="markup"><p>I propose a new XPath function to calculate the edit distance between two strings. It could use a specific algorithm, for example <code>fn:levenshtein-distance(s1,s2)</code>.</p>
<p>The function could also be designed  more generic like <code>fn:edit-distance(s1, s2, algorithm)</code> where <em>algorithm</em> could be levenshtein, hamming, lcs ... (see <a href="https://en.wikipedia.org/wiki/Edit_distance">edit distance</a>).</p>
<p>Use Case: Schematron Quick Fix when checking <code>glossentry</code> elements against terms defined in <code>glossary</code>. <em>"Your term is not defined in Glossary, did you mean ...".</em></p>
<p>Thanks, Frank</p>
</div></details></div>
<div class="toot" id="closed-1407"><h2>Issue #1407 closed<span class="toot-id"> #closed-1407</span></h2><div class="pubdate">13 Jan at 17:53:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1407">https://github.com/qt4cg/qtspecs/issues/1407</a></div><p>Improve the spec prose and table of content layout for types</p></div>
<div class="toot" id="created-1698"><h2>Issue #1698 created<span class="toot-id"> #created-1698</span></h2><div class="pubdate">13 Jan at 13:53:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1698">https://github.com/qt4cg/qtspecs/issues/1698</a></div><details><summary>Allow select attribute for xsl:call-template instruction</summary><div class="markup"><p>The lack of the following feature is something that bothers me from time to time. I hope this is the right place here for my proposal.
And even though I did some search -- I am not sure if something similar was discussed before ...</p>
<p>I propose to allow a <code>select</code> attribute for <code>xsl:call-template</code> instructions. When the <code>select</code> attribute is set, then the named template is called for each selected item as context item.</p>
<p>When the empty sequence is selected, the template is not invoked.</p>
<p>When the <code>select</code> attribute is omitted, then the instruction works as before (Invoked once and <em>"[...] does not change focus [...]"</em>).</p>
<p>For extension instructions from named templates: May work the same with a prefixed attribute (e.g. <code>xsl:select</code>).</p>
<p>Benefits I see:</p>
<ul>
<li>Change the context without <code>xsl:apply-templates</code></li>
<li>Avoid template parameter with <code>current()</code> as default value (annoying when you have nested named template calls)</li>
<li>Avoid <code>xsl:for-each</code> workaround where context just must be adjusted for a single item (no such parameter available, see before)</li>
<li>Save an <code>xsl:for-each</code> instruction with this shorter form</li>
<li>Harmonize <code>xsl:call-template</code> with <code>xsl:apply-templates</code> concept a little bit</li>
</ul>
<p>Simple example:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:call-template name="t:make-something" select="child-elem"/&gt;
  &lt;!-- ... or as extension instruction: --&gt;
  &lt;t:make-something xsl:select="child-elem"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template name="t:make-something"&gt;
  &lt;xsl:context-item use="required" as="element(child-elem)"&gt;
  &lt;!-- ... --&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The call of <code>t:make-something</code> before is equivalent with:</p>
<pre><code class="language-xml">&lt;xsl:template match="elem"&gt;
  &lt;xsl:for-each select="child-elem"&gt;
    &lt;xsl:call-template name="t:make-something"/&gt;
  &lt;/xsl:for-each&gt;
&lt;/xsl:template&gt;
</code></pre>
</div></details></div>
<div class="toot" id="closed-1675"><h2>Issue #1675 closed<span class="toot-id"> #closed-1675</span></h2><div class="pubdate">13 Jan at 12:03:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="closed-1677"><h2>Issue #1677 closed<span class="toot-id"> #closed-1677</span></h2><div class="pubdate">13 Jan at 12:03:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><p>1675 Fixes for CSV parsing</p></div>
<div class="toot" id="closed-1673"><h2>Issue #1673 closed<span class="toot-id"> #closed-1673</span></h2><div class="pubdate">13 Jan at 11:55:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><p>1407 TOC structure for types</p></div>
<div class="toot" id="closed-1681"><h2>Issue #1681 closed<span class="toot-id"> #closed-1681</span></h2><div class="pubdate">13 Jan at 09:21:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><p> Î” in the table of contents</p></div>
<div class="toot" id="closed-1691"><h2>Issue #1691 closed<span class="toot-id"> #closed-1691</span></h2><div class="pubdate">13 Jan at 09:21:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><p>1681 - Delta marker in TOC</p></div>
<div class="toot" id="created-1697"><h2>Issue #1697 created<span class="toot-id"> #created-1697</span></h2><div class="pubdate">13 Jan at 00:17:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1697">https://github.com/qt4cg/qtspecs/issues/1697</a></div><details><summary>Add documentary names to callback function signatures</summary><div class="markup"><p>If PR #1696 is accepted we can add documentary names to the parameters of callback function signatures, for example <code>fn:filter</code> can become</p>
<pre><code>fn:filter(
  $input as&nbsp;item()*, | &nbsp;
  $predicate as&nbsp;fn($item as item(), $position as xs:integer) as xs:boolean? | &nbsp;
)&nbsp;as&nbsp;item()*

</code></pre>
<p>and we can (if we need to) use the parameter names in the prose</p>
</div></details></div>
<div class="toot" id="created-1696"><h2>Pull request #1696 created<span class="toot-id"> #created-1696</span></h2><div class="pubdate">13 Jan at 00:07:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1696">https://github.com/qt4cg/qtspecs/pull/1696</a></div><details><summary>1136 Optional names in typed function types</summary><div class="markup"><p>Fix #1136</p>
</div></details></div>
<div class="toot" id="created-1695"><h2>Pull request #1695 created<span class="toot-id"> #created-1695</span></h2><div class="pubdate">12 Jan at 23:36:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1695">https://github.com/qt4cg/qtspecs/pull/1695</a></div><details><summary>1284 Define streamability of distinct-ordered-nodes</summary><div class="markup"><p>Fix #1284</p>
</div></details></div>
<div class="toot" id="closed-1610"><h2>Issue #1610 closed<span class="toot-id"> #closed-1610</span></h2><div class="pubdate">11 Jan at 10:48:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1610">https://github.com/qt4cg/qtspecs/issues/1610</a></div><p>Some cross references are incorrect</p></div>
<div class="toot" id="closed-1683"><h2>Issue #1683 closed<span class="toot-id"> #closed-1683</span></h2><div class="pubdate">10 Jan at 09:35:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><p>There are validity errors in the function catalog related to csv elements</p></div>
<div class="toot" id="created-1694"><h2>Pull request #1694 created<span class="toot-id"> #created-1694</span></h2><div class="pubdate">09 Jan at 23:10:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1694">https://github.com/qt4cg/qtspecs/pull/1694</a></div><details><summary>1632 Add xsl:map/@select</summary><div class="markup"><p>Fix #1632</p>
</div></details></div>
<div class="toot" id="created-1693"><h2>Pull request #1693 created<span class="toot-id"> #created-1693</span></h2><div class="pubdate">09 Jan at 22:25:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1693">https://github.com/qt4cg/qtspecs/pull/1693</a></div><details><summary>1683 Extend xpath-functions schema with CSV components</summary><div class="markup"><p>This was an unsuccessful attempt to fix issue #1683, but the change is still worth making. It extends the aggregated schema for the XPath functions namespace to include definitions for the result of the csv-to-xml function.</p>
</div></details></div>
<div class="toot" id="created-1692"><h2>Pull request #1692 created<span class="toot-id"> #created-1692</span></h2><div class="pubdate">09 Jan at 21:55:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1692">https://github.com/qt4cg/qtspecs/pull/1692</a></div><details><summary>1680 Fix switch syntax ambiguity</summary><div class="markup"><p>Fix #1680 (as suggested in the issue)</p>
</div></details></div>
<div class="toot" id="created-1691"><h2>Pull request #1691 created<span class="toot-id"> #created-1691</span></h2><div class="pubdate">09 Jan at 21:42:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1691">https://github.com/qt4cg/qtspecs/pull/1691</a></div><details><summary>1681 - Delta marker in TOC</summary><div class="markup"><p>Fix #1681</p>
</div></details></div>
<div class="toot" id="created-1690"><h2>Pull request #1690 created<span class="toot-id"> #created-1690</span></h2><div class="pubdate">09 Jan at 20:28:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1690">https://github.com/qt4cg/qtspecs/pull/1690</a></div><details><summary>1688 In "implementation-defined" appendix, fix absent generated link</summary><div class="markup"><p>For F&amp;O the automatically-generated appendix of implementation-defined item should link each such item to the nearest containing section that has a <code>head</code> child as well as an id attribute.</p>
</div></details></div>
<div class="toot" id="created-1689"><h2>Pull request #1689 created<span class="toot-id"> #created-1689</span></h2><div class="pubdate">09 Jan at 18:10:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1689">https://github.com/qt4cg/qtspecs/pull/1689</a></div><details><summary>1684 Composite merge keys; current-merge-key-array function</summary><div class="markup"><p>Acknowledges that as a result of changes to <code>xsl:sort</code>, <code>xsl:merge</code> now accepts composite merge keys; introduces the <code>current-merge-key-array()</code> function to handle them.</p>
<p>Fix #1684</p>
</div></details></div>
<div class="toot" id="created-1688"><h2>Issue #1688 created<span class="toot-id"> #created-1688</span></h2><div class="pubdate">09 Jan at 17:39:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1688">https://github.com/qt4cg/qtspecs/issues/1688</a></div><details><summary>In rendered HTML, link to definition is missing its link text</summary><div class="markup"><p>https://qt4cg.org/specifications/xpath-functions-40/Overview.html#impl-def Item 6 contains a sentence that renders as "See ." In the raw HTML, there is a link <code>&lt;a href="#dt-nondeterministic-wrt-ordering"&gt;&lt;/a&gt;</code> with no link text.</p>
<p>I thought I might make this issue a little more substantive by reporting a second typo or broken link, but I can't find a second one at the moment. :)</p>
</div></details></div>
<div class="toot" id="created-1687"><h2>Pull request #1687 created<span class="toot-id"> #created-1687</span></h2><div class="pubdate">09 Jan at 12:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1687">https://github.com/qt4cg/qtspecs/pull/1687</a></div><details><summary>1672 array:values, map:values: Alternatives</summary><div class="markup"><p>Issue: #1672</p>
</div></details></div>
<div class="toot" id="created-1686"><h2>Pull request #1686 created<span class="toot-id"> #created-1686</span></h2><div class="pubdate">09 Jan at 11:46:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1686">https://github.com/qt4cg/qtspecs/pull/1686</a></div><details><summary>1685 Pipeline Operator</summary><div class="markup"><p>Issue: #1685</p>
<p>The PR introduces the pipeline operator <code>-&gt;</code>. If we decide to add it, we could drop <code>=!&gt;</code> in a second step and update various examples in the text.</p>
</div></details></div>
<div class="toot" id="created-1685"><h2>Issue #1685 created<span class="toot-id"> #created-1685</span></h2><div class="pubdate">09 Jan at 09:46:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1685">https://github.com/qt4cg/qtspecs/issues/1685</a></div><details><summary>Pipeline Operator</summary><div class="markup"><p>This is an attempt to find a solution for the discussion in #755, which was originally about defining an expression to bind the context value. It serves as a summary for an upcoming PR.</p>
<p>We have two operators in the language that can be used for pipelining:
&nbsp;&nbsp;1.&nbsp;With the simple map operator <code>!</code>, single items of an input can be bound to the context value.
&nbsp;&nbsp;2.&nbsp;With the arrow operator <code>=&gt;</code>, an input can be bound as first argument in a function call.</p>
<p>The current restrictions are:
&nbsp;&nbsp;A) There is no way to bind a sequence with 0 or more than 1 items to the context value.
&nbsp;&nbsp;B) We can only bind the input to the first function argument.</p>
<p>In addition, we have introduced the mapping arrow expression <code>=!&gt;</code> to bind single items of an input to the first function argument.</p>
<p>We could generalize and simplify the situation by introducing a dedicated and very basic pipeline operator: <code>A -&gt; B</code> evaluates <code>A</code> to a value, which is bound to the context value before evaluating <code>B</code>.</p>
<p>With the operator, restriction A) would be resolved. Restriction B) would be tackled indirectly, as <code>-&gt;</code> and <code>!</code> can often be combined. For example, the following examples from the specification could be simplifiedâ€¦</p>
<pre><code class="language-xquery">(: current vs. simplified syntax :)
$s =&gt; tokenize() =!&gt; fn { `"{.}"` }()
$s -&gt; tokenize(.) ! `"{.}"`

(: current vs. simplified syntax :)
(1 to 5) =!&gt; xs:double() =!&gt; math:sqrt() =!&gt; fn($a) { $a + 1 }() =&gt; sum()
(1 to 5) ! xs:double(.) ! math:sqrt(.) ! (. + 1) -&gt; sum(.)
</code></pre>
<p>â€¦and we could drop <code>=!&gt;</code> in favor of the new operator.</p>
<p>An equivalent representation for the focus function <code>fn { E }</code> would be <code>fn($c) { $c -&gt; E }</code>.</p>
</div></details></div>
<div class="toot" id="created-1684"><h2>Issue #1684 created<span class="toot-id"> #created-1684</span></h2><div class="pubdate">08 Jan at 21:41:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1684">https://github.com/qt4cg/qtspecs/issues/1684</a></div><details><summary>[XSLT] Composite merge keys</summary><div class="markup"><p>The changes in PR #1674 to allow composite sort keys automatically propagate to <code>xsl:merge</code>, because the semantics of <code>xsl:merge-key</code> are defined entirely by reference to <code>xsl:sort</code>.</p>
<p>No immediate problem, except (1) we should acknowledge the fact and point out that composite merge keys are now allowed, and (2) the effect on the current-merge-key() function. This is the sequence-concatenation of the merge keys for multiple merge sources. The spec says:</p>
<blockquote>
<p>the [current merge key] will be a single atomic item if there is a single merge key, or a sequence of atomic items if there are multiple merge keys.</p>
</blockquote>
<p>Actually I think that's already wrong, because it forgets that an individual merge key may be an empty sequence. If that happens then the current-merge-key() function is somewhat useless. I suggest we simply document the fact: if there are multiple merge sources generating multiple merge keys and they are not all singletons, then the sequence concatenation of the merge keys may not be especially useful.</p>
<p>We could provide a variant current-merge-key-array() that returns an array of sort key values, one for each xsl:merge-key element, each one being a sequence of atomic items.</p>
</div></details></div>
<div class="toot" id="minutesâ€”01-07"><h2>QT4 CG meeting 104 draft minutes<span class="toot-id"> #minutesâ€”01-07</span></h2><div class="pubdate">07 Jan at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2025/01-07">https://qt4cg.org/meeting/minutes/2025/01-07</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1261"><h2>Issue #1261 closed<span class="toot-id"> #closed-1261</span></h2><div class="pubdate">07 Jan at 17:24:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1261">https://github.com/qt4cg/qtspecs/issues/1261</a></div><p>Add decimal-divide function</p></div>
<div class="toot" id="closed-1671"><h2>Issue #1671 closed<span class="toot-id"> #closed-1671</span></h2><div class="pubdate">07 Jan at 17:24:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><p>1261 New fn:divide-decimals() function</p></div>
<div class="toot" id="closed-1662"><h2>Issue #1662 closed<span class="toot-id"> #closed-1662</span></h2><div class="pubdate">07 Jan at 17:22:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1662">https://github.com/qt4cg/qtspecs/issues/1662</a></div><p>xsl:sort - add composite sort keys</p></div>
<div class="toot" id="closed-1674"><h2>Issue #1674 closed<span class="toot-id"> #closed-1674</span></h2><div class="pubdate">07 Jan at 17:22:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><p>1662 Allow composite sort keys in xsl:sort</p></div>
<div class="toot" id="closed-1621"><h2>Issue #1621 closed<span class="toot-id"> #closed-1621</span></h2><div class="pubdate">07 Jan at 17:20:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1621">https://github.com/qt4cg/qtspecs/issues/1621</a></div><p>compare() with collations that do not support ordering</p></div>
<div class="toot" id="closed-1676"><h2>Issue #1676 closed<span class="toot-id"> #closed-1676</span></h2><div class="pubdate">07 Jan at 17:20:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><p>1621 Capabilities of Collations</p></div>
<div class="toot" id="closed-1678"><h2>Issue #1678 closed<span class="toot-id"> #closed-1678</span></h2><div class="pubdate">07 Jan at 17:17:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><p>Semantics of element(N, T) where T is a union type</p></div>
<div class="toot" id="closed-1679"><h2>Issue #1679 closed<span class="toot-id"> #closed-1679</span></h2><div class="pubdate">07 Jan at 17:17:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><p>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</p></div>
<div class="toot" id="closed-1670"><h2>Issue #1670 closed<span class="toot-id"> #closed-1670</span></h2><div class="pubdate">07 Jan at 17:11:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div>
<div class="toot" id="closed-1667"><h2>Issue #1667 closed<span class="toot-id"> #closed-1667</span></h2><div class="pubdate">07 Jan at 17:08:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1667">https://github.com/qt4cg/qtspecs/issues/1667</a></div><p>Invalid XML characters in JSON input</p></div>
<div class="toot" id="closed-1669"><h2>Issue #1669 closed<span class="toot-id"> #closed-1669</span></h2><div class="pubdate">07 Jan at 17:08:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1669">https://github.com/qt4cg/qtspecs/pull/1669</a></div><p>1667 Revise handling of non-XML characters in parse-json</p></div>
<div class="toot" id="closed-1668"><h2>Issue #1668 closed<span class="toot-id"> #closed-1668</span></h2><div class="pubdate">07 Jan at 17:05:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1668">https://github.com/qt4cg/qtspecs/pull/1668</a></div><p>Minor copy edits (no issue raised)</p></div>
<div class="toot" id="closed-1649"><h2>Issue #1649 closed<span class="toot-id"> #closed-1649</span></h2><div class="pubdate">07 Jan at 17:02:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1649">https://github.com/qt4cg/qtspecs/issues/1649</a></div><p>Result type of fn:function-annotations()</p></div>
<div class="toot" id="closed-1666"><h2>Issue #1666 closed<span class="toot-id"> #closed-1666</span></h2><div class="pubdate">07 Jan at 17:02:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1666">https://github.com/qt4cg/qtspecs/pull/1666</a></div><p>1649 result of function annotations</p></div>
<div class="toot" id="closed-1650"><h2>Issue #1650 closed<span class="toot-id"> #closed-1650</span></h2><div class="pubdate">07 Jan at 16:59:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1650">https://github.com/qt4cg/qtspecs/issues/1650</a></div><p>fn:node-kind, fn:type-of: Editorial</p></div>
<div class="toot" id="closed-1665"><h2>Issue #1665 closed<span class="toot-id"> #closed-1665</span></h2><div class="pubdate">07 Jan at 16:59:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1665">https://github.com/qt4cg/qtspecs/pull/1665</a></div><p>1650 Tidy up fn:type-of</p></div>
<div class="toot" id="closed-1663"><h2>Issue #1663 closed<span class="toot-id"> #closed-1663</span></h2><div class="pubdate">07 Jan at 16:57:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1663">https://github.com/qt4cg/qtspecs/pull/1663</a></div><p>Remove DTD/stylesheet distractions at the top of the schema</p></div>
<div class="toot" id="agenda-01-07"><h2>QT4 CG meeting 104 draft agenda<span class="toot-id"> #agenda-01-07</span></h2><div class="pubdate">07 Jan at 10:11:30 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2025/01-07">https://qt4cg.org/meeting/agenda/2025/01-07</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1683"><h2>Issue #1683 created<span class="toot-id"> #created-1683</span></h2><div class="pubdate">06 Jan at 11:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1683">https://github.com/qt4cg/qtspecs/issues/1683</a></div><details><summary>There are validity errors in the function catalog related to csv elements</summary><div class="markup"><p>The build reports:</p>
<pre><code>Processing file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Building tree for file:/Volumes/Saxonica/src/qt4cg/qtspecs/specifications/xpath-functions-40/src/function-catalog.xml using class net.sf.saxon.tree.tiny.TinyBuilder
Tree built in 215.684667ms
Tree size: 38655 nodes, 773635 characters, 7637 attributes
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-002
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 5 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-003
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 3 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-004
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 8 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-005
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 16 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-006
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 24 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-007
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 37 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-008
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 40 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-009
Using parser com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Error on line 1 column 53 of generate-qt3-test-set.xsl:
  XTTE1512  Cannot validate &lt;Q{.../xpath-functions}csv&gt;: no element declaration available
Error on line 36 column 7 of generate-qt3-test-set.xsl:
  XTTE1512  One validation error was reported: Cannot validate &lt;Q{.../xpath-functions}csv&gt;:
  no element declaration available
** Failure in parse-xml on fos:result of csv-to-xml-010
Execution time: 532.103792ms
Memory used: 98Mb
</code></pre>
</div></details></div>
<div class="toot" id="created-1682"><h2>Issue #1682 created<span class="toot-id"> #created-1682</span></h2><div class="pubdate">06 Jan at 11:05:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1682">https://github.com/qt4cg/qtspecs/issues/1682</a></div><details><summary>Type Promotion</summary><div class="markup"><p>The description of type promotion in Appendix B.1 has become outdated.</p>
<p>Firstly, the coercion rules no longer invoke type promotion; instead, they use a custom table of "implicit casts". So B.1 is wrong to say that type promotion is invoked by the coercion rules.</p>
<p>Secondly, for selecting an entry in the operator mapping table, I don't think type promotion comes into play.</p>
<ul>
<li>The rules for value comparisons do all the necessary type conversions of operands BEFORE invoking a search of the operator mapping table.</li>
<li>The rules for arithmetic operators don't require any type promotion: for numerics, they invoke a function such as op:numeric-add, and it is the definition of this function (not the selection of the function in the mapping table) that invokes type promotion.</li>
</ul>
<p>The statement in B.1 that "If the result type of an operator is listed as numeric, it means "the first type in the ordered list (xs:integer, xs:decimal, xs:float, xs:double) into which all operands can be converted by [subtype substitution] and [type promotion]" seems wrong in general: for example it doesn't cover <code>integer div integer</code>. The result type is actually defined by the rules of the selected function, e.g. op:numeric-divide, and not by the "result type" column of the operator mapping table. Perhaps it should say that if the result type is a subtype of numeric as defined by the particular function.</p>
<p>References to Type Promotion in F&amp;O section 1.6 are also outdated.</p>
<p>The sum() and avg() functions invoke "numeric promotion" to convert all values in the input to a common type, but the exact rules for doing this aren't exactly clear. For example, the equivalent expression given for sum() doesn't do what the prose says. For example, given sum() applied to a sequence (X as decimal, Y as decimal, Z as float), the prose says the result is float(X) + float(Y) + Z, whereas the equivalent expression gives float(decimal(X + Y)) + Z) which is not necessarily the same thing.</p>
</div></details></div>
<div class="toot" id="created-1681"><h2>Issue #1681 created<span class="toot-id"> #created-1681</span></h2><div class="pubdate">05 Jan at 23:38:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1681">https://github.com/qt4cg/qtspecs/issues/1681</a></div><details><summary> Î” in the table of contents</summary><div class="markup"><p>All the spec say in their first changes section:</p>
<blockquote>
<p>Sections with significant changes are marked Î” in the table of contents.</p>
</blockquote>
<p>However, these markers are present only in the F&amp;O specification.</p>
</div></details></div>
<div class="toot" id="created-1680"><h2>Issue #1680 created<span class="toot-id"> #created-1680</span></h2><div class="pubdate">05 Jan at 19:27:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1680">https://github.com/qt4cg/qtspecs/issues/1680</a></div><details><summary>Ambiguous `switch` syntax</summary><div class="markup"><p>Unless I am overlooking some constraint preventing this, an ambiguity has been introduced to the XQuery 4.0 grammar by allowing the <code>SwitchComparand</code> to be omitted per #671/#678.</p>
<p>Here is an example of an ambiguous expression:</p>
<pre><code class="language-xquery">switch case A return switch case B return switch case C return D default return E default return F
</code></pre>
<p>It can be parsed along the lines of</p>
<pre><code class="language-xquery">switch
case A return SWITCH 
case B return switch
              case C return D 
              default return E 
default return F
</code></pre>
<p>but also like the following</p>
<pre><code class="language-xquery">switch
case A return switch
              case B return SWITCH
              case C return D
              default return E
default return F
</code></pre>
</div></details></div>
<div class="toot" id="created-1679"><h2>Pull request #1679 created<span class="toot-id"> #created-1679</span></h2><div class="pubdate">05 Jan at 14:28:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1679">https://github.com/qt4cg/qtspecs/pull/1679</a></div><details><summary>1678 Define element(E,T) and attribute(A,T) in terms of "derives-from"</summary><div class="markup"><p>Fix #1678</p>
</div></details></div>
<div class="toot" id="created-1678"><h2>Issue #1678 created<span class="toot-id"> #created-1678</span></h2><div class="pubdate">05 Jan at 00:24:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1678">https://github.com/qt4cg/qtspecs/issues/1678</a></div><details><summary>Semantics of element(N, T) where T is a union type</summary><div class="markup"><p>The semantics of <code>element(N, T)</code> say that to get a match, the type annotation A of the element must be derived from T <em>by restriction</em>. This means you will never get a match if T is a union type.</p>
<p>Furthermore, if T is a complex type, there is no match if the type annotation is a complex type derived by extension from T.</p>
<p>I think this is a simple error in the spec. It should say that derived-from(A, T) must be true. The derived-from() relationship handles union types and derivation by extension correctly.</p>
<p>We do use <code>derived-from</code> when specifying subtyping. This means that an element E can be an instance of <code>element(E, xs:integer)</code>, and not be an instance of <code>element(E, xs:numeric)</code>, even though  <code>element(E, xs:integer)</code>, is a subtype of <code>element(E, xs:numeric)</code>.</p>
<p>The error seems to have crept in when the rules were redrafted for 4.0. Up to and including 3.1, the semantics of ElementTest and AttributeTest reference the derived-from() function.</p>
</div></details></div>
<div class="toot" id="created-1677"><h2>Pull request #1677 created<span class="toot-id"> #created-1677</span></h2><div class="pubdate">04 Jan at 18:32:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1677">https://github.com/qt4cg/qtspecs/pull/1677</a></div><details><summary>1675 Fixes for CSV parsing</summary><div class="markup"><p>Fix #1675</p>
</div></details></div>
<div class="toot" id="created-1676"><h2>Pull request #1676 created<span class="toot-id"> #created-1676</span></h2><div class="pubdate">03 Jan at 20:08:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1676">https://github.com/qt4cg/qtspecs/pull/1676</a></div><details><summary>1621 Capabilities of Collations</summary><div class="markup"><p>Fix #1621</p>
<p>This PR is largely editorial, except that it makes a substantive change to the <code>fn:collation-available</code> function.</p>
</div></details></div>
<div class="toot" id="created-1675"><h2>Issue #1675 created<span class="toot-id"> #created-1675</span></h2><div class="pubdate">03 Jan at 16:02:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1675">https://github.com/qt4cg/qtspecs/issues/1675</a></div><p>CSV parsing</p></div>
<div class="toot" id="created-1674"><h2>Pull request #1674 created<span class="toot-id"> #created-1674</span></h2><div class="pubdate">03 Jan at 13:32:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1674">https://github.com/qt4cg/qtspecs/pull/1674</a></div><details><summary>1662 Allow composite sort keys in xsl:sort</summary><div class="markup"><p>Fix #1662</p>
</div></details></div>
<div class="toot" id="created-1673"><h2>Pull request #1673 created<span class="toot-id"> #created-1673</span></h2><div class="pubdate">03 Jan at 01:07:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1673">https://github.com/qt4cg/qtspecs/pull/1673</a></div><details><summary>1407 TOC structure for types</summary><div class="markup"><p>Addresses part of #1407:</p>
<ul>
<li>Improves the section headings and levels for the Types and Subtyping sections</li>
<li>Level-4 headings (and level-5 if there were any) are no longer omitted from the F&amp;O TOC.</li>
</ul>
<p>There are other suggestions in #1407 regarding the spec prose that are not (yet) implemented.</p>
<p>Changing the CSS to adjust presentation of level-4 and level-5 headings in the TOC is way above my level of CSS competence, there's some very elaborate logic in this area, and anyone who wants to tackle it is welcome.</p>
</div></details></div>
<div class="toot" id="created-1672"><h2>Issue #1672 created<span class="toot-id"> #created-1672</span></h2><div class="pubdate">02 Jan at 20:50:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1672">https://github.com/qt4cg/qtspecs/issues/1672</a></div><details><summary>array:values, map:values: Alternatives</summary><div class="markup"><p>We still have <code>array:values</code> and <code>map:values</code> in the spec, even though the names were considered suboptimal: When retrieving values of struct(ure(d item))s, one would expect to get not a flat, but a structured result.</p>
<p>A while ago, the <code>items</code> key specifier was introduced to mimic the classical wildcard lookup syntax (making <code>$A?*</code> and <code>$A?items::*</code> equivalent), and I suggest renaming our functions to <code>array:items</code> and <code>map:items</code>:</p>
<pre><code class="language-xquery">  $map?*
â‰ map:items($map)

  $array?*
â‰ array:items($array)
</code></pre>
<p>Plan&nbsp;B could be to extend the second argument of <code>map:get</code> (and <code>array:get</code>) to also accept predicate functionsâ€¦</p>
<pre><code class="language-xquery">map:get(
  $map  as map(*),	
  $key  as (xs:anyAtomicType|fn(xs:anyAtomicType) as xs:boolean?)
) as item()*
</code></pre>
<p>â€¦which would allow us to write:</p>
<pre><code class="language-xquery">  $map?a
â‰ $map =&gt; map:get('a')
â‰ $map =&gt; map:get(fn { . = 'a' })

  $map?(1 to 5)
â‰ $map =&gt; map:get(fn { . = 1 to 5 })

  $map?*
â‰ $map =&gt; map:get(true#0)

(: and things like :)
$map =&gt; map:get(fn { . mod 2 = 1 })
</code></pre>
</div></details></div>
<div class="toot" id="created-1671"><h2>Pull request #1671 created<span class="toot-id"> #created-1671</span></h2><div class="pubdate">01 Jan at 16:50:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1671">https://github.com/qt4cg/qtspecs/pull/1671</a></div><details><summary>1261 New fn:divide-decimals() function</summary><div class="markup"><p>Fix #1261</p>
</div></details></div>
<div class="toot" id="created-1670"><h2>Pull request #1670 created<span class="toot-id"> #created-1670</span></h2><div class="pubdate">01 Jan at 12:51:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1670">https://github.com/qt4cg/qtspecs/pull/1670</a></div><p>Action QT4CS-097-02: Enable xtermref links to XSD SCM property names</p></div></div></article></main></body></html>
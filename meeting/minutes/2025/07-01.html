<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 127 Minutes 2025-07-01</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 127 Minutes 2025-07-01</h1>
<p>
<a href="../">Meeting index</a> / <a href="https://qt4cg.org">QT4CG.org</a> / <a href="https://qt4cg.org/dashboard">Dashboard</a> / <a href="https://github.com/qt4cg/qtspecs/issues">GH Issues</a> / <a href="https://github.com/qt4cg/qtspecs/pulls">GH Pull Requests</a>
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/7]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[8/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a></li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[1/6]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests and issues</a>
<ul>
<li><a href="#blocked">1.6.1. Blocked</a></li>
<li><a href="#merge-without-discussion">1.6.2. Merge without discussion</a></li>
<li><a href="#close-without-action">1.6.3. Close without action</a></li>
<li><a href="#substantive">1.6.4. Substantive PRs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical agenda</a>
<ul>
<li><a href="#h-9B6561A3-42E4-446B-BD54-64E818A607D6">2.1. PR #2031: 2025 JNodes</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/7]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with NW to come to agreement on the fn:ranks proposal</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-112-01: JLO to propose a concrete example that uses “.” in a ~%method~s.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-116-01: Add a specific error code for unsupported options on doc and doc-available</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-118-01: MK to make an incorrect type raise an error in #1906</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-123-01: MK to do the set example in XQuery.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-127-01: NW to diagram the JTree representing arbitrary XDM content.</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[8/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: DB, JWL
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> David J Birnbaum (DB)</li>
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK) [x:08-]</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> Juri Leino (JLO)</li>
<li class="off"><code>[&#xa0;]</code> John Lumley (JWL)</li>
<li class="off"><code>[&#xa0;]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Wendell Piez (WP)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="off"><code>[&#xa0;]</code> Bethan Tovey-Walsh (BTW)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW) <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2025/07-01.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2025/06-24.html">the minutes of the previous meeting</a>. 
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
The next meeting is scheduled for 8 July 2025.
</p>

<p>
JWL gives regrets for 8 July.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[1/6]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<p>
(Items marked [X] are believed to have been closed via email before
this agenda was posted.)
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with NW to come to agreement on the fn:ranks proposal</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-112-01: JLO to propose a concrete example that uses “.” in a ~%method~s.</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-116-01: Add a specific error code for unsupported options on doc and doc-available</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-118-01: MK to make an incorrect type raise an error in #1906</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-123-01: MK to do the set example in XQuery.</li>
<li class="on"><code>[X]</code> QT4CG-126-01: JLO to add an example where the map:build key function returns multiple keys.</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests and issues</h3>
<div class="outline-text-3" id="text-open-pull-requests">
<p>
This section summarizes all of the issues and pull requests that need to be
resolved before we can finish. See <a href="#technical-agenda">Technical Agenda</a> below for the focus of this
meeting.
</p>
</div>

<div id="outline-container-blocked" class="outline-4">
<h4 id="blocked"><span class="section-number-4">1.6.1.</span> Blocked</h4>
<div class="outline-text-4" id="text-blocked">
<p>
The following PRs are open but have merge conflicts or comments which
suggest they aren’t ready for action.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2063">#2063</a>: 1996 Lookups, KeySpecifier: Literal, ContextValueRef</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2019">#2019</a>: 1776: XSLT template rules for maps and array</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1283">#1283</a>: 77b Update expressions</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1062">#1062</a>: 150bis revised proposal for fn:ranks</li>
</ul>
</div>
</div>

<div id="outline-container-merge-without-discussion" class="outline-4">
<h4 id="merge-without-discussion"><span class="section-number-4">1.6.2.</span> Merge without discussion</h4>
<div class="outline-text-4" id="text-merge-without-discussion">
<p>
The following PRs are editorial, small, or otherwise appeared to be
uncontroversial when the agenda was prepared. The chairs propose that
these can be merged without discussion. If you think discussion is
necessary, please say so.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2050">#2050</a>: 2040 Fix context value declaration issues</li>
</ul>

<p>
Proposal: accept without discussion.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-close-without-action" class="outline-4">
<h4 id="close-without-action"><span class="section-number-4">1.6.3.</span> Close without action</h4>
<div class="outline-text-4" id="text-close-without-action">
<p>
It has been proposed that the following issues be closed without action.
If you think discussion is necessary, please say so.
</p>

<ul class="org-ul">
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/1903">#1903</a>: <code>fn:scan-left</code>, <code>fn:scan-right</code>: missing steps</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/1583">#1583</a>: JSON: Parsing and serializing numbers, often undesired E notation</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/1021">#1021</a>: Extend <code>fn:doc</code>, <code>fn:collection</code> and <code>fn:uri-collection</code> with options maps</li>
<li>Issue <a href="https://github.com/qt4cg/qtspecs/issues/967">#967</a>: XPath Appendix I: Comparisons</li>
</ul>

<p>
Proposal: close with no further action.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-substantive" class="outline-4">
<h4 id="substantive"><span class="section-number-4">1.6.4.</span> Substantive PRs</h4>
<div class="outline-text-4" id="text-substantive">
<p>
The following substantive PRs were open when this agenda was prepared.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2031">#2031</a>: 2025 JNodes</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2043">#2043</a>: 2038 Tweak the rules for fn:apply-templates references to modes</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2037">#2037</a>: 2036 Add rule for streamability of xsl:map</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2019">#2019</a>: 1776: XSLT template rules for maps and array</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2014">#2014</a>: QT4CG-122-01 Add notes, examples, and rationale for xsl:select</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-2011">#2011</a>: 675(part): Add XSLT static typing rules for new kinds of XPath expression</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
<p>
This week, our plan is to focus on the JNodes proposal. Failing that, we’ll see
if we can resolve any of the other open PRs.
</p>
</div>

<div id="outline-container-h-9B6561A3-42E4-446B-BD54-64E818A607D6" class="outline-3">
<h3 id="h-9B6561A3-42E4-446B-BD54-64E818A607D6"><span class="section-number-3">2.1.</span> PR #2031: 2025 JNodes</h3>
<div class="outline-text-3" id="text-h-9B6561A3-42E4-446B-BD54-64E818A607D6">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-2031">#2031</a>
</p>

<ul class="org-ul">
<li>MK: How do we want to review this?</li>
<li>JLO: I would like to discuss the concepts first.</li>
<li>WP: I’d like examples too!</li>
<li>MK: In that case, let’s start with the data model; that’s where the concepts
are introduced.</li>
</ul>

<p>
MK reviews changes in the data model specification.
</p>

<ul class="org-ul">
<li>MK: There’s some removing around; JNodes replaces a couple of concepts, so we
lose labeled items.
<ul class="org-ul">
<li>… In the type system, we add a “generic node”. An unqualified use of the
term “node()” means an XNode.</li>
<li>… A JNode can wrap any sequence, but the interesting cases are maps and arrays.</li>
<li>… The diagrams have changed but the diffs are confused.</li>
</ul></li>
<li>MK: Section 6, Generic nodes.
<ul class="org-ul">
<li>… GNode is a collective term for XNodes or JNodes.</li>
<li>… (etc.)</li>
<li>… Both XNodes and JNodes have unique identity and document order.</li>
</ul></li>
</ul>

<p>
The data model document is now very asymmetric.
</p>

<ul class="org-ul">
<li>MK: Any value can participate in a map or array and can be a value in a JTree.
<ul class="org-ul">
<li>… But the tree isn’t considered to extend to those nodes, it’s a context
switch to a different space.</li>
</ul></li>
<li>JLO: So it’s a foreign object.</li>
<li>MK: Yes. It’s like a ZIP file in a directory structure, it’s not part of the
same tree.</li>
<li>MK: A lot of things have been moved around.</li>
<li>NW: I’m surprised there isn’t more to change about accessors.</li>
<li>MK: Section 8.4 introduces JNodes in more detail.
<ul class="org-ul">
<li>… I’ve kept the ¶ notation so that they stand out.</li>
<li>… The term “value” in particular is usefully distinguised <code>¶value</code>.</li>
<li>… A JNode always wraps a value and if it isn’t the root it has a parent and
a selector which is it’s key or index. And it has a position.</li>
<li>We have to cater to the possibility that an array item will contain more than one map.</li>
</ul></li>
<li>MK: There’s an accessor <code>j-children</code> that returns the children.</li>
<li>MK: Values can be leaf or non-leaf values; it’s a non-leaf if at least one
item in the value is a non-empty map or array.
<ul class="org-ul">
<li>… There’s a lot of subtlety in that sentence!</li>
<li>… You can distinguish them, but it’s a bit complicted.</li>
</ul></li>
<li>RD: Would it make more sense to define JNodes using data model parent and
other properties that are done for the XML node types. Then things like the
child selector and parent and such are all in effect defined by those data
model functions.</li>
<li>MK: There are some similarities but many differences. I’ve tried to move what
is common up to the GNode level and keep what I couldn’t integrate at the next
level.
<ul class="org-ul">
<li>… It gets terribly complicated if you try to go too far.</li>
</ul></li>
</ul>

<p>
Some discussion of how things like the attributes accessor might work.
</p>

<ul class="org-ul">
<li>MK: If the <code>¶value</code> is non-leaf, then it contains one or more JNodes for each
member.
<ul class="org-ul">
<li>… There’s an accessor <code>dm:j-value</code> that is used to access the value.</li>
<li>… The function <code>dm:JNode</code> can be used to wrap a value.</li>
</ul></li>
</ul>

<p>
MK explains the code that follows the introduction of <code>dm:j-value</code> and
<code>dm:JNode</code>.
</p>

<ul class="org-ul">
<li>MK: You don’t get a JNode for entries in an array that don’t contain more
nodes. That’s different from how text nodes work. Here you just get atomics at
the root level.</li>
</ul>

<p>
MK describes the examples.
</p>

<ul class="org-ul">
<li>NW: I wonder if we could improve on “position” and “selector”.</li>
<li>JLO: What is the necessity to allow for sequences in JNodes? Is it a
must-have?</li>
<li>MK: Yes, it has to be possible to process all maps and arrays, rather than
just ones that represent well-formed JSON.</li>
<li>JLO: If I have a sequence of 14 empty arrays, then it will be a leaf node?</li>
<li>MK: Yep. Basically, if you haven’t got any children, then you have to do some
conventional processing on the value to work out what you’ve got.</li>
<li>JLO: The really hard part is to distinguish empty arrays and maps.</li>
<li>MK: Yes, the JSON value <code>null</code> turns into an empty sequence and that has no
children either.</li>
</ul>

<p>
Some discussion of distinguishing empty arrays and null.
</p>

<p>
MK discusses the example of a JTree representing arbitrary XDM content.
</p>

<p>
ACTION: QT4CG-127-01: NW to diagram the JTree representing arbitrary XDM content.
</p>

<ul class="org-ul">
<li>WP: (Scrolling back up a little) Are there cases where you’re going to have
the same selector in different positions?</li>
<li>MK: Yes. If the third element has two items.</li>
<li>MK: There’s some effort here to make the 90% case easier; but it does squash a
few things that make the 10% case more complicated.</li>

<li>MK: Every root JNode has its own identity.
<ul class="org-ul">
<li>… For a non-root JNode, the identity is a function of its properties. (If they have the same 
<code>¶parent</code>, <code>¶position</code>, and <code>¶selector</code>, they are the same JNode.)</li>
</ul></li>
</ul>

<p>
JNodes are likely to be lazily constructed. Parent pointers are transient. This
is like the “Zipper” data structure frequently found in functional programming.
</p>

<ul class="org-ul">
<li>JK: I have some knotty questions about terms, but we can come back to those.</li>
</ul>

<p>
MK turns to the XPath specification.
</p>

<ul class="org-ul">
<li>MK: There are two new item types, <code>GNodeType</code> and <code>JNodeType</code>.</li>
<li>MK: There’s new exposition about what the types mean and what they match, but they’re obvious.
<ul class="org-ul">
<li>… So are the subtyping rules.</li>
</ul></li>
<li>MK: Coercion rules say that if you supply a JNode where one isn’t accepted,
then you substitute its value. (A map or array function will accept a JNode
and implicitly unwrap it.)</li>
<li>MK: Union, intersect, and except are generalized to apply to both JNodes and XNodes.</li>
<li>MK: Similarly, the “is”, “before” and “after” operators apply to JNodes.</li>
<li>MK: Then we get to Lookup Expressions.</li>
</ul>

<p>
MK reviews the details of lookup expressions.
</p>

<ul class="org-ul">
<li>MK: If there is no axis, it almost but not quite defaults to child.
<ul class="org-ul">
<li>… The distinction is that it unwraps the nodes to give you the values.
That’s consistent with what we currently have.</li>
</ul></li>
</ul>

<p>
MK moves on to deep lookup.
</p>

<ul class="org-ul">
<li>MK: This is new in 4.0, so we can change the semantics and I have, it is just
the ancestor access.</li>
</ul>

<p>
MK skims over the changes to Functions &amp; Operators.
</p>

<ul class="org-ul">
<li>MK: <code>fn:root</code>, <code>fn:generate-id</code> and <code>fn:distinct-ordered-nodes</code> have been
generalized to GNodes
<ul class="org-ul">
<li>… We could do others.</li>
</ul></li>
</ul>

<p>
NW wonders how to proceed…
</p>

<ul class="org-ul">
<li>CG: I think this is a big step forward. There’s one thing that keeps me
thinking, it’s the question of whether we should overload the existing lookup
operator that was in 3.0. I wonder if we should keep lookup expression as it
is and introduce a new expression, like JPath, that is much more similar to an
existing XPath expression.
<ul class="org-ul">
<li>… That would give us more freedom to define the semantics. Mostly we could
make the simple step symmetric with the child axis.</li>
<li>… One problem is that ?b and ?child::b will produce different results and
that will be problematic.</li>
</ul></li>
<li>MK: Yes, there are a few surprises in here.
<ul class="org-ul">
<li>… You suggested using a different operator. I looked at “/” but decided that
wasn’t viable.</li>
</ul></li>
<li>MK: How does that effect the discussion of adopting this as baseline.
<ul class="org-ul">
<li>… My preference would be to adopt this and work from here. That will make
proprosed improvements easier.</li>
</ul></li>
<li>CG: I think it could be a pretty fundamental change if we decided to leave the
lookup operator untouched.</li>
<li>MK: Hopefully that would only effect lookup expressions.</li>
<li>JK: I’d like to have more time to review it. I have some fundamental questions
about how we’re addressing the data model.</li>
<li>RD: I wondering about the JPath syntax which I quite like. I wonder whether it
would make sense to instead of having a separate syntax, keep the existing
syntax and somehow do something mixed.</li>
<li>CG: The main challenge is that we cannot redefine the shallow lookup operator.</li>
<li>RD: I’m thinking of “//”, given that we’re defining the parent and other things.
<ul class="org-ul">
<li>… I think with care the existing XPath syntax should fall out and be compatible.</li>
</ul></li>
<li>JLO: I’d like more time.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>

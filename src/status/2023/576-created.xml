<item>
   <title>Issue #576 created</title>
   <pubDate>2023-06-27T20:03:19Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/576</link>
   <guid>https://qt4cg.org/@qt4cg/2023/#created-576</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:items-to-json, fn:element-to-map, JSON serialization&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;As far as possible, the JSON serialization method should be aligned with the new fn:items-to-json() (aka xdm-to-json) function.&lt;/p&gt;
&lt;p&gt;Firstly, the results should be the same when the input consists entirely of atomic values, or sequences, maps, and arrays consisting entirely of atomic values. This only requires one change: serializing a sequence of length &amp;gt;1 should output the sequence as if it were an array, rather than raising an error. This is a compatible change.&lt;/p&gt;
&lt;p&gt;Secondly, the new fn:items-to-json() function should have an option to output elements (for example elements appearing within maps or arrays) in the same way as the JSON serialization method does, by serializing the nodes to lexical XML or HTML contained within a JSON character string.&lt;/p&gt;
&lt;p&gt;Finally, we should align the rules on how to output a function item (other than a map or array). We could either adopt the serialization approach (raise an error), or the items-to-json() approach (output some kind of placeholder saying "here be dragons") but they should be aligned.&lt;/p&gt;
&lt;p&gt;Note that the two operations are still very different. items-to-json() is primarily about converting XML to JSON, while JSON serialization is primarily about turning maps and arrays into their JSON lexical form.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

<item>
   <title>Issue #2458 created</title>
   <pubDate>2026-02-11T08:19:25Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2458</link>
   <guid>https://qt4cg.org/@qt4cg/2026/#created-2458</guid>
   <description>&lt;div&gt;&lt;p&gt;NodeTests: Unify jnode(X) and get(X)&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;I can currently write &lt;code&gt;$map/jnode("key")&lt;/code&gt; or &lt;code&gt;$map/get("key")&lt;/code&gt;, and both have the same meaning.&lt;/p&gt;
&lt;p&gt;Both imply the child axis: I can also write &lt;code&gt;$map/child::jnode("key")&lt;/code&gt; or &lt;code&gt;$map/child::get("key")&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;There are differences:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jnode&lt;/code&gt; also allows a content type to be specified&lt;/li&gt;
&lt;li&gt;&lt;code&gt;get&lt;/code&gt; allows the key to be an arbitrary expression, while &lt;code&gt;jnode&lt;/code&gt; requires a &lt;code&gt;Constant&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jnode&lt;/code&gt; allows an NCName-valued key to be written without quotes&lt;/li&gt;
&lt;li&gt;&lt;code&gt;get&lt;/code&gt; allows multiple keys to be selected&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jnode&lt;/code&gt; allows all keys to be selected&lt;/li&gt;
&lt;li&gt;&lt;code&gt;get&lt;/code&gt; also works with XNodes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I propose that we unify these constructs.&lt;/p&gt;
&lt;p&gt;To do this we distinguish &lt;code&gt;jnode&lt;/code&gt; as an item type from &lt;code&gt;jnode&lt;/code&gt; as a selector.&lt;/p&gt;
&lt;p&gt;When used as a selector, the first argument of &lt;code&gt;jnode&lt;/code&gt; should accept a &lt;code&gt;KeySpecifier&lt;/code&gt; rather than a &lt;code&gt;Constant&lt;/code&gt;. &lt;code&gt;KeySpecifier&lt;/code&gt; is the subset of &lt;code&gt;Expression&lt;/code&gt; that we allow after the lookup operator &lt;code&gt;?&lt;/code&gt;. (We should extend it to generalise &lt;code&gt;Literal&lt;/code&gt; to &lt;code&gt;Constant&lt;/code&gt;) A &lt;code&gt;KeySpecifier&lt;/code&gt; allows an arbitrary expression in parentheses; we can debate what focus should be used to evaluate it.&lt;/p&gt;
&lt;p&gt;This means, for example, that &lt;code&gt;$array/get($i)&lt;/code&gt; becomes &lt;code&gt;$array/jnode($i)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We could apply the same treatment to &lt;code&gt;element()&lt;/code&gt; and &lt;code&gt;attribute()&lt;/code&gt;, allowing &lt;code&gt;$doc//element($N)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The second optional argument of &lt;code&gt;jnode()&lt;/code&gt;, &lt;code&gt;element()&lt;/code&gt;, and &lt;code&gt;attribute()&lt;/code&gt; is unaffected.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

<item>
   <title>Issue #2403 created</title>
   <pubDate>2026-01-23T12:00:34Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2403</link>
   <guid>https://qt4cg.org/@qt4cg/2026/#created-2403</guid>
   <description>&lt;div&gt;&lt;p&gt;Testable examples in the file spec&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;In PR #2401 Norm introduced a temporary fix needed because the function catalog in the EXPath file spec doesn't conform to the fos.xsd schema.&lt;/p&gt;
&lt;p&gt;I think we can fix this without a schema or stylesheet change by using existing mechanisms illustrated by this example from fn:collation:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;             &amp;lt;fos:test&amp;gt;
               &amp;lt;fos:expression&amp;gt;collation({ 'lang': 'de', 'strength': 'primary' })&amp;lt;/fos:expression&amp;gt;
               &amp;lt;fos:result&amp;gt;"http://www.w3.org/2013/collation/UCA?lang=de;strength=primary"&amp;lt;/fos:result&amp;gt;
               &amp;lt;fos:test-assertion&amp;gt;
                  &amp;lt;result xmlns="http://www.w3.org/2010/09/qt-fots-catalog"&amp;gt;
                     &amp;lt;any-of&amp;gt;
                        &amp;lt;assert-string-value&amp;gt;http://www.w3.org/2013/collation/UCA?lang=de;strength=primary&amp;lt;/assert-string-value&amp;gt;
                        &amp;lt;assert-string-value&amp;gt;http://www.w3.org/2013/collation/UCA?strength=primary;lang=de;&amp;lt;/assert-string-value&amp;gt;
                     &amp;lt;/any-of&amp;gt;
                  &amp;lt;/result&amp;gt;
               &amp;lt;/fos:test-assertion&amp;gt;
               &amp;lt;fos:postamble&amp;gt;The order of query parameters may vary.&amp;lt;/fos:postamble&amp;gt;
            &amp;lt;/fos:test&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;fos:result&lt;/code&gt; (or &lt;code&gt;fos:error-result&lt;/code&gt;) element must always be present, and will always be rendered in the spec as the expected result. If the example will not always deliver this result, then &lt;code&gt;&amp;lt;fos:test-assertion&amp;gt;&lt;/code&gt; can appear to give the result as it will appear in the generated test case.&lt;/p&gt;
&lt;p&gt;But I suggest we add another attribute &lt;code&gt;&amp;lt;fos:result narrative="true"/&amp;gt;&lt;/code&gt; to indicate that the result is given as explanatory prose, not as a testable XPath expression. This would allow another fn:collation example&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         &amp;lt;fos:example&amp;gt;
            &amp;lt;p&amp;gt;The expression &amp;lt;code&amp;gt;collation({ 'lang': default-language() })&amp;lt;/code&amp;gt;
               returns a collation suitable for the default language in the
               dynamic context.&amp;lt;/p&amp;gt;
         &amp;lt;/fos:example&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to be rewritten as&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         &amp;lt;fos:example&amp;gt;
            &amp;lt;fos:test&amp;gt;
                &amp;lt;fos:expression&amp;gt;collation({ 'lang': default-language() })&amp;lt;/fos:expression&amp;gt;
                &amp;lt;fos:result narrative="true"&amp;gt;A collation suitable for the default language in the
               dynamic context.&amp;lt;/fos:result&amp;gt;
                &amp;lt;fos:test-assertion&amp;gt;
                   &amp;lt;result xmlns="http://www.w3.org/2010/09/qt-fots-catalog"&amp;gt;&amp;lt;assert&amp;gt;true()&amp;lt;/assert&amp;gt;&amp;lt;/result&amp;gt;
                &amp;lt;/fos:test-assertion&amp;gt;
           &amp;lt;/fos:test&amp;gt;
         &amp;lt;/fos:example&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which will (a) make it easier to fit the results into the tabular presentation of examples, and (b) cause a test case to be generated which will ensure that the example is syntactically valid.&lt;/p&gt;
&lt;p&gt;(Or we could leave out &lt;code&gt;&amp;lt;fos:test-assertion&amp;gt;&lt;/code&gt; in this example. If the supplied fos:result has narrative="true" and there is no test assertion, the generated test case can assume &lt;code&gt;&amp;lt;assert&amp;gt;true()&amp;lt;/assert&amp;gt;&lt;/code&gt;)&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

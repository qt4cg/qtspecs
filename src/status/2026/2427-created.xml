<item>
   <title>Issue #2427 created</title>
   <pubDate>2026-01-30T15:38:24Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2427</link>
   <guid>https://qt4cg.org/@qt4cg/2026/#created-2427</guid>
   <description>&lt;div&gt;&lt;p&gt;Node construction in XPath&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;There was pushback on issue #573 which proposed a set of functions for constructing nodes, on the grounds that for XQuery users, this was unnecessary duplication.&lt;/p&gt;
&lt;p&gt;A possible alternative is to add a subset of the XQuery syntax for node construction to XPath: specifically, computed node constructors, which are relatively free of hassles such as dependence on the namespace context, boundary space rules, etc.&lt;/p&gt;
&lt;p&gt;Specifically we could add computed constructors:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ComputedConstructor::=CompDocConstructor
|  CompElemConstructor
|  CompAttrConstructor
|  CompNamespaceConstructor
|  CompTextConstructor
|  CompCommentConstructor
|  CompPIConstructorCompDocConstructor::="document" EnclosedExpr
 CompElemConstructor::="element"  CompNodeName EnclosedContentExpr
 CompAttrConstructor::="attribute"  CompNodeName EnclosedExpr
 CompNamespaceConstructor::="namespace"  CompNodeNCName EnclosedExpr
 CompTextConstructor::="text"  EnclosedExpr
 CompCommentConstructor::="comment"  EnclosedExpr
 CompPIConstructor::="processing-instruction"  CompNodeNCName EnclosedExpr
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;with the restriction that CompNodeName / CompNodeNCName are either expressions in curly braces, or use the new XQuery 4.0 form with a leading "#".&lt;/p&gt;
&lt;p&gt;It is of course trivial to define a function library on top of this if someone wants the extra flexibility:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;let $new-element := fn($name, $content) { element {$name} {$content} }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;etc&lt;/p&gt;
&lt;p&gt;(Incidentally, &lt;code&gt;EnclosedContentExpr&lt;/code&gt; serves no useful purpose as it's identical to &lt;code&gt;EnclosedExpr&lt;/code&gt;.)&lt;/p&gt;
&lt;p&gt;We could common up the rules for "constructing simple content" and "constructing complex content" at the same time, putting them in XPath where both XQuery and XSLT can refer to them. I believe they are identical except for (a) error codes, (b) with duplicate attribute names, XQuery throws an error while XSLT takes the last.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

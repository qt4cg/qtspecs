<item>
   <title>Issue #2056 created</title>
   <pubDate>2025-06-18T13:52:01Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2056</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2056</guid>
   <description>&lt;div&gt;&lt;p&gt;Implicit Whitespace in `MarkedNCName` and `QNameLiteral`&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The REx-generated XQuery parser has failed to raise the expected syntax error for test case &lt;a href="https://github.com/qt4cg/qt4tests/blob/44f7691e986b39f81effea9686f7035d5ee99f6b/prod/CompNamespaceConstructor.xml#L711"&gt;&lt;code&gt;nscons-046&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is caused by REx' unability to precisely handle differing whitespace allowances of multiple viable parsing alternatives. In the actual case,&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;&amp;lt;foo&amp;gt;{namespace # ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;there are two possible interpretations for &lt;code&gt;namespace&lt;/code&gt; &lt;code&gt;#&lt;/code&gt; that still need to be distinguished:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a &lt;code&gt;NamedFunctionRef&lt;/code&gt; refering to some arity of a function named &lt;code&gt;namespace&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;a &lt;code&gt;CompNamespaceConstructor&lt;/code&gt; using a &lt;code&gt;MarkedNCName&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now the problem is that the former allows implicit whitespace to follow, while the latter does not. A REx parser accepts whitespace here and thus fails the test case.&lt;/p&gt;
&lt;p&gt;While this is REx' problem, and can be worked around by creating multiple &lt;code&gt;#&lt;/code&gt; tokens with different lexical lookahead, it would be nicer to avoid this situation. This would possibly also simplify the work for other parsers.&lt;/p&gt;
&lt;p&gt;May I ask to allow implicit whitespace in both the &lt;code&gt;MarkedNCName&lt;/code&gt; and &lt;code&gt;QNameLiteral&lt;/code&gt; productions? This would be in line with variable declarations and references, which also allow implicit whitespace between &lt;code&gt;$&lt;/code&gt; and &lt;code&gt;EQName&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

<item>
   <title>Issue #2252 created</title>
   <pubDate>2025-10-15T09:29:03Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2252</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2252</guid>
   <description>&lt;div&gt;&lt;p&gt;Dynamic XPath Evaluation the functional way&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The xsl:evaluate instruction in XSLT 3.0 has proved highly popular. I've been studying a workload that uses it extensively. The Saxon implementation uses caching to prevent repeated parsing of the same expression, and on this workload we are getting a very high hit rate on the cache - over 99%. However, computing the cache keys is expensive: in fact, because the expressions are all very simple, computing the cache key probably costs almost as much as re-parsing the expression every time it is used. (One reason for this is that the cache key includes the entire static namespace context).&lt;/p&gt;
&lt;p&gt;I would like to propose a functional equivalent of xsl:evaluate. Specifically, a function&lt;/p&gt;
&lt;p&gt;fn:compile-xpath($expr as xs:string)&lt;/p&gt;
&lt;p&gt;which returns a function $f such that $f($params) evaluates the compiled XPath expression with supplied parameters. This eliminates the need for caching (or rather, it enables the user to do the caching intelligently) which should give a performance benefit.&lt;/p&gt;
&lt;p&gt;The proposed design also makes dynamic XPath evaluation available in XPath and XQuery, and generally fits better into the new functional way of working.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

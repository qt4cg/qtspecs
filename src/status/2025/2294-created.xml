<item>
   <title>Issue #2294 created</title>
   <pubDate>2025-11-14T15:57:48Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2294</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2294</guid>
   <description>&lt;div&gt;&lt;p&gt;Type element(E, T)&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;In XPath ยง3.2.7.2 we say&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Where a [TypeName] is included in an [ElementTest] T, an element node will only match the test if it has been validated against a schema that defines type T; furthermore, T must be present in the [in-scope schema definitions] of the static context of the [ElementTest].&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This obviously doesn't apply where T is &lt;code&gt;xs:untyped&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And I don't think it applies where T is &lt;code&gt;xs:anyType&lt;/code&gt;. An untyped element matches &lt;code&gt;element(E, xs:anyType)&lt;/code&gt; by virtue of the fact that &lt;code&gt;xs:untyped&lt;/code&gt; is a subtype of &lt;code&gt;xs:anyType&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;I think the rules in XPath ยง3.3.2.5.3 say that &lt;code&gt;element(E)&lt;/code&gt; and &lt;code&gt;element(E, xs:anyType?)&lt;/code&gt; are essentially the same type (each is a subtype of the other). However, &lt;code&gt;element(E)&lt;/code&gt; and &lt;code&gt;element(E, xs:anyType)&lt;/code&gt; are NOT the same type, because the former allows the element to be nilled.&lt;/p&gt;
&lt;p&gt;In the XSLT rules for patterns (which is how I got here), &lt;code&gt;element(E)&lt;/code&gt;, &lt;code&gt;element(E, xs:anyType)&lt;/code&gt;, and &lt;code&gt;element(E, xs:anyType?)&lt;/code&gt; are all valid patterns, and their meaning is defined by reference to XPath item types. However,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;element(E)&lt;/code&gt; and &lt;code&gt;element(E, xs:anyType?)&lt;/code&gt; have different default priorities even though they match exactly the same nodes&lt;/li&gt;
&lt;li&gt;&lt;code&gt;element(E, xs:anyType)&lt;/code&gt; and &lt;code&gt;element(E, xs:anyType?)&lt;/code&gt; have the same default priority even though the first is a supertype of the second&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is all unchanged from XSLT 3.0&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

<item>
   <title>Issue #2034 created</title>
   <pubDate>2025-06-01T18:33:53Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2034</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2034</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:parse-xml, fn:doc: `safe` option&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;This issue replaces #1955.&lt;/p&gt;
&lt;p&gt;The first feedback that we got for the &lt;code&gt;entity-expansion-limit&lt;/code&gt; option indicates that our current solution is neither fish nor fowl (weder Fisch noch Fleisch?):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;With the initial suggestion in #1860, I hoped we could define sane defaults to prevent attacks caused by &lt;code&gt;fn:parse-xml&lt;/code&gt; and &lt;code&gt;fn:doc&lt;/code&gt;. This turned out to be difficult. Instead, we now have two specific options (allow-external-entities, entity-expansion-limit) that need to be explicitly assigned to make parsing safer.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In order to parse certain XML documents, like &lt;a href="https://dblp.org/xml/dblp.xml.gz"&gt;&lt;code&gt;dblp.xml.gz&lt;/code&gt;&lt;/a&gt;, more than one JDK 11 limit needs to be increased:&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;http://www.oracle.com/xml/jaxp/properties/entityExpansionLimit
http://www.oracle.com/xml/jaxp/properties/maxGeneralEntitySizeLimit
http://www.oracle.com/xml/jaxp/properties/totalEntitySizeLimit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As we have observed, XML parsing depends on the specific XML parsers. I believe it would be more user-friendly to replace the specific settings with a single option &lt;code&gt;safe&lt;/code&gt;, and to let the processor decide which properties are assigned:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;true&lt;/code&gt; (default): Avoid XXE and billion laughs attacks&lt;/li&gt;
&lt;li&gt;&lt;code&gt;false&lt;/code&gt;: disable safe parsing (increase limits, allow parsing of external resources)&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

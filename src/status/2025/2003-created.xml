<item>
   <title>Issue #2003 created</title>
   <pubDate>2025-05-15T16:08:37Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2003</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2003</guid>
   <description>&lt;div&gt;&lt;p&gt;Conditional entries in map constructors&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;If you're constructing a map using a map constructor, adding an entry conditionally can be a real pain, and typically involves a wholesale rewrite of the way the map is constructed. It would be nice to be able to mark an entry as optional so users don't have to resort to such wholesale rewrites.&lt;/p&gt;
&lt;p&gt;The difficulty of course is finding a nice syntax: one that is both intuitively readable and grammatically unambiguous.&lt;/p&gt;
&lt;p&gt;One possibility might be:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MapConstructorEntry  ::=  MapKeyExpr ":"  MapValueExpr "optional"?&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;with the semantics that if the "optional" keyword is present, and the result of evaluating MapValueExpr is an empty sequence, then the entry is omitted from the constructed map.&lt;/p&gt;
&lt;p&gt;A more ambitious construct might be&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MapConstructorEntry  ::=  MapKeyExpr ":"  MapValueExpr  ("when" MapEntryCondition)?&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;which adds the entry to the map only if the condition is true.&lt;/p&gt;
&lt;p&gt;For example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;let $map := {"height": string(@height), 
            "width": string(@width), 
            "weight": string(@weight) when exists(@weight)}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

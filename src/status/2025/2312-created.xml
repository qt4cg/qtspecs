<item>
   <title>Issue #2312 created</title>
   <pubDate>2025-11-23T08:18:58Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/2312</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-2312</guid>
   <description>&lt;div&gt;&lt;p&gt;Map/Array Filter: too much syntactic sugar?&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;Adopted from https://github.com/qt4cg/qtspecs/issues/2195#issuecomment-3426412436, and raised because of new user feedback:&lt;/p&gt;
&lt;p&gt;Now that we have dropped &lt;code&gt;map:pairs&lt;/code&gt;, the map filter expression is the only remaining that represents map entries as &lt;code&gt;record(key, value)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;For the sake of simplicity and usability, we could question if the alternative writings for both filtering maps and arrays are not sufficient:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;let $map := { 0: 1, 1: 2, 2: 4, 3: 8 }
let $filter := fn($k, $v) { $k = $v - 1 }
return (
  (: existing ways of filtering map entries :)
  map:filter($map, $filter),
  { for key $k value $v in $map where $filter($k, $v) return { $k: $v } },
  (: redundant? :)
  $map?[$filter(?key, ?value)]
)

let $array := [ (), 1, (2, 3), (4, 5, 6) ]
let $filter := fn($m) { count($m) &amp;gt; 1 }
return (
  (: existing ways of filtering array members :)
  array:filter($array, $filter),
  array:join(for member $m in $array where $filter($m) return [ $m ]),
  (: redundant? :)
  $array?[$filter(.)]
)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

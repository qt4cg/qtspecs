<item>
   <title>Issue #1997 created</title>
   <pubDate>2025-05-12T13:57:29Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1997</link>
   <guid>https://qt4cg.org/@qt4cg/2025/#created-1997</guid>
   <description>&lt;div&gt;&lt;p&gt;Coercion Rules: ยง3.4.1 rule 3(c)&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;This section reads:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If R is an [atomic type] and J is an [atomic item], then:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If J is an instance of R then it is used unchanged.&lt;/li&gt;
&lt;li&gt;If J is an instance of type xs:untypedAtomic then:
** If R is an [enumeration type] then A is cast to xs:string.
** If R is [namespace-sensitive] then a [type error] [[err:XPTY0117]] is raised.&lt;/li&gt;
&lt;li&gt;Otherwise, J is cast to type R.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;The last line (rule 3(c)) looks all wrong. If we just did a cast at this point then rules 4 and 5 would be unnecessary.&lt;/p&gt;
&lt;p&gt;It's not easy to trace the history, but I think it went wrong when the rules for choice/union types were refactored (around 2024-04-12). The line in question appears to have originally been under a conditional "if A is an instance of xs:untypedAtomic...".&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>

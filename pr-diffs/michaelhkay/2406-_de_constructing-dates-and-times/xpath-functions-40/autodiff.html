<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml" lang="EN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XPath and XQuery Functions and Operators 4.0 </title><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" type="text/css" href="css/w3c-base.css"><link rel="stylesheet" href="css/qtspecs.css"><link rel="stylesheet" href="css/xpath-functions-40.css"><script src="js/fo-datalist.js"></script><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css"></head><body class="toc-inline"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p><p>This draft contains only sections that have differences from the version that it modified.</p></div><div class="head"><p><a href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" height="48" width="72"></a></p><h1><a id="title"></a>XPath and XQuery Functions and Operators 4.0 </h1><h2><a id="w3c-doctype"></a>W3C Editor's Draft <span class="deltaxml-old" style="background:#FF5555">30&nbsp;January</span><span class="deltaxml-new" style="background:#90EE90">2&nbsp;February</span>&nbsp;2026</h2><dl><dt>This version:</dt><dd><a href="https://qt4cg.org/specifications/xpath-functions-40/">https://qt4cg.org/specifications/xpath-functions-40/</a></dd><dt>Latest version of XPath and XQuery Functions and Operators 4.0:</dt><dd><a href="https://qt4cg.org/specifications/xpath-functions-40/">https://qt4cg.org/specifications/xpath-functions-40/</a></dd><dt>Most recent Recommendation of XPath and XQuery Functions and Operators:</dt><dd><a href="https://www.w3.org/TR/2017/REC-xpath-functions-31-20170321/">https://www.w3.org/TR/2017/REC-xpath-functions-31-20170321/</a></dd><dt>Editor:</dt><dd>Michael Kay, Saxonica <a href="http://www.saxonica.com/">&lt;http://www.saxonica.com/&gt;</a></dd></dl><p>This document is also available in these non-normative formats: <a href="xpath-functions-40.xml">Specification in XML format</a> and&nbsp;<a href="function-catalog.xml">XML function catalog</a>.</p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2000&nbsp;<a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr></div><div><h2><a id="abstract"></a>Abstract</h2><p>This document defines constructor functions, operators, and functions on the datatypes defined in <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> and the datatypes defined in <a href="#xpath-datamodel-40">[XQuery and XPath Data Model (XDM) 4.0]</a>. It also defines functions and operators on nodes and node sequences as defined in the <a href="#xpath-datamodel-40">[XQuery and XPath Data Model (XDM) 4.0]</a>. These functions and operators are defined for use in <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a> and <a href="#xquery-40">[XQuery 4.0: An XML Query Language]</a> and <a href="#xslt-40">[XSL Transformations (XSLT) Version 4.0]</a> and other related XML standards. The signatures and summaries of functions defined in this document are available at: <a href="http://www.w3.org/2005/xpath-functions/">http://www.w3.org/2005/xpath-functions/</a>.</p><p>A summary of changes since version 3.1 is provided at <a href="#changelog"><b>H Changes since 3.1</b></a>.</p></div><div><h2><a id="status"></a>Status of this Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document.</em></p><p>This document is a working draft developed and maintained by a W3C Community Group, the <a href="https://www.w3.org/community/xslt-40/">XQuery and XSLT Extensions Community Group</a> unofficially known as QT4CG (where "QT" denotes Query and Transformation). This draft is work in progress and should not be considered either stable or complete. Standard W3C copyright and patent conditions apply.</p><p>The community group welcomes comments on the specification. Comments are best submitted as issues on the group's <a href="https://github.com/qt4cg/qtspecs/issues">GitHub repository</a>.</p><p id="at-risk">As the Community Group moves towards publishing dated, stable drafts, some features that the group thinks may likely be removed or substantially changed are marked “at risk” in their changes section. In this draft:</p><ul><li><a href="#func-array-members">array:members</a></li><li><a href="#func-array-of-members">array:of-members</a></li></ul><p>The community group maintains two extensive test suites, one oriented to XQuery and XPath, the other to XSLT. These can be found at <a href="https://github.com/qt4cg/qt4tests">qt4tests</a> and <a href="https://github.com/qt4cg/xslt40-test">xslt40-test</a> respectively. New tests, or suggestions for correcting existing tests, are welcome. The test suites include extensive metadata describing the conditions for applicability of each test case as well as the expected results. They do not include any test drivers for executing the tests: each implementation is expected to provide its own test driver.</p><div class="dedication" id="dedication"><h3>Dedication</h3><p>The publications of this community group <a href="../xquery-40/xpath-40.html#dedication">are dedicated</a> to our co-chair, Michael Sperberg-McQueen&nbsp;(1954–2024).</p></div></div><hr><div class="body"><div class="_diffs div1"><h2><a id="durations"></a>8 <a href="#durations" style="text-decoration: none">Processing durations</a></h2><p>Operators are defined on the following type:</p><ul><li><p><code>xs:duration</code></p></li></ul><p>and on the two defined subtypes (see <a href="#duration-subtypes"><b>8.1.1 Subtypes of duration</b></a>):</p><ul><li><p><code>xs:yearMonthDuration</code></p></li><li><p><code>xs:dayTimeDuration</code></p></li></ul><p>Arithmetic on durations is defined only on these subtypes: this is because the results of some operations (for example one month minus one day) have no representation in the value space.</p><p>Two <code>xs:duration</code> values may however be compared.</p><div class="_diffs div2"><h3><a id="duration-construction"></a>8.4 <a href="#duration-construction" style="text-decoration: none">Constructing durations</a></h3><p>This section decribes the <a href="#func-seconds"><code>fn:seconds</code></a> function, which constructs an <code>xs:dayTimeDuration</code> value representing a decimal number of seconds.</p><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-seconds"><code>fn:seconds</code></a></td><td>Returns an <code>xs:dayTimeDuration</code> whose length is a given number of seconds.</td></tr></tbody></table><div class="_diffs div3"><h4><a id="func-seconds"></a>8.4.1 <a href="#func-seconds" style="text-decoration: none">fn:seconds</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-build-dateTime">next</a> | <a href="#duration-conformance">previous</a>)</p><ol><li><p>New in 4.0<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/959">959</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/984">984</a>&nbsp;6 February 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns an <code>xs:dayTimeDuration</code> whose length is a given number of seconds.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:seconds</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:decimal?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:dayTimeDuration</code> value whose length in seconds is equal to <code>$value</code>. </p><p>If <code>$value</code> is negative then the result will be a negative duration.</p><p>For handling of overflow and underflow, see <a href="#duration-limits"><span style="display: none;" class="delete_version"><b>9.7.1 Limits and precision</b></span><span style="display: none;" class="add_version"><b>9.8.1 Limits and precision</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.7.1</span><span class="deltaxml-new" style="background:#90EE90">9.8.1</span> Limits and precision</b></span></a>.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>The result of <code>seconds($n)</code> is approximately equal to the result of the expression <code>xs:dayTimeDuration('PT1S') * $n</code>. The equivalence is only approximate, because <code>seconds($n)</code> uses the exact <code>xs:decimal</code> value supplied, whereas multiplying a duration by a number first converts the number to an <code>xs:double</code> value, which may lose precision.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds(1)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('PT1S')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds(0.001)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('PT0.001S')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds(60)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('PT1M')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds(86400)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('P1D')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds(-5400)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('-PT1H30M')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('1970-01-01T00:00:00Z') + 1706702400 * seconds(1)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2024-01-31T12:00:00Z')</pre></div><p><em>(The expression converts a Unix timestamp to an <code>xs:dateTime</code> value).</em></p></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">(
  xs:dateTime('2024-01-31T12:00:00Z') -
  xs:dateTime('1970-01-01T00:00:00Z')
) div seconds(1)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1706702400</pre></div><p><em>(The expression converts an <code>xs:dateTime</code> value to a Unix timestamp).</em></p></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div2"><h3><a id="duration-arithmetic"></a>8.5 <a href="#duration-arithmetic" style="text-decoration: none">Arithmetic operators on durations</a></h3><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-yearMonthDurations"><code>op:add-yearMonthDurations</code></a></td><td>Returns the result of adding two <code>xs:yearMonthDuration</code> values. </td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-yearMonthDurations"><code>op:subtract-yearMonthDurations</code></a></td><td>Returns the result of subtracting one <code>xs:yearMonthDuration</code> value from another. </td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-multiply-yearMonthDuration"><code>op:multiply-yearMonthDuration</code></a></td><td>Returns the result of multiplying <code>$arg1</code> by <code>$arg2</code>. The result is rounded to the nearest month.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-divide-yearMonthDuration"><code>op:divide-yearMonthDuration</code></a></td><td>Returns the result of dividing <code>$arg1</code> by <code>$arg2</code>. The result is rounded to the nearest month.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-divide-yearMonthDuration-by-yearMonthDuration"><code>op:divide-yearMonthDuration-by-yearMonthDuration</code></a></td><td>Returns the ratio of two <code>xs:yearMonthDuration</code> values.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-dayTimeDurations"><code>op:add-dayTimeDurations</code></a></td><td>Returns the sum of two <code>xs:dayTimeDuration</code> values.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dayTimeDurations"><code>op:subtract-dayTimeDurations</code></a></td><td>Returns the result of subtracting one <code>xs:dayTimeDuration</code> from another.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-multiply-dayTimeDuration"><code>op:multiply-dayTimeDuration</code></a></td><td>Returns the result of multiplying a <code>xs:dayTimeDuration</code> by a number.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-divide-dayTimeDuration"><code>op:divide-dayTimeDuration</code></a></td><td>Returns the result of multiplying a <code>xs:dayTimeDuration</code> by a number.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-divide-dayTimeDuration-by-dayTimeDuration"><code>op:divide-dayTimeDuration-by-dayTimeDuration</code></a></td><td>Returns the ratio of two <code>xs:dayTimeDuration</code> values, as a decimal number.</td></tr></tbody></table><p>For operators that combine a duration and a date/time value, see <a href="#dateTime-arithmetic"><span style="display: none;" class="delete_version"><b>9.7 Arithmetic operators on durations, dates and times</b></span><span style="display: none;" class="add_version"><b>9.8 Arithmetic operators on durations, dates and times</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.7</span><span class="deltaxml-new" style="background:#90EE90">9.8</span> Arithmetic operators on durations, dates and times</b></span></a>.</p><div class="_diffs div3"><h4><a id="func-multiply-yearMonthDuration"></a>8.5.3 <a href="#func-multiply-yearMonthDuration" style="text-decoration: none">op:multiply-yearMonthDuration</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the result of multiplying <code>$arg1</code> by <code>$arg2</code>. The result is rounded to the nearest month.</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>*</code> operator when applied to an <code>xs:yearMonthDuration</code> and a numeric value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:multiply-yearMonthDuration</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:double</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:yearMonthDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Rules</dt><dd><p>The result is the <code>xs:yearMonthDuration</code> whose length in months is equal to the result of applying the <a href="#func-round"><code>fn:round</code></a> function to the value obtained by multiplying the length in months of <code>$arg1</code> by the value of <code>$arg2</code>.</p><p><span style="display: none;" class="delete_version">If <code>$arg2</code> is positive or negative zero, the result is a zero-length duration. If <code>$arg2</code> is positive or negative infinity, the result overflows and is handled as described in <a href="#duration-limits"><span class="delete_version"><b>9.7.1 Limits and precision</b></span><span class="modify_version"><b>9.7.1 Limits and precision</b></span></a>. </span><span style="display: none;" class="add_version">If <code>$arg2</code> is positive or negative zero, the result is a zero-length duration. If <code>$arg2</code> is positive or negative infinity, the result overflows and is handled as described in <a href="#duration-limits"><span class="add_version"><b>9.8.1 Limits and precision</b></span><span class="modify_version"><b>9.8.1 Limits and precision</b></span></a>. </span><span class="modify_version">If <code>$arg2</code> is positive or negative zero, the result is a zero-length duration. If <code>$arg2</code> is positive or negative infinity, the result overflows and is handled as described in <a href="#duration-limits"><span style="display: none;" class="delete_version"><b>9.7.1 Limits and precision</b></span><span style="display: none;" class="add_version"><b>9.8.1 Limits and precision</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.7.1</span><span class="deltaxml-new" style="background:#90EE90">9.8.1</span> Limits and precision</b></span></a>. </span></p><p>For handling of overflow, underflow, and rounding, see <a href="#duration-conformance"><b>8.1.2 Limits and precision</b></a>.</p></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFOCA0005" title="err:FOCA0005">err:FOCA0005</a>] if <code>$arg2</code> is <code>NaN</code>.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>Either duration (and therefore the result) may be negative.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:multiply-yearMonthDuration(
  xs:yearMonthDuration("P2Y11M"),
  2.3
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:yearMonthDuration("P6Y9M")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-divide-yearMonthDuration"></a>8.5.4 <a href="#func-divide-yearMonthDuration" style="text-decoration: none">op:divide-yearMonthDuration</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the result of dividing <code>$arg1</code> by <code>$arg2</code>. The result is rounded to the nearest month.</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>div</code> operator when applied to an <code>xs:yearMonthDuration</code> and a numeric value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:divide-yearMonthDuration</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:double</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:yearMonthDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Rules</dt><dd><p>The result is the <code>xs:yearMonthDuration</code> whose length in months is equal to the result of applying the <a href="#func-round"><code>fn:round</code></a> function to the value obtained by dividing the length in months of <code>$arg1</code> by the value of <code>$arg2</code>.</p><p><span style="display: none;" class="delete_version">If <code>$arg2</code> is positive or negative infinity, the result is a zero-length duration. If <code>$arg2</code> is positive or negative zero, the result overflows and is handled as described in <a href="#duration-limits"><span class="delete_version"><b>9.7.1 Limits and precision</b></span><span class="modify_version"><b>9.7.1 Limits and precision</b></span></a>. </span><span style="display: none;" class="add_version">If <code>$arg2</code> is positive or negative infinity, the result is a zero-length duration. If <code>$arg2</code> is positive or negative zero, the result overflows and is handled as described in <a href="#duration-limits"><span class="add_version"><b>9.8.1 Limits and precision</b></span><span class="modify_version"><b>9.8.1 Limits and precision</b></span></a>. </span><span class="modify_version">If <code>$arg2</code> is positive or negative infinity, the result is a zero-length duration. If <code>$arg2</code> is positive or negative zero, the result overflows and is handled as described in <a href="#duration-limits"><span style="display: none;" class="delete_version"><b>9.7.1 Limits and precision</b></span><span style="display: none;" class="add_version"><b>9.8.1 Limits and precision</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.7.1</span><span class="deltaxml-new" style="background:#90EE90">9.8.1</span> Limits and precision</b></span></a>. </span></p><p>For handling of overflow, underflow, and rounding, see <a href="#duration-conformance"><b>8.1.2 Limits and precision</b></a>.</p></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFOCA0005" title="err:FOCA0005">err:FOCA0005</a>] if <code>$arg2</code> is <code>NaN</code>.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>Either operand (and therefore the result) may be negative.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:divide-yearMonthDuration(
  xs:yearMonthDuration("P2Y11M"),
  1.5
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:yearMonthDuration("P1Y11M")</pre></div></td></tr></tbody></table></div></dd></dl></div></div></div><div class="_diffs div1"><h2><a id="dates-times"></a>9 <a href="#dates-times" style="text-decoration: none">Processing dates and times</a></h2><p>This section defines operations on the <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> date and time types.</p><p> See <a href="#Working-With-Timezones">[Working With Timezones]</a> for a disquisition on working with date and time values with and without timezones. </p><div class="_diffs div2"><h3><a id="date-time-types"></a>9.1 <a href="#date-time-types" style="text-decoration: none">Date and time types</a></h3><p><span class="termdef"><a id="dt-gregorian"></a>[Definition] The eight primitive types <code>xs:dateTime</code>, <code>xs:date</code>, <code>xs:time</code>, <code>xs:gYearMonth</code>, <code>xs:gYear</code>, <code>xs:gMonthDay</code>, <code>xs:gMonth</code>, <code>xs:gDay</code> are referred to collectively as the <b>Gregorian</b> types.</span></p><p>This section describes operations on atomic items of these types.</p><p>Values of these types are modeled as comprising one or more of the seven components year, month, day, hour, minute, second, and timezone.</p><p>The only operations defined on <code>xs:gYearMonth</code>, <code>xs:gYear</code>, <code>xs:gMonthDay</code>, <code>xs:gMonth</code> and <code>xs:gDay</code> values are equality comparison and component extraction. For other types, further operations are provided, including order comparisons, arithmetic, formatted display, and timezone adjustment.</p><div class="_diffs div3"><h4><a id="date-time-duration-conformance"></a>9.1.1 <a href="#date-time-duration-conformance" style="text-decoration: none">Limits and precision</a></h4><p>All conforming processors <span class="verb">must</span> support year values in the range 1 to 9999, and a minimum fractional second precision of 1 millisecond or three digits (i.e., s.sss). However, processors <span class="verb">may</span> set larger <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on the maximum number of digits they support in these two situations. Processors <span class="verb">may</span> also choose to support the year 0 and years with negative values. The results of operations on dates that cross the year 0 are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>.</p><p><span style="display: none;" class="delete_version">A processor that limits the number of digits in date and time datatype representations may encounter overflow and underflow conditions when it tries to execute the functions in <a href="#dateTime-arithmetic"><span class="delete_version"><b>9.7 Arithmetic operators on durations, dates and times</b></span><span class="modify_version"><b>9.7 Arithmetic operators on durations, dates and times</b></span></a>. In these situations, the processor <span class="verb">must</span> return 00:00:00 in case of time underflow. It <span class="verb">must</span> raise a dynamic error [<a href="#ERRFODT0001" title="err:FODT0001">err:FODT0001</a>] in case of overflow.</span><span style="display: none;" class="add_version">A processor that limits the number of digits in date and time datatype representations may encounter overflow and underflow conditions when it tries to execute the functions in <a href="#dateTime-arithmetic"><span class="add_version"><b>9.8 Arithmetic operators on durations, dates and times</b></span><span class="modify_version"><b>9.8 Arithmetic operators on durations, dates and times</b></span></a>. In these situations, the processor <span class="verb">must</span> return 00:00:00 in case of time underflow. It <span class="verb">must</span> raise a dynamic error [<a href="#ERRFODT0001" title="err:FODT0001">err:FODT0001</a>] in case of overflow.</span><span class="modify_version">A processor that limits the number of digits in date and time datatype representations may encounter overflow and underflow conditions when it tries to execute the functions in <a href="#dateTime-arithmetic"><span style="display: none;" class="delete_version"><b>9.7 Arithmetic operators on durations, dates and times</b></span><span style="display: none;" class="add_version"><b>9.8 Arithmetic operators on durations, dates and times</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.7</span><span class="deltaxml-new" style="background:#90EE90">9.8</span> Arithmetic operators on durations, dates and times</b></span></a>. In these situations, the processor <span class="verb">must</span> return 00:00:00 in case of time underflow. It <span class="verb">must</span> raise a dynamic error [<a href="#ERRFODT0001" title="err:FODT0001">err:FODT0001</a>] in case of overflow.</span></p><p>Similarly, a processor that limits the precision of the seconds component of date and time or duration values may need to deliver a rounded result for arithmetic operations. Such a processor <span class="verb">must</span> deliver a result that is as close as possible to the mathematically precise result, given these limits: if two values are equally close, the one that is chosen is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>.</p></div></div><div class="_diffs div2"><h3><a id="dateTime-record"></a><span class="deltaxml-new" style="background:#90EE90">9.3 </span><a href="#dateTime-record" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">Record fn:dateTime-record</span></a></h3><p><span class="deltaxml-new" style="background:#90EE90">This record type is used to represent the components of a value of type </span><code><span class="deltaxml-new" style="background:#90EE90">xs:dateTime</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:date</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:time</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gYear</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gYearMonth</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gMonth</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gMonthDay</span></code><span class="deltaxml-new" style="background:#90EE90">, or </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gDay</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><table class="fos-options"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Name</span></th><th><span class="deltaxml-new" style="background:#90EE90">Meaning</span></th></tr></thead><tbody><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">year?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">year</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range is implementation-defined.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">month?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">month</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range 1 to 12 inclusive.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">day?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">day</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range 1 to 31 inclusive.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">hours?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">hours</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range 0 to 23 inclusive.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">minutes?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">minutes</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range 0 to 59 inclusive.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">seconds?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code><span class="deltaxml-new" style="background:#90EE90">seconds</span></code><span class="deltaxml-new" style="background:#90EE90"> component. Range 0 (inclusive) to 60 (exclusive).</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:decimal</span></code></p></li></ul></td></tr><tr><td><p><code><span class="deltaxml-new" style="background:#90EE90">timezone?</span></code></p></td><td class="fos-thin"><p><span class="deltaxml-new" style="background:#90EE90">The timezone offset, if the value has a timezone.</span></p><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:dayTimeDuration</span></code></p></li></ul></td></tr></tbody></table></div><div class="_diffs div2"><h3><a id="constructing-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.3</span><span class="deltaxml-new" style="background:#90EE90">9.4</span> <a href="#constructing-dateTime" style="text-decoration: none">Constructing a dateTime</a></h3><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-dateTime"><code>fn:dateTime</code></a></td><td>Returns an <code>xs:dateTime</code> value created by combining an <code>xs:date</code> and an <code>xs:time</code>.</td></tr><tr class="add_version" style="display: none;"><td style="white-space:nowrap; vertical-align:top"><a href="#func-build-dateTime"><code>fn:build-dateTime</code></a></td><td>Constructs a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value from the values of its components.</td></tr><tr class="modify_version"><td style="white-space:nowrap; vertical-align:top"><a href="#func-build-dateTime"><code><span class="deltaxml-new" style="background:#90EE90">fn:build-dateTime</span></code></a></td><td><span class="deltaxml-new" style="background:#90EE90">Constructs a </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value from the values of its components.</span></td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-unix-dateTime"><code>fn:unix-dateTime</code></a></td><td>Returns a dateTime value for a Unix time.</td></tr></tbody></table><div class="_diffs div3"><h4><a id="func-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.3.1</span><span class="deltaxml-new" style="background:#90EE90">9.4.1</span> <a href="#func-dateTime" style="text-decoration: none">fn:dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns an <code>xs:dateTime</code> value created by combining an <code>xs:date</code> and an <code>xs:time</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:dateTime</code>(</td></tr><tr class="arg"><td><code>$date</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$time</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If either <code>$date</code> or <code>$time</code> is the empty sequence the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:dateTime</code> whose date component is equal to <code>$date</code> and whose time component is equal to <code>$time</code>.</p><p>The timezone of the result is computed as follows:</p><ul><li><p>If neither argument has a timezone, the result has no timezone.</p></li><li><p>If exactly one of the arguments has a timezone, or if both arguments have the same timezone, the result has this timezone.</p></li></ul></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFORG0008" title="err:FORG0008">err:FORG0008</a>] if the two arguments both have timezones and the timezones are different. </p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">dateTime(
  xs:date("1999-12-31"),
  xs:time("12:00:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("1999-12-31T12:00:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">dateTime(
  xs:date("1999-12-31"),
  xs:time("24:00:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("1999-12-31T00:00:00")</pre></div><p><em>(This is because <code>"24:00:00"</code> is an alternate lexical form for <code>"00:00:00"</code>).</em></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-build-dateTime"></a><span class="deltaxml-new" style="background:#90EE90">9.4.2 </span><a href="#func-build-dateTime" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">fn:build-dateTime</span></a></h4><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90"> Changes in 4.0 (</span><a href="#func-unix-dateTime"><span class="deltaxml-new" style="background:#90EE90">next</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><a href="#func-seconds"><span class="deltaxml-new" style="background:#90EE90">previous</span></a><span class="deltaxml-new" style="background:#90EE90">)</span></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p></li></ol></div><dl><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Summary</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Constructs a </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value from the values of its components.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Signature</span></dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">fn:build-dateTime</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code><a href="#dateTime-record"><span class="deltaxml-new" style="background:#90EE90">dateTime-record</span></a><span class="deltaxml-new" style="background:#90EE90">?</span></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-new" style="background:#90EE90">(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</span></code></code></td></tr></tbody></table></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Properties</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">This function is </span><a title="deterministic" class="termref" href="#dt-deterministic"><span class="deltaxml-new" style="background:#90EE90">deterministic</span></a><span class="deltaxml-new" style="background:#90EE90">, </span><a title="context-independent" class="termref" href="#dt-context-independent"><span class="deltaxml-new" style="background:#90EE90">context-independent</span></a><span class="deltaxml-new" style="background:#90EE90">, and </span><a title="focus-dependent" class="termref" href="#dt-focus-independent"><span class="deltaxml-new" style="background:#90EE90">focus-independent</span></a><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Rules</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns the empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns a </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value based on the supplied component values. The result will be the </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value </span><code><span class="deltaxml-new" style="background:#90EE90">$R</span></code><span class="deltaxml-new" style="background:#90EE90"> such that </span><code><span class="deltaxml-new" style="background:#90EE90">deep-equal( $significant(parts-of-dateTime($R)), $significant($value) )</span></code><span class="deltaxml-new" style="background:#90EE90">, where </span><code><span class="deltaxml-new" style="background:#90EE90">$significant</span></code><span class="deltaxml-new" style="background:#90EE90"> is the function </span><code><span class="deltaxml-new" style="background:#90EE90">map:filter(?, fn($K, $V){$K eq "timezone" or exists($V)})</span></code><span class="deltaxml-new" style="background:#90EE90">, that is, a function that discards entries in a map whose value is the empty sequence, other than the entry with key </span><code><span class="deltaxml-new" style="background:#90EE90">"timezone"</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If all seven components are present (year, month, day, hours, minutes, seconds, and timezone) then the result will be of type </span><code><span class="deltaxml-new" style="background:#90EE90">xs:dateTimeStamp</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Error Conditions</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">A dynamic error is raised [</span><a href="#ERRFODT0005" title="err:FODT0005"><span class="deltaxml-new" style="background:#90EE90">err:FODT0005</span></a><span class="deltaxml-new" style="background:#90EE90">] if the set of fields that are present and non-empty in </span><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code><span class="deltaxml-new" style="background:#90EE90"> is not one of the sets:</span></p><ul><li><p><span class="deltaxml-new" style="background:#90EE90">year, month, day, hours, minutes, seconds, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:dateTime</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">year, month, day, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:date</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">year, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gYear</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">year, month, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gYearMonth</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">month, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gMonth</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">month, day, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gMonthDay</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">day, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:gDay</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">hours, minutes, seconds, and optional timezone (delivering an </span><code><span class="deltaxml-new" style="background:#90EE90">xs:time</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></li></ul><p><span class="deltaxml-new" style="background:#90EE90">A dynamic error is raised [</span><a href="#ERRFODT0006" title="err:FODT0006"><span class="deltaxml-new" style="background:#90EE90">err:FODT0006</span></a><span class="deltaxml-new" style="background:#90EE90">] if any of the components in </span><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code><span class="deltaxml-new" style="background:#90EE90"> is outside the permitted range (for example if the value of the </span><code><span class="deltaxml-new" style="background:#90EE90">minutes</span></code><span class="deltaxml-new" style="background:#90EE90"> component is less than zero or greater than 59), or if the combinatioun of fields is not a valid date/time (for example, if </span><code><span class="deltaxml-new" style="background:#90EE90">month</span></code><span class="deltaxml-new" style="background:#90EE90"> is 4 and </span><code><span class="deltaxml-new" style="background:#90EE90">day&gt;</span></code><span class="deltaxml-new" style="background:#90EE90"> is 31).</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Notes</span></dt><dd><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">Components that are present in </span><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code><span class="deltaxml-new" style="background:#90EE90"> but with an empty value are treated as if they were absent.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Midnight must be expressed with the </span><code><span class="deltaxml-new" style="background:#90EE90">hours</span></code><span class="deltaxml-new" style="background:#90EE90"> value set to zero, not 24.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">build-dateTime({ "year": 1999, "month": 5, "day": 31, 
  "hours": 13, "minutes": 20, "seconds": 0, 
  "timezone": xs:dayTimeDuration("-PT5H")})</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">xs:dateTime("1999-05-31T13:20:00-05:00")</span></pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">build-dateTime({"hours": 13, "minutes": 30, "seconds": 4.2678})</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">xs:time("13:30:04.2678")</span></pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">build-dateTime({ "year": 2007, "month": 5, 
                     "timezone": xs:dayTimeDuration("PT0S")})</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">xs:gYearMonth("2007-05Z")</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-unix-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.3.2</span><span class="deltaxml-new" style="background:#90EE90">9.4.3</span> <a href="#func-unix-dateTime" style="text-decoration: none">fn:unix-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-year-from-dateTime">next</a> | <a href="#func-build-dateTime">previous</a>)</p><ol><li><p>New in 4.0<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/959">959</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1358">1358</a>&nbsp;1 August 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns a dateTime value for a Unix time.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:unix-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:nonNegativeInteger?</code></code></td><td><code class="assign">:=&nbsp;</code><code>0</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTimeStamp</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns a dateTime value in UTC timezone for the Unix time specified by <code>$value</code> in milliseconds. If the value is absent or an empty sequence, <code>0</code> is used. The Unix time is defined in <a href="#ieee1003.1-2024">[IEEE 1003.1-2024]</a>.</p><p>If the implementation supports data types from XSD 1.1 then the returned value will be an instance of <code>xs:dateTimeStamp</code>. Otherwise, the only guarantees are that it will be an instance of <code>xs:dateTime</code> and will have a timezone component.</p></dd><dt class="label">Formal Equivalent</dt><dd><p>The effect of the function is equivalent to the result of the following XPath expression.</p><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('1970-01-01T00:00:00Z') + ($value otherwise 0) * seconds(0.001)</pre></div></dd><dt class="label">Notes</dt><dd><div class="note"><p>By calling this convenience function, it can be ensured that the correct timezone is used for computing the Unix time.</p><p>Note that Unix time does not account for leap seconds. It assumes that every day has 86,400 seconds.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">unix-dateTime()</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('1970-01-01T00:00:00Z')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">unix-dateTime(1)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('1970-01-01T00:00:00.001Z')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">unix-dateTime(86400000)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('1970-01-02T00:00:00Z')</pre></div></td></tr><tr><td colspan="2"><p>Calculate the Unix time associated with a <code>xs:dateTime</code> value:</p></td></tr><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">let $value := current-dateTime()
return ($value - unix-dateTime()) div seconds(0.001)</pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div2"><h3><a id="comp.datetime"></a><span class="deltaxml-old" style="background:#FF5555">9.4</span><span class="deltaxml-new" style="background:#90EE90">9.5</span> <a href="#comp.datetime" style="text-decoration: none">Comparing date and time values</a></h3><p>Date and time values can be compared using the function <a href="#func-compare"><code>fn:compare</code></a>.</p><p><a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> states that the order relation on date and time datatypes is not a total order but a partial order because these datatypes may or may not have a timezone. This is handled as follows. If either operand to a comparison function on date or time values does not have an (explicit) timezone then, for the purpose of the operation, an implicit timezone, provided by the dynamic context <a href="https://www.w3.org/TR/xpath-31/#id-xp-evaluation-context-components"> C.2 Dynamic Context Components </a><sup><small>XP31</small></sup>, is assumed to be present as part of the value. This creates a total order for all date and time values.</p><p>An <code>xs:dateTime</code> can be considered to consist of seven components: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, <code>minute</code>, <code>second</code> and <code>timezone</code>. For <code>xs:dateTime</code> six components (<code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, <code>minute</code> and <code>second</code>) are required and <code>timezone</code> is optional. For other date/time values, of the first six components, some are required and others must be <a href="https://www.w3.org/TR/xpath-datamodel-31/#dt-absent">absent</a><sup><small>DM31</small></sup>. <code>Timezone</code> is always optional. For example, for <code>xs:date</code>, the <code>year</code>, <code>month</code> and <code>day</code> components are required and <code>hour</code>, <code>minute</code> and <code>second</code> components must be absent; for <code>xs:time</code> the <code>hour</code>, <code>minute</code> and <code>second</code> components are required and <code>year</code>, <code>month</code> and <code>day</code> are missing; for <code>xs:gDay</code>, <code>day</code> is required and <code>year</code>, <code>month</code>, <code>hour</code>, <code>minute</code> and <code>second</code> are missing.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>In <a href="#xmlschema11-2">[XSD 1.1 Part 2]</a>, a new <code>explicitTimezone</code> facet is available with values <code>optional</code>, <code>required</code>, or <code>prohibited</code> to enable the timezone to be defined as mandatory or disallowed.</p></div><p>Values of the date/time datatypes <code>xs:time</code>, <code>xs:gMonthDay</code>, <code>xs:gMonth</code>, and <code>xs:gDay</code>, can be considered to represent a sequence of recurring time instants or time periods. An <code>xs:time</code> occurs every day. An <code>xs:gMonth</code> occurs every year. Comparison operators on these datatypes compare the starting instants of equivalent occurrences in the recurring series. These <code>xs:dateTime</code> values are calculated as described below.</p><p>Comparison operators on <code>xs:date</code>, <code>xs:gYearMonth</code> and <code>xs:gYear</code> compare their starting instants. These <code>xs:dateTime</code> values are calculated as described below.</p><p>The starting instant of an occurrence of a date/time value is an <code>xs:dateTime</code> calculated by filling in the missing components of the local value from a reference <code>xs:dateTime</code>. An example of a suitable reference <code>xs:dateTime</code> is <code>1972-01-01T00:00:00</code>. Then, for example, the starting instant corresponding to the <code>xs:date</code> value <code>2009-03-12</code> is <code>2009-03-12T00:00:00</code>; the starting instant corresponding to the <code>xs:time</code> value <code>13:30:02</code> is <code>1972-01-01T13:30:02</code>; and the starting instant corresponding to the <code>gMonthDay</code> value <code>--02-29</code> is <code>1972-02-29T00:00:00</code> (which explains why a leap year was chosen for the reference).</p><div class="note"><p class="prefix"><b>Note:</b></p><p>In the previous version of this specification, the reference date/time chosen was <code>1972-12-31T00:00:00</code>. While this gives the same results, it produces a "starting instant" for a <code>gMonth</code> or <code>gMonthDay</code> that bears no relation to the ordinary meaning of the term, and it also required special handling of short months. The original choice was made to allow for leap seconds; but since leap seconds are not recognized in date/time arithmetic, this is not actually necessary.</p></div><p>If the <code>xs:time</code> value written as <code>24:00:00</code> is to be compared, filling in the missing components gives <code>1972-01-01T00:00:00</code>, because <code>24:00:00</code> is an alternative representation of <code>00:00:00</code> (the lexical value <code>"24:00:00"</code> is converted to the time components { 0, 0, 0 } before the missing components are filled in). This has the consequence that when ordering <code>xs:time</code> values, <code>24:00:00</code> is considered to be earlier than <code>23:59:59</code>. However, when ordering <code>xs:dateTime</code> values, a time component of <code>24:00:00</code> is considered equivalent to <code>00:00:00</code> on the following day.</p><p>Note that the reference <code>xs:dateTime</code> does not have a timezone. The <code>timezone</code> component is never filled in from the reference <code>xs:dateTime</code>. In some cases, if the date/time value does not have a timezone, the implicit timezone from the dynamic context is used as the timezone.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>This specification uses the reference <code>xs:dateTime 1972-01-01T00:00:00</code> in the description of the comparison operators. Implementations may use other reference <code>xs:dateTime</code> values as long as they yield the same results. The reference <code>xs:dateTime</code> used must meet the following constraints: when it is used to supply components into <code>xs:gMonthDay</code> values, the year must allow for February 29 and so must be a leap year; when it is used to supply missing components into <code>xs:gDay</code> values, the month must allow for 31 days. Different reference <code>xs:dateTime</code> values may be used for different operators.</p></div></div><div class="_diffs div2"><h3><a id="component-extraction-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5</span><span class="deltaxml-new" style="background:#90EE90">9.6</span> <a href="#component-extraction-dateTime" style="text-decoration: none">Extracting components of dates and times</a></h3><p>The date and time datatypes may be considered to be composite datatypes in that they contain distinct properties or components. The extraction functions specified below extract a single component from a date or time value. In all cases the local value (that is, the original value as written, without any timezone adjustment) is used. </p><div class="note"><p class="prefix"><b>Note:</b></p><p>A time written as <code>24:00:00</code> is treated as <code>00:00:00</code> on the following day.</p></div><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-year-from-dateTime"><code>fn:year-from-dateTime</code></a></td><td>Returns the year component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-month-from-dateTime"><code>fn:month-from-dateTime</code></a></td><td>Returns the month component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-day-from-dateTime"><code>fn:day-from-dateTime</code></a></td><td>Returns the day component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-hours-from-dateTime"><code>fn:hours-from-dateTime</code></a></td><td>Returns the hours component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-minutes-from-dateTime"><code>fn:minutes-from-dateTime</code></a></td><td>Returns the minute component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-seconds-from-dateTime"><code>fn:seconds-from-dateTime</code></a></td><td>Returns the seconds component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-timezone-from-dateTime"><code>fn:timezone-from-dateTime</code></a></td><td>Returns the timezone component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-year-from-date"><code>fn:year-from-date</code></a></td><td>Returns the year component of an <code>xs:date</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-month-from-date"><code>fn:month-from-date</code></a></td><td>Returns the month component of an <code>xs:date</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-day-from-date"><code>fn:day-from-date</code></a></td><td>Returns the day component of an <code>xs:date</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-timezone-from-date"><code>fn:timezone-from-date</code></a></td><td>Returns the timezone component of an <code>xs:date</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-hours-from-time"><code>fn:hours-from-time</code></a></td><td>Returns the hours component of an <code>xs:time</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-minutes-from-time"><code>fn:minutes-from-time</code></a></td><td>Returns the minutes component of an <code>xs:time</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-seconds-from-time"><code>fn:seconds-from-time</code></a></td><td>Returns the seconds component of an <code>xs:time</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-timezone-from-time"><code>fn:timezone-from-time</code></a></td><td>Returns the timezone component of an <code>xs:time</code>.</td></tr><tr class="add_version" style="display: none;"><td style="white-space:nowrap; vertical-align:top"><a href="#func-parts-of-dateTime"><code>fn:parts-of-dateTime</code></a></td><td>Returns all the components of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</td></tr><tr class="modify_version"><td style="white-space:nowrap; vertical-align:top"><a href="#func-parts-of-dateTime"><code><span class="deltaxml-new" style="background:#90EE90">fn:parts-of-dateTime</span></code></a></td><td><span class="deltaxml-new" style="background:#90EE90">Returns all the components of a </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value.</span></td></tr></tbody></table><div class="_diffs div3"><h4><a id="func-year-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.1</span><span class="deltaxml-new" style="background:#90EE90">9.6.1</span> <a href="#func-year-from-dateTime" style="text-decoration: none">fn:year-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-month-from-dateTime">next</a> | <a href="#func-unix-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other Gregorian types such as <code>xs:gYearMonth</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the year component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:year-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if the <code>year</code> component is absent, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> representing the year component in <code>$value</code>. The result may be negative.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>Ignoring complications that arise with midnight on the last day of the year, the year returned is the same numeric value that appears in the lexical representation, which for negative years means the meaning may vary depending on whether XSD 1.0 or XSD 1.1 conventions are in use.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1999</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:dateTime("1999-05-31T21:30:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1999</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:dateTime("1999-12-31T19:20:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1999</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:dateTime("1999-12-31T24:00:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">2000</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:dateTime("-0002-06-06T00:00:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">-2</pre></div><p><em>(The result is the same whether XSD 1.0 or 1.1 is in use, despite the absence of a year 0 in the XSD 1.0 value space.)</em></p></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">2007</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-month-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.2</span><span class="deltaxml-new" style="background:#90EE90">9.6.2</span> <a href="#func-month-from-dateTime" style="text-decoration: none">fn:month-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-day-from-dateTime">next</a> | <a href="#func-year-from-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other Gregorian types such as <code>xs:gYearMonth</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the month component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:month-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if it contains no <code>month</code> component, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>1</code> and <code>12</code>, both inclusive, representing the month component in <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">5</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-dateTime(
  xs:dateTime("1999-12-31T19:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">12</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">month-from-dateTime(
  adjust-dateTime-to-timezone(
    xs:dateTime("1999-12-31T19:20:00-05:00"),
    xs:dayTimeDuration("PT0S")
  )
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">5</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-day-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.3</span><span class="deltaxml-new" style="background:#90EE90">9.6.3</span> <a href="#func-day-from-dateTime" style="text-decoration: none">fn:day-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-hours-from-dateTime">next</a> | <a href="#func-month-from-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other Gregorian types such as <code>xs:gMonthDay</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the day component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:day-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if it contains no <code>day</code> component, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>1</code> and <code>31</code>, both inclusive, representing the day component in the local value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">31</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-dateTime(
  xs:dateTime("1999-12-31T20:00:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">31</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">day-from-dateTime(
  adjust-dateTime-to-timezone(
    xs:dateTime("1999-12-31T19:20:00-05:00"),
    xs:dayTimeDuration("PT0S")
  )
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-dateTime(
  xs:gMonthDay("--05-31Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">31</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-hours-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.4</span><span class="deltaxml-new" style="background:#90EE90">9.6.4</span> <a href="#func-hours-from-dateTime" style="text-decoration: none">fn:hours-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-minutes-from-dateTime">next</a> | <a href="#func-day-from-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other types including <code>xs:time</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the hours component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:hours-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if it contains no <code>hours</code> component, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>0</code> and <code>23</code>, both inclusive, representing the hours component in <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:dateTime("1999-05-31T08:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">8</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:dateTime("1999-12-31T21:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">21</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">hours-from-dateTime(
  adjust-dateTime-to-timezone(
    xs:dateTime("1999-12-31T21:20:00-05:00"),
    xs:dayTimeDuration("PT0S")
  )
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">2</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:dateTime("1999-12-31T12:00:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">12</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:dateTime("1999-12-31T24:00:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">0</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">hours-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">12</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-minutes-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.5</span><span class="deltaxml-new" style="background:#90EE90">9.6.5</span> <a href="#func-minutes-from-dateTime" style="text-decoration: none">fn:minutes-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-timezone-from-dateTime">next</a> | <a href="#func-hours-from-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other types including <code>xs:time</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the minute component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:minutes-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if it contains no <code>minutes</code> component, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> value between <code>0</code> and <code>59</code>, both inclusive, representing the minute component in the local value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">minutes-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">20</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">minutes-from-dateTime(
  xs:dateTime("1999-05-31T13:30:00+05:30")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">30</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">minutes-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">minutes-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">30</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-seconds-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.6</span><span class="deltaxml-new" style="background:#90EE90">9.6.6</span> <a href="#func-seconds-from-dateTime" style="text-decoration: none">fn:seconds-from-dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the seconds component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:seconds-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:decimal?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, or if it contains no <code>seconds</code> component, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:decimal</code> value greater than or equal to zero and less than 60, representing the seconds and fractional seconds in <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">0</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">seconds-from-dateTime(
  xs:time("12:30:14.5")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">14.5</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-timezone-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.5.7</span><span class="deltaxml-new" style="background:#90EE90">9.6.7</span> <a href="#func-timezone-from-dateTime" style="text-decoration: none">fn:timezone-from-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-parts-of-dateTime">next</a> | <a href="#func-minutes-from-dateTime">previous</a>)</p><ol><li><p>The function has been extended to handle other types such as <code>xs:gYearMonth</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1448">1448</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481</a>&nbsp;8 October 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the timezone component of a <a title="Gregorian" class="termref" href="#dt-gregorian">Gregorian</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:timezone-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns the timezone component of <code>$value</code>, if any. If <code>$value</code> has a timezone component, then the result is an <code>xs:dayTimeDuration</code> that indicates deviation from UTC; its value may range from +14:00 to -14:00 hours, both inclusive. If <code>$value</code> has no timezone component, the result is the empty sequence.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("-PT5H")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-dateTime(
  xs:dateTime("2000-06-12T13:20:00Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("PT0S")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-dateTime(
  xs:dateTime("2004-08-27T00:00:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-dateTime(
  xs:gYearMonth("2007-05Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("PT0S")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-dateTime(
  xs:time("12:30:00")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-year-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.5.8</span><span class="deltaxml-new" style="background:#90EE90">9.6.8</span> <a href="#func-year-from-date" style="text-decoration: none">fn:year-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the year component of an <code>xs:date</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:year-from-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> representing the year in the local value of <code>$value</code>. The value may be negative. </p></dd><dt class="label">Notes</dt><dd><div class="note"><p>The year returned is the same numeric value that appears in the lexical representation, which for negative years means the meaning may vary depending on whether XSD 1.0 or XSD 1.1 conventions are in use.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-date(
  xs:date("1999-05-31")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1999</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-date(
  xs:date("2000-01-01+05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">2000</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">year-from-date(
  xs:date("-0002-06-01")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">-2</pre></div><p><em>(The result is the same whether XSD 1.0 or 1.1 is in use, despite the absence of a year 0 in the XSD 1.0 value space.)</em></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-month-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.5.9</span><span class="deltaxml-new" style="background:#90EE90">9.6.9</span> <a href="#func-month-from-date" style="text-decoration: none">fn:month-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the month component of an <code>xs:date</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:month-from-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>1</code> and <code>12</code>, both inclusive, representing the month component in the local value of <code>$value</code>. </p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-date(
  xs:date("1999-05-31-05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">5</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">month-from-date(
  xs:date("2000-01-01+05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-day-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.5.10</span><span class="deltaxml-new" style="background:#90EE90">9.6.10</span> <a href="#func-day-from-date" style="text-decoration: none">fn:day-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the day component of an <code>xs:date</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:day-from-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>1</code> and <code>31</code>, both inclusive, representing the day component in the localized value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-date(
  xs:date("1999-05-31-05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">31</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">day-from-date(
  xs:date("2000-01-01+05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-timezone-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.5.11</span><span class="deltaxml-new" style="background:#90EE90">9.6.11</span> <a href="#func-timezone-from-date" style="text-decoration: none">fn:timezone-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the timezone component of an <code>xs:date</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:timezone-from-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns the timezone component of <code>$value</code>, if any. If <code>$value</code> has a timezone component, then the result is an <code>xs:dayTimeDuration</code> that indicates deviation from UTC; its value may range from +14:00 to -14:00 hours, both inclusive. If <code>$value</code> has no timezone component, the result is the empty sequence.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-date(
  xs:date("1999-05-31-05:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("-PT5H")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">timezone-from-date(
  xs:date("2000-06-12Z")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("PT0S")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-hours-from-time"></a><span class="deltaxml-old" style="background:#FF5555">9.5.12</span><span class="deltaxml-new" style="background:#90EE90">9.6.12</span> <a href="#func-hours-from-time" style="text-decoration: none">fn:hours-from-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the hours component of an <code>xs:time</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:hours-from-time</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> between <code>0</code> and <code>23</code>, both inclusive, representing the value of the hours component in the local value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td colspan="2"><p>Assume that the dynamic context provides an implicit timezone value of <code>-05:00</code>. </p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>hours-from-time(xs:time("11:23:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>11</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>hours-from-time(xs:time("21:23:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>21</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>hours-from-time(xs:time("01:23:00+05:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>1</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">hours-from-time(
  adjust-time-to-timezone(
    xs:time("01:23:00+05:00"),
    xs:dayTimeDuration("PT0S")
  )
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">20</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>hours-from-time(xs:time("24:00:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>0</code></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-minutes-from-time"></a><span class="deltaxml-old" style="background:#FF5555">9.5.13</span><span class="deltaxml-new" style="background:#90EE90">9.6.13</span> <a href="#func-minutes-from-time" style="text-decoration: none">fn:minutes-from-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the minutes component of an <code>xs:time</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:minutes-from-time</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:integer</code> value between <code>0</code> and <code>59</code>, both inclusive, representing the value of the minutes component in the local value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>minutes-from-time(xs:time("13:00:00Z"))</code></pre></div></td><td style="vertical-align:top"><p><code>0</code></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-seconds-from-time"></a><span class="deltaxml-old" style="background:#FF5555">9.5.14</span><span class="deltaxml-new" style="background:#90EE90">9.6.14</span> <a href="#func-seconds-from-time" style="text-decoration: none">fn:seconds-from-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the seconds component of an <code>xs:time</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:seconds-from-time</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:decimal?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns an <code>xs:decimal</code> value greater than or equal to zero and less than 60, representing the seconds and fractional seconds in the local value of <code>$value</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>seconds-from-time(xs:time("13:20:10.5"))</code></pre></div></td><td style="vertical-align:top"><p><code>10.5</code></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-timezone-from-time"></a><span class="deltaxml-old" style="background:#FF5555">9.5.15</span><span class="deltaxml-new" style="background:#90EE90">9.6.15</span> <a href="#func-timezone-from-time" style="text-decoration: none">fn:timezone-from-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the timezone component of an <code>xs:time</code>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:timezone-from-time</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Otherwise, the function returns the timezone component of <code>$value</code>, if any. If <code>$value</code> has a timezone component, then the result is an <code>xs:dayTimeDuration</code> that indicates deviation from UTC; its value may range from +14:00 to -14:00 hours, both inclusive. If <code>$value</code> has no timezone component, the result is the empty sequence.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>timezone-from-time(xs:time("13:20:00-05:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dayTimeDuration("-PT5H")</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>timezone-from-time(xs:time("13:20:00"))</code></pre></div></td><td style="vertical-align:top"><p><code>()</code></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-parts-of-dateTime"></a><span class="deltaxml-new" style="background:#90EE90">9.6.16 </span><a href="#func-parts-of-dateTime" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">fn:parts-of-dateTime</span></a></h4><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90"> Changes in 4.0 (</span><a href="#func-civil-timezone"><span class="deltaxml-new" style="background:#90EE90">next</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><a href="#func-timezone-from-dateTime"><span class="deltaxml-new" style="background:#90EE90">previous</span></a><span class="deltaxml-new" style="background:#90EE90">)</span></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p></li></ol></div><dl><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Summary</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Returns all the components of a </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> value.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Signature</span></dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">fn:parts-of-dateTime</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">(xs:dateTime | xs:date | xs:time | xs:gYear | xs:gYearMonth | xs:gMonth | xs:gMonthDay | xs:gDay)?</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="return-type-ref"><a href="#dateTime-record"><span class="deltaxml-new" style="background:#90EE90">dateTime-record</span></a><span class="deltaxml-new" style="background:#90EE90">?</span></code></td></tr></tbody></table></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Properties</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">This function is </span><a title="deterministic" class="termref" href="#dt-deterministic"><span class="deltaxml-new" style="background:#90EE90">deterministic</span></a><span class="deltaxml-new" style="background:#90EE90">, </span><a title="context-independent" class="termref" href="#dt-context-independent"><span class="deltaxml-new" style="background:#90EE90">context-independent</span></a><span class="deltaxml-new" style="background:#90EE90">, and </span><a title="focus-dependent" class="termref" href="#dt-focus-independent"><span class="deltaxml-new" style="background:#90EE90">focus-independent</span></a><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Rules</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns the empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns a record whose fields are as follows. All entries will be present, even when the value is an empty sequence.</span></p><table><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Key</span></th><th><span class="deltaxml-new" style="background:#90EE90">Value</span></th></tr></thead><tbody><tr><td><code><span class="deltaxml-new" style="background:#90EE90">year</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:year-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">month</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:month-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">day</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:day-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">hours</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:hours-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">minutes</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:minutes-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">seconds</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:seconds-from-dateTime($value)</span></code></td></tr><tr><td><code><span class="deltaxml-new" style="background:#90EE90">timezone</span></code></td><td><span class="deltaxml-new" style="background:#90EE90">The value of </span><code><span class="deltaxml-new" style="background:#90EE90">fn:timezone-from-dateTime($value)</span></code></td></tr></tbody></table></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">parts-of-dateTime(
  xs:dateTime("1999-05-31T13:20:00-05:00")
)</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">{ "year": 1999, "month": 5, "day": 31, 
  "hours": 13, "minutes": 20, "seconds": 0, 
  "timezone": xs:dayTimeDuration("-PT5H") }</span></pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">parts-of-dateTime(
  xs:time("13:30:04.2678")
)</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">{ "year": (), "month": (), "day": (), 
  "hours": 13, "minutes": 30, "seconds": 4.2678, 
  "timezone": () }</span></pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">parts-of-dateTime(
  xs:gYearMonth("2007-05Z")
)</span></pre></div></td></tr><tr><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">{ "year": 2007, "month": 5, "day": (), 
  "hours": (), "minutes": (), "seconds": (), 
  "timezone": xs:dayTimeDuration("-PT0S") }</span></pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div2"><h3><a id="timezone.functions"></a><span class="deltaxml-old" style="background:#FF5555">9.6</span><span class="deltaxml-new" style="background:#90EE90">9.7</span> <a href="#timezone.functions" style="text-decoration: none">Adjusting timezones on dates and times</a></h3><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-adjust-dateTime-to-timezone"><code>fn:adjust-dateTime-to-timezone</code></a></td><td>Adjusts an <code>xs:dateTime</code> value to a specific timezone, or to no timezone at all.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-adjust-date-to-timezone"><code>fn:adjust-date-to-timezone</code></a></td><td>Adjusts an <code>xs:date</code> value to a specific timezone, or to no timezone at all; the result is the date in the target timezone that contains the starting instant of the supplied date.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-adjust-time-to-timezone"><code>fn:adjust-time-to-timezone</code></a></td><td>Adjusts an <code>xs:time</code> value to a specific timezone, or to no timezone at all.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-civil-timezone"><code>fn:civil-timezone</code></a></td><td>Returns the timezone offset from UTC that is in conventional use at a given place and time.</td></tr></tbody></table><p>These functions adjust the timezone component of an <code>xs:dateTime</code>, <code>xs:date</code> or <code>xs:time</code> value. The <code>$timezone</code> argument to these functions is defined as an <code>xs:dayTimeDuration</code> but must be a valid timezone value.</p><div class="_diffs div3"><h4><a id="func-adjust-dateTime-to-timezone"></a><span class="deltaxml-old" style="background:#FF5555">9.6.1</span><span class="deltaxml-new" style="background:#90EE90">9.7.1</span> <a href="#func-adjust-dateTime-to-timezone" style="text-decoration: none">fn:adjust-dateTime-to-timezone</a></h4><dl><dt class="label">Summary</dt><dd><p>Adjusts an <code>xs:dateTime</code> value to a specific timezone, or to no timezone at all.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:adjust-dateTime-to-timezone</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$timezone</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration?</code></code></td><td><code class="assign">:=&nbsp;</code><code>fn:implicit-timezone()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>The one-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p><p>The two-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p> If <code>$timezone</code> is not specified, then the effective value of <code>$timezone</code> is the value of the implicit timezone in the dynamic context.</p><p> If <code>$value</code> is the empty sequence, then the function returns the empty sequence.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is the empty sequence, then the result is <code>$value</code>.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is not the empty sequence, then the result is <code>$value</code> with <code>$timezone</code> as the timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is the empty sequence, then the result is the local value of <code>$value</code> without its timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is not the empty sequence, then the result is the <code>xs:dateTime</code> value that is equal to <code>$value</code> and that has a timezone component equal to <code>$timezone</code>.</p></dd><dt class="label">Error Conditions</dt><dd><p> A dynamic error is raised [<a href="#ERRFODT0003" title="err:FODT0003">err:FODT0003</a>] if <code>$timezone</code> is less than <code>-PT14H</code> or greater than <code>PT14H</code> or is not an integral number of minutes.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Variables</th></tr></thead><tbody><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">let $tz-10 := xs:dayTimeDuration("-PT10H")</pre></div></td></tr></tbody></table><table class="medium"><tbody><tr><td colspan="2"><p> Assume the dynamic context provides an implicit timezone of <code>-05:00 (-PT5H0M)</code>.</p></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00')
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T10:00:00-05:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00-07:00')
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T12:00:00-05:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00'),
  $tz-10
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T10:00:00-10:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00-07:00'),
  $tz-10
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T07:00:00-10:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00-07:00'),
  xs:dayTimeDuration("PT10H")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-08T03:00:00+10:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T00:00:00+01:00'),
  xs:dayTimeDuration("-PT8H")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-06T15:00:00-08:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00'),
  ()
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T10:00:00')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-dateTime-to-timezone(
  xs:dateTime('2002-03-07T10:00:00-07:00'),
  ()
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime('2002-03-07T10:00:00')</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-adjust-date-to-timezone"></a><span class="deltaxml-old" style="background:#FF5555">9.6.2</span><span class="deltaxml-new" style="background:#90EE90">9.7.2</span> <a href="#func-adjust-date-to-timezone" style="text-decoration: none">fn:adjust-date-to-timezone</a></h4><dl><dt class="label">Summary</dt><dd><p>Adjusts an <code>xs:date</code> value to a specific timezone, or to no timezone at all; the result is the date in the target timezone that contains the starting instant of the supplied date.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:adjust-date-to-timezone</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$timezone</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration?</code></code></td><td><code class="assign">:=&nbsp;</code><code>fn:implicit-timezone()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:date?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>The one-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p><p>The two-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p> If <code>$timezone</code> is not specified, then the effective value of <code>$timezone</code> is the value of the implicit timezone in the dynamic context.</p><p> If <code>$value</code> is the empty sequence, then the function returns the empty sequence.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is the empty sequence, then the result is <code>$value</code>.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is not the empty sequence, then the result is <code>$value</code> with <code>$timezone</code> as the timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is the empty sequence, then the result is the local value of <code>$value</code> without its timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is not the empty sequence, then:</p><ul><li><p>Let <code>$dt</code> be the value of <code>fn:dateTime($arg, xs:time('00:00:00'))</code>.</p></li><li><p>Let <code>$adt</code> be the value of <code>fn:adjust-dateTime-to-timezone($dt, $timezone)</code></p></li><li><p>The function returns the value of <code>xs:date($adt)</code></p></li></ul></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFODT0003" title="err:FODT0003">err:FODT0003</a>] if <code>$timezone</code> is less than <code>-PT14H</code> or greater than <code>PT14H</code> or is not an integral number of minutes.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Variables</th></tr></thead><tbody><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">let $tz-10 := xs:dayTimeDuration("-PT10H")</pre></div></td></tr></tbody></table><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td colspan="2"><p>Assume the dynamic context provides an implicit timezone of <code>-05:00 (-PT5H0M)</code>.</p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-07-05:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07-07:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-07-05:00")</pre></div><p><em>(<code>$value</code> is converted to <code>xs:dateTime("2002-03-07T00:00:00-07:00")</code>. This is adjusted to the implicit timezone, giving <code>"2002-03-07T02:00:00-05:00"</code>. ).</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07"),
  $tz-10
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-07-10:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07-07:00"),
  $tz-10
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-06-10:00")</pre></div><p><em>(<code>$value</code> is converted to <code>xs:dateTime("2002-03-07T00:00:00-07:00")</code>. This is adjusted to the given timezone, giving <code>"2002-03-06T21:00:00-10:00"</code>. ).</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07"),
  ()
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-07")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-date-to-timezone(
  xs:date("2002-03-07-07:00"),
  ()
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2002-03-07")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-adjust-time-to-timezone"></a><span class="deltaxml-old" style="background:#FF5555">9.6.3</span><span class="deltaxml-new" style="background:#90EE90">9.7.3</span> <a href="#func-adjust-time-to-timezone" style="text-decoration: none">fn:adjust-time-to-timezone</a></h4><dl><dt class="label">Summary</dt><dd><p>Adjusts an <code>xs:time</code> value to a specific timezone, or to no timezone at all.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:adjust-time-to-timezone</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$timezone</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration?</code></code></td><td><code class="assign">:=&nbsp;</code><code>fn:implicit-timezone()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:time?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>The one-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p><p>The two-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p> If <code>$timezone</code> is not specified, then the effective value of <code>$timezone</code> is the value of the implicit timezone in the dynamic context.</p><p> If <code>$value</code> is the empty sequence, then the function returns the empty sequence.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is the empty sequence, then the result is <code>$value</code>.</p><p> If <code>$value</code> does not have a timezone component and <code>$timezone</code> is not the empty sequence, then the result is <code>$value</code> with <code>$timezone</code> as the timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is the empty sequence, then the result is the localized value of <code>$value</code> without its timezone component.</p><p> If <code>$value</code> has a timezone component and <code>$timezone</code> is not the empty sequence, then:</p><ul><li><p>Let <code>$dt</code> be the <code>xs:dateTime</code> value <code>fn:dateTime(xs:date('1972-12-31'), $value)</code>.</p></li><li><p>Let <code>$adt</code> be the value of <code>fn:adjust-dateTime-to-timezone($dt, $timezone)</code></p></li><li><p>The function returns the <code>xs:time</code> value <code>xs:time($adt)</code>.</p></li></ul></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFODT0003" title="err:FODT0003">err:FODT0003</a>] if <code>$timezone</code> is less than <code>-PT14H</code> or greater than <code>PT14H</code> or if does not contain an integral number of minutes.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Variables</th></tr></thead><tbody><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">let $tz-10 := xs:dayTimeDuration("-PT10H")</pre></div></td></tr></tbody></table><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td colspan="2"><p>Assume the dynamic context provides an implicit timezone of <code>-05:00 (-PT5H0M)</code>.</p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("10:00:00-05:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00-07:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("12:00:00-05:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00"),
  $tz-10
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("10:00:00-10:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00-07:00"),
  $tz-10
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("07:00:00-10:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00"),
  ()
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("10:00:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00-07:00"),
  ()
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("10:00:00")</pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">adjust-time-to-timezone(
  xs:time("10:00:00-07:00"),
  xs:dayTimeDuration("PT10H")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("03:00:00+10:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-civil-timezone"></a><span class="deltaxml-old" style="background:#FF5555">9.6.4</span><span class="deltaxml-new" style="background:#90EE90">9.7.4</span> <a href="#func-civil-timezone" style="text-decoration: none">fn:civil-timezone</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-format-dateTime">next</a> | <a href="#func-parts-of-dateTime">previous</a>)</p><ol><li><p>New in 4.0<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1539">1539</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1545">1545</a>&nbsp;5 November 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the timezone offset from UTC that is in conventional use at a given place and time.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:civil-timezone</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$place</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>The one-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on default place. </p><p>The two-argument form of this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>This function uses a database of civil timezones (including daylight savings time) to return the timezone offset for a given date/time and place. For example, the timezone offset for New York on 31 December 2024 would be <code>-PT5H</code>.</p><p>If the <code>$place</code> argument is omitted or empty then the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-default-place">default place</a><sup><small>XP</small></sup> from the dynamic context is used.</p><p>If the supplied <code>$value</code> has no timezone then the implicit timezone from the dynamic context is used. This is unrelated to the timezone applicable to the requested <code>$place</code>.</p><p>The intended use of the <code>$place</code> argument is to identify the place where an event represented by the <code>$value</code> argument took place or will take place. The value must be an IANA timezone name as defined in the IANA timezone database <a href="#olson">[IANA Timezone Database]</a>. Examples are <code>"America/New_York"</code> and <code>"Europe/Rome"</code>.</p><p>The result of the function is the civil timezone offset applicable to the given date/time and place, as determined by the IANA timezone database or an alternative authoritative source.</p></dd><dt class="label">Error Conditions</dt><dd><p> A dynamic error is raised [<a href="#ERRFODT0004" title="err:FODT0004">err:FODT0004</a>] if no timezone information is available for the given date/time and place. This includes the case where the given place is not present in the timezone database, and also the case where the information available for that place does not cover a sufficient range of dates.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">civil-timezone(
  xs:dateTime('2024-12-31T23:59:59'), 'America/New_York')</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('-PT5H')</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">civil-timezone(
  xs:dateTime('2024-06-30T23:59:59'), 'America/New_York')</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration('-PT4H')</pre></div></td></tr><tr><td colspan="2"><p>The expression:</p></td></tr><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve" class="small">adjust-dateTime-to-timezone(
  current-dateTime(),
  civil-timezone(current-dateTime(), 'America/New_York')
)</pre></div></td></tr><tr><td colspan="2"><p>returns the current civil date and time in New York.</p></td></tr><tr><td colspan="2"><p>If the default place is a location in the same timezone as (say) Paris, then the expression</p></td></tr><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">civil-timezone(xs:dateTime('2024-07-01T09:00:00'))</pre></div></td></tr><tr><td colspan="2"><p>returns PT2H.</p></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div2"><h3><a id="dateTime-arithmetic"></a><span class="deltaxml-old" style="background:#FF5555">9.7</span><span class="deltaxml-new" style="background:#90EE90">9.8</span> <a href="#dateTime-arithmetic" style="text-decoration: none">Arithmetic operators on durations, dates and times</a></h3><p>These functions support adding or subtracting a duration value to or from an <code>xs:dateTime</code>, an <code>xs:date</code> or an <code>xs:time</code> value. Appendix E of <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> describes an algorithm for performing such operations.</p><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dateTimes"><code>op:subtract-dateTimes</code></a></td><td>Returns an <code>xs:dayTimeDuration</code> representing the amount of elapsed time between the instants <code>arg2</code> and <code>arg1</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dates"><code>op:subtract-dates</code></a></td><td>Returns the <code>xs:dayTimeDuration</code> that corresponds to the elapsed time between the starting instant of <code>$arg2</code> and the starting instant of <code>$arg2</code>.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-times"><code>op:subtract-times</code></a></td><td>Returns the <code>xs:dayTimeDuration</code> that corresponds to the elapsed time between the values of <code>$arg2</code> and <code>$arg1</code> treated as times on the same date.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-yearMonthDuration-to-dateTime"><code>op:add-yearMonthDuration-to-dateTime</code></a></td><td>Returns the <code>xs:dateTime</code> that is a given duration after a specified <code>xs:dateTime</code> (or before, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-dayTimeDuration-to-dateTime"><code>op:add-dayTimeDuration-to-dateTime</code></a></td><td>Returns the <code>xs:dateTime</code> that is a given duration after a specified <code>xs:dateTime</code> (or before, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-yearMonthDuration-from-dateTime"><code>op:subtract-yearMonthDuration-from-dateTime</code></a></td><td>Returns the <code>xs:dateTime</code> that is a given duration before a specified <code>xs:dateTime</code> (or after, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dayTimeDuration-from-dateTime"><code>op:subtract-dayTimeDuration-from-dateTime</code></a></td><td>Returns the <code>xs:dateTime</code> that is a given duration before a specified <code>xs:dateTime</code> (or after, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-yearMonthDuration-to-date"><code>op:add-yearMonthDuration-to-date</code></a></td><td>Returns the <code>xs:date</code> that is a given duration after a specified <code>xs:date</code> (or before, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-dayTimeDuration-to-date"><code>op:add-dayTimeDuration-to-date</code></a></td><td>Returns the <code>xs:date</code> that is a given duration after a specified <code>xs:date</code> (or before, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-yearMonthDuration-from-date"><code>op:subtract-yearMonthDuration-from-date</code></a></td><td>Returns the <code>xs:date</code> that is a given duration before a specified <code>xs:date</code> (or after, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dayTimeDuration-from-date"><code>op:subtract-dayTimeDuration-from-date</code></a></td><td>Returns the <code>xs:date</code> that is a given duration before a specified <code>xs:date</code> (or after, if the duration is negative).</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-add-dayTimeDuration-to-time"><code>op:add-dayTimeDuration-to-time</code></a></td><td>Returns the <code>xs:time</code> value that is a given duration after a specified <code>xs:time</code> (or before, if the duration is negative or causes wrap-around past midnight)</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-subtract-dayTimeDuration-from-time"><code>op:subtract-dayTimeDuration-from-time</code></a></td><td>Returns the <code>xs:time</code> value that is a given duration before a specified <code>xs:time</code> (or after, if the duration is negative or causes wrap-around past midnight)</td></tr></tbody></table><div class="_diffs div3"><h4><a id="duration-limits"></a><span class="deltaxml-old" style="background:#FF5555">9.7.1</span><span class="deltaxml-new" style="background:#90EE90">9.8.1</span> <a href="#duration-limits" style="text-decoration: none">Limits and precision</a></h4><p>A processor that limits the number of digits in date and time datatype representations may encounter overflow and underflow conditions when it tries to execute the functions in this section. In these situations, the processor <span class="verb">must</span> return P0M or PT0S in case of duration underflow and 00:00:00 in case of time underflow. It <span class="verb">must</span> raise a dynamic error [<a href="#ERRFODT0001" title="err:FODT0001">err:FODT0001</a>] in case of overflow.</p><p>The value spaces of the two totally ordered subtypes of <code>xs:duration</code> described in <a href="#duration-subtypes"><b>8.1.1 Subtypes of duration</b></a> are <code>xs:integer</code> months for <code>xs:yearMonthDuration</code> and <code>xs:decimal</code> seconds for <code>xs:dayTimeDuration</code>. If a processor limits the number of digits allowed in the representation of <code>xs:integer</code> and <code>xs:decimal</code> then overflow and underflow situations can arise when it tries to execute the functions in <a href="#duration-arithmetic"><b>8.5 Arithmetic operators on durations</b></a>. In these situations the processor <span class="verb">must</span> return zero in case of numeric underflow and P0M or PT0S in case of duration underflow. It <span class="verb">must</span> raise a dynamic error [<a href="#ERRFODT0002" title="err:FODT0002">err:FODT0002</a>] in case of overflow.</p></div><div class="_diffs div3"><h4><a id="func-subtract-dateTimes"></a><span class="deltaxml-old" style="background:#FF5555">9.7.2</span><span class="deltaxml-new" style="background:#90EE90">9.8.2</span> <a href="#func-subtract-dateTimes" style="text-decoration: none">op:subtract-dateTimes</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns an <code>xs:dayTimeDuration</code> representing the amount of elapsed time between the instants <code>arg2</code> and <code>arg1</code>.</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to two <code>xs:dateTime</code> values.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-dateTimes</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>If either <code>$arg1</code> or <code>$arg2</code> do not contain an explicit timezone then, for the purpose of the operation, the implicit timezone provided by the dynamic context (See <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-xp-evaluation-context-components">B.2 Dynamic Context Components</a>.) is assumed to be present as part of the value.</p><p>The function returns the elapsed time between the date/time instant <code>arg2</code> and the date/time instant <code>arg1</code>, computed according to the algorithm given in Appendix E of <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a>, and expressed as a <code>xs:dayTimeDuration</code>.</p><p>If the normalized value of <code>$arg1</code> precedes in time the normalized value of <code>$arg2</code>, then the returned value is a negative duration.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr><td colspan="2"><p>Assume that the dynamic context provides an implicit timezone value of <code>-05:00</code>.</p></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dateTimes(
  xs:dateTime("2000-10-30T06:12:00"),
  xs:dateTime("1999-11-28T09:00:00Z")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("P337DT2H12M")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-dates"></a><span class="deltaxml-old" style="background:#FF5555">9.7.3</span><span class="deltaxml-new" style="background:#90EE90">9.8.3</span> <a href="#func-subtract-dates" style="text-decoration: none">op:subtract-dates</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dayTimeDuration</code> that corresponds to the elapsed time between the starting instant of <code>$arg2</code> and the starting instant of <code>$arg2</code>.</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to two <code>xs:date</code> values.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-dates</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>If either <code>$arg1</code> or <code>$arg2</code> do not contain an explicit timezone then, for the purpose of the operation, the implicit timezone provided by the dynamic context (See <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-xp-evaluation-context-components">B.2 Dynamic Context Components</a>.) is assumed to be present as part of the value.</p><p>The starting instant of an <code>xs:date</code> is the <code>xs:dateTime</code> at <code>00:00:00</code> on that date. </p><p>The function returns the result of subtracting the two starting instants using <a href="#func-subtract-dateTimes"><code>op:subtract-dateTimes</code></a>.</p><p>If the starting instant of <code>$arg1</code> precedes in time the starting instant of <code>$arg2</code>, then the returned value is a negative duration.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td colspan="2"><p>Assume that the dynamic context provides an implicit timezone value of <code>Z</code>. </p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dates(
  xs:date("2000-10-30"),
  xs:date("1999-11-28")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("P337D")</pre></div><p><em>(The normalized values of the two starting instants are <code>{ 2000, 10, 30, 0, 0, 0, xs:dayTimeDuration("PT0S") }</code> and <code>{ 1999, 11, 28, 0, 0, 0, xs:dayTimeDuration("PT0S") }</code>.)</em></p></td></tr><tr><td colspan="2"><p>Now assume that the dynamic context provides an implicit timezone value of <code>+05:00</code>.</p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dates(
  xs:date("2000-10-30"),
  xs:date("1999-11-28Z")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("P336DT19H")</pre></div><p><em>( The normalized values of the two starting instants are <code>{ 2000, 10, 29, 19, 0, 0, xs:dayTimeDuration("PT0S") }</code> and <code>{ 1999, 11, 28, 0, 0, 0, xs:dayTimeDuration("PT0S") }</code>.)</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dates(
  xs:date("2000-10-15-05:00"),
  xs:date("2000-10-10+02:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("P5DT7H")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-times"></a><span class="deltaxml-old" style="background:#FF5555">9.7.4</span><span class="deltaxml-new" style="background:#90EE90">9.8.4</span> <a href="#func-subtract-times" style="text-decoration: none">op:subtract-times</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dayTimeDuration</code> that corresponds to the elapsed time between the values of <code>$arg2</code> and <code>$arg1</code> treated as times on the same date.</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to two <code>xs:time</code> values.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-times</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dayTimeDuration</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of the expression:</p><div class="exampleInner"><pre xml:space="preserve" class="small">op-subtract-dateTimes(
        dateTime(xs:date('1972-12-31'), $arg1),
        dateTime(xs:date('1972-12-31'), $arg2))</pre></div></dd><dt class="label">Notes</dt><dd><div class="note"><p>Any other reference date would work equally well.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td colspan="2"><p>Assume that the dynamic context provides an implicit timezone value of <code>-05:00</code>. Assume, also, that the date components of the reference <code>xs:dateTime</code> correspond to <code>"1972-12-31"</code>.</p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-times(
  xs:time("11:12:00Z"),
  xs:time("04:00:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("PT2H12M")</pre></div><p><em>(This is obtained by subtracting from the <code>xs:dateTime</code> value <code>{ 1972, 12, 31, 11, 12, 0, xs:dayTimeDuration("PT0S") }</code> the <code>xs:dateTime</code> value <code>{ 1972, 12, 31, 9, 0, 0, xs:dayTimeDuration("PT0S") }</code>.)</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-times(
  xs:time("11:00:00-05:00"),
  xs:time("21:30:00+05:30")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("PT0S")</pre></div><p><em>(The two <code>xs:dateTime</code> values are <code>{ 1972, 12, 31, 11, 0, 0, xs:dayTimeDuration("-PT5H") }</code> and <code>{ 1972, 12, 31, 21, 30, 0, xs:dayTimeDuration("PT5H30M") }</code>. These normalize to <code>{ 1972, 12, 31, 16, 0, 0, xs:dayTimeDuration("PT0S") }</code> and <code>{ 1972, 12, 31, 16, 0, 0, xs:dayTimeDuration("PT0S") }</code>. ).</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-times(
  xs:time("17:00:00-06:00"),
  xs:time("08:00:00+09:00")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("P1D")</pre></div><p><em>(The two normalized <code>xs:dateTime</code> values are <code>{ 1972, 12, 31, 23, 0, 0, xs:dayTimeDuration("PT0S") }</code> and <code>{ 1972, 12, 30, 23, 0, 0, xs:dayTimeDuration("PT0S") }</code>.)</em></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-times(
  xs:time("24:00:00"),
  xs:time("23:59:59")
)</pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dayTimeDuration("-PT23H59M59S")</pre></div><p><em>(The two normalized <code>xs:dateTime</code> values are <code>{ 1972, 12, 31, 0, 0, 0, () }</code> and <code>{ 1972, 12, 31, 23, 59, 59.0, () }</code>.)</em></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-add-yearMonthDuration-to-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.7.5</span><span class="deltaxml-new" style="background:#90EE90">9.8.5</span> <a href="#func-add-yearMonthDuration-to-dateTime" style="text-decoration: none">op:add-yearMonthDuration-to-dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dateTime</code> that is a given duration after a specified <code>xs:dateTime</code> (or before, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>+</code> operator when applied to an <code>xs:dateTime</code> and an <code>xs:yearMonthDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:add-yearMonthDuration-to-dateTime</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of adding <code>$arg2</code> to the value of <code>$arg1</code> using the algorithm described in Appendix E of <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a>, disregarding the rule about leap seconds. If <code>$arg2</code> is negative, then the result <code>xs:dateTime</code> precedes <code>$arg1</code>.</p><p>The result has the same timezone as <code>$arg1</code>. If <code>$arg1</code> has no timezone, the result has no timezone. </p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:add-yearMonthDuration-to-dateTime(
  xs:dateTime("2000-10-30T11:12:00"),
  xs:yearMonthDuration("P1Y2M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("2001-12-30T11:12:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-add-dayTimeDuration-to-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.7.6</span><span class="deltaxml-new" style="background:#90EE90">9.8.6</span> <a href="#func-add-dayTimeDuration-to-dateTime" style="text-decoration: none">op:add-dayTimeDuration-to-dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dateTime</code> that is a given duration after a specified <code>xs:dateTime</code> (or before, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>+</code> operator when applied to an <code>xs:dateTime</code> and an <code>xs:dayTimeDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:add-dayTimeDuration-to-dateTime</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of adding <code>$arg2</code> to the value of <code>$arg1</code> using the algorithm described in Appendix E of <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a>, disregarding the rule about leap seconds. If <code>$arg2</code> is negative, then the result <code>xs:dateTime</code> precedes <code>$arg1</code>.</p><p>The result has the same timezone as <code>$arg1</code>. If <code>$arg1</code> has no timezone, the result has no timezone. </p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:add-dayTimeDuration-to-dateTime(
  xs:dateTime("2000-10-30T11:12:00"),
  xs:dayTimeDuration("P3DT1H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("2000-11-02T12:27:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-yearMonthDuration-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.7.7</span><span class="deltaxml-new" style="background:#90EE90">9.8.7</span> <a href="#func-subtract-yearMonthDuration-from-dateTime" style="text-decoration: none">op:subtract-yearMonthDuration-from-dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dateTime</code> that is a given duration before a specified <code>xs:dateTime</code> (or after, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to an <code>xs:dateTime</code> and an <code>xs:yearMonthDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-yearMonthDuration-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the <code>xs:dateTime</code> computed by negating <code>$arg2</code> and adding the result to <code>$arg1</code> using the function <a href="#func-add-yearMonthDuration-to-dateTime"><code>op:add-yearMonthDuration-to-dateTime</code></a>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:subtract-yearMonthDuration-from-dateTime(
  xs:dateTime("2000-10-30T11:12:00"),
  xs:yearMonthDuration("P1Y2M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("1999-08-30T11:12:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-dayTimeDuration-from-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.7.8</span><span class="deltaxml-new" style="background:#90EE90">9.8.8</span> <a href="#func-subtract-dayTimeDuration-from-dateTime" style="text-decoration: none">op:subtract-dayTimeDuration-from-dateTime</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:dateTime</code> that is a given duration before a specified <code>xs:dateTime</code> (or after, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to an <code>xs:dateTime</code> an and <code>xs:dayTimeDuration</code> values</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-dayTimeDuration-from-dateTime</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime</code></code></td></tr></tbody></table></div></dd><dt class="label">Rules</dt><dd><p>The function returns the <code>xs:dateTime</code> computed by negating <code>$arg2</code> and adding the result to <code>$arg1</code> using the function <a href="#func-add-dayTimeDuration-to-dateTime"><code>op:add-dayTimeDuration-to-dateTime</code></a>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:subtract-dayTimeDuration-from-dateTime(
  xs:dateTime("2000-10-30T11:12:00"),
  xs:dayTimeDuration("P3DT1H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:dateTime("2000-10-27T09:57:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-add-yearMonthDuration-to-date"></a><span class="deltaxml-old" style="background:#FF5555">9.7.9</span><span class="deltaxml-new" style="background:#90EE90">9.8.9</span> <a href="#func-add-yearMonthDuration-to-date" style="text-decoration: none">op:add-yearMonthDuration-to-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:date</code> that is a given duration after a specified <code>xs:date</code> (or before, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>+</code> operator when applied to an <code>xs:date</code> and an <code>xs:yearMonthDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:add-yearMonthDuration-to-date</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:date</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of casting <code>$arg1</code> to an <code>xs:dateTime</code>, adding <code>$arg2</code> using the function <a href="#func-add-yearMonthDuration-to-dateTime"><code>op:add-yearMonthDuration-to-dateTime</code></a>, and casting the result back to an <code>xs:date</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:add-yearMonthDuration-to-date(
  xs:date("2000-10-30"),
  xs:yearMonthDuration("P1Y2M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2001-12-30")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-add-dayTimeDuration-to-date"></a><span class="deltaxml-old" style="background:#FF5555">9.7.10</span><span class="deltaxml-new" style="background:#90EE90">9.8.10</span> <a href="#func-add-dayTimeDuration-to-date" style="text-decoration: none">op:add-dayTimeDuration-to-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:date</code> that is a given duration after a specified <code>xs:date</code> (or before, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>+</code> operator when applied to an <code>xs:date</code> and an <code>xs:dayTimeDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:add-dayTimeDuration-to-date</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:date</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of casting <code>$arg1</code> to an <code>xs:dateTime</code>, adding <code>$arg2</code> using the function <a href="#func-add-dayTimeDuration-to-dateTime"><code>op:add-dayTimeDuration-to-dateTime</code></a>, and casting the result back to an <code>xs:date</code>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:add-dayTimeDuration-to-date(
  xs:date("2004-10-30Z"),
  xs:dayTimeDuration("P2DT2H30M0S")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2004-11-01Z")</pre></div><p><em>( The starting instant of the first argument is the <code>xs:dateTime</code> value <code>{ 2004, 10, 30, 0, 0, 0, xs:dayTimeDuration("PT0S") }</code>. Adding the second argument to this gives the <code>xs:dateTime</code> value <code>{ 2004, 11, 1, 2, 30, 0, xs:dayTimeDuration("PT0S") }</code>. The time components are then discarded. ).</em></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-yearMonthDuration-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.7.11</span><span class="deltaxml-new" style="background:#90EE90">9.8.11</span> <a href="#func-subtract-yearMonthDuration-from-date" style="text-decoration: none">op:subtract-yearMonthDuration-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:date</code> that is a given duration before a specified <code>xs:date</code> (or after, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to an <code>xs:date</code> and an <code>xs:yearMonthDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-yearMonthDuration-from-date</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:yearMonthDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:date</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>Returns the <code>xs:date</code> computed by negating <code>$arg2</code> and adding the result to <code>$arg1</code> using the function <a href="#func-add-yearMonthDuration-to-date"><code>op:add-yearMonthDuration-to-date</code></a>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-yearMonthDuration-from-date(
  xs:date("2000-10-30"),
  xs:yearMonthDuration("P1Y2M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("1999-08-30")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-yearMonthDuration-from-date(
  xs:date("2000-02-29Z"),
  xs:yearMonthDuration("P1Y")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("1999-02-28Z")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:subtract-yearMonthDuration-from-date(
  xs:date("2000-10-31-05:00"),
  xs:yearMonthDuration("P1Y1M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("1999-09-30-05:00")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-dayTimeDuration-from-date"></a><span class="deltaxml-old" style="background:#FF5555">9.7.12</span><span class="deltaxml-new" style="background:#90EE90">9.8.12</span> <a href="#func-subtract-dayTimeDuration-from-date" style="text-decoration: none">op:subtract-dayTimeDuration-from-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:date</code> that is a given duration before a specified <code>xs:date</code> (or after, if the duration is negative).</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to an <code>xs:date</code> and an <code>xs:dayTimeDuration</code>. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-dayTimeDuration-from-date</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:date</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>Returns the <code>xs:date</code> computed by negating <code>$arg2</code> and adding the result to <code>$arg1</code> using the function <a href="#func-add-dayTimeDuration-to-date"><code>op:add-dayTimeDuration-to-date</code></a>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dayTimeDuration-from-date(
  xs:date("2000-10-30"),
  xs:dayTimeDuration("P3DT1H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:date("2000-10-26")</pre></div></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-add-dayTimeDuration-to-time"></a><span class="deltaxml-old" style="background:#FF5555">9.7.13</span><span class="deltaxml-new" style="background:#90EE90">9.8.13</span> <a href="#func-add-dayTimeDuration-to-time" style="text-decoration: none">op:add-dayTimeDuration-to-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:time</code> value that is a given duration after a specified <code>xs:time</code> (or before, if the duration is negative or causes wrap-around past midnight)</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>+</code> operator when applied to an <code>xs:time</code> and an <code>xs:dayTimeDuration</code> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:add-dayTimeDuration-to-time</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:time</code></code></td></tr></tbody></table></div></dd><dt class="label">Rules</dt><dd><p>First, the days component in the canonical lexical representation of <code>$arg2</code> is set to zero (0) and the value of the resulting <code>xs:dayTimeDuration</code> is calculated. Alternatively, the value of <code>$arg2</code> modulus 86,400 is used as the second argument. This value is added to the value of <code>$arg1</code> converted to an <code>xs:dateTime</code> using a reference date such as <code>1972-12-31</code>, and the time component of the result is returned. Note that the <code>xs:time</code> returned may occur in a following or preceding day and may be less than <code>$arg1</code>.</p><p>The result has the same timezone as <code>$arg1</code>. If <code>$arg1</code> has no timezone, the result has no timezone.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:add-dayTimeDuration-to-time(
  xs:time("11:12:00"),
  xs:dayTimeDuration("P3DT1H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("12:27:00")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:add-dayTimeDuration-to-time(
  xs:time("23:12:00+03:00"),
  xs:dayTimeDuration("P1DT3H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("02:27:00+03:00")</pre></div><p><em>(That is, <code>{ 0, 0, 0, 2, 27, 0, xs:dayTimeDuration("PT3H") }</code>).</em></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div3"><h4><a id="func-subtract-dayTimeDuration-from-time"></a><span class="deltaxml-old" style="background:#FF5555">9.7.14</span><span class="deltaxml-new" style="background:#90EE90">9.8.14</span> <a href="#func-subtract-dayTimeDuration-from-time" style="text-decoration: none">op:subtract-dayTimeDuration-from-time</a></h4><dl><dt class="label">Summary</dt><dd><p>Returns the <code>xs:time</code> value that is a given duration before a specified <code>xs:time</code> (or after, if the duration is negative or causes wrap-around past midnight)</p></dd><dt class="label">Operator Mapping</dt><dd><p>Defines the semantics of the <code>-</code> operator when applied to an <code>xs:time</code> and an <code>xs:dayTimeDuration</code> value. </p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">op:subtract-dayTimeDuration-from-time</code>(</td></tr><tr class="arg"><td><code>$arg1</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time</code></code>,</td><td></td></tr><tr class="arg"><td><code>$arg2</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dayTimeDuration</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:time</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function returns the result of negating <code>$arg2</code> and adding the result to <code>$arg1</code> using the function <a href="#func-add-dayTimeDuration-to-time"><code>op:add-dayTimeDuration-to-time</code></a>.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">op:subtract-dayTimeDuration-from-time(
  xs:time("11:12:00"),
  xs:dayTimeDuration("P3DT1H15M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("09:57:00")</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">op:subtract-dayTimeDuration-from-time(
  xs:time("08:20:00-05:00"),
  xs:dayTimeDuration("P23DT10H10M")
)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">xs:time("22:10:00-05:00")</pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div2"><h3><a id="formatting-dates-and-times"></a><span class="deltaxml-old" style="background:#FF5555">9.8</span><span class="deltaxml-new" style="background:#90EE90">9.9</span> <a href="#formatting-dates-and-times" style="text-decoration: none">Formatting dates and times</a></h3><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-format-dateTime"><code>fn:format-dateTime</code></a></td><td>Returns a string containing an <code>xs:dateTime</code> value formatted for display.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-format-date"><code>fn:format-date</code></a></td><td>Returns a string containing an <code>xs:date</code> value formatted for display.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-format-time"><code>fn:format-time</code></a></td><td>Returns a string containing an <code>xs:time</code> value formatted for display.</td></tr></tbody></table><p>Three functions are provided to represent dates and times as a string, using the conventions of a selected calendar, language, and country. The functions are presented in their customary fashion, except for the rules and examples, which are described en bloc at <a href="#rules-for-datetime-formatting"><span style="display: none;" class="delete_version"><b>9.8.4 The date/time formatting functions</b></span><span style="display: none;" class="add_version"><b>9.9.4 The date/time formatting functions</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4</span> The date/time formatting functions</b></span></a> and <a href="#date-time-examples"><span style="display: none;" class="delete_version"><b>9.8.5 Examples of date and time formatting</b></span><span style="display: none;" class="add_version"><b>9.9.5 Examples of date and time formatting</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.5</span><span class="deltaxml-new" style="background:#90EE90">9.9.5</span> Examples of date and time formatting</b></span></a>.</p><div class="_diffs div3"><h4><a id="func-format-dateTime"></a><span class="deltaxml-old" style="background:#FF5555">9.8.1</span><span class="deltaxml-new" style="background:#90EE90">9.9.1</span> <a href="#func-format-dateTime" style="text-decoration: none">fn:format-dateTime</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-format-date">next</a> | <a href="#func-civil-timezone">previous</a>)</p><ol><li><p>The 3rd, 4th, and 5th arguments are now optional; previously the function required either 2 or 5 arguments.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/895">895</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/901">901</a>&nbsp;16 December 2023]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns a string containing an <code>xs:dateTime</code> value formatted for display.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:format-dateTime</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:dateTime?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$picture</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string</code></code>,</td><td></td></tr><tr class="arg"><td><code>$language</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$calendar</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$place</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:string?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on default calendar, and default language, and default place, and implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>See <a href="#rules-for-datetime-formatting"><span style="display: none;" class="delete_version"><b>9.8.4 The date/time formatting functions</b></span><span style="display: none;" class="add_version"><b>9.9.4 The date/time formatting functions</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4</span> The date/time formatting functions</b></span></a>.</p></dd></dl></div><div class="_diffs div3"><h4><a id="func-format-date"></a><span class="deltaxml-old" style="background:#FF5555">9.8.2</span><span class="deltaxml-new" style="background:#90EE90">9.9.2</span> <a href="#func-format-date" style="text-decoration: none">fn:format-date</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-format-time">next</a> | <a href="#func-format-dateTime">previous</a>)</p><ol><li><p>The 3rd, 4th, and 5th arguments are now optional; previously the function required either 2 or 5 arguments.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/895">895</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/901">901</a>&nbsp;16 December 2023]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns a string containing an <code>xs:date</code> value formatted for display.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:format-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:date?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$picture</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string</code></code>,</td><td></td></tr><tr class="arg"><td><code>$language</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$calendar</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$place</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:string?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on default calendar, and default language, and default place, and implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>See <a href="#rules-for-datetime-formatting"><span style="display: none;" class="delete_version"><b>9.8.4 The date/time formatting functions</b></span><span style="display: none;" class="add_version"><b>9.9.4 The date/time formatting functions</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4</span> The date/time formatting functions</b></span></a>.</p></dd></dl></div><div class="_diffs div3"><h4><a id="func-format-time"></a><span class="deltaxml-old" style="background:#FF5555">9.8.3</span><span class="deltaxml-new" style="background:#90EE90">9.9.3</span> <a href="#func-format-time" style="text-decoration: none">fn:format-time</a></h4><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-parse-QName">next</a> | <a href="#func-format-date">previous</a>)</p><ol><li><p>The 3rd, 4th, and 5th arguments are now optional; previously the function required either 2 or 5 arguments.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/895">895</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/901">901</a>&nbsp;16 December 2023]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns a string containing an <code>xs:time</code> value formatted for display.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:format-time</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:time?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$picture</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string</code></code>,</td><td></td></tr><tr class="arg"><td><code>$language</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$calendar</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code>,</td></tr><tr class="arg"><td><code>$place</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:string?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-dependent" class="termref" href="#dt-context-dependent">context-dependent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. It depends on default calendar, and default language, and default place, and implicit timezone. </p></dd><dt class="label">Rules</dt><dd><p>See <a href="#rules-for-datetime-formatting"><span style="display: none;" class="delete_version"><b>9.8.4 The date/time formatting functions</b></span><span style="display: none;" class="add_version"><b>9.9.4 The date/time formatting functions</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4</span> The date/time formatting functions</b></span></a>.</p></dd></dl></div><div class="_diffs div3"><h4><a id="rules-for-datetime-formatting"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4</span> <a href="#rules-for-datetime-formatting" style="text-decoration: none">The date/time formatting functions</a></h4><p>The <a href="#func-format-dateTime"><code>fn:format-dateTime</code></a>, <a href="#func-format-date"><code>fn:format-date</code></a>, and <a href="#func-format-time"><code>fn:format-time</code></a> functions format <code>$value</code> as a string using the picture string specified by the <code>$picture</code> argument, the calendar specified by the <code>$calendar</code> argument, the language specified by the <code>$language</code> argument, and the country or other place name specified by the <code>$place</code> argument. The result of the function is the formatted string representation of the supplied <code>xs:dateTime</code>, <code>xs:date</code>, or <code>xs:time</code> value.</p><p><span class="termdef"><a id="dt-date-formatting-function"></a>[Definition] The three functions <a href="#func-format-dateTime"><code>fn:format-dateTime</code></a>, <a href="#func-format-date"><code>fn:format-date</code></a>, and <a href="#func-format-time"><code>fn:format-time</code></a> are referred to collectively as the <b>date formatting functions</b>.</span></p><p>If <code>$value</code> is the empty sequence, the function returns the empty sequence.</p><p>Calling the two-argument form of each of the three functions is equivalent to calling the five-argument form with each of the last three arguments set to an empty sequence.</p><p><span style="display: none;" class="delete_version">For details of the <code>$language</code>, <code>$calendar</code>, and <code>$place</code> arguments, see <a href="#lang-cal-place"><span class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span></a>.</span><span style="display: none;" class="add_version">For details of the <code>$language</code>, <code>$calendar</code>, and <code>$place</code> arguments, see <a href="#lang-cal-place"><span class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span></a>.</span><span class="modify_version">For details of the <code>$language</code>, <code>$calendar</code>, and <code>$place</code> arguments, see <a href="#lang-cal-place"><span style="display: none;" class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span style="display: none;" class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4.8</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.8</span> The language, calendar, and place arguments</b></span></a>.</span></p><p>In general, the use of an invalid <code>$picture</code>, <code>$language</code>, <code>$calendar</code>, or <code>$place</code> argument results in a dynamic error [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]. By contrast, use of an option in any of these arguments that is valid but not supported by the implementation is not an error, and in these cases the implementation is required to output the value in a fallback representation. More detailed rules are given below.</p><div class="_diffs div4"><h5><a id="date-picture-string"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.1</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.1</span> <a href="#date-picture-string" style="text-decoration: none">The picture string</a></h5><p>The picture consists of a sequence of variable markers and literal substrings. A substring enclosed in square brackets is interpreted as a variable marker; substrings not enclosed in square brackets are taken as literal substrings. The literal substrings are optional and if present are rendered unchanged, including any whitespace. If an opening or closing square bracket is required within a literal substring, it <span class="verb">must</span> be doubled. The variable markers are replaced in the result by strings representing aspects of the date and/or time to be formatted. These are described in detail below.</p><p>A variable marker consists of a component specifier followed optionally by one or two presentation modifiers and/or optionally by a width modifier. Whitespace within a variable marker is ignored.</p><p>The variable marker may be separated into its components by applying the following rules:</p><ol class="enumar"><li><p>The component specifier is always present and is always a single letter.</p></li><li><p>The width modifier may be recognized by the presence of a comma.</p></li><li><p>The substring between the component specifier and the comma (if present) or the end of the string (if there is no comma) contains the first and second presentation modifiers, both of which are optional. If this substring contains a single character, this is interpreted as the first presentation modifier. If it contains more than one character, the last character is examined: if it is valid as a second presentation modifier then it is treated as such, and the preceding part of the substring constitutes the first presentation modifier. Otherwise, the second presentation modifier is presumed absent and the whole substring is interpreted as the first presentation modifier.</p></li></ol><p>The <em>component specifier</em> indicates the component of the date or time that is required, and takes the following values:</p><table class="data"><thead><tr><th style="text-align:left">Specifier</th><th style="text-align:left">Meaning</th><th style="text-align:left">Default Presentation Modifier</th></tr></thead><tbody><tr><td>Y</td><td>year (absolute value)</td><td>1</td></tr><tr><td>M</td><td>month in year</td><td>1</td></tr><tr><td>D</td><td>day in month</td><td>1</td></tr><tr><td>d</td><td>day in year</td><td>1</td></tr><tr><td>F</td><td>day of week</td><td>n</td></tr><tr><td>W</td><td>week in year</td><td>1</td></tr><tr><td>w</td><td>week in month</td><td>1</td></tr><tr><td>H</td><td>hour in day (24 hours)</td><td>1</td></tr><tr><td>h</td><td>hour in half-day (12 hours)</td><td>1</td></tr><tr><td>P</td><td>am/pm marker</td><td>n</td></tr><tr><td>m</td><td>minute in hour</td><td>01</td></tr><tr><td>s</td><td>second in minute</td><td>01</td></tr><tr><td>f</td><td>fractional seconds</td><td>1</td></tr><tr><td>Z</td><td>timezone</td><td>01:01</td></tr><tr><td>z</td><td>timezone (Same as Z, but modified where appropriate to include a prefix as a time offset using GMT, for example GMT+1 or GMT-05:00. For this component there is a fixed prefix of <code>GMT</code>, or a localized variation thereof for the chosen language, and the remainder of the value is formatted as for specifier <code>Z</code>.) </td><td>01:01</td></tr><tr><td>C</td><td>calendar: the name or abbreviation of a calendar name</td><td>n</td></tr><tr><td>E</td><td>era: the name of a baseline for the numbering of years, for example the reign of a monarch</td><td>n</td></tr></tbody></table><p>A dynamic error is reported [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>] if the syntax of the picture is incorrect.</p><p>A dynamic error is reported [<a href="#ERRFOFD1350" title="err:FOFD1350">err:FOFD1350</a>] if a component specifier within the picture refers to components that are not available in the given type of <code>$value</code>, for example if the picture supplied to the <a href="#func-format-time"><code>fn:format-time</code></a> refers to the year, month, or day component.</p><p>It is not an error to include a timezone component when the supplied value has no timezone. In these circumstances the timezone component will be ignored.</p><p>The first <em>presentation modifier</em> indicates the style in which the value of a component is to be represented. Its value may be either:</p><ul><li><p>any format token permitted as a primary format token in the second argument of the <a href="#func-format-integer"><code>fn:format-integer</code></a> function, indicating that the value of the component is to be output numerically using the specified number format (for example, <code>1</code>, <code>01</code>, <code>i</code>, <code>I</code>, <code>w</code>, <code>W</code>, or <code>Ww</code>) or </p></li><li><p>the format token <code>n</code>, <code>N</code>, or <code>Nn</code>, indicating that the value of the component is to be output by name, in lower-case, upper-case, or title-case respectively. Components that can be output by name include (but are not limited to) months, days of the week, timezones, and eras. If the processor cannot output these components by name for the chosen calendar and language then it must use an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> fallback representation.</p></li></ul><p>If a comma is to be used as a grouping separator within the format token, then there must be a width specifier. More specifically: if a variable marker contains one or more commas, then the last comma is treated as introducing the width modifier, and all others are treated as grouping separators. So <code>[Y9,999,*]</code> will output the year as <code>2,008</code>.</p><p>It is not possible to use a closing square bracket as a grouping separator within the format token.</p><p>If the implementation does not support the use of the requested format token, it <span class="verb">must</span> use the default presentation modifier for that component.</p><p>If the first presentation modifier is present, then it may optionally be followed by a second presentation modifier as follows:</p><table class="longlastcol"><thead><tr><th style="text-align:left">Modifier</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td>either <code>a</code> or <code>t</code></td><td>indicates alphabetic or traditional numbering respectively, the default being <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. This has the same meaning as in the second argument of <a href="#func-format-integer"><code>fn:format-integer</code></a>.</td></tr><tr><td>either <code>c</code> or <code>o</code></td><td>indicates cardinal or ordinal numbering respectively, for example <code>7</code> or <code>seven</code> for a cardinal number, or <code>7th</code>, <code>seventh</code>, or <code>7º</code> for an ordinal number. This has the same meaning as in the second argument of <a href="#func-format-integer"><code>fn:format-integer</code></a>. The actual representation of the ordinal form of a number may depend not only on the language, but also on the grammatical context (for example, in some languages it must agree in gender).</td></tr></tbody></table><div class="note"><p class="prefix"><b>Note:</b></p><p>Although the formatting rules are expressed in terms of the rules for format tokens in <a href="#func-format-integer"><code>fn:format-integer</code></a>, the formats actually used may be specialized to the numbering of date components where appropriate. For example, in Italian, it is conventional to use an ordinal number (<code>primo</code>) for the first day of the month, and cardinal numbers (<code>due, tre, quattro ...</code>) for the remaining days. A processor may therefore use this convention to number days of the month, ignoring the presence or absence of the ordinal presentation modifier.</p></div></div><div class="_diffs div4"><h5><a id="width-modifier"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.2</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.2</span> <a href="#width-modifier" style="text-decoration: none">The Width Modifier</a></h5><p>Whether or not a presentation modifier is included, a width modifier may be supplied. This indicates the number of characters to be included in the representation of the value.</p><p>The width modifier, if present, is introduced by a comma. It takes the form:</p><p><code>&nbsp;&nbsp;&nbsp;","&nbsp;&nbsp;min-width ("-" max-width)?</code></p><p>where <code>min-width</code> is either an unsigned integer indicating the minimum number of characters to be output, or <code>*</code> indicating that there is no explicit minimum, and <code>max-width</code> is either an unsigned integer indicating the maximum number of characters to be output, or <code>*</code> indicating that there is no explicit maximum; if <code>max-width</code> is omitted then <code>*</code> is assumed.</p><p>A dynamic error ([<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]) is raised if <code>min-width</code> is present and less than one, or if <code>max-width</code> is present and less than one or less than <code>min-width</code>. </p><p>A format token containing more than one digit, such as <code>001</code> or <code>9999</code>, sets the minimum and maximum width to the number of digits appearing in the format token; if a width modifier is also present, then the width modifier takes precedence.</p></div><div class="_diffs div4"><h5><a id="formatting-integer-valued-components"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.3</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.3</span> <a href="#formatting-integer-valued-components" style="text-decoration: none">Formatting Integer-Valued Date/Time Components</a></h5><p>The rules in this section apply to the majority of integer-valued components: specifically <code>M D d F W w H h m s</code>.</p><p>In the rules below, the term <b>decimal digit pattern</b> has the meaning given in <a href="#func-format-integer"><b>4.6.1 fn:format-integer</b></a>.</p><ol class="enumar"><li><p>If the first presentation modifier takes the form of a <b>decimal digit pattern</b>:</p><ol class="enumla"><li><p>If there is no width modifier, then the value is formatted according to the rules of the <code>format-integer</code> function.</p></li><li><p>If there is a width modifier, then the first presentation modifier is adjusted as follows:</p><ol class="enumlr"><li><p>If the decimal digit pattern includes a grouping separator, the output is implementation-defined (but this is not an error). </p><div class="note"><p class="prefix"><b>Note:</b></p><p>Use of a width modifier together with grouping separators is inadvisable for this reason. It is never necessary to use a width modifier with a decimal digit pattern, since the same effect can be achieved by use of optional digit signs.</p></div></li><li><p>Otherwise, the number of mandatory-digit-sign characters in the presentation modifier is increased if necessary. This is done first by replacing optional-digit-signs with mandatory-digit-signs, starting from the right, and then prepending mandatory-digit-signs to the presentation modifier, until the number of mandatory-digit-signs is equal to the minimum width. Any mandatory-digit-signs that are added by this process must use the same decimal digit family as existing mandatory-digit-signs in the presentation modifier if there are any, or ASCII digits otherwise. </p></li><li><p>The maximum width, if specified, is ignored. </p></li><li><p>The output is then as defined using the <code>format-integer</code> function with this adjusted decimal digit pattern. </p></li></ol></li></ol></li><li><p>If the first presentation modifiers is one of <code>N</code>, <code>n</code>, or <code>Nn</code>:</p><ol class="enumla"><li><p>Let <var>FN</var> be the full name of the component, that is, the form of the name that would be used in the absence of any width modifier.</p></li><li><p>If <var>FN</var> is shorter than the minimum width, then it is padded by appending spaces to the end of the name. </p></li><li><p>If <var>FN</var> is longer than the maximum width, then it is abbreviated, either by choosing a conventional abbreviation that fits within the maximum width (for example, “Wednesday” might be abbreviated to “Weds”), or by removing characters from the end of <var>FN</var> until it fits within the maximum width. </p></li></ol></li><li><p>For other presentation modifiers:</p><ol class="enumla"><li><p>Any adjustment of the value to fit within the requested width range is implementation-defined. </p></li><li><p>The value should not be truncated if this results in output that will not be meaningful to users (for example, there is no sensible way to truncate Roman numerals).</p></li><li><p>If shorter than the minimum width, the value should be padded to the minimum width, either by appending spaces, or in some other way appropriate to the numbering scheme.</p></li></ol></li></ol></div><div class="_diffs div4"><h5><a id="formatting-year-component"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.4</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.4</span> <a href="#formatting-year-component" style="text-decoration: none">Formatting the Year Component</a></h5><p><span style="display: none;" class="delete_version">The rules for the year component (Y) are the same as those in <a href="#formatting-integer-valued-components"><span class="delete_version"><b>9.8.4.3 Formatting Integer-Valued Date/Time Components</b></span><span class="modify_version"><b>9.8.4.3 Formatting Integer-Valued Date/Time Components</b></span></a>, except that the value of the year as output is the value of the year component of the supplied value modulo ten to the power <var>N</var> where <var>N</var> is determined as follows: </span><span style="display: none;" class="add_version">The rules for the year component (Y) are the same as those in <a href="#formatting-integer-valued-components"><span class="add_version"><b>9.9.4.3 Formatting Integer-Valued Date/Time Components</b></span><span class="modify_version"><b>9.9.4.3 Formatting Integer-Valued Date/Time Components</b></span></a>, except that the value of the year as output is the value of the year component of the supplied value modulo ten to the power <var>N</var> where <var>N</var> is determined as follows: </span><span class="modify_version">The rules for the year component (Y) are the same as those in <a href="#formatting-integer-valued-components"><span style="display: none;" class="delete_version"><b>9.8.4.3 Formatting Integer-Valued Date/Time Components</b></span><span style="display: none;" class="add_version"><b>9.9.4.3 Formatting Integer-Valued Date/Time Components</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4.3</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.3</span> Formatting Integer-Valued Date/Time Components</b></span></a>, except that the value of the year as output is the value of the year component of the supplied value modulo ten to the power <var>N</var> where <var>N</var> is determined as follows: </span></p><ol class="enumar"><li><p>If the width modifier is present and defines a finite maximum width, then that maximum width. </p></li><li><p>Otherwise, if the first presentation modifier takes the form of a decimal-digit-pattern, then:</p><ol class="enumla"><li><p>Let <var>W</var> be the number of optional-digit-signs and mandatory-digit-signs in that decimal-digit-pattern.</p></li><li><p>If <var>W</var> is 2 or more, then <var>W</var>.</p></li></ol></li><li><p>Otherwise, <var>N</var> is infinity (that is, the year is output in full).</p></li></ol></div><div class="_diffs div4"><h5><a id="formatting-fractional-seconds"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.5</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.5</span> <a href="#formatting-fractional-seconds" style="text-decoration: none">Formatting Fractional Seconds</a></h5><p>The output for the fractional seconds component (<code>f</code>) is equivalent to the result of the following algorithm: </p><ol class="enumar"><li><p>If the first presentation modifier contains no Unicode digit, then the output is implementation-defined. </p></li><li><p>Otherwise, the value of the fractional seconds is output as follows:</p><ol class="enumla"><li><p>If there is no width modifier and the first presentation modifier comprises in its entirety a single mandatory-digit-sign (for example the default <code>1</code>), then the presentation modifier is extended on the right with as many optional-digit-signs as are needed to accommodate the actual fractional seconds precision encountered in the value to be formatted. </p></li><li><p>If there is a width modifier, then the first presentation modifier is adjusted as follows:</p><ol class="enumlr"><li><p>If a minimum width is specified, and if this exceeds the number of mandatory-digit-sign characters in the first presentation modifier, then the first presentation modifier is adjusted. This is done first by replacing optional-digit-signs with mandatory-digit-signs, starting from the left, and then appending mandatory-digit-signs to the presentation modifier, until the number of mandatory-digit-signs is equal to the minimum width. Any mandatory-digit-signs that are added by this process must use the same decimal digit family as existing mandatory-digit-signs in the presentation modifier. </p></li><li><p>If a maximum width is specified, the first presentation modifier is extended on the right with as many optional-digit-signs as are needed to ensure that the number of mandatory-digit-signs and optional-digit-signs is at least equal to the maximum width. </p></li></ol></li><li><p>The sequence of characters in the (adjusted) first presentation modifier is reversed (for example, <code>999'###</code> becomes <code>###'999</code>). If the result is not a valid <b>decimal digit pattern</b>, then the output is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. </p></li><li><p>The sequence of digits in the conventional decimal representation of the fractional seconds component is reversed, with insignificant zeroes removed, and the result is treated as an integer. For example, if the seconds value is <code>25.8235</code>, the reversed fractional seconds value is <code>5328</code>. </p></li><li><p>The reversed fractional seconds value is formatted using the reversed decimal digit pattern according to the rules of the <a href="#func-format-integer"><code>fn:format-integer</code></a> function. Given the examples above, the result is <code>5'328</code></p></li><li><p>The resulting string is reversed. In our example, the result is <code>823'5</code>.</p></li><li><p>If the result contains more digits than the number of mandatory-digit-signs and optional-digit-signs in the decimal digit pattern, then excess digits are removed from the right hand end (that is, the value is truncated towards zero rather than being rounded). Any grouping separator that immediately precedes a removed digit is also removed.</p></li></ol></li></ol><div class="note"><p class="prefix"><b>Note:</b></p><p>The reason for presenting the algorithm in this way is that it enables maximum reuse of the rules defined for <a href="#func-format-integer"><code>fn:format-integer</code></a>. Since the fractional seconds value is not properly an integer, the rules do not work if used directly: for example, the positions of grouping separators need to be counted from the left rather than from the right. Implementations, as always, are free to use a different algorithm that yields the same result.</p></div><div class="note"><p class="prefix"><b>Note:</b></p><p>A format token consisting of a single digit, such as <code>1</code>, does not constrain the number of digits in the output. In the case of fractional seconds in particular, <code>[f001]</code> requests three decimal digits, <code>[f01]</code> requests two digits, but <code>[f1]</code> will retain all digits in the supplied date/time value (the maximum number of digits is implementation-defined). If exactly one digit is required, this can be achieved using the component specifier <code>[f1,1-1]</code>.</p></div></div><div class="_diffs div4"><h5><a id="formatting-timezones"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.6</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.6</span> <a href="#formatting-timezones" style="text-decoration: none">Formatting timezones</a></h5><p>Special rules apply to the formatting of timezones. When the component specifiers <code>Z</code> or <code>z</code> are used, the rules in this section override any rules given elsewhere in the case of discrepancies.</p><p>If the date/time value to be formatted does not include a timezone offset, then the timezone component specifier is generally ignored (results in no output). The exception is where military timezones are used (format <code>ZZ</code>) in which case the string <code>"J"</code> is output, indicating local time.</p><ul><li><p>When the component specifier is <code>z</code>, the output is the same as for component specifier <code>Z</code>, except that it is prefixed by the characters <code>GMT</code> or some localized equivalent. The prefix is omitted, however, in cases where the timezone is identified by name rather than by a numeric offset from UTC.</p></li><li><p>If the first <var>presentation modifier</var> is numeric and comprises one or two digits with no <var>grouping-separator</var> (for example <code>1</code> or <code>01</code>), then the timezone is formatted as a displacement from UTC in hours, preceded by a plus or minus sign: for example <code>-5</code> or <code>+03</code>. If the actual timezone offset is not an integral number of hours, then the minutes part of the offset is appended, separated by a colon: for example <code>+10:30</code> or <code>-1:15</code>.</p></li><li><p>If the first <var>presentation modifier</var> is numeric with a <var>grouping-separator</var> (for example <code>1:01</code> or <code>01.01</code>), then the timezone offset is output in hours and minutes, separated by the grouping separator, even if the number of minutes is zero: for example <code>+5:00</code> or <code>+10.30</code>.</p></li><li><p>If the first <var>presentation modifier</var> is numeric and comprises three or four digits with no <var>grouping-separator</var>, for example <code>001</code> or <code>0001</code>, then the timezone offset is shown in hours and minutes with no separator, for example <code>-0500</code> or <code>+1030</code>. </p></li><li><p>If the first <var>presentation modifier</var> is numeric, in any of the above formats, and the second <var>presentation modifier</var> is <code>t</code>, then a zero timezone offset (that is, UTC) is output as <code>Z</code> instead of a signed numeric value. In this presentation modifier is absent or if the timezone offset is non-zero, then the displayed timezone offset is preceded by a <code>-</code> sign for negative offsets or a <code>+</code> sign for non-negative offsets.</p></li><li><p>If the first <var>presentation modifier</var> is <code>Z</code>, then the timezone is formatted as a military timezone letter, using the convention Z = +00:00, A = +01:00, B = +02:00, ..., M = +12:00, N = -01:00, O = -02:00, ... Y = -12:00. The letter J (meaning local time) is used in the case of a value that does not specify a timezone offset. Timezone offsets that have no representation in this system (for example Indian Standard Time, +05:30) are output as if the format <code>01:01</code> had been requested.</p></li><li><p>If the first <var>presentation modifier</var> is <code>N</code>, then the timezone is output (where possible) as a timezone name, for example <code>EST</code> or <code>CET</code>. The same timezone offset has different names in different places; it is therefore <span class="verb">recommended</span> that this option should be used only if a country code (see <a href="#ISO3166">[ISO 3166-1]</a>) or IANA timezone name (see <a href="#olson">[IANA Timezone Database]</a>) is supplied in the <code>$place</code> argument. In the absence of this information, the implementation may apply a default, for example by using the timezone names that are conventional in North America. If no timezone name can be identified, the timezone offset is output using the fallback format <span><code>01:01</code></span>.</p></li></ul><p>The following examples illustrate options for timezone formatting.</p><table class="small complex data"><thead><tr><th>Variable marker</th><th><code>$place</code></th><th colspan="5">Timezone offsets (with time = 12:00:00)</th></tr><tr><th>&nbsp;</th><th>&nbsp;</th><th>-10:00</th><th>-05:00</th><th>+00:00</th><th>+05:30</th><th>+13:00</th></tr></thead><tbody><tr><td>[Z]</td><td>()</td><td>-10:00</td><td>-05:00</td><td>+00:00</td><td>+05:30</td><td>+13:00</td></tr><tr><td>[Z0]</td><td>()</td><td>-10</td><td>-5</td><td>+0</td><td>+5:30</td><td>+13</td></tr><tr><td>[Z0:00]</td><td>()</td><td>-10:00</td><td>-5:00</td><td>+0:00</td><td>+5:30</td><td>+13:00</td></tr><tr><td>[Z00:00]</td><td>()</td><td>-10:00</td><td>-05:00</td><td>+00:00</td><td>+05:30</td><td>+13:00</td></tr><tr><td>[Z0000]</td><td>()</td><td>-1000</td><td>-0500</td><td>+0000</td><td>+0530</td><td>+1300</td></tr><tr><td>[Z00:00t]</td><td>()</td><td>-10:00</td><td>-05:00</td><td>Z</td><td>+05:30</td><td>+13:00</td></tr><tr><td>[z]</td><td>()</td><td>GMT‑10:00</td><td>GMT‑05:00</td><td>GMT+00:00</td><td>GMT+05:30</td><td>GMT+13:00</td></tr><tr><td>[ZZ]</td><td>()</td><td>W</td><td>R</td><td>Z</td><td>+05:30</td><td>+13:00</td></tr><tr><td>[ZN]</td><td>"us"</td><td>HST</td><td>EST</td><td>GMT</td><td>IST</td><td>+13:00</td></tr><tr><td>[H00]:[M00] [ZN]</td><td>"America/New_York"</td><td>06:00 EST</td><td>12:00 EST</td><td>07:00 EST</td><td>01:30 EST</td><td>18:00 EST</td></tr></tbody></table><p>If a width specifier is present when formatting a timezone, then the representation as defined in this section is padded to the minimum width as described in <a href="#width-modifier"><span style="display: none;" class="delete_version"><b>9.8.4.2 The Width Modifier</b></span><span style="display: none;" class="add_version"><b>9.9.4.2 The Width Modifier</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4.2</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.2</span> The Width Modifier</b></span></a>, but it is never shortened.</p></div><div class="_diffs div4"><h5><a id="formatting-other-components"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.7</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.7</span> <a href="#formatting-other-components" style="text-decoration: none">Formatting Other Components</a></h5><p>This section applies to the remaining components: <code>P</code> (am/pm marker), <code>C</code> (calendar), and <code>E</code> (era).</p><p><span style="display: none;" class="delete_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span></a>.</span><span style="display: none;" class="add_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span></a>.</span><span class="modify_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span style="display: none;" class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span style="display: none;" class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4.8</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.8</span> The language, calendar, and place arguments</b></span></a>.</span></p></div><div class="_diffs div4"><h5><a id="lang-cal-place"></a><span class="deltaxml-old" style="background:#FF5555">9.8.4.8</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.8</span> <a href="#lang-cal-place" style="text-decoration: none">The language, calendar, and place arguments</a></h5><p>The set of languages, calendars, and places that are supported in the <a title="date formatting function" class="termref" href="#dt-date-formatting-function">date formatting functions</a> is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. When any of these arguments is omitted or is an empty sequence, an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> default value is used.</p><p>If the fallback representation uses a different calendar from that requested, the output string <span class="verb">must</span> identify the calendar actually used, for example by prefixing the string with <code>[Calendar: X]</code> (where X is the calendar actually used), localized as appropriate to the requested language. If the fallback representation uses a different language from that requested, the output string <span class="verb">must</span> identify the language actually used, for example by prefixing the string with <code>[Language: Y]</code> (where Y is the language actually used) localized in an implementation-dependent way. If a particular component of the value cannot be output in the requested format, it <span class="verb">should</span> be output in the default format for that component.</p><p>The <code>$language</code> argument specifies the language to be used for the result string of the function. The value of the argument <span class="verb">should</span> be either the empty sequence or a value that would be valid for the <code>xml:lang</code> attribute (see <a href="#xml">[Extensible Markup Language (XML) 1.0 (Fifth Edition)]</a>). Note that this permits the identification of sublanguages based on country codes (from <a href="#ISO3166">[ISO 3166-1]</a>) as well as identification of dialects and of regions within a country.</p><p>If the <code>$language</code> argument is omitted or is set to an empty sequence, or if it is set to an invalid value or a value that the implementation does not recognize, then the processor uses the default language defined in the dynamic context.</p><p>The language is used to select the appropriate language-dependent forms of:</p><ul><li><p>names (for example, of months)</p></li><li><p>numbers expressed as words or as ordinals (<code>twenty, 20th, twentieth</code>)</p></li><li><p>hour convention (0-23 vs 1-24, 0-11 vs 1-12)</p></li><li><p>first day of week, first week of year</p></li></ul><p>Where appropriate this choice may also take into account the value of the <code>$place</code> argument, though this <span class="verb">should</span> not be used to override the language or any sublanguage that is specified as part of the <code>language</code> argument.</p><p>The choice of the names and abbreviations used in any given language is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. For example, one implementation might abbreviate July as <code>Jul</code> while another uses <code>Jly</code>. In German, one implementation might represent Saturday as <code>Samstag</code> while another uses <code>Sonnabend</code>. Implementations <span class="verb">may</span> provide mechanisms allowing users to control such choices.</p><p>Where ordinal numbers are used, the selection of the correct representation of the ordinal (for example, the grammatical gender) <span class="verb">may</span> depend on the component being formatted and on its textual context in the picture string.</p><p>The <code>calendar</code> attribute specifies that the <code>dateTime</code>, <code>date</code>, or <code>time</code> supplied in the <code>$value</code> argument <span class="verb">must</span> be converted to a value in the specified calendar and then converted to a string using the conventions of that calendar.</p><p>The calendar value if present <span class="verb">must</span> be a valid <code>EQName</code> (dynamic error: [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]). If it is a lexical <code>QName</code> then it is expanded into an expanded QName using the statically known namespaces; if it has no prefix then it represents an expanded-QName in no namespace. If the expanded QName is in no namespace, then it <span class="verb">must</span> identify a calendar with a designator specified below (dynamic error: [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]). If the expanded QName is in a namespace then it identifies the calendar in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way.</p><p>If the <code>$calendar</code> argument is omitted or is set to an empty sequence then the default calendar defined in the dynamic context is used.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>The calendars listed below were known to be in use during the last hundred years. Many other calendars have been used in the past.</p><p>This specification does not define any of these calendars, nor the way that they map to the value space of the <code>xs:date</code> datatype in <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a>. There may be ambiguities when dates are recorded using different calendars. For example, the start of a new day is not simultaneous in different calendars, and may also vary geographically (for example, based on the time of sunrise or sunset). Translation of dates is therefore more reliable when the time of day is also known, and when the geographic location is known. When translating dates between one calendar and another, the processor may take account of the values of the <code>$place</code> and/or <code>$language</code> arguments, with the <code>$place</code> argument taking precedence.</p><p>Information about some of these calendars, and algorithms for converting between them, may be found in <a href="#CALCALC">[Calendrical Calculations]</a>.</p></div><table class="data"><thead><tr><th>Designator</th><th>Calendar</th></tr></thead><tbody><tr><td>AD</td><td>Anno Domini (Christian Era)</td></tr><tr><td>AH</td><td>Anno Hegirae (Islamic Era)</td></tr><tr><td>AME</td><td>Mauludi Era (solar years since Muhammad’s birth)</td></tr><tr><td>AM</td><td>Anno Mundi (Jewish Calendar)</td></tr><tr><td>AP</td><td>Anno Persici</td></tr><tr><td>AS</td><td>Aji Saka Era (Java)</td></tr><tr><td>BE</td><td>Buddhist Era</td></tr><tr><td>CB</td><td>Cooch Behar Era</td></tr><tr><td>CE</td><td>Common Era</td></tr><tr><td>CL</td><td>Chinese Lunar Era</td></tr><tr><td>CS</td><td>Chula Sakarat Era</td></tr><tr><td>EE</td><td>Ethiopian Era</td></tr><tr><td>FE</td><td>Fasli Era</td></tr><tr><td>ISO</td><td>ISO 8601 calendar</td></tr><tr><td>JE</td><td>Japanese Calendar</td></tr><tr><td>KE</td><td>Khalsa Era (Sikh calendar)</td></tr><tr><td>KY</td><td>Kali Yuga</td></tr><tr><td>ME</td><td>Malabar Era</td></tr><tr><td>MS</td><td>Monarchic Solar Era</td></tr><tr><td>NS</td><td>Nepal Samwat Era</td></tr><tr><td>OS</td><td>Old Style (Julian Calendar)</td></tr><tr><td>RS</td><td>Rattanakosin (Bangkok) Era</td></tr><tr><td>SE</td><td>Saka Era</td></tr><tr><td>SH</td><td>Solar Hijri (Islamic Era, used in Iran and Afghanistan)</td></tr><tr><td>SS</td><td>Saka Samvat</td></tr><tr><td>TE</td><td>Tripurabda Era</td></tr><tr><td>VE</td><td>Vikrama Era</td></tr><tr><td>VS</td><td>Vikrama Samvat Era</td></tr></tbody></table><p>At least one of the above calendars <span class="verb">must</span> be supported. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which calendars are supported.</p><p>The ISO 8601 calendar (<a href="#ISO8601">[ISO 8601]</a>), which is included in the above list and designated <code>ISO</code>, is very similar to the Gregorian calendar designated <code>AD</code>, but it differs in several ways. The ISO calendar is intended to ensure that date and time formats can be read easily by other software, as well as being legible for human users. The ISO calendar prescribes the use of particular numbering conventions as defined in ISO 8601, rather than allowing these to be localized on a per-language basis. In particular it provides a numeric “week date” format which identifies dates by year, week of the year, and day in the week; in the ISO calendar the days of the week are numbered from 1 (Monday) to 7 (Sunday), and week 1 in any calendar year is the week (from Monday to Sunday) that includes the first Thursday of that year. The numeric values of the components year, month, day, hour, minute, and second are the same in the ISO calendar as the values used in the lexical representation of the date and time as defined in <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a>. The era (<code>E</code> component) with this calendar is either a minus sign (for negative years) or a zero-length string (for positive years). For dates before 1 January, AD 1, year numbers in the ISO and AD calendars are off by one from each other: ISO year 0000 is 1 BC, -0001 is 2 BC, etc.</p><p>ISO 8601 does not define a numbering for weeks within a month. When the <code>w</code> component is used, the convention to be adopted is that each Monday-to-Sunday week is considered to fall within a particular month if its Thursday occurs in that month; the weeks that fall in a particular month under this definition are numbered starting from 1. Thus, for example, 29 January 2013 falls in week 5 because the Thursday of the week (31 January 2013) is the fifth Thursday in January, and 1 February 2013 is also in week 5 for the same reason.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>The value space of the date and time datatypes, as defined in XML Schema, is based on absolute points in time. The lexical space of these datatypes defines a representation of these absolute points in time using the proleptic Gregorian calendar, that is, the modern Western calendar extrapolated into the past and the future; but the value space is calendar-neutral. The <a title="date formatting function" class="termref" href="#dt-date-formatting-function">date formatting functions</a> produce a representation of this absolute point in time, but denoted in a possibly different calendar. So, for example, the date whose lexical representation in XML Schema is <code>1502-01-11</code> (the day on which Pope Gregory XIII was born) might be formatted using the Old Style (Julian) calendar as <code>1 January 1502</code>. This reflects the fact that there was at that time a ten-day difference between the two calendars. It would be incorrect, and would produce incorrect results, to represent this date in an element or attribute of type <code>xs:date</code> as <code>1502-01-01</code>, even though this might reflect the way the date was recorded in contemporary documents.</p><p>When referring to years occurring in antiquity, modern historians generally use a numbering system in which there is no year zero (the year before 1 CE is thus 1 BCE). This is the convention that <span class="verb">should</span> be used when the requested calendar is OS (Julian) or AD (Gregorian). When the requested calendar is ISO, however, the conventions of ISO 8601 <span class="verb">should</span> be followed: here the year before +0001 is numbered zero. In <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> (version 1.0), the value space for <code>xs:date</code> and <code>xs:dateTime</code> does not include a year zero: however, XSD 1.1 endorses the ISO 8601 convention. This means that the date on which Julius Caesar was assassinated has the ISO 8601 lexical representation -0043-03-13, but will be formatted as 15 March 44 BCE in the Julian calendar or 13 March 44 BCE in the Gregorian calendar (dependent on the chosen localization of the names of months and eras).</p></div><p>The intended use of the <code>$place</code> argument is to identify the place where an event represented by the <code>dateTime</code>, <code>date</code>, or <code>time</code> supplied in the <code>$value</code> argument took place or will take place. If the <code>$place</code> argument is omitted or is set to an empty sequence, then the default place defined in the dynamic context is used. If the value is supplied, and is not the empty sequence, then it <span class="verb">should</span> either be a country code or an IANA timezone name. If the value does not take this form, or if its value is not recognized by the implementation, then the default place defined in the dynamic context is used.</p><ul><li><p>Country codes are defined in <a href="#ISO3166">[ISO 3166-1]</a>. Examples are <code>"de"</code> for Germany and <code>"jp"</code> for Japan. Implementations <span class="verb">may</span> also allow the use of codes representing subdivisions of a country from ISO 3166-2, or codes representing formerly used names of countries from ISO 3166-3</p></li><li><p>IANA timezone names are defined in the IANA timezone database <a href="#olson">[IANA Timezone Database]</a>. Examples are <code>"America/New_York"</code> and <code>"Europe/Rome"</code>.</p></li></ul><p>This argument is not intended to identify the location of the user for whom the date or time is being formatted; that should be done by means of the <code>$language</code> attribute. This information <span class="verb">may</span> be used to provide additional information when converting dates between calendars or when deciding how individual components of the date and time are to be formatted. For example, different countries using the Old Style (Julian) calendar started the new year on different days, and some countries used variants of the calendar that were out of synchronization as a result of differences in calculating leap years.</p><p>The geographical area identified by a country code is defined by the boundaries as they existed at the time of the date to be formatted, or the present-day boundaries for dates in the future.</p><p>If the <code>$place</code> argument is supplied in the form of an IANA timezone name that is recognized by the implementation, then the date or time being formatted is adjusted to the timezone offset applicable in that timezone. For example, if the <code>xs:dateTime</code> value <code>2010-02-15T12:00:00Z</code> is formatted with the <code>$place</code> argument set to <code>America/New_York</code>, then the output will be as if the value <code>2010-02-15T07:00:00-05:00</code> had been supplied. This adjustment takes daylight savings time into account where possible; if the date in question falls during daylight savings time in New York, then it is adjusted to timezone offset <code>-PT4H</code> rather than <code>-PT5H</code>. Adjustment using daylight savings time is only possible where the value includes a date, and where the date is within the range covered by the timezone database.</p></div></div><div class="_diffs div3"><h4><a id="date-time-examples"></a><span class="deltaxml-old" style="background:#FF5555">9.8.5</span><span class="deltaxml-new" style="background:#90EE90">9.9.5</span> <a href="#date-time-examples" style="text-decoration: none">Examples of date and time formatting</a></h4><p>The following examples show a selection of dates and times and the way they might be formatted. These examples assume the use of the Gregorian calendar as the default calendar.</p><table class="data"><thead><tr><th>Required Output</th><th>Expression</th></tr></thead><tbody><tr><td><code>2002-12-31</code></td><td><code>format-date($d, "[Y0001]-[M01]-[D01]")</code></td></tr><tr><td><code>12-31-2002</code></td><td><code>format-date($d, "[M]-[D]-[Y]")</code></td></tr><tr><td><code>31-12-2002</code></td><td><code>format-date($d, "[D]-[M]-[Y]")</code></td></tr><tr><td><code>31 XII 2002</code></td><td><code>format-date($d, "[D1] [MI] [Y]")</code></td></tr><tr><td><code>31st December, 2002</code></td><td><code>format-date($d, "[D1o] [MNn], [Y]", "en", (), ())</code></td></tr><tr><td><code>31 DEC 2002</code></td><td><code>format-date($d, "[D01] [MN,*-3] [Y0001]", "en", (), ())</code></td></tr><tr><td><code>December 31, 2002</code></td><td><code>format-date($d, "[MNn] [D], [Y]", "en", (), ())</code></td></tr><tr><td><code>31 Dezember, 2002</code></td><td><code>format-date($d, "[D] [MNn], [Y]", "de", (), ())</code></td></tr><tr><td><code>Tisdag 31 December 2002</code></td><td><code>format-date($d, "[FNn] [D] [MNn] [Y]", "sv", (), ())</code></td></tr><tr><td><code>[2002-12-31]</code></td><td><code>format-date($d, "[[[Y0001]-[M01]-[D01]]]")</code></td></tr><tr><td><code>Two Thousand and Three</code></td><td><code>format-date($d, "[YWw]", "en", (), ())</code></td></tr><tr><td><code>einunddreißigste Dezember</code></td><td><code>format-date($d, "[Dwo] [MNn]", "de", (), ())</code></td></tr><tr><td><code>3:58 PM</code></td><td><code>format-time($t, "[h]:[m01] [PN]", "en", (), ())</code></td></tr><tr><td><code>3:58:45 pm</code></td><td><code>format-time($t, "[h]:[m01]:[s01] [Pn]", "en", (), ())</code></td></tr><tr><td><code>3:58:45 PM PDT</code></td><td><code>format-time($t, "[h]:[m01]:[s01] [PN] [ZN,*-3]", "en", (), ())</code></td></tr><tr><td><code>3:58:45 o'clock PM PDT</code></td><td><code>format-time($t, "[h]:[m01]:[s01] o'clock [PN] [ZN,*-3]", "en", (), ())</code></td></tr><tr><td><code>15:58</code></td><td><code>format-time($t, "[H01]:[m01]")</code></td></tr><tr><td><code>15:58:45.762</code></td><td><code>format-time($t, "[H01]:[m01]:[s01].[f001]")</code></td></tr><tr><td><code>15:58:45 GMT+02:00</code></td><td><code>format-time($t, "[H01]:[m01]:[s01] [z,6-6]", "en", (), ())</code></td></tr><tr><td><code>15.58 Uhr GMT+2</code></td><td><code>format-time($t, "[H01]:[m01] Uhr [z]", "de", (), ())</code></td></tr><tr><td><code>3.58pm on Tuesday, 31st December</code></td><td><code>format-dateTime($dt, "[h].[m01][Pn] on [FNn], [D1o] [MNn]")</code></td></tr><tr><td><code>12/31/2002 at 15:58:45</code></td><td><code>format-dateTime($dt, "[M01]/[D01]/[Y0001] at [H01]:[m01]:[s01]")</code></td></tr></tbody></table><p>The following examples use calendars other than the Gregorian calendar.</p><table class="data"><thead><tr><th>Description</th><th>Request</th><th>Result</th></tr></thead><tbody><tr><td>Islamic</td><td><code>format-date($d, "[D&amp;#x0661;] [Mn] [Y&amp;#x0661;]", "ar", "AH", ())</code></td><td>٢٦ ﺸﻭّﺍﻝ ١٤٢٣</td></tr><tr><td>Jewish (with Western numbering)</td><td><code>format-date($d, "[D] [Mn] [Y]", "he", "AM", ())</code></td><td>‏26 טבת 5763</td></tr><tr><td>Jewish (with traditional numbering)</td><td><code>format-date($d, "[D&amp;#x05D0;t] [Mn] [Y&amp;#x05D0;t]", "he", "AM", ())</code></td><td>כ״ו טבת תשס״ג</td></tr><tr><td>Julian (Old Style)</td><td><code>format-date($d, "[D] [MNn] [Y]", "en", "OS", ())</code></td><td>18 December 2002</td></tr><tr><td>Thai</td><td><code>format-date($d, "[D&amp;#x0E51;] [Mn] [Y&amp;#x0E51;]", "th", "BE", ())</code></td><td>๓๑ ธันวาคม ๒๕๔๕</td></tr></tbody></table></div></div><div class="_diffs div2"><h3><a id="parsing-dates-and-times"></a><span class="deltaxml-old" style="background:#FF5555">9.9</span><span class="deltaxml-new" style="background:#90EE90">9.10</span> <a href="#parsing-dates-and-times" style="text-decoration: none">Parsing dates and times</a></h3><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-parse-ietf-date"><code>fn:parse-ietf-date</code></a></td><td>Parses a string containing the date and time in IETF format, returning the corresponding <code>xs:dateTime</code> value.</td></tr></tbody></table><p>A function is provided to parse dates and times expressed using syntax that is commonly encountered in internet protocols.</p><div class="_diffs div3"><h4><a id="func-parse-ietf-date"></a><span class="deltaxml-old" style="background:#FF5555">9.9.1</span><span class="deltaxml-new" style="background:#90EE90">9.10.1</span> <a href="#func-parse-ietf-date" style="text-decoration: none">fn:parse-ietf-date</a></h4><dl><dt class="label">Summary</dt><dd><p>Parses a string containing the date and time in IETF format, returning the corresponding <code>xs:dateTime</code> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:parse-ietf-date</code>(</td></tr><tr class="arg"><td><code>$value</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:dateTime?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The function accepts a string matching the production <code>input</code> in the following grammar:</p><table class="scrap"><tbody><tr><td><code>input</code></td><td><code>::=</code></td><td><code>S? (dayname ","? S)? ((datespec S time) | asctime) S?</code></td></tr><tr><td><code>dayname</code></td><td><code>::=</code></td><td><code>"Mon" | "Tue" | "Wed" | "Thu" | "Fri" | "Sat" | "Sun" | "Monday | "Tuesday" | "Wednesday" | "Thursday" | "Friday" | "Saturday" | "Sunday"</code></td></tr><tr><td><code>datespec</code></td><td><code>::=</code></td><td><code>daynum dsep monthname dsep year</code></td></tr><tr><td><code>asctime</code></td><td><code>::=</code></td><td><code>monthname dsep daynum S time S year</code></td></tr><tr><td><code>dsep</code></td><td><code>::=</code></td><td><code>S | (S? "-" S?)</code></td></tr><tr><td><code>daynum</code></td><td><code>::=</code></td><td><code>digit digit?</code></td></tr><tr><td><code>year</code></td><td><code>::=</code></td><td><code>digit digit (digit digit)?</code></td></tr><tr><td><code>digit</code></td><td><code>::=</code></td><td><code>[0-9]</code></td></tr><tr><td><code>monthname</code></td><td><code>::=</code></td><td><code>"Jan" | "Feb" | "Mar" | "Apr" | "May" | "Jun" | "Jul" | "Aug" | "Sep" | "Oct" | "Nov" | "Dec"</code></td></tr><tr><td><code>time</code></td><td><code>::=</code></td><td><code>hours ":" minutes (":" seconds)? (S? timezone)?</code></td></tr><tr><td><code>hours</code></td><td><code>::=</code></td><td><span><code>digit digit?</code></span></td></tr><tr><td><code>minutes</code></td><td><code>::=</code></td><td><code>digit digit</code></td></tr><tr><td><code>seconds</code></td><td><code>::=</code></td><td><code>digit digit ("." digit+)?</code></td></tr><tr><td><code>timezone</code></td><td><code>::=</code></td><td><code>tzname | tzoffset (S? "(" S? tzname S? ")")?</code></td></tr><tr><td><code>tzname</code></td><td><code>::=</code></td><td><code>"UT" | "UTC" | "GMT" | "EST" | "EDT" | "CST" | "CDT" | "MST" | "MDT" | "PST" | "PDT" </code></td></tr><tr><td><code>tzoffset</code></td><td><code>::=</code></td><td><span><code>("+"|"-") hours ":"? minutes?</code></span></td></tr><tr><td><code>S</code></td><td><code>::=</code></td><td><code>(x09 | x0A | x0D | x20)+</code></td></tr></tbody></table><p>The input is case-insensitive: upper-case and lower-case distinctions in the above grammar show the conventional usage, but otherwise have no significance.</p><p>If the input is an empty sequence, the result is an empty sequence.</p><p>The <code>dayname</code>, if present, is ignored.</p><p>The <code>daynum</code>, <code>monthname</code>, and <code>year</code> supply the day, month, and year of the resulting <code>xs:dateTime</code> value. A two-digit year <span class="verb">must</span> have 1900 added to it. A year such as 0070 is to be treated as given; negative years are not permitted.</p><p>The <code>hours</code>, <code>minutes</code>, and <code>seconds</code> (including fractional seconds) values supply the corresponding components of the resulting <code>xs:dateTime</code> value; if the <code>seconds</code> value <span>or the fractional seconds value</span> is absent then zero is assumed.</p><p>If both a <code>tzoffset</code> and a <code>tzname</code> are supplied then the <code>tzname</code> is ignored.</p><p>If a <code>tzoffset</code> is supplied then this defines the hours and minutes parts of the timezone offset:</p><ul><li><p>If it contains a colon, this separates the hours part from the minutes part.</p></li><li><p>Otherwise, the grammar allows a sequence of from one to four digits. These are interpreted as <code>H</code>, <code>HH</code>, <code>HMM</code>, or <code>HHMM</code> respectively, where <code>H</code> or <code>HH</code> is the hours part, and <code>MM</code> (if present) is the minutes part.</p></li><li><p>If the minutes part is absent it defaults to <code>00</code>.</p></li></ul><p>If a <code>tzname</code> is supplied with no <code>tzoffset</code> then it is translated to a timezone offset as follows:</p><table class="data"><thead><tr><th>tzname</th><th>Offset</th></tr></thead><tbody><tr><td>UT, UTC, GMT</td><td>00:00</td></tr><tr><td>EST</td><td>-05:00</td></tr><tr><td>EDT</td><td>-04:00</td></tr><tr><td>CST</td><td>-06:00</td></tr><tr><td>CDT</td><td>-05:00</td></tr><tr><td>MST</td><td>-07:00</td></tr><tr><td>MDT</td><td>-06:00</td></tr><tr><td>PST</td><td>-08:00</td></tr><tr><td>PDT</td><td>-07:00</td></tr></tbody></table><p>If neither a <code>tzoffset</code> nor <code>tzname</code> is supplied, a timezone offset of <code>00:00</code> is assumed.</p></dd><dt class="label">Error Conditions</dt><dd><p>A dynamic error is raised [<a href="#ERRFORG0010" title="err:FORG0010">err:FORG0010</a>] if the input does not match the grammar, or if the resulting date/time value is invalid (for example, <code>"31 February"</code>).</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>The <code>parse-ietf-date</code> function attempts to interpret its input as a date in any of the three formats specified by HTTP <a href="#rfc2616">[RFC 2616]</a>.</p><p>These formats are used widely on the Internet to represent timestamps, and were specified in:</p><ul><li><p><a href="#rfc822">[RFC 822]</a> (electronic mail), extended in <a href="#rfc1123">[RFC 1123]</a> to allow four-digit years;</p></li><li><p><a href="#rfc850">[RFC 850]</a> (Usenet Messages), obsoleted by <a href="#rfc1036">[RFC 1036]</a>;</p></li><li><p>POSIX <code>asctime()</code> format</p></li></ul><p><a href="#rfc2616">[RFC 2616]</a> (HTTP) officially uses a subset of those three formats restricted to GMT.</p><p>The grammar for this function is slightly more liberal than the RFCs (reflecting the internet tradition of being liberal in what is accepted). For example the function:</p><ol class="enumar"><li><p>Accepts a single-digit value where appropriate in place of a two-digit value with a leading zero (so <code>"Wed 1 Jun"</code> is acceptable in place of <code>"Wed 01 Jun"</code>, <span>and the timezone offset <code>"-5:00"</code> is equivalent to <code>"-05:00"</code>)</span></p></li><li><p>Accepts one or more whitespace characters (x20, x09, x0A, x0D) wherever a single space is required, and allows whitespace to be omitted where it is not required for parsing</p></li><li><p>Accepts and ignores whitespace characters (x20, x09, x0A, x0D) at the start or end of the string.</p></li></ol><p>In new protocols IETF recommends the format of <a href="#rfc3339">[RFC 3339]</a>, which is based on a profile of ISO 8601 similar to that already used in XPath and XSD, but the “approximate” <a href="#rfc822">[RFC 822]</a> format described here is very widely used.</p><p>An <a href="#rfc1123">[RFC 1123]</a> date can be generated approximately using <a href="#func-format-dateTime"><code>fn:format-dateTime</code></a> with a picture string of <code>"[FNn3], [D01] [MNn3] [Y04] [H01]:[m01]:[s01] [Z0000]"</code>.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>parse-ietf-date("Wed, 06 Jun 1994 07:29:35 GMT")</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dateTime("1994-06-06T07:29:35Z")</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>parse-ietf-date("Wed, 6 Jun 94 07:29:35 GMT")</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dateTime("1994-06-06T07:29:35Z")</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>parse-ietf-date("Wed Jun 06 11:54:45 EST 2013")</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dateTime("2013-06-06T11:54:45-05:00")</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>parse-ietf-date("Sunday, 06-Nov-94 08:49:37 GMT")</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dateTime("1994-11-06T08:49:37Z")</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>parse-ietf-date("Wed, 6 Jun 94 07:29:35 +0500")</code></pre></div></td><td style="vertical-align:top"><p><code>xs:dateTime("1994-06-06T07:29:35+05:00")</code></p></td></tr></tbody></table></div></dd></dl></div></div></div><div class="_diffs div1"><h2><a id="dynamic-loading"></a>18 <a href="#dynamic-loading" style="text-decoration: none">Dynamic evaluation</a></h2><p>The following functions allow dynamic loading and evaluation of XQuery queries, XSLT stylesheets, and XPath binary operators.</p><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a></td><td>Provides access to the public functions and global variables of a dynamically loaded XQuery library module.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-transform"><code>fn:transform</code></a></td><td>Invokes a transformation using a dynamically loaded XSLT stylesheet.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-op"><code>fn:op</code></a></td><td>Returns a function whose effect is to apply a supplied binary operator to two arguments.</td></tr></tbody></table><div class="_diffs div2"><h3><a id="load-xquery-module-record"></a>18.1 <a href="#load-xquery-module-record" style="text-decoration: none">Record fn:load-xquery-module-record</a></h3><p>This record type is used to hold the result of the <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> function.</p><table class="fos-options"><thead><tr><th>Name</th><th>Meaning</th></tr></thead><tbody><tr><td><p><code>variables</code></p></td><td class="fos-thin"><span class="deltaxml-new" style="background:#90EE90"> global variable declared in the library module. The key of the </span><p><span style="display: none;" class="delete_version">This map (<var>V</var> ) contains one entry for each public global variable declared in the library module. The key of the entry is the name of the variable, as an <code>xs:QName</code> value; the associated value is the value of the variable.</span><span style="display: none;" class="add_version">This map (<var>V</var> ) contains one entry for each public entry is the name of the variable, as an <code>xs:QName</code> value; the associated value is the value of the variable.</span><span class="modify_version">This map (<var>V</var> ) contains one entry for each public <span class="deltaxml-old" style="background:#FF5555">global variable declared in the library module. The key of the </span>entry is the name of the variable, as an <code>xs:QName</code> value; the associated value is the value of the variable.</span></p><ul><li><p><b>Type: </b><code>map(xs:QName, item()*)</code></p></li></ul></td></tr><tr><td><p><code>functions</code></p></td><td class="fos-thin"><p>This map (<var>F</var> ) contains one entry for each distinct QName <var>Q</var> that represents the name of a public and non-external function declared in the library module. The key of the entry is <var>Q</var>, as an <code>xs:QName</code> value; the associated value is a map <var>A</var>. This map (<var>A</var>) contains one entry for each arity <var>N</var> within the arity range of any of the function declarations with the given name; its key is <var>N</var>, as an <code>xs:integer</code> value, and its associated value is a function item obtained as if by evaluating a named function reference <code>Q#N</code>, using the static and dynamic context of the call on <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a>. The function item can be invoked using the rules for dynamic function invocation.</p><ul><li><p><b>Type: </b><code>map(xs:QName, map(xs:integer, function(*)))</code></p></li></ul></td></tr></tbody></table></div></div></div><div class="back"><div class="_diffs div1"><h2><a id="error-summary"></a>B <a href="#error-summary" style="text-decoration: none">Error codes</a></h2><p>The error text provided with these errors is non-normative.</p><dl><dt><a id="ERRFOAP0001"></a>err:FOAP0001, Wrong number of arguments.</dt><dd><p>Raised when <a href="#func-apply"><code>fn:apply</code></a> is called and the arity of the supplied function is not the same as the number of members in the supplied array.</p></dd><dt><a id="ERRFOAR0001"></a>err:FOAR0001, Division by zero.</dt><dd><p>This error is raised whenever an attempt is made to divide by zero.</p></dd><dt><a id="ERRFOAR0002"></a>err:FOAR0002, Numeric operation overflow/underflow.</dt><dd><p>This error is raised whenever numeric operations result in an overflow or underflow.</p></dd><dt><a id="ERRFOAY0001"></a>err:FOAY0001, Array index out of bounds.</dt><dd><p>This error is raised when an integer used to select a member of an array is outside the range of values for that array.</p></dd><dt><a id="ERRFOAY0002"></a>err:FOAY0002, Negative array length.</dt><dd><p>This error is raised when the <code>$length</code> argument to <a href="#func-array-subarray"><code>array:subarray</code></a> is negative.</p></dd><dt><a id="ERRFOCA0001"></a>err:FOCA0001, Input value too large for decimal.</dt><dd><p>Raised when casting to <code>xs:decimal</code> if the supplied value exceeds the implementation-defined limits for the datatype.</p></dd><dt><a id="ERRFOCA0002"></a>err:FOCA0002, Invalid lexical value.</dt><dd><p>Raised by <a href="#func-resolve-QName"><code>fn:resolve-QName</code></a> and <a href="#func-QName"><code>fn:QName</code></a> when a supplied value does not have the lexical form of a QName or URI respectively; and when casting to decimal, if the supplied value is <code>NaN</code> or Infinity.</p></dd><dt><a id="ERRFOCA0003"></a>err:FOCA0003, Input value too large for integer.</dt><dd><p>Raised when casting to <code>xs:integer</code> if the supplied value exceeds the implementation-defined limits for the datatype.</p></dd><dt><a id="ERRFOCA0005"></a>err:FOCA0005, NaN supplied as float/double value.</dt><dd><p>Raised when multiplying or dividing a duration by a number, if the number supplied is <code>NaN</code>.</p></dd><dt><a id="ERRFOCA0006"></a>err:FOCA0006, String to be cast to decimal has too many digits of precision.</dt><dd><p>Raised when casting a string to <code>xs:decimal</code> if the string has more digits of precision than the implementation can represent (the implementation also has the option of rounding).</p></dd><dt><a id="ERRFOCH0001"></a>err:FOCH0001, Codepoint not valid.</dt><dd><p>Raised by <a href="#func-codepoints-to-string"><code>fn:codepoints-to-string</code></a> if the input contains an integer that is not the codepoint of a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>.</p></dd><dt><a id="ERRFOCH0002"></a>err:FOCH0002, Unsupported collation.</dt><dd><p>Raised by any function that uses a collation if the requested collation is not recognized.</p></dd><dt><a id="ERRFOCH0003"></a>err:FOCH0003, Unsupported normalization form.</dt><dd><p>Raised by <a href="#func-normalize-unicode"><code>fn:normalize-unicode</code></a> if the requested normalization form is not supported by the implementation.</p></dd><dt><a id="ERRFOCH0004"></a>err:FOCH0004, Collation does not support collation units.</dt><dd><p>Raised by functions such as <a href="#func-contains"><code>fn:contains</code></a> if the requested collation does not operate on a character-by-character basis.</p></dd><dt><a id="ERRFOCH0005"></a>err:FOCH0005, Unrecognized or invalid character name.</dt><dd><p>Raised by <a href="#func-char"><code>fn:char</code></a> if the supplied character name is not recognized, or if it represents a codepoint that is not a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>.</p></dd><dt><a id="ERRFOCV0001"></a>err:FOCV0001, CSV field quoting error.</dt><dd><p>Raised when parsing CSV input if a syntax error in the input CSV is found.</p></dd><dt><a id="ERRFOCV0002"></a>err:FOCV0002, Invalid CSV delimiter error.</dt><dd><p>Raised when parsing CSV input if the <code>field-separator</code>, <code>record-separator</code>, or <code>quote-character</code> option is set to an invalid value.</p></dd><dt><a id="ERRFOCV0003"></a>err:FOCV0003, Duplicate CSV delimiter error.</dt><dd><p>Raised when parsing CSV input if the same delimiter character is assigned to more than one role.</p></dd><dt><a id="ERRFOCV0004"></a>err:FOCV0004, Argument supplied is not a known column name.</dt><dd><p>Raised by the function from the <code>get</code> entry of <code>csv-columns-record</code>, if its <code>$key</code> argument is an <code>xs:string</code> and is not one of the known column names.</p></dd><dt><a id="ERRFODC0001"></a>err:FODC0001, No context document.</dt><dd><p>Raised by <a href="#func-id"><code>fn:id</code></a>, <a href="#func-idref"><code>fn:idref</code></a>, and <a href="#func-element-with-id"><code>fn:element-with-id</code></a> if the node that identifies the tree to be searched is a node in a tree whose root is not a document node.</p></dd><dt><a id="ERRFODC0002"></a>err:FODC0002, Error retrieving resource.</dt><dd><p>Raised by <a href="#func-doc"><code>fn:doc</code></a>, <a href="#func-collection"><code>fn:collection</code></a>, and <a href="#func-uri-collection"><code>fn:uri-collection</code></a> to indicate that either the supplied URI cannot be dereferenced to obtain a resource, or the resource that is returned is not parseable as XML.</p></dd><dt><a id="ERRFODC0003"></a>err:FODC0003, Function not defined as deterministic.</dt><dd><p>Raised by <a href="#func-doc"><code>fn:doc</code></a>, <a href="#func-collection"><code>fn:collection</code></a>, and <a href="#func-uri-collection"><code>fn:uri-collection</code></a> to indicate that it is not possible to return a result that is guaranteed deterministic.</p></dd><dt><a id="ERRFODC0004"></a>err:FODC0004, Invalid collection URI.</dt><dd><p>Raised by <a href="#func-collection"><code>fn:collection</code></a> and <a href="#func-uri-collection"><code>fn:uri-collection</code></a> if the argument is not a valid <code>xs:anyURI</code>.</p></dd><dt><a id="ERRFODC0005"></a>err:FODC0005, Invalid URI reference.</dt><dd><p>Raised (optionally) by <a href="#func-doc"><code>fn:doc</code></a> if the argument is not a valid <code>xs:anyURI</code>.</p></dd><dt><a id="ERRFODC0006"></a>err:FODC0006, String passed to fn:parse-xml is not a well-formed XML document.</dt><dd><p>Raised by <a href="#func-parse-xml"><code>fn:parse-xml</code></a> if the supplied string is not a well-formed and namespace-well-formed XML document; or if DTD validation is requested and the document is not valid against its DTD.</p></dd><dt><a id="ERRFODC0007"></a>err:FODC0007, String passed to fn:parse-xml is not a DTD-valid XML document.</dt><dd><p>Raised by <a href="#func-parse-xml"><code>fn:parse-xml</code></a> if DTD validation is requested and the supplied string has no DTD or is not valid against the DTD.</p></dd><dt><a id="ERRFODC0008"></a>err:FODC0008, Invalid value for the xsd-validation option of fn:parse-xml.</dt><dd><p>Raised when the <code>xsd-validation</code> option to <a href="#func-parse-xml"><code>fn:parse-xml</code></a> is supplied, and the value is not one of the permitted values; for example if the option <code>type Q{U}NNN</code> is used, and <code>Q{U}NNN</code> does not identify a type in the static context.</p></dd><dt><a id="ERRFODC0009"></a>err:FODC0009, Processor is not schema-aware.</dt><dd><p>Raised when the <code>xsd-validation</code> option to <a href="#func-parse-xml"><code>fn:parse-xml</code></a> is set to a value other than <code>skip</code>, if the processor is not schema-aware.</p></dd><dt><a id="ERRFODC0010"></a>err:FODC0010, The processor does not support serialization.</dt><dd><p>Raised when <a href="#func-serialize"><code>fn:serialize</code></a> is called and the processor does not support serialization, in cases where the host language makes serialization an optional feature.</p></dd><dt><a id="ERRFODC0011"></a>err:FODC0011, String passed to fn:parse-html is not a well-formed HTML document.</dt><dd><p>Raised by <a href="#func-parse-html"><code>fn:parse-html</code></a> if the supplied string is not a well-formed HTML document.</p></dd><dt><a id="ERRFODC0013"></a>err:FODC0013, No validating XML parser available.</dt><dd><p>Raised when the <code>dtd-validation</code> option to <a href="#func-parse-xml"><code>fn:parse-xml</code></a> is set, if no validating XML parser is available. Note: it is <span class="verb">recommended</span> that all processors should support the <code>dtd-validation</code> option, but there may be environments (such as web browsers) where this is not practically feasible.</p></dd><dt><a id="ERRFODC0014"></a>err:FODC0014, String passed to fn:parse-xml is not a schema-valid XML document.</dt><dd><p>Raised by <a href="#func-parse-xml"><code>fn:parse-xml</code></a> if XSD validation is requested and the XML document represented by the supplied string is not valid against the relevant XSD schema.</p></dd><dt><a id="ERRFODC0015"></a>err:FODC0015, Unable to compile schema for fn:xsd-validator.</dt><dd><p>Raised by <a href="#func-xsd-validator"><code>fn:xsd-validator</code></a> if it is not possible to assemble a valid and consistent schema.</p></dd><dt><a id="ERRFODF1280"></a>err:FODF1280, Invalid decimal format name.</dt><dd><p>This error is raised if the decimal format name supplied to <a href="#func-format-number"><code>fn:format-number</code></a> is not a valid QName, or if the prefix in the QName is undeclared, or if there is no decimal format in the static context with a matching name.</p></dd><dt><a id="ERRFODF1290"></a>err:FODF1290, Invalid decimal format property.</dt><dd><p>This error is raised if a decimal format value supplied to <a href="#func-format-number"><code>fn:format-number</code></a> is not valid for the associated property, or if the properties of the decimal format resulting from a supplied map do not have distinct values.</p></dd><dt><a id="ERRFODF1310"></a>err:FODF1310, Invalid decimal format picture string.</dt><dd><p>This error is raised if the picture string supplied to <a href="#func-format-number"><code>fn:format-number</code></a> or <a href="#func-format-integer"><code>fn:format-integer</code></a> has invalid syntax.</p></dd><dt><a id="ERRFODT0001"></a>err:FODT0001, Overflow/underflow in date/time operation.</dt><dd><p>Raised when casting to date/time datatypes, or performing arithmetic with date/time values, if arithmetic overflow or underflow occurs.</p></dd><dt><a id="ERRFODT0002"></a>err:FODT0002, Overflow/underflow in duration operation.</dt><dd><p>Raised when casting to duration datatypes, or performing arithmetic with duration values, if arithmetic overflow or underflow occurs.</p></dd><dt><a id="ERRFODT0003"></a>err:FODT0003, Invalid timezone value.</dt><dd><p>Raised by <code>adjust-date-to-timezone</code> and related functions if the supplied timezone is invalid.</p></dd><dt><a id="ERRFODT0004"></a>err:FODT0004, No timezone data available</dt><dd><p>Raised by <code>civil-timezone</code> if no timezone data is available for the given date/time and place.</p></dd><dt><a id="ERRFODT0005"></a><span class="deltaxml-new" style="background:#90EE90">err:FODT0005, Invalid combination of date/time fields</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Raised by </span><code><span class="deltaxml-new" style="background:#90EE90">build-dateTime</span></code><span class="deltaxml-new" style="background:#90EE90"> if the set of fields supplied does not correspond to those present in one of the </span><a title="Gregorian" class="termref" href="#dt-gregorian"><span class="deltaxml-new" style="background:#90EE90">Gregorian</span></a><span class="deltaxml-new" style="background:#90EE90"> types.</span></p></dd><dt><a id="ERRFODT0006"></a><span class="deltaxml-new" style="background:#90EE90">err:FODT0006, Invalid component of date/time vallue</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Raised by </span><code><span class="deltaxml-new" style="background:#90EE90">build-dateTime</span></code><span class="deltaxml-new" style="background:#90EE90"> if one of the fields supplied has a value that is outside the supported range.</span></p></dd><dt><a id="ERRFOER0000"></a>err:FOER0000, Unidentified error.</dt><dd><p>Error code used by <a href="#func-error"><code>fn:error</code></a> when no other error code is provided.</p></dd><dt><a id="ERRFOFD1340"></a>err:FOFD1340, Invalid date/time formatting parameters.</dt><dd><p>This error is raised if the picture string or calendar supplied to <a href="#func-format-date"><code>fn:format-date</code></a>, <a href="#func-format-time"><code>fn:format-time</code></a>, or <a href="#func-format-dateTime"><code>fn:format-dateTime</code></a> has invalid syntax.</p></dd><dt><a id="ERRFOFD1350"></a>err:FOFD1350, Invalid date/time formatting component.</dt><dd><p>This error is raised if the picture string supplied to <a href="#func-format-date"><code>fn:format-date</code></a> selects a component that is not present in a date, or if the picture string supplied to <a href="#func-format-time"><code>fn:format-time</code></a> selects a component that is not present in a time.</p></dd><dt><a id="ERRFOHA0001"></a>err:FOHA0001, Invalid algorithm.</dt><dd><p>Raised by <a href="#func-hash"><code>fn:hash</code></a> if the effective value of the supplied algorithm is not one of the values supported by the implementation.</p></dd><dt><a id="ERRFOJS0001"></a>err:FOJS0001, JSON syntax error.</dt><dd><p>Raised by functions such as <a href="#func-json-doc"><code>fn:json-doc</code></a>, <a href="#func-parse-json"><code>fn:parse-json</code></a> or <a href="#func-json-to-xml"><code>fn:json-to-xml</code></a> if the string supplied as input does not conform to the JSON grammar (optionally with implementation-defined extensions).</p></dd><dt><a id="ERRFOJS0003"></a>err:FOJS0003, JSON duplicate keys.</dt><dd><p>Raised by functions such as <a href="#func-map-merge"><code>map:merge</code></a>, <a href="#func-json-doc"><code>fn:json-doc</code></a>, <a href="#func-parse-json"><code>fn:parse-json</code></a> or <a href="#func-json-to-xml"><code>fn:json-to-xml</code></a> if the input contains duplicate keys, when the chosen policy is to reject duplicates.</p></dd><dt><a id="ERRFOJS0004"></a>err:FOJS0004, JSON: not schema-aware.</dt><dd><p>Raised by <a href="#func-json-to-xml"><code>fn:json-to-xml</code></a> if validation is requested when the processor does not support schema validation or typed nodes.</p></dd><dt><a id="ERRFOJS0005"></a>err:FOJS0005, Invalid options.</dt><dd><p>Raised by functions such as <a href="#func-map-merge"><code>map:merge</code></a>, <a href="#func-parse-json"><code>fn:parse-json</code></a>, and <a href="#func-xml-to-json"><code>fn:xml-to-json</code></a> if the <code>$options</code> map contains an invalid entry.</p></dd><dt><a id="ERRFOJS0006"></a>err:FOJS0006, Invalid XML representation of JSON.</dt><dd><p>Raised by <a href="#func-xml-to-json"><code>fn:xml-to-json</code></a> if the XML input does not conform to the rules for the XML representation of JSON.</p></dd><dt><a id="ERRFOJS0007"></a>err:FOJS0007, Bad JSON escape sequence.</dt><dd><p>Raised by <a href="#func-xml-to-json"><code>fn:xml-to-json</code></a> if the XML input uses the attribute <code>escaped="true"</code> or <code>escaped-key="true"</code>, and the corresponding string or key contains an invalid JSON escape sequence.</p></dd><dt><a id="ERRFOJS0008"></a>err:FOJS0008, Cannot convert element to map.</dt><dd><p>Raised by <a href="#func-element-to-map"><code>fn:element-to-map</code></a> if the layout selected for converting elements of a given name is unsuitable for an element node with that name, or if the conversion plan explicitly defines the processing of a particular element as an error.</p></dd><dt><a id="ERRFONS0004"></a>err:FONS0004, No namespace found for prefix.</dt><dd><p>Raised by <a href="#func-resolve-QName"><code>fn:resolve-QName</code></a> and analogous functions if a supplied QName has a prefix that has no binding to a namespace.</p></dd><dt><a id="ERRFONS0005"></a>err:FONS0005, Base-uri not defined in the static context.</dt><dd><p>Raised by <a href="#func-resolve-uri"><code>fn:resolve-uri</code></a> if no base URI is available for resolving a relative URI.</p></dd><dt><a id="ERRFOPA0001"></a>err:FOPA0001, Origin node is not an ancestor of the target node.</dt><dd><p>Raised by <a href="#func-path"><code>fn:path</code></a> if the node supplied in the <code>origin</code> option is not an ancestor of the <code>$node</code> whose relative path is required.</p></dd><dt><a id="ERRFOQM0001"></a>err:FOQM0001, Module URI is a zero-length string.</dt><dd><p>Raised by <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> if the supplied module URI is zero-length.</p></dd><dt><a id="ERRFOQM0002"></a>err:FOQM0002, Module URI not found.</dt><dd><p>Raised by <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> if no module can be found with the supplied module URI.</p></dd><dt><a id="ERRFOQM0003"></a>err:FOQM0003, Static error in dynamically loaded XQuery module.</dt><dd><p>Raised by <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> if a static error (including a statically detected type error) is encountered when processing the library module.</p></dd><dt><a id="ERRFOQM0005"></a>err:FOQM0005, Parameter for dynamically loaded XQuery module has incorrect type.</dt><dd><p>Raised by <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> if a value is supplied for the initial context item or for an external variable, and the value does not conform to the required type declared in the dynamically loaded module.</p></dd><dt><a id="ERRFOQM0006"></a>err:FOQM0006, No suitable XQuery processor available.</dt><dd><p>Raised by <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a> if no XQuery processor is available supporting the requested XQuery version (or if none is available at all).</p></dd><dt><a id="ERRFORG0001"></a>err:FORG0001, Invalid value for cast/constructor.</dt><dd><p>A general-purpose error raised when casting, if a cast between two datatypes is allowed in principle, but the supplied value cannot be converted: for example when attempting to cast the string <code>"nine"</code> to an integer.</p></dd><dt><a id="ERRFORG0002"></a>err:FORG0002, Invalid argument to fn:resolve-uri.</dt><dd><p>Raised when either argument to <a href="#func-resolve-uri"><code>fn:resolve-uri</code></a> is not a valid URI/IRI.</p></dd><dt><a id="ERRFORG0003"></a>err:FORG0003, fn:zero-or-one called with a sequence containing more than one item.</dt><dd><p>Raised by <a href="#func-zero-or-one"><code>fn:zero-or-one</code></a> if the supplied value contains more than one item.</p></dd><dt><a id="ERRFORG0004"></a>err:FORG0004, fn:one-or-more called with a sequence containing no items.</dt><dd><p>Raised by <a href="#func-one-or-more"><code>fn:one-or-more</code></a> if the supplied value is an empty sequence.</p></dd><dt><a id="ERRFORG0005"></a>err:FORG0005, fn:exactly-one called with a sequence containing zero or more than one item.</dt><dd><p>Raised by <a href="#func-exactly-one"><code>fn:exactly-one</code></a> if the supplied value is not a singleton sequence.</p></dd><dt><a id="ERRFORG0006"></a>err:FORG0006, Invalid argument type.</dt><dd><p>Raised by functions such as <a href="#func-max"><code>fn:max</code></a>, <a href="#func-min"><code>fn:min</code></a>, <a href="#func-avg"><code>fn:avg</code></a>, <a href="#func-sum"><code>fn:sum</code></a> if the supplied sequence contains values inappropriate to this function.</p></dd><dt><a id="ERRFORG0008"></a>err:FORG0008, The two arguments to fn:dateTime have inconsistent timezones.</dt><dd><p>Raised by <a href="#func-dateTime"><code>fn:dateTime</code></a> if the two arguments both have timezones and the timezones are different.</p></dd><dt><a id="ERRFORG0009"></a>err:FORG0009, Error in resolving a relative URI against a base URI in fn:resolve-uri.</dt><dd><p>A catch-all error for <a href="#func-resolve-uri"><code>fn:resolve-uri</code></a>, recognizing that the implementation can choose between a variety of algorithms and that some of these may fail for a variety of reasons.</p></dd><dt><a id="ERRFORG0010"></a>err:FORG0010, Invalid date/time.</dt><dd><p>Raised when the input to <a href="#func-parse-ietf-date"><code>fn:parse-ietf-date</code></a> does not match the prescribed grammar, or when it represents an invalid date/time such as 31 February.</p></dd><dt><a id="ERRFORG0011"></a>err:FORG0011, Invalid radix.</dt><dd><p>Raised when the radix supplied to <a href="#func-parse-integer"><code>fn:parse-integer</code></a> is not in the range 2 to 36.</p></dd><dt><a id="ERRFORG0012"></a>err:FORG0012, Invalid digits.</dt><dd><p>Raised when the digits in the string supplied to <a href="#func-parse-integer"><code>fn:parse-integer</code></a> are not in the range appropriate to the chosen radix.</p></dd><dt><a id="ERRFORX0001"></a>err:FORX0001, Invalid regular expression flags.</dt><dd><p>Raised by regular expression functions such as <a href="#func-matches"><code>fn:matches</code></a> and <a href="#func-replace"><code>fn:replace</code></a> if the regular expression flags contain a character other than <code>i</code>, <code>m</code>, <code>q</code>, <code>s</code>, or <code>x</code>.</p></dd><dt><a id="ERRFORX0002"></a>err:FORX0002, Invalid regular expression.</dt><dd><p>Raised by regular expression functions such as <a href="#func-matches"><code>fn:matches</code></a> and <a href="#func-replace"><code>fn:replace</code></a> if the regular expression is syntactically invalid.</p></dd><dt><a id="ERRFORX0004"></a>err:FORX0004, Invalid replacement string.</dt><dd><p>Raised by <a href="#func-replace"><code>fn:replace</code></a> to report errors in the replacement string.</p></dd><dt><a id="ERRFORX0005"></a>err:FORX0005, Incompatible arguments for fn:replace.</dt><dd><p>Raised by <a href="#func-replace"><code>fn:replace</code></a> if both the <code>$replacement</code> and <code>$action</code> arguments are supplied.</p></dd><dt><a id="ERRFOTY0012"></a>err:FOTY0012, Argument to fn:data contains a node that does not have a typed value.</dt><dd><p>Raised by <a href="#func-data"><code>fn:data</code></a>, or by implicit atomization, if applied to a node with no typed value, the main example being an element validated against a complex type that defines it to have element-only content.</p></dd><dt><a id="ERRFOTY0013"></a>err:FOTY0013, The argument to fn:data contains a function item.</dt><dd><p>Raised by <a href="#func-data"><code>fn:data</code></a>, or by implicit atomization, if the sequence to be atomized contains a function item other than an array.</p></dd><dt><a id="ERRFOTY0014"></a>err:FOTY0014, The argument to fn:string is a function item.</dt><dd><p>Raised by <a href="#func-string"><code>fn:string</code></a>, or by implicit string conversion, if the input sequence contains a function item.</p></dd><dt><a id="ERRFOUR0001"></a>err:FOUR0001, Invalid IPv6/IPvFuture authority</dt><dd><p>A dynamic error is raised if the authority component of a URI contains an open square bracket but no corresponding close square bracket.</p></dd><dt><a id="ERRFOUT1170"></a>err:FOUT1170, Invalid URI reference.</dt><dd><p>Raised by <a href="#func-unparsed-text"><code>fn:unparsed-text</code></a> or <a href="#func-unparsed-text-lines"><code>fn:unparsed-text-lines</code></a> if the <code>$source</code> argument contains a fragment identifier, or if it cannot be resolved to an absolute URI (for example, because the base-URI property in the static context is absent), or if it cannot be used to retrieve the string representation of a resource.</p></dd><dt><a id="ERRFOUT1190"></a>err:FOUT1190, Cannot decode external resource.</dt><dd><p>Raised by <a href="#func-unparsed-text"><code>fn:unparsed-text</code></a> or <a href="#func-unparsed-text-lines"><code>fn:unparsed-text-lines</code></a> if the <code>$encoding</code> argument is not a valid encoding name, if the processor does not support the specified encoding, if the string representation of the retrieved resource contains octets that cannot be decoded into Unicode <a title="character" class="termref" href="#character">characters</a> using the specified encoding, or if the resulting characters are not <a title="permitted character" class="termref" href="#dt-permitted-character">permitted characters</a>.</p></dd><dt><a id="ERRFOUT1200"></a>err:FOUT1200, Cannot infer encoding of external resource.</dt><dd><p>Raised by <a href="#func-unparsed-text"><code>fn:unparsed-text</code></a> or <a href="#func-unparsed-text-lines"><code>fn:unparsed-text-lines</code></a> if the <code>$encoding</code> argument is absent and the processor cannot infer the encoding using external information and the encoding is not UTF-8.</p></dd><dt><a id="ERRFOXT0001"></a>err:FOXT0001, No suitable XSLT processor available</dt><dd><p>A dynamic error is raised if no XSLT processor suitable for evaluating a call on <a href="#func-transform"><code>fn:transform</code></a> is available.</p></dd><dt><a id="ERRFOXT0002"></a>err:FOXT0002, Invalid parameters to XSLT transformation</dt><dd><p>A dynamic error is raised if the parameters supplied to <a href="#func-transform"><code>fn:transform</code></a> are invalid, for example if two mutually exclusive parameters are supplied. If a suitable XSLT error code is available (for example in the case where the requested <code>initial-template</code> does not exist in the stylesheet), that error code should be used in preference.</p></dd><dt><a id="ERRFOXT0003"></a>err:FOXT0003, XSLT transformation failed</dt><dd><p>A dynamic error is raised if an XSLT transformation invoked using <a href="#func-transform"><code>fn:transform</code></a> fails with a static or dynamic error. The XSLT error code is used if available; this error code provides a fallback when no XSLT error code is returned, for example because the processor is an XSLT 1.0 processor.</p></dd><dt><a id="ERRFOXT0004"></a>err:FOXT0004, XSLT transformation has been disabled</dt><dd><p>A dynamic error is raised if the <a href="#func-transform"><code>fn:transform</code></a> function is invoked when XSLT transformation (or a specific transformation option) has been disabled for security or other reasons.</p></dd><dt><a id="ERRFOXT0006"></a>err:FOXT0006, XSLT output contains non-accepted characters</dt><dd><p>A dynamic error is raised if the result of the <a href="#func-transform"><code>fn:transform</code></a> function contains characters available only in XML 1.1 and the calling processor cannot handle such characters.</p></dd></dl></div><div class="_diffs div1"><h2><a id="id-built-in-named-record-types"></a>C <a href="#id-built-in-named-record-types" style="text-decoration: none">Built-in named record types</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#schemata">next</a> | <a href="#casting-from-strings">previous</a>)</p><ol><li><p> Named record types used in the signatures of built-in functions are now available as standard in the static context. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/835">835</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1991">1991</a>&nbsp;11 May 2025]</i></p></li></ol></div><p>This appendix lists the named record types that are used in function signatures in this function library, and that are available in the static context of every application.</p><p>These definitions are all in the standard function namespace <code>http://www.w3.org/2005/xpath-functions</code>, which is normally bound to the prefix <code>fn</code>. Because this will not usually be the default namespace for types, the names will usually be written with the prefix <code>fn</code>.</p><ul><li class="add_version" style="display: none;"><p>Record <a href="#dateTime-record">dateTime-record</a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">Record </span><a href="#dateTime-record"><span class="deltaxml-new" style="background:#90EE90">dateTime-record</span></a></p></li><li><p>Record <a href="#load-xquery-module-record">load-xquery-module-record</a></p></li><li><p>Record <a href="#parsed-csv-structure-record">parsed-csv-structure-record</a></p></li><li><p>Record <a href="#random-number-generator-record">random-number-generator-record</a></p></li><li><p>Record <a href="#schema-type-record">schema-type-record</a></p></li><li><p>Record <a href="#uri-structure-record">uri-structure-record</a></p></li></ul></div><div class="_diffs div1"><h2><a id="impl-def"></a>G <a href="#impl-def" style="text-decoration: none">Implementation-defined features</a> (Non-Normative)</h2><ol><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which version of Unicode is supported, but it is recommended that the most recent version of Unicode be used. (See <a href="#conformance">Conformance</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether the type system is based on XML Schema 1.0 or XML Schema 1.1. (See <a href="#conformance">Conformance</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether definitions that rely on XML (for example, the set of valid XML characters) should use the definitions in XML 1.0 or XML 1.1. (See <a href="#conformance">Conformance</a>.)</p></li><li><p>Implementations <span class="verb">may</span> attach an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> meaning to options in the map that are not described in this specification. These options <span class="verb">should</span> use values of type <code>xs:QName</code> as the option names, using an appropriate namespace. (See <a href="#options">Options</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which version of <a href="#Unicode">[The Unicode Standard]</a> is supported, but it is recommended that the most recent version of Unicode be used. (See <a href="#character-terminology">Strings, characters, and codepoints</a>.)</p></li><li><p><span class="termdef">[Definition] Some functions (such as <a href="#func-in-scope-prefixes"><code>fn:in-scope-prefixes</code></a>, <a href="#func-load-xquery-module"><code>fn:load-xquery-module</code></a>, and <a href="#func-unordered"><code>fn:unordered</code></a>) produce result sequences or result maps in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> or <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a> order. In such cases two calls with the same arguments are not guaranteed to produce the results in the same order. These functions are said to be <b>nondeterministic with respect to ordering</b>.</span> (See <a href="#properties-of-functions">Properties of functions</a>.)</p></li><li><p>Where the results of a function are described as being (to a greater or lesser extent) <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> or <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a>, this does not by itself remove the requirement that the results should be deterministic: that is, that repeated calls with the same explicit and implicit arguments <span class="verb">must</span> return identical results. (See <a href="#properties-of-functions">Properties of functions</a>.)</p></li><li><p> They <span class="verb">may</span> provide an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> mechanism that allows users to choose between raising an error and returning a result that is modulo the largest representable integer value. See <a href="#ISO10967">[ISO 10967]</a>. (See <a href="#op.numeric">Arithmetic operators on numeric values</a>.)</p></li><li><p>For <code>xs:decimal</code> values, let <var>N</var> be the number of digits of precision supported by the implementation, and let <var>M</var> (<code>M &lt;= N</code>) be the minimum limit on the number of digits required for conformance (18 digits for XSD 1.0, 16 digits for XSD 1.1). Then for addition, subtraction, and multiplication operations, the returned result <span class="verb">should</span> be accurate to <var>N</var> digits of precision, and for division and modulus operations, the returned result <span class="verb">should</span> be accurate to at least <var>M</var> digits of precision. The actual precision is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the number of digits in the mathematical result exceeds the number of digits that the implementation retains for that operation, the result is truncated or rounded in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> manner. (See <a href="#op.numeric">Arithmetic operators on numeric values</a>.)</p></li><li><p>The <a href="#ieee754-2019">[IEEE 754-2019]</a> specification also describes handling of two exception conditions called <code>divideByZero</code> and <code>invalidOperation</code>. The IEEE <code>divideByZero</code> exception is raised not only by a direct attempt to divide by zero, but also by operations such as <code>log(0)</code>. The IEEE <code>invalidOperation</code> exception is raised by attempts to call a function with an argument that is outside the function’s domain (for example, <code>sqrt(-1)</code> or <code>log(-1)</code>). Although IEEE defines these as exceptions, it also defines “default non-stop exception handling” in which the operation returns a defined result, typically positive or negative infinity, or <code>NaN</code>. With this function library, these IEEE exceptions do not cause a dynamic error at the application level; rather they result in the relevant function or operator returning the defined non-error result. The underlying IEEE exception <span class="verb">may</span> be notified to the application or to the user by some <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> warning condition, but the observable effect on an application using the functions and operators defined in this specification is simply to return the defined result (typically <code>-INF</code>, <code>+INF</code>, or <code>NaN</code>) with no error. (See <a href="#op.numeric">Arithmetic operators on numeric values</a>.)</p></li><li><p>The <a href="#ieee754-2019">[IEEE 754-2019]</a> specification distinguishes two <code>NaN</code> values: a quiet <code>NaN</code> and a signaling <code>NaN</code>. These two values are not distinguishable in the XDM model: the value spaces of <code>xs:float</code> and <code>xs:double</code> each include only a single <code>NaN</code> value. This does not prevent the implementation distinguishing them internally, and triggering different <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> warning conditions, but such distinctions do not affect the observable behavior of an application using the functions and operators defined in this specification. (See <a href="#op.numeric">Arithmetic operators on numeric values</a>.)</p></li><li><p>The implementation may adopt a different algorithm provided that it is equivalent to this formulation in all cases where <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a> or <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> behavior does not affect the outcome, for example, the implementation-defined precision of the result of <code>xs:decimal</code> division. (See <a href="#func-numeric-integer-divide">op:numeric-integer-divide</a>.)</p></li><li><p>There may be <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on the precision available. If the requested <code>$precision</code> is outside this range, it should be adjusted to the nearest value supported by the implementation. (See <a href="#func-divide-decimals">fn:divide-decimals</a>.)</p></li><li><p>There may be <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on the precision available. If the requested <code>$precision</code> is outside this range, it should be adjusted to the nearest value supported by the implementation. (See <a href="#func-round">fn:round</a>.)</p></li><li><p>There may be <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on the precision available. If the requested <code>$precision</code> is outside this range, it should be adjusted to the nearest value supported by the implementation. (See <a href="#func-round-half-to-even">fn:round-half-to-even</a>.)</p></li><li><p>XSD 1.1 allows the string <code>+INF</code> as a representation of positive infinity; XSD 1.0 does not. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether XSD 1.1 is supported. (See <a href="#func-number">fn:number</a>.)</p></li><li><p>Any other format token, which indicates a numbering sequence in which that token represents the number 1 (one) (but see the note below). It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which numbering sequences, additional to those listed above, are supported. If an implementation does not support a numbering sequence represented by the given token, it <span class="verb">must</span> use a format token of <code>1</code>. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>For all format tokens other than a <var>digit-pattern</var>, there <span class="verb">may</span> be <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> lower and upper bounds on the range of numbers that can be formatted using this format token; indeed, for some numbering sequences there may be intrinsic limits. For example, the format token <span class="unicode-codepoint">U+2460</span> (<span class="unicode-name">CIRCLED DIGIT ONE</span>, <code>①</code>) has a range imposed by the Unicode character repertoire — <span>zero to 20</span> in Unicode versions prior to <span>3.2</span>, or <span>zero to 50</span> in subsequent versions. For the numbering sequences described above any upper bound imposed by the implementation <span class="verb">must not</span> be less than 1000 (one thousand) and any lower bound must not be greater than 1. Numbers that fall outside this range <span class="verb">must</span> be formatted using the format token <code>1</code>. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>The set of languages for which numbering is supported is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the <code>$language</code> argument is absent, or is set to an empty sequence, or is invalid, or is not a language supported by the implementation, then the number is formatted using the default language from the dynamic context. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>...either <code>a</code> or <code>t</code>, to indicate alphabetic or traditional numbering respectively, the default being <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>The string of characters between the parentheses, if present, is used to select between other possible variations of cardinal or ordinal numbering sequences. The interpretation of this string is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. No error occurs if the implementation does not define any interpretation for the defined string. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> what combinations of values of the format token, the language, and the cardinal/ordinal modifier are supported. If ordinal numbering is not supported for the combination of the format token, the language, and the string appearing in parentheses, the request is ignored and cardinal numbers are generated instead. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>The use of the <code>a</code> or <code>t</code> modifier disambiguates between numbering sequences that use letters. In many languages there are two commonly used numbering sequences that use letters. One numbering sequence assigns numeric values to letters in alphabetic sequence, and the other assigns numeric values to each letter in some other manner traditional in that language. In English, these would correspond to the numbering sequences specified by the format tokens <code>a</code> and <code>i</code>. In some languages, the first member of each sequence is the same, and so the format token alone would be ambiguous. In the absence of the <code>a</code> or <code>t</code> modifier, the default is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-format-integer">fn:format-integer</a>.)</p></li><li><p>The static context provides a set of decimal formats. One of the decimal formats is unnamed, the others (if any) are identified by a QName. There is always an unnamed decimal format available, but its contents are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#defining-decimal-format">Defining a decimal format</a>.)</p></li><li><p>IEEE states that the preferred quantum is language-defined. In this specification, it is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#trigonometry">Trigonometric and exponential functions</a>.)</p></li><li><p>IEEE defines various rounding algorithms for inexact results, and states that the choice of rounding direction, and the mechanisms for influencing this choice, are language-defined. In this specification, the rounding direction and any mechanisms for influencing it are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#trigonometry">Trigonometric and exponential functions</a>.)</p></li><li><p>The map returned by the <a href="#func-random-number-generator"><code>fn:random-number-generator</code></a> function <span class="verb">may</span> contain additional entries beyond those specified here, but it <span class="verb">must</span> match the <span>record type defined above</span>. The meaning of any additional entries is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. To avoid conflict with any future version of this specification, the keys of any such entries <span class="verb">should</span> start with an underscore character. (See <a href="#func-random-number-generator">fn:random-number-generator</a>.)</p></li><li><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted. (See <a href="#func-codepoints-to-string">fn:codepoints-to-string</a>.)</p></li><li><p>If two query parameters use the same keyword then the last one wins. If a query parameter uses a keyword or value which is not defined in this specification then the meaning is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the implementation recognizes the meaning of the keyword and value then it <span class="verb">should</span> interpret it accordingly; if it does not recognize the keyword or value then if the <code>fallback</code> parameter is present with the value <code>no</code> it should reject the collation as unsupported, otherwise it should ignore the unrecognized parameter. (See <a href="#uca-collations">The Unicode Collation Algorithm</a>.)</p></li><li><p>The following query parameters are defined. If any parameter is absent, the default is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> except where otherwise stated. The meaning given for each parameter is non-normative; the normative specification is found in <a href="#UNICODE-TR35">[UTS #35]</a>. (See <a href="#uca-collations">The Unicode Collation Algorithm</a>.)</p></li><li><p>Because the set of collations that are supported is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, an implementation has the option to support all collation URIs, in which case it will never raise this error. (See <a href="#choosing-a-collation">Choosing a collation</a>.)</p></li><li><p>The properties available are as defined for the Unicode Collation Algorithm (see <a href="#uca-collations"><b>5.3.4 The Unicode Collation Algorithm</b></a>). Additional <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> properties <span class="verb">may</span> be specified as described in the rules for UCA collation URIs. (See <a href="#func-collation">fn:collation</a>.)</p></li><li><p>It is possible to define collations that do not have the ability to generate collation keys. Supplying such a collation will cause the function to fail. The ability to generate collation keys is an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> property of the collation. (See <a href="#func-collation-key">fn:collation-key</a>.)</p></li><li><p>Conforming implementations <span class="verb">must</span> support normalization form <code>NFC</code> and <span class="verb">may</span> support normalization forms <code>NFD</code>, <code>NFKC</code>, <code>NFKD</code>, and <code>FULLY-NORMALIZED</code>. They <span class="verb">may</span> also support other normalization forms with <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> semantics. (See <a href="#func-normalize-unicode">fn:normalize-unicode</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which version of Unicode (and therefore, of the normalization algorithms and their underlying data) is supported by the implementation. See <a href="#UNICODE-TR15">[UAX #15]</a> for details of the stability policy regarding changes to the normalization rules in future versions of Unicode. If the input string contains codepoints that are unassigned in the relevant version of Unicode, or for which no normalization rules are defined, the <a href="#func-normalize-unicode"><code>fn:normalize-unicode</code></a> function leaves such codepoints unchanged. If the implementation supports the requested normalization form then it <span class="verb">must</span> be able to handle every input string without raising an error. (See <a href="#func-normalize-unicode">fn:normalize-unicode</a>.)</p></li><li><p>It is possible to define collations that do not have the ability to decompose a string into units suitable for substring matching. An argument to a function defined in this section may be a URI that identifies a collation that is able to compare two strings, but that does not have the capability to split the string into collation units. Such a collation may cause the function to fail, or to give unexpected results, or it may be rejected as an unsuitable argument. The ability to decompose strings into collation units is an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> property of the collation. The <a href="#func-collation-available"><code>fn:collation-available</code></a> function can be used to ask whether a particular collation has this property. (See <a href="#substring.functions">Functions based on substring matching</a>.)</p></li><li><p>The result of the function will always be such that validation against this schema would succeed. However, it is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether the result is typed or untyped, that is, whether the elements and attributes in the returned tree have type annotations that reflect the result of validating against this schema. (See <a href="#func-analyze-string">fn:analyze-string</a>.)</p></li><li><p>Some URI schemes are hierarchical and some are non-hierarchical. Implementations must treat the following schemes as non-hierarchical: <code>jar</code>, <code>mailto</code>, <code>news</code>, <code>tag</code>, <code>tel</code>, and <code>urn</code>. Whether additional schemes are known to be non-hierarchical <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If a scheme is not known to be non-hierarchical, it must be treated as hierarchical. (See <a href="#parse-build">Parsing and building URIs</a>.)</p></li><li><p>If the <code>omit-default-ports</code> option is <code>true</code>, the port is discarded and set to the empty sequence if the port number is the same as the default port for the given scheme. Implementations <span class="verb">should</span> recognize the default ports for <code>http</code> (80), <code>https</code> (443), <code>ftp</code> (21), and <code>ssh</code> (22). Exactly which ports are recognized is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-parse-uri">fn:parse-uri</a>.)</p></li><li><p>If the <code>omit-default-ports</code> option is <code>true</code> then the <code>$port</code> is set to the empty sequence if the port number is the same as the default port for the given scheme. Implementations <span class="verb">should</span> recognize the default ports for <code>http</code> (80), <code>https</code> (443), <code>ftp</code> (21), and <code>ssh</code> (22). Exactly which ports are recognized is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-build-uri">fn:build-uri</a>.)</p></li><li><p>Processors <span class="verb">may</span> support a greater range and/or precision. The limits are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#duration-conformance">Limits and precision</a>.)</p></li><li><p>Similarly, a processor may be unable accurately to represent the result of dividing a duration by 2, or multiplying a duration by 0.5. A processor that limits the precision of the seconds component of duration values <span class="verb">must</span> deliver a result that is as close as possible to the mathematically precise result, given these limits; if two values are equally close, the one that is chosen is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#duration-conformance">Limits and precision</a>.)</p></li><li><p>All conforming processors <span class="verb">must</span> support year values in the range 1 to 9999, and a minimum fractional second precision of 1 millisecond or three digits (i.e., s.sss). However, processors <span class="verb">may</span> set larger <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on the maximum number of digits they support in these two situations. Processors <span class="verb">may</span> also choose to support the year 0 and years with negative values. The results of operations on dates that cross the year 0 are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#date-time-duration-conformance">Limits and precision</a>.)</p></li><li><p>Similarly, a processor that limits the precision of the seconds component of date and time or duration values may need to deliver a rounded result for arithmetic operations. Such a processor <span class="verb">must</span> deliver a result that is as close as possible to the mathematically precise result, given these limits: if two values are equally close, the one that is chosen is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#date-time-duration-conformance">Limits and precision</a>.)</p></li><li><p>...the format token <code>n</code>, <code>N</code>, or <code>Nn</code>, indicating that the value of the component is to be output by name, in lower-case, upper-case, or title-case respectively. Components that can be output by name include (but are not limited to) months, days of the week, timezones, and eras. If the processor cannot output these components by name for the chosen calendar and language then it must use an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> fallback representation. (See <a href="#date-picture-string">The picture string</a>.)</p></li><li><p>...indicates alphabetic or traditional numbering respectively, the default being <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. This has the same meaning as in the second argument of <a href="#func-format-integer"><code>fn:format-integer</code></a>. (See <a href="#date-picture-string">The picture string</a>.)</p></li><li><p>The sequence of characters in the (adjusted) first presentation modifier is reversed (for example, <code>999'###</code> becomes <code>###'999</code>). If the result is not a valid <b>decimal digit pattern</b>, then the output is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#formatting-fractional-seconds">Formatting Fractional Seconds</a>.)</p></li><li><p><span style="display: none;" class="delete_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span></a>. (See <a href="#formatting-other-components">Formatting Other Components</a>.)</span><span style="display: none;" class="add_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span></a>. (See <a href="#formatting-other-components">Formatting Other Components</a>.)</span><span class="modify_version">The output for these components is entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. The default presentation modifier for these components is <code>n</code>, indicating that they are output as names (or conventional abbreviations), and the chosen names will in many cases depend on the chosen language: see <a href="#lang-cal-place"><span style="display: none;" class="delete_version"><b>9.8.4.8 The language, calendar, and place arguments</b></span><span style="display: none;" class="add_version"><b>9.9.4.8 The language, calendar, and place arguments</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.4.8</span><span class="deltaxml-new" style="background:#90EE90">9.9.4.8</span> The language, calendar, and place arguments</b></span></a>. (See <a href="#formatting-other-components">Formatting Other Components</a>.)</span></p></li><li><p>The set of languages, calendars, and places that are supported in the <a title="date formatting function" class="termref" href="#dt-date-formatting-function">date formatting functions</a> is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. When any of these arguments is omitted or is an empty sequence, an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> default value is used. (See <a href="#lang-cal-place">The language, calendar, and place arguments</a>.)</p></li><li><p>The choice of the names and abbreviations used in any given language is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. For example, one implementation might abbreviate July as <code>Jul</code> while another uses <code>Jly</code>. In German, one implementation might represent Saturday as <code>Samstag</code> while another uses <code>Sonnabend</code>. Implementations <span class="verb">may</span> provide mechanisms allowing users to control such choices. (See <a href="#lang-cal-place">The language, calendar, and place arguments</a>.)</p></li><li><p>The choice of the names and abbreviations used in any given language for calendar units such as days of the week and months of the year is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#lang-cal-place">The language, calendar, and place arguments</a>.)</p></li><li><p>The calendar value if present <span class="verb">must</span> be a valid <code>EQName</code> (dynamic error: [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]). If it is a lexical <code>QName</code> then it is expanded into an expanded QName using the statically known namespaces; if it has no prefix then it represents an expanded-QName in no namespace. If the expanded QName is in no namespace, then it <span class="verb">must</span> identify a calendar with a designator specified below (dynamic error: [<a href="#ERRFOFD1340" title="err:FOFD1340">err:FOFD1340</a>]). If the expanded QName is in a namespace then it identifies the calendar in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way. (See <a href="#lang-cal-place">The language, calendar, and place arguments</a>.)</p></li><li><p>At least one of the above calendars <span class="verb">must</span> be supported. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which calendars are supported. (See <a href="#lang-cal-place">The language, calendar, and place arguments</a>.)</p></li><li><p>If the arguments to <a href="#func-function-lookup"><code>fn:function-lookup</code></a> identify a function that is present in the static context of the function call, the function will always return the same function that a static reference to this function would bind to. If there is no such function in the static context, then the results depend on what is present in the dynamic context, which is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-function-lookup">fn:function-lookup</a>.)</p></li><li><p>It is to some extent <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether two maps or arrays have the same function identity. Processors <span class="verb">should</span> ensure as a minimum that when a variable <code>$m</code> is bound to a map or array, calling <code>jtree($m)</code> more than once (with the same variable reference) will deliver the same JNode each time. (See <a href="#func-jtree">fn:jtree</a>.)</p></li><li><p>The requirement to deliver a deterministic result has performance implications, and for this reason implementations may provide a user option to evaluate the function without a guarantee of determinism. The manner in which any such option is provided is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the user has not selected such an option, a call of the function must either return a deterministic result or must raise a dynamic error [<a href="#ERRFODC0003" title="err:FODC0003">err:FODC0003</a>]. (See <a href="#func-doc">fn:doc</a>.)</p></li><li><p>Various aspects of this processing are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Implementations may provide external configuration options that allow any aspect of the processing to be controlled by the user. In particular:... (See <a href="#func-doc">fn:doc</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether DTD validation and/or schema validation is applied to the source document. (See <a href="#func-doc">fn:doc</a>.)</p></li><li><p>The effect of a fragment identifier in the supplied URI is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. One possible interpretation is to treat the fragment identifier as an ID attribute value, and to return a document node having the element with the selected ID value as its only child. (See <a href="#func-doc">fn:doc</a>.)</p></li><li><p>By default, this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>. This means that repeated calls on the function with the same argument will return the same result. However, for performance reasons, implementations may provide a user option to evaluate the function without a guarantee of determinism. The manner in which any such option is provided is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the user has not selected such an option, a call to this function must either return a deterministic result or must raise a dynamic error [<a href="#ERRFODC0003" title="err:FODC0003">err:FODC0003</a>]. (See <a href="#func-collection">fn:collection</a>.)</p></li><li><p>By default, this function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>. This means that repeated calls on the function with the same argument will return the same result. However, for performance reasons, implementations may provide a user option to evaluate the function without a guarantee of determinism. The manner in which any such option is provided is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. If the user has not selected such an option, a call to this function must either return a deterministic result or must raise a dynamic error [<a href="#ERRFODC0003" title="err:FODC0003">err:FODC0003</a>]. (See <a href="#func-uri-collection">fn:uri-collection</a>.)</p></li><li><p>It is no longer automatically an error if the resource (after decoding) contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted. (See <a href="#func-unparsed-text">fn:unparsed-text</a>.)</p></li><li><p><code>UTF-8</code>, or a value that results from <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> heuristics. (See <a href="#func-unparsed-text">fn:unparsed-text</a>.)</p></li><li><p>The fact that the resolution of URIs is defined by a mapping in the dynamic context means that in effect, various aspects of the behavior of this function are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Implementations may provide external configuration options that allow any aspect of the processing to be controlled by the user. In particular:... (See <a href="#func-unparsed-text">fn:unparsed-text</a>.)</p></li><li><p>The fact that the resolution of URIs is defined by a mapping in the dynamic context means that in effect, various aspects of the behavior of this function are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Implementations may provide external configuration options that allow any aspect of the processing to be controlled by the user. In particular:... (See <a href="#func-unparsed-binary">fn:unparsed-binary</a>.)</p></li><li><p>The collation used for matching names is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but must be the same as the collation used to ensure that the names of all environment variables are unique. (See <a href="#func-environment-variable">fn:environment-variable</a>.)</p></li><li><p>Except to the extent defined by these options, the precise process used to construct the XDM instance is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. In particular, it is implementation-defined whether an XML 1.0 or XML 1.1 parser is used. (See <a href="#func-parse-xml">fn:parse-xml</a>.)</p></li><li><p>Options set in <code>$options</code> may be supplemented or modified based on configuration options defined externally using <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> mechanisms. (See <a href="#func-parse-xml">fn:parse-xml</a>.)</p></li><li><p>Except as explicitly defined, the precise process used to construct the XDM instance is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. In particular, it is implementation-defined whether an XML 1.0 or XML 1.1 parser is used. (See <a href="#func-parse-xml-fragment">fn:parse-xml-fragment</a>.)</p></li><li><p>If the second argument is omitted, or is supplied in the form of an <code>output:serialization-parameters</code> element, then the values of any serialization parameters that are not explicitly specified is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, and may depend on the context. (See <a href="#func-serialize">fn:serialize</a>.)</p></li><li><p>A list of target namespaces identifying schema components to be used for validation. The way in which the processor locates schema components for the specified target namespaces is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. A zero-length string denotes a no-namespace schema.... (See <a href="#func-xsd-validator">fn:xsd-validator</a>.)</p></li><li><p>Set to the decimal value 1.0 or 1.1 to indicate which version of XSD is to be used. The default is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. A processor may use a later version of XSD than the version requested, but must not use an earlier version.... (See <a href="#func-xsd-validator">fn:xsd-validator</a>.)</p></li><li><p>The XSD specification allows a schema to be used for validation even when it contains unresolved references to absent schema components. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether this function allows the schema to be incomplete in this way. For example, some processors might allow validation using a schema in which an element declaration contains a reference to a type declaration that is not present in the schema, provided that the element declaration is never needed in the course of a particular validation episode. (See <a href="#func-xsd-validator">fn:xsd-validator</a>.)</p></li><li><p>...<code>error-details as map(*)*</code>. This field is present only when (a) the option <code>return-error-details</code> was set to <code>true</code>, and (b) the supplied document was found to be invalid. The value is a sequence of maps, each containing details of one invalidity that was found. The precise details of the invalidities are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but they <span class="verb">may</span> include the following fields, if the information is available:... (See <a href="#func-xsd-validator">fn:xsd-validator</a>.)</p></li><li><p>Because the <a href="#dom-ls">[DOM: Living Standard]</a> and <a href="#html5">[HTML: Living Standard]</a> are not fixed, it is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which versions are used. (See <a href="#html-xdm-mapping">XDM Mapping from HTML DOM Nodes</a>.)</p></li><li><p>If an implementation allows these nodes to be passed in via an API or similar mechanism, their behaviour is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#html-xdm-mapping">XDM Mapping from HTML DOM Nodes</a>.)</p></li><li><p>If the local name contains a character that is not a valid XML <code>NameStartChar</code> or <code>NameChar</code>, then an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> replacement string is used. The result must be a valid <code>NCName</code>. (See <a href="#html-node-name-accessor">node-name Accessor</a>.)</p></li><li><p>If the local name contains a character that is not a valid XML <code>NameStartChar</code> or <code>NameChar</code>, then an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> replacement string is used. The result must be a valid <code>NCName</code>. (See <a href="#html-node-name-accessor">node-name Accessor</a>.)</p></li><li><p> The input <span class="verb">may</span> contain deviations from the grammar of <a href="#rfc7159">[RFC 7159]</a>, which are handled in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way. (Note: some popular extensions include allowing quotes on keys to be omitted, allowing a comma to appear after the last item in an array, allowing leading zeroes in numbers, and allowing control characters such as tab and newline to be present in unescaped form.) Since the extensions accepted are implementation-defined, an error <span class="verb">may</span> be raised [<a href="#ERRFOJS0001" title="err:FOJS0001">err:FOJS0001</a>] if the input does not conform to the grammar. (See <a href="#func-parse-json">fn:parse-json</a>.)</p></li><li><p> The supplied function is called to process the string value of any JSON number in the input. By default, numbers are processed by converting to <code>xs:double</code> using the XPath casting rules. Supplying the value <code>xs:decimal#1</code> will instead convert to <code>xs:decimal</code> (which potentially retains more precision, but disallows exponential notation), while supplying a function that casts to <code>(xs:decimal | xs:double)</code> will treat the value as <code>xs:decimal</code> if there is no exponent, or as <code>xs:double</code> otherwise. Supplying the value <a href="#func-identity"><code>fn:identity#1</code></a> causes the value to be retained unchanged as an <code>xs:untypedAtomic</code>. If the <code>liberal</code> option is <code>false</code> (the default), then the supplied <code>number-parser</code> is called if and only if the value conforms to the JSON grammar for numbers (for example, a leading plus sign and redundant leading zeroes are not allowed). If the <code>liberal</code> option is <code>true</code> then it is also called if the value conforms to an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> extension of this grammar. (See <a href="#func-parse-json">fn:parse-json</a>.)</p></li><li><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted. (See <a href="#func-json-doc">fn:json-doc</a>.)</p></li><li><p> The input <span class="verb">may</span> contain deviations from the grammar of <a href="#rfc7159">[RFC 7159]</a>, which are handled in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way. (Note: some popular extensions include allowing quotes on keys to be omitted, allowing a comma to appear after the last item in an array, allowing leading zeroes in numbers, and allowing control characters such as tab and newline to be present in unescaped form.) Since the extensions accepted are implementation-defined, an error <span class="verb">may</span> be raised (see below) if the input does not conform to the grammar. (See <a href="#func-json-to-xml">fn:json-to-xml</a>.)</p></li><li><p><b>Default: </b><a title="implementation-defined" class="termref" href="#implementation-defined">Implementation-defined</a>. (See <a href="#func-json-to-xml">fn:json-to-xml</a>.)</p></li><li><p> Indicates that the resulting XDM instance must be typed; that is, the element and attribute nodes must carry the type annotations that result from validation against the schema given at <a href="#schema-for-json"><b>D.2 Schema for the result of fn:json-to-xml</b></a>, or against an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> schema if the <code>liberal</code> option has the value <code>true</code>. (See <a href="#func-json-to-xml">fn:json-to-xml</a>.)</p></li><li><p>The result of the function will always be such that validation against this schema would succeed. However, it is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether the result is typed or untyped, that is, whether the elements and attributes in the returned tree have type annotations that reflect the result of validating against this schema. (See <a href="#func-csv-to-xml">fn:csv-to-xml</a>.)</p></li><li><p>Additional, <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> options may be available, for example, to control aspects of the XML serialization, to specify the grammar start symbol, or to produce output formats other than XML. (See <a href="#func-invisible-xml">fn:invisible-xml</a>.)</p></li><li><p><b>Default: </b>The version given in the prolog of the library module; or <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> if this is absent. (See <a href="#func-load-xquery-module">fn:load-xquery-module</a>.)</p></li><li><p>A sequence of URIs (in the form of <code>xs:string</code> values) which may be used or ignored in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way.... (See <a href="#func-load-xquery-module">fn:load-xquery-module</a>.)</p></li><li><p>Values for vendor-defined configuration options for the XQuery processor used to process the request. The key is the name of an option, expressed as a QName: the namespace URI of the QName <span class="verb">should</span> be a URI controlled by the vendor of the XQuery processor. The meaning of the associated value is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Implementations <span class="verb">should</span> ignore options whose names are in an unrecognized namespace. The <a title="option parameter conventions" class="termref" href="#option-parameter-conventions">option parameter conventions</a> do not apply to this contained map.... (See <a href="#func-load-xquery-module">fn:load-xquery-module</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether constructs in the library module are evaluated in the same <a title="execution scope" class="termref" href="#execution-scope">execution scope</a> as the calling module. (See <a href="#func-load-xquery-module">fn:load-xquery-module</a>.)</p></li><li><p>The library module that is loaded may import schema declarations using an <code>import schema</code> declaration. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether schema components in the in-scope schema definitions of the calling module are automatically added to the in-scope schema definitions of the dynamically loaded module. The in-scope schema definitions of the calling and called modules must be consistent, according to the rules defined in <a href="https://www.w3.org/TR/xquery-31/#id-consistency-constraints"> 2.2.5 Consistency Constraints </a><sup><small>XQ31</small></sup>. (See <a href="#func-load-xquery-module">fn:load-xquery-module</a>.)</p></li><li><p>The serialized result is written to persistent storage. This means that the <code>fn:transform</code> function has side-effects and becomes nondeterministic, so the option should be used with care, and the precise behavior may be <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. When this option is used, the URIs used for the <code>base-output-uri</code> and the URIs of any secondary result documents must be writable locations. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>Indicates whether any <code>xsl:message</code> instructions in the stylesheet are to be evaluated. The destination and formatting of any such messages is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p><b>Default: </b><a title="implementation-defined" class="termref" href="#implementation-defined">Implementation-defined</a>. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p><b>Default: </b><a title="implementation-defined" class="termref" href="#implementation-defined">Implementation-defined</a>. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>If the implementation provides a way of writing or invoking functions with side-effects, this post-processing function might be used to save a copy of the result document to persistent storage. For example, if the implementation provides access to the EXPath File library <a href="#expath">[EXPath]</a>, then a serialized document might be written to filestore by calling the <code>file:write</code> function. Similar mechanisms might be used to issue an HTTP POST request that posts the result to an HTTP server, or to send the document to an email recipient. The semantics of calling functions with side-effects are entirely <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>Calls to <a href="#func-transform"><code>fn:transform</code></a> can potentially have side-effects even in the absence of the post-processing option, because the XSLT specification allows a stylesheet to invoke extension functions that have side-effects. The semantics in this case are <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>A string intended to be used as the static base URI of the principal stylesheet module. This value <span class="verb">must</span> be used if no other static base URI is available. If the supplied stylesheet already has a base URI (which will generally be the case if the stylesheet is supplied using <code>stylesheet-node</code> or <code>stylesheet-location</code>) then it is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether this parameter has any effect. If the value is a relative reference, it is resolved against the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-executable-base-uri">executable base URI</a><sup><small>XP</small></sup> of the <code>fn:transform</code> function call.... (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>Values for vendor-defined configuration options for the XSLT processor used to process the request. The key is the name of an option, expressed as a QName: the namespace URI of the QName <span class="verb">should</span> be a URI controlled by the vendor of the XSLT processor. The meaning of the associated value is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Implementations <span class="verb">should</span> ignore options whose names are in an unrecognized namespace. Default is an empty map.... (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> whether the XSLT transformation is executed within the same <a title="execution scope" class="termref" href="#execution-scope">execution scope</a> as the calling code. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>XSLT 1.0 does not define any error codes, so this is the likely outcome with an XSLT 1.0 processor. XSLT 2.0 and 3.0 do define error codes, but some APIs do not expose them. If multiple errors are signaled by the transformation (which is most likely to happen with static errors) then the error code should where possible be that of one of these errors, chosen arbitrarily; the processor may make details of additional errors available to the application in an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> way. (See <a href="#func-transform">fn:transform</a>.)</p></li><li><p>In addition, the values of <code>$input</code>, typically serialized and converted to an <code>xs:string</code>, and <code>$label</code> (if supplied <span>and non-empty</span>) <span class="verb">may</span> be output to an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> destination. (See <a href="#func-trace">fn:trace</a>.)</p></li><li><p>Consider a situation in which a user wants to investigate the actual value passed to a function. Assume that in a particular execution, <code>$v</code> is an <code>xs:decimal</code> with value <code>124.84</code>. Writing <code>fn:trace($v, 'the value of $v is:')</code> will return <code>$v</code>. The processor <span class="verb">may</span> output <code>"124.84"</code> and <code>"the value of $v is:"</code> to an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> destination. (See <a href="#func-trace">fn:trace</a>.)</p></li><li><p>Similar to <a href="#func-trace"><code>fn:trace</code></a>, the values of <code>$input</code>, typically serialized and converted to an <code>xs:string</code>, and <code>$label</code> (if supplied and non-empty) <span class="verb">may</span> be output to an <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> destination. (See <a href="#func-message">fn:message</a>.)</p></li><li><p>If <var>ST</var> is <code>xs:float</code> or <code>xs:double</code>, then <var>TV</var> is the <code>xs:decimal</code> value, within the set of <code>xs:decimal</code> values that the implementation is capable of representing, that is numerically closest to <var>SV</var>. If two values are equally close, then the one that is closest to zero is chosen. If <var>SV</var> is too large to be accommodated as an <code>xs:decimal</code>, (see <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> for <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on numeric values) a dynamic error is raised [<a href="#ERRFOCA0001" title="err:FOCA0001">err:FOCA0001</a>]. If <var>SV</var> is one of the special <code>xs:float</code> or <code>xs:double</code> values <code>NaN</code>, <code>INF</code>, or <code>-INF</code>, a dynamic error is raised [<a href="#ERRFOCA0002" title="err:FOCA0002">err:FOCA0002</a>]. (See <a href="#casting-to-decimal">Casting to xs:decimal</a>.)</p></li><li><p> In casting to <code>xs:decimal</code> or to a type derived from <code>xs:decimal</code>, if the value is not too large or too small but nevertheless cannot be represented accurately with the number of decimal digits available to the implementation, the implementation may round to the nearest representable value or may raise a dynamic error [<a href="#ERRFOCA0006" title="err:FOCA0006">err:FOCA0006</a>]. The choice of rounding algorithm and the choice between rounding and error behavior is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. (See <a href="#casting-from-strings">Casting from xs:string and xs:untypedAtomic</a>.)</p></li><li><p>If <var>ST</var> is <code>xs:decimal</code>, <code>xs:float</code> or <code>xs:double</code>, then <var>TV</var> is <var>SV</var> with the fractional part discarded and the value converted to <code>xs:integer</code>. Thus, casting <code>3.1456</code> returns <code>3</code> while <code>-17.89</code> returns <code>-17</code>. Casting <code>3.124E1</code> returns <code>31</code>. If <var>SV</var> is too large to be accommodated as an integer, (see <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> for <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> limits on numeric values) a dynamic error is raised [<a href="#ERRFOCA0003" title="err:FOCA0003">err:FOCA0003</a>]. If <var>SV</var> is one of the special <code>xs:float</code> or <code>xs:double</code> values <code>NaN</code>, <code>INF</code>, or <code>-INF</code>, a dynamic error is raised [<a href="#ERRFOCA0002" title="err:FOCA0002">err:FOCA0002</a>]. (See <a href="#casting-to-integer">Casting to xs:integer</a>.)</p></li><li><p> The <em>tz</em> timezone database, available at <a href="http://www.iana.org/time-zones">http://www.iana.org/time-zones</a>. It is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a> which version of the database is used. (See <a href="#olson">IANA Timezone Database</a>.)</p></li><li><p><em>Unicode Standard Annex #15: Unicode Normalization Forms</em>. Ed. Mark Davis and Ken Whistler, Unicode Consortium. The current version is 16.0.0, dated 2024-08-14. As with <a href="#Unicode">[The Unicode Standard]</a>, the version to be used is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Available at: <a href="http://www.unicode.org/reports/tr15/">http://www.unicode.org/reports/tr15/</a>. (See <a href="#UNICODE-TR15">UAX #15</a>.)</p></li><li><p><em>Unicode Standard Annex #29: Unicode Text Segmentation</em>. Ed. Josh Hadley, Unicode Consortium. The current version is 16.0.0, dated 2024-08-28. As with <a href="#Unicode">[The Unicode Standard]</a>, the version to be used is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Available at: <a href="http://www.unicode.org/reports/tr29/">http://www.unicode.org/reports/tr29/</a>. (See <a href="#UNICODE-TR29">UAX #29</a>.)</p></li><li><p> The Unicode Consortium, Reading, MA, Addison-Wesley, 2016. <em>The Unicode Standard</em> as updated from time to time by the publication of new versions. See <a href="http://www.unicode.org/standard/versions/">http://www.unicode.org/standard/versions/</a> for the latest version and additional information on versions of the standard and of the Unicode Character Database. The version of Unicode to be used is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but implementations are recommended to use the latest Unicode version; currently, Version 9.0.0. (See <a href="#Unicode">The Unicode Standard</a>.)</p></li><li><p><em>Unicode Technical Standard #10: Unicode Collation Algorithm</em>. Ed. Mark Davis and Ken Whistler, Unicode Consortium. The current version is 16.0.0, dated 2024-08-22. As with <a href="#Unicode">[The Unicode Standard]</a>, the version to be used is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Available at: <a href="http://www.unicode.org/reports/tr10/">http://www.unicode.org/reports/tr10/</a>. (See <a href="#UNICODE-TR10">UTS #10</a>.)</p></li><li><p><em>Unicode Technical Standard #35: Unicode Locale Data Markup Language</em>. Ed Mark Davis <em>et al</em>, Unicode Consortium. The current version is 47, dated 2025-03-11. As with <a href="#Unicode">[The Unicode Standard]</a>, the version to be used is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>. Available at: <a href="http://www.unicode.org/reports/tr35/">http://www.unicode.org/reports/tr35/</a>. (See <a href="#UNICODE-TR35">UTS #35</a>.)</p></li></ol></div><div class="_diffs div1"><h2><a id="changelog"></a>H <a href="#changelog" style="text-decoration: none">Changes since 3.1</a> (Non-Normative)</h2><div class="_diffs div2"><h3><a id="changes-summary"></a>H.1 <a href="#changes-summary" style="text-decoration: none">Summary of Changes</a></h3><ol><li><p>If a section of this specification has been updated since version 3.1, an overview of the changes is provided, along with links to navigate to the next or previous change.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p>Sections with significant changes are marked with a ✭ symbol in the table of contents. New functions are indicated by ✚.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1504 2329">1504 2329&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-insert-separator"><b>2.1.7 fn:insert-separator</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-replicate"><b>2.1.10 fn:replicate</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-slice"><b>2.1.12 fn:slice</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1120 1150">1120 1150&nbsp;</a></p><p>A callback function can be supplied for comparing individual items.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p></li><li><p>Changed in 4.0 to use transitive equality comparisons for numeric values.</p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/614 987">614 987&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-duplicate-values"><b>2.2.6 fn:duplicate-values</b></a></p></li><li><p>New in 4.0. Originally proposed under the name <code>fn:uniform</code></p><p>See <a href="#func-all-equal"><b>2.4.2 fn:all-equal</b></a></p></li><li><p>New in 4.0. Originally proposed under the name <code>fn:unique</code></p><p>See <a href="#func-all-different"><b>2.4.3 fn:all-different</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-every"><b>2.5.3 fn:every</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-highest"><b>2.5.9 fn:highest</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-index-where"><b>2.5.10 fn:index-where</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-lowest"><b>2.5.11 fn:lowest</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-scan-right"><b>2.5.15 fn:scan-right</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-some"><b>2.5.16 fn:some</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/795 2228">795 2228&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-sort-with"><b>2.5.19 fn:sort-with</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/521 761">521 761&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-transitive-closure"><b>2.5.22 fn:transitive-closure</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-is-NaN"><b>4.4.5 fn:is-NaN</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1260 1275">1260 1275&nbsp;</a></p><p>A third argument has been added, providing control over the rounding mode.</p><p>See <a href="#func-round"><b>4.4.6 fn:round</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1049 1151">1049 1151&nbsp;</a></p><p>Decimal format parameters can now be supplied directly as a map in the third argument, rather than referencing a format defined in the static context.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1205 1230">1205 1230&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-math-e"><b>4.8.2 math:e</b></a></p><p>See <a href="#func-math-cosh"><b>4.8.8 math:cosh</b></a></p><p>See <a href="#func-math-sinh"><b>4.8.15 math:sinh</b></a></p><p>See <a href="#func-math-tanh"><b>4.8.18 math:tanh</b></a></p></li><li><p>The 3.1 specification suggested that every value in the result range should have the same chance of being chosen. This has been corrected to say that the distribution should be arithmetically uniform (because there are as many <code>xs:double</code> values between 0.01 and 0.1 as there are between 0.1 and 1.0).</p><p>See <a href="#func-random-number-generator"><b>4.9.2 fn:random-number-generator</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/261 306 993">261 306 993&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-char"><b>5.4.1 fn:char</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-characters"><b>5.4.2 fn:characters</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/937 995 1190">937 995 1190&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-hash"><b>5.4.13 fn:hash</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/215 415 ">215 415 &nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-uri"><b>7.6.2 fn:parse-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1423 1413">1423 1413&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-build-uri"><b>7.6.3 fn:build-uri</b></a></p></li><li class="add_version" style="display: none;"><p>New in 4.0</p><p>See <a href="#func-build-dateTime"><b>9.4.2 fn:build-dateTime</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-build-dateTime"><b><span class="deltaxml-new" style="background:#90EE90">9.4.2 fn:build-dateTime</span></b></a></p></li><li class="add_version" style="display: none;"><p>New in 4.0</p><p>See <a href="#func-parts-of-dateTime"><b>9.6.16 fn:parts-of-dateTime</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-parts-of-dateTime"><b><span class="deltaxml-new" style="background:#90EE90">9.6.16 fn:parts-of-dateTime</span></b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-in-scope-namespaces"><b>12.2.2 fn:in-scope-namespaces</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1620 1886">1620 1886&nbsp;</a></p><p>Options are added to customize the form of the output.</p><p>See <a href="#func-path"><b>12.2.9 fn:path</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1547 1551">1547 1551&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-siblings"><b>12.2.11 fn:siblings</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/969 1134">969 1134&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/478 515">478 515&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-keys-where"><b>14.4.12 map:keys-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1575 1906">1575 1906&nbsp;</a></p><p> A new function <a href="#func-element-to-map"><code>fn:element-to-map</code></a> is provided for converting XDM trees to maps suitable for serialization as JSON. Unlike the <a href="#func-xml-to-json"><code>fn:xml-to-json</code></a> function retained from 3.1, this can handle arbitrary XML as input. </p><p>See <a href="#xml-to-json-mappings"><b>14.5 Converting elements to maps</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-array-empty"><b>15.2.3 array:empty</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/968 1295">968 1295&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-index-of"><b>15.2.13 array:index-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/476 1087">476 1087&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-items"><b>15.2.16 array:items</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/360 476">360 476&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-members"><b>15.2.18 array:members</b></a></p><p>See <a href="#func-array-of-members"><b>15.2.19 array:of-members</b></a></p></li><li><p>Supplying an empty sequence as the value of an optional argument is equivalent to omitting the argument.</p><p>See <a href="#func-array-subarray"><b>15.2.29 array:subarray</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1117 1279">1117 1279&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-unparsed-text-lines"><b>17.1.6 fn:unparsed-text-lines</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/259 956">259 956&nbsp;</a></p><p> A new function is available for processing input data in HTML format. </p><p>See <a href="#html-functions"><b>17.3 Functions on HTML Data</b></a></p><p>New in 4.0</p><p>See <a href="#func-parse-html"><b>17.3.2 fn:parse-html</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/975 1058 1246">975 1058 1246&nbsp;</a></p><p>An option is provided to control how JSON numbers should be formatted.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>Additional options are available, as defined by <a href="#func-parse-json"><code>fn:parse-json</code></a>.</p><p>See <a href="#func-json-doc"><b>17.4.5 fn:json-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834 1066">533 719 834 1066&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-csv-to-arrays"><b>17.5.4 fn:csv-to-arrays</b></a></p><p>See <a href="#func-parse-csv"><b>17.5.7 fn:parse-csv</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834 1066 1605">533 719 834 1066 1605&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-csv-to-xml"><b>17.5.10 fn:csv-to-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/791 1256 1282 1405">791 1256 1282 1405&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-invisible-xml"><b>17.6.1 fn:invisible-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/629 803">629 803&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-message"><b>21.2.2 fn:message</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834">533 719 834&nbsp;</a></p><p> New functions are available for processing input data in CSV (comma separated values) format. </p><p>See <a href="#csv-functions"><b>17.5 Functions on CSV Data</b></a></p></li><li><p>Comparison of mixed numeric types (for example <code>xs:double</code> and <code>xs:decimal</code>) now generally converts both values to <code>xs:decimal</code>.</p><p>See <a href="#comp.numeric"><b>4.3 Comparing numeric values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/289 1901">289 1901&nbsp;</a></p><p>A third argument is added, allowing user control of how absent keys should be handled.</p><p>See <a href="#func-map-get"><b>14.4.9 map:get</b></a></p><p>A third argument is added, allowing user control of how index-out-of-bounds conditions should be handled.</p><p>See <a href="#func-array-get"><b>15.2.11 array:get</b></a></p></li><li><p> A new collation URI is defined for Unicode case-insensitive comparison and ordering. </p><p>See <a href="#unicode-case-insensitive-collation"><b>5.3.5 The Unicode case-insensitive collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1727 1740">1727 1740&nbsp;</a></p><p>It is no longer guaranteed that the new key replaces the existing key.</p><p>See <a href="#func-map-put"><b>14.4.14 map:put</b></a></p></li><li><p>The group may remove this function, it is considered <a href="#at-risk">at risk</a>. </p><p>See <a href="#func-array-members"><b>15.2.18 array:members</b></a></p><p>See <a href="#func-array-of-members"><b>15.2.19 array:of-members</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/173">173&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-op"><b>18.4 fn:op</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/203">203&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-build"><b>14.4.1 map:build</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/207">207&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-QName"><b>10.1.2 fn:parse-QName</b></a></p><p>See <a href="#func-expanded-QName"><b>10.2.5 fn:expanded-QName</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/222">222&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-contains-subsequence"><b>2.2.3 fn:contains-subsequence</b></a></p><p>See <a href="#func-ends-with-subsequence"><b>2.2.7 fn:ends-with-subsequence</b></a></p><p>See <a href="#func-starts-with-subsequence"><b>2.2.9 fn:starts-with-subsequence</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/250">250&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-foot"><b>2.1.3 fn:foot</b></a></p><p>See <a href="#func-trunk"><b>2.1.15 fn:trunk</b></a></p><p>See <a href="#func-array-build"><b>15.2.2 array:build</b></a></p><p>See <a href="#func-array-foot"><b>15.2.8 array:foot</b></a></p><p>See <a href="#func-array-trunk"><b>15.2.31 array:trunk</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/258">258&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-index-where"><b>15.2.14 array:index-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/313">313&nbsp;</a></p><p>The second argument can now be a sequence of integers.</p><p>See <a href="#func-remove"><b>2.1.9 fn:remove</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/319">319&nbsp;</a></p><p>New in 4.0. The function replaces the internal <a href="#dt-same-key"><code>op:same-key</code></a> function in 3.1</p><p>See <a href="#func-atomic-equal"><b>2.2.1 fn:atomic-equal</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/326">326&nbsp;</a></p><p>Higher-order functions are no longer an optional feature.</p><p>See <a href="#conformance"><b>1.2 Conformance</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/360">360&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-entries"><b>14.4.4 map:entries</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/419">419&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-items-at"><b>2.1.8 fn:items-at</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/434">434&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-integer"><b>4.5.2 fn:parse-integer</b></a></p><p>The function has been extended to allow output in a radix other than 10, for example in hexadecimal.</p><p>See <a href="#func-format-integer"><b>4.6.1 fn:format-integer</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/477">477&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-slice"><b>15.2.24 array:slice</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/482">482&nbsp;</a></p><p>Deleted an inaccurate statement concerning the behavior of NaN.</p><p>See <a href="#comp.numeric"><b>4.3 Comparing numeric values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/507">507&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-partition"><b>2.5.13 fn:partition</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/546">546&nbsp;</a></p><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-codepoints-to-string"><b>5.2.1 fn:codepoints-to-string</b></a></p><p>It is no longer automatically an error if the resource (after decoding) contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p><p> The rules regarding use of non-XML characters in JSON texts have been relaxed. </p><p>See <a href="#json-character-repertoire"><b>17.4.3 JSON character repertoire</b></a></p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-json-doc"><b>17.4.5 fn:json-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/609">609&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-split"><b>15.2.28 array:split</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/631">631&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-decode-from-uri"><b>7.1 fn:decode-from-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/662">662&nbsp;</a></p><p> Constructor functions now have a zero-arity form; the first argument defaults to the context item. </p><p>See <a href="#constructor-functions"><b>22 Constructor functions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/680">680&nbsp;</a></p><p> The case-insensitive collation is now defined normatively within this specification, rather than by reference to the HTML "living specification", which is subject to change. The collation can now be used for ordering comparisons as well as equality comparisons. </p><p>See <a href="#html-ascii-case-insensitive-collation"><b>5.3.6 The HTML ASCII Case-Insensitive Collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/702">702&nbsp;</a></p><p>The function can now take any number of arguments (previously it had to be two or more), and the arguments can be sequences of strings rather than single strings.</p><p>See <a href="#func-concat"><b>5.4.4 fn:concat</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/710">710&nbsp;</a></p><p>Changes the function to return a sequence of key-value pairs rather than a map.</p><p>See <a href="#func-function-annotations"><b>13.5 fn:function-annotations</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/727">727&nbsp;</a></p><p>It has been clarified that loading a module has no effect on the static or dynamic context of the caller.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/828">828&nbsp;</a></p><p>The <code>$predicate</code> callback function accepts an optional position argument.</p><p>See <a href="#func-filter"><b>2.5.4 fn:filter</b></a></p><p>The <code>$action</code> callback function accepts an optional position argument.</p><p>See <a href="#func-for-each"><b>2.5.7 fn:for-each</b></a></p><p>See <a href="#func-for-each-pair"><b>2.5.8 fn:for-each-pair</b></a></p><p>The <code>$predicate</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-array-filter"><b>15.2.4 array:filter</b></a></p><p>The <code>$action</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-array-for-each"><b>15.2.9 array:for-each</b></a></p><p>See <a href="#func-array-for-each-pair"><b>15.2.10 array:for-each-pair</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/881">881&nbsp;</a></p><p>The way that <a href="#func-min"><code>fn:min</code></a> and <a href="#func-max"><code>fn:max</code></a> compare numeric values of different types has changed. The most noticeable effect is that when these functions are applied to a sequence of <code>xs:integer</code> or <code>xs:decimal</code> values, the result is an <code>xs:integer</code> or <code>xs:decimal</code>, rather than the result of converting this to an <code>xs:float</code> or <code>xs:double</code>.</p><p>See <a href="#func-max"><b>2.4.5 fn:max</b></a></p><p>See <a href="#func-min"><b>2.4.6 fn:min</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/901">901&nbsp;</a></p><p>The optional third argument can now be supplied as an empty sequence.</p><p>See <a href="#func-subsequence"><b>2.1.13 fn:subsequence</b></a></p><p>The third argument can now be supplied as an empty sequence.</p><p>See <a href="#func-substring"><b>5.4.6 fn:substring</b></a></p><p>The second argument can now be an empty sequence.</p><p>See <a href="#func-tokenize"><b>6.3.3 fn:tokenize</b></a></p><p>The optional second argument can now be supplied as an empty sequence.</p><p>See <a href="#func-resolve-uri"><b>7.5 fn:resolve-uri</b></a></p><p>The 3rd, 4th, and 5th arguments are now optional; previously the function required either 2 or 5 arguments.</p><p>See <a href="#func-format-dateTime"><span style="display: none;" class="delete_version"><b>9.8.1 fn:format-dateTime</b></span><span style="display: none;" class="add_version"><b>9.9.1 fn:format-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.1</span><span class="deltaxml-new" style="background:#90EE90">9.9.1</span> fn:format-dateTime</b></span></a></p><p>See <a href="#func-format-date"><span style="display: none;" class="delete_version"><b>9.8.2 fn:format-date</b></span><span style="display: none;" class="add_version"><b>9.9.2 fn:format-date</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.2</span><span class="deltaxml-new" style="background:#90EE90">9.9.2</span> fn:format-date</b></span></a></p><p>See <a href="#func-format-time"><span style="display: none;" class="delete_version"><b>9.8.3 fn:format-time</b></span><span style="display: none;" class="add_version"><b>9.9.3 fn:format-time</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.8.3</span><span class="deltaxml-new" style="background:#90EE90">9.9.3</span> fn:format-time</b></span></a></p><p>All three arguments are now optional, and each argument can be set to an empty sequence. Previously if <code>$description</code> was supplied, it could not be empty.</p><p>See <a href="#func-error"><b>21.1.1 fn:error</b></a></p><p>The <code>$label</code> argument can now be set to an empty sequence. Previously if <code>$label</code> was supplied, it could not be empty.</p><p>See <a href="#func-trace"><b>21.2.1 fn:trace</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/905">905&nbsp;</a></p><p>The rule that multiple calls on <a href="#func-doc"><code>fn:doc</code></a> supplying the same absolute URI must return the same document node has been clarified; in particular the rule does not apply if the dynamic context for the two calls requires different processing of the documents (such as schema validation or whitespace stripping).</p><p>See <a href="#func-doc"><b>17.1.1 fn:doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/909">909&nbsp;</a></p><p>The function has been expanded in scope to handle comparison of values other than strings.</p><p>See <a href="#func-compare"><b>2.2.2 fn:compare</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/924">924&nbsp;</a></p><p> Rules have been added clarifying that users should not be allowed to change the schema for the <code>fn</code> namespace. </p><p>See <a href="#schemata"><b>D Schemas</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/925">925&nbsp;</a></p><p>The decimal format name can now be supplied as a value of type <code>xs:QName</code>, as an alternative to supplying a lexical QName as an instance of <code>xs:string</code>.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/932">932&nbsp;</a></p><p> The specification now prescribes a minimum precision and range for durations. </p><p>See <a href="#duration-conformance"><b>8.1.2 Limits and precision</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/933">933&nbsp;</a></p><p>When comments and processing instructions are ignored, any text nodes either side of the comment or processing instruction are now merged prior to comparison.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/940">940&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-subsequence-where"><b>2.5.20 fn:subsequence-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/953">953&nbsp;</a></p><p> Constructor functions for named record types have been introduced. </p><p>See <a href="#id-constructors-for-record-tests"><b>22.6 Constructor functions for named record types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/962">962&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-do-until"><b>2.5.2 fn:do-until</b></a></p><p>See <a href="#func-while-do"><b>2.5.23 fn:while-do</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/969">969&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-empty"><b>14.4.3 map:empty</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/984">984&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-seconds"><b>8.4.1 fn:seconds</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/987">987&nbsp;</a></p><p>The order of results is now prescribed; it was previously implementation-dependent.</p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1022">1022&nbsp;</a></p><p> Regular expressions can include comments (starting and ending with <code>#</code>) if the <code>c</code> flag is set. </p><p>See <a href="#regex-syntax"><b>6.1 Regular expression syntax</b></a></p><p>See <a href="#flags"><b>6.2 Flags</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1028">1028&nbsp;</a></p><p>An option is provided to control how the JSON <code>null</code> value should be handled.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1032">1032&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-void"><b>2.1.17 fn:void</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1046">1046&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-take-while"><b>2.5.21 fn:take-while</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1059">1059&nbsp;</a></p><p> Use of an option keyword that is not defined in the specification and is not known to the implementation now results in a dynamic error; previously it was ignored. </p><p>See <a href="#options"><b>1.7 Options</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1068">1068&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-graphemes"><b>5.4.3 fn:graphemes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1072">1072&nbsp;</a></p><p>The return type is now specified more precisely.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1090">1090&nbsp;</a></p><p> When casting from a string to a duration or time or dateTime, it is now specified that when there are more digits in the fractional seconds than the implementation is able to retain, excess digits are truncated. Rounding upwards (which could affect the number of minutes or hours in the value) is not permitted. </p><p>See <a href="#casting-from-strings"><b>23.2 Casting from xs:string and xs:untypedAtomic</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1093">1093&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-collation"><b>5.3.9 fn:collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1117">1117&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p><p>See <a href="#func-unparsed-text-available"><b>17.1.7 fn:unparsed-text-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1182">1182&nbsp;</a></p><p>The <code>$predicate</code> callback function may return an empty sequence (meaning <code>false</code>).</p><p>See <a href="#func-do-until"><b>2.5.2 fn:do-until</b></a></p><p>See <a href="#func-every"><b>2.5.3 fn:every</b></a></p><p>See <a href="#func-filter"><b>2.5.4 fn:filter</b></a></p><p>See <a href="#func-index-where"><b>2.5.10 fn:index-where</b></a></p><p>See <a href="#func-some"><b>2.5.16 fn:some</b></a></p><p>See <a href="#func-take-while"><b>2.5.21 fn:take-while</b></a></p><p>See <a href="#func-while-do"><b>2.5.23 fn:while-do</b></a></p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-keys-where"><b>14.4.12 map:keys-where</b></a></p><p>See <a href="#func-array-filter"><b>15.2.4 array:filter</b></a></p><p>See <a href="#func-array-index-where"><b>15.2.14 array:index-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1191">1191&nbsp;</a></p><p>The <code>$options</code> parameter has been added, absorbing the <code>$collation</code> parameter.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p><p>New in 4.0</p><p>See <a href="#func-distinct-ordered-nodes"><b>12.3.1 fn:distinct-ordered-nodes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1250">1250&nbsp;</a></p><p>For selected properties including <code>percent</code> and <code>exponent-separator</code>, it is now possible to specify a single-character marker to be used in the picture string, together with a multi-character rendition to be used in the formatted output.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1257">1257&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p><p>See <a href="#func-parse-xml-fragment"><b>17.2.2 fn:parse-xml-fragment</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1262">1262&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-collation-available"><b>5.3.10 fn:collation-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1265">1265&nbsp;</a></p><p>The constraints on the result of the function have been relaxed.</p><p>See <a href="#func-document-uri"><b>12.1.2 fn:document-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1280">1280&nbsp;</a></p><p>As a result of changes to the coercion rules, the number of supplied arguments can be greater than the number required: extra arguments are ignored.</p><p>See <a href="#func-apply"><b>2.5.1 fn:apply</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1288">1288&nbsp;</a></p><p>Additional error conditions have been defined.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1296">1296&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-scan-left"><b>2.5.14 fn:scan-left</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1333">1333&nbsp;</a></p><p>A new option is provided to allow the content of the loaded module to be supplied as a string.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1353">1353&nbsp;</a></p><p>An option has been added to suppress the escaping of the solidus (forwards slash) character.</p><p>See <a href="#func-xml-to-json"><b>17.4.7 fn:xml-to-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1358">1358&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-unix-dateTime"><span style="display: none;" class="delete_version"><b>9.3.2 fn:unix-dateTime</b></span><span style="display: none;" class="add_version"><b>9.4.3 fn:unix-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.3.2</span><span class="deltaxml-new" style="background:#90EE90">9.4.3</span> fn:unix-dateTime</b></span></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1361">1361&nbsp;</a></p><p> The term <b>atomic value</b> has been replaced by <b>atomic item</b>. </p><p>See <a href="#terminology"><b>1.9 Terminology</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1393">1393&nbsp;</a></p><p>Changes the function to return a sequence of key-value pairs rather than a map.</p><p>See <a href="#func-function-annotations"><b>13.5 fn:function-annotations</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1409">1409&nbsp;</a></p><p> This section now uses the term <b>primitive type</b> strictly to refer to the 20 atomic types that are not derived by restriction from another atomic type: that is, the 19 primitive atomic types defined in XSD, plus <code>xs:untypedAtomic</code>. The three types <code>xs:integer</code>, <code>xs:dayTimeDuration</code>, and <code>xs:yearMonthDuration</code>, which have custom casting rules but are not strictly-speaking primitive, are now handled in other subsections. </p><p>See <a href="#casting-from-primitive-to-primitive"><b>23.1 Casting from primitive types to primitive types</b></a></p><p> The rules for conversion of dates and times to strings are now defined entirely in terms of XSD 1.1 canonical mappings, since these deliver exactly the same result as the XPath 3.1 rules. </p><p>See <a href="#casting-date-time-to-string"><b>23.1.2.2 Casting date/time values to xs:string</b></a></p><p> The rules for conversion of durations to strings are now defined entirely in terms of XSD 1.1 canonical mappings, since the XSD 1.1 rules deliver exactly the same result as the XPath 3.1 rules. </p><p>See <a href="#casting-duration-to-string"><b>23.1.2.3 Casting xs:duration values to xs:string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1455">1455&nbsp;</a></p><p>Numbers now retain their original lexical form, except for any changes needed to satisfy JSON syntax rules (for example, stripping leading zero digits).</p><p>See <a href="#func-xml-to-json"><b>17.4.7 fn:xml-to-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1473">1473&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-identity"><b>2.1.5 fn:identity</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481&nbsp;</a></p><p>The function has been extended to handle other Gregorian types such as <code>xs:gYearMonth</code>.</p><p>See <a href="#func-year-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.1 fn:year-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.1 fn:year-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.1</span><span class="deltaxml-new" style="background:#90EE90">9.6.1</span> fn:year-from-dateTime</b></span></a></p><p>See <a href="#func-month-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.2 fn:month-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.2 fn:month-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.2</span><span class="deltaxml-new" style="background:#90EE90">9.6.2</span> fn:month-from-dateTime</b></span></a></p><p>The function has been extended to handle other Gregorian types such as <code>xs:gMonthDay</code>.</p><p>See <a href="#func-day-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.3 fn:day-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.3 fn:day-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.3</span><span class="deltaxml-new" style="background:#90EE90">9.6.3</span> fn:day-from-dateTime</b></span></a></p><p>The function has been extended to handle other types including <code>xs:time</code>.</p><p>See <a href="#func-hours-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.4 fn:hours-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.4 fn:hours-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.4</span><span class="deltaxml-new" style="background:#90EE90">9.6.4</span> fn:hours-from-dateTime</b></span></a></p><p>See <a href="#func-minutes-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.5 fn:minutes-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.5 fn:minutes-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.5</span><span class="deltaxml-new" style="background:#90EE90">9.6.5</span> fn:minutes-from-dateTime</b></span></a></p><p>The function has been extended to handle other types such as <code>xs:gYearMonth</code>.</p><p>See <a href="#func-timezone-from-dateTime"><span style="display: none;" class="delete_version"><b>9.5.7 fn:timezone-from-dateTime</b></span><span style="display: none;" class="add_version"><b>9.6.7 fn:timezone-from-dateTime</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.5.7</span><span class="deltaxml-new" style="background:#90EE90">9.6.7</span> fn:timezone-from-dateTime</b></span></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1523">1523&nbsp;</a></p><p> New functions are provided to obtain information about built-in types and types defined in an imported schema. </p><p>See <a href="#functions-on-types"><b>19 Processing types</b></a></p><p>New in 4.0</p><p>See <a href="#func-schema-type"><b>19.1.2 fn:schema-type</b></a></p><p>See <a href="#func-atomic-type-annotation"><b>19.1.4 fn:atomic-type-annotation</b></a></p><p>See <a href="#func-node-type-annotation"><b>19.1.5 fn:node-type-annotation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1545">1545&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-civil-timezone"><span style="display: none;" class="delete_version"><b>9.6.4 fn:civil-timezone</b></span><span style="display: none;" class="add_version"><b>9.7.4 fn:civil-timezone</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">9.6.4</span><span class="deltaxml-new" style="background:#90EE90">9.7.4</span> fn:civil-timezone</b></span></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1565">1565&nbsp;</a></p><p>The default for the <code>escape</code> option has been changed to <code>false</code>. The 3.1 specification gave the default value as <code>true</code>, but this appears to have been an error, since it was inconsistent with examples given in the specification and with tests in the test suite.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1570">1570&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-type-of"><b>19.1.3 fn:type-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1587">1587&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-unparsed-binary"><b>17.1.8 fn:unparsed-binary</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1611">1611&nbsp;</a></p><p>The spec has been corrected to note that the function depends on the implicit timezone.</p><p>See <a href="#func-compare"><b>2.2.2 fn:compare</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1671">1671&nbsp;</a></p><p>New in 4.0.</p><p>See <a href="#func-divide-decimals"><b>4.4.3 fn:divide-decimals</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1687">1687&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-items"><b>14.4.10 map:items</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1703">1703&nbsp;</a></p><p>Ordered maps are introduced.</p><p>See <a href="#map-ordering"><b>14.1 Ordering of Maps</b></a></p><p>Enhanced to allow for ordered maps.</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-find"><b>14.4.7 map:find</b></a></p><p>See <a href="#func-map-for-each"><b>14.4.8 map:for-each</b></a></p><p>See <a href="#func-map-put"><b>14.4.14 map:put</b></a></p><p>See <a href="#func-map-remove"><b>14.4.15 map:remove</b></a></p><p>The order of entries in maps is retained.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1711">1711&nbsp;</a></p><p>It is explicitly stated that the limits for <code>$precision</code> are implementation-defined.</p><p>See <a href="#func-round"><b>4.4.6 fn:round</b></a></p><p>See <a href="#func-round-half-to-even"><b>4.4.7 fn:round-half-to-even</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1727">1727&nbsp;</a></p><p>For consistency with the new function <a href="#func-map-build"><code>map:build</code></a>, the handling of duplicates may now be controlled by supplying a user-defined callback function as an alternative to the fixed values for the earlier <code>duplicates</code> option.</p><p>See <a href="#func-map-merge"><b>14.4.13 map:merge</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1734">1734&nbsp;</a></p><p>In 3.1, given a mixed input sequence such as (1, 3, 4.2e0), the specification was unclear whether it was permitted to add the first two integer items using integer arithmetic, rather than converting all items to doubles before performing any arithmetic. The 4.0 specification is clear that this is permitted; but since the items can be reordered before being added, this is not required.</p><p>See <a href="#func-avg"><b>2.4.4 fn:avg</b></a></p><p>See <a href="#func-sum"><b>2.4.7 fn:sum</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1825">1825&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-partial-apply"><b>2.5.12 fn:partial-apply</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1856">1856&nbsp;</a></p><p> Word boundaries can be matched. Lookahead and lookbehind assertions are supported. Assertions (including <code>^</code> and <code>$</code>) can no longer be followed by a quantifier. </p><p>See <a href="#regex-syntax"><b>6.1 Regular expression syntax</b></a></p><p>The output of the function is extended to allow the represention of captured groups found within lookahead assertions.</p><p>See <a href="#func-analyze-string"><b>6.3.4 fn:analyze-string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1879">1879&nbsp;</a></p><p>Additional options to control DTD and XInclude processing have been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1897">1897&nbsp;</a></p><p>The <code>$replacement</code> argument can now be a function that computes the replacement strings.</p><p>See <a href="#func-replace"><b>6.3.2 fn:replace</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1906">1906&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-element-to-map-plan"><b>14.5.10 fn:element-to-map-plan</b></a></p><p>New in 4.0.</p><p>See <a href="#func-element-to-map"><b>14.5.11 fn:element-to-map</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1910">1910&nbsp;</a></p><p>An <code>$options</code> parameter is added. Note that the rules for the <code>$options</code> parameter control aspects of processing that were implementation-defined in earlier versions of this specification. An implementation may provide configuration options designed to retain backwards-compatible behavior when no explicit options are supplied.</p><p>See <a href="#func-doc"><b>17.1.1 fn:doc</b></a></p><p>See <a href="#func-doc-available"><b>17.1.2 fn:doc-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1913">1913&nbsp;</a></p><p>It is now permitted for the regular expression to match a zero-length string.</p><p>See <a href="#func-replace"><b>6.3.2 fn:replace</b></a></p><p>See <a href="#func-tokenize"><b>6.3.3 fn:tokenize</b></a></p><p>See <a href="#func-analyze-string"><b>6.3.4 fn:analyze-string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1933">1933&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-xsd-validator"><b>17.2.5 fn:xsd-validator</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1991">1991&nbsp;</a></p><p> Named record types used in the signatures of built-in functions are now available as standard in the static context. </p><p>See <a href="#id-built-in-named-record-types"><b>C Built-in named record types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2001">2001&nbsp;</a></p><p>New in 4.0.</p><p>See <a href="#func-sort-by"><b>2.5.18 fn:sort-by</b></a></p><p>See <a href="#func-array-sort-by"><b>15.2.26 array:sort-by</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2013">2013&nbsp;</a></p><p>Support for binary input has been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p><p>See <a href="#func-parse-xml-fragment"><b>17.2.2 fn:parse-xml-fragment</b></a></p><p>New in 4.0</p><p>See <a href="#func-html-doc"><b>17.3.3 fn:html-doc</b></a></p><p>See <a href="#func-csv-doc"><b>17.5.8 fn:csv-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2030">2030&nbsp;</a></p><p> This description of the XSD validation process was previously found (with some duplication) in the XQuery and XSLT specifications; those specifications now reference this description. As a side-effects, the descriptions of the process in XQuery and XSLT are better aligned. </p><p>See <a href="#xsd-validation"><b>17.2.4 XSD validation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2031">2031&nbsp;</a></p><p> Introduced the concept of JNodes. </p><p>See <a href="#processing-jnodes"><b>16 Processing JNodes</b></a></p><p>New in 4.0</p><p>See <a href="#func-jtree"><b>16.1.1 fn:jtree</b></a></p><p>See <a href="#func-jnode-selector"><b>16.1.3 fn:jnode-selector</b></a></p><p>See <a href="#func-jnode-position"><b>16.1.4 fn:jnode-position</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2149">2149&nbsp;</a></p><p>Generalized to work with JNodes as well as XNodes.</p><p>See <a href="#func-has-children"><b>12.2.1 fn:has-children</b></a></p><p>The function is extended to handle JNodes.</p><p>See <a href="#func-path"><b>12.2.9 fn:path</b></a></p><p>Generalized to work with JNodes as well as XNodes.</p><p>See <a href="#func-innermost"><b>12.3.2 fn:innermost</b></a></p><p>See <a href="#func-outermost"><b>12.3.3 fn:outermost</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2168">2168&nbsp;</a></p><p>Atomic items of types <code>xs:hexBinary</code> and <code>xs:base64Binary</code> are now mutually comparable. In rare cases, where an application uses both types and assumes they are distinct, this can represent a backwards incompatibility.</p><p>See <a href="#func-atomic-equal"><b>2.2.1 fn:atomic-equal</b></a></p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2223">2223&nbsp;</a></p><p>An error may now be raised if the base URI is not a valid LEIRI reference.</p><p>See <a href="#func-base-uri"><b>12.1.1 fn:base-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2224">2224&nbsp;</a></p><p>The <code>$action</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-for-each"><b>14.4.8 map:for-each</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2228">2228&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-sort-with"><b>15.2.27 array:sort-with</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2249">2249&nbsp;</a></p><p>The specification now describes in more detail how to determine the effective encoding value.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2256">2256&nbsp;</a></p><p>In the interests of consistency, the <a href="#func-index-of"><code>index-of</code></a> function now defines equality to mean <a title="contextually equal" class="termref" href="#dt-contextually-equal">contextually equal</a>. This has the implication that <code>NaN</code> is now considered equal to <code>NaN</code>.</p><p>See <a href="#func-index-of"><b>2.2.8 fn:index-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2259">2259&nbsp;</a></p><p>A new parameter <code>canonical</code> is available to give control over serialization of XML, XHTML, and JSON.</p><p>See <a href="#func-serialize"><b>17.2.3 fn:serialize</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2286">2286&nbsp;</a></p><p>The type of <code>$value</code> has been generalized to <code>xs:anyAtomicType?</code>.</p><p>See <a href="#func-string-length"><b>5.4.7 fn:string-length</b></a></p><p>See <a href="#func-normalize-space"><b>5.4.8 fn:normalize-space</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2387">2387&nbsp;</a></p><p>It is now recommended that out-of-range <code>xs:double</code> values should translate to positive or negative infinity.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li></ol></div></div></div><script src="js/toc.js"></script><script src="/js/scroll.js"></script></body></html>
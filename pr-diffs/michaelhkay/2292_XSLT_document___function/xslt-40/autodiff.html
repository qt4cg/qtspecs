<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml" lang="EN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XSL Transformations (XSLT) Version 4.0</title><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" type="text/css" href="css/w3c-base.css"><link rel="stylesheet" href="css/qtspecs.css"><link rel="stylesheet" href="css/xslt-40.css"><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css"></head><body class="toc-inline"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p><p>This draft contains only sections that have differences from the version that it modified.</p></div><div class="head"><p><a href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" height="48" width="72"></a></p><h1><a id="title"></a>XSL Transformations (XSLT) Version 4.0</h1><h2><a id="w3c-doctype"></a>W3C Editor's Draft <span class="deltaxml-old" style="background:#FF5555">30 January</span><span class="deltaxml-new" style="background:#90EE90">2 February</span> 2026</h2><dl><dt>This version:</dt><dd><a href="https://qt4cg.org/specifications/xslt-40/">https://qt4cg.org/specifications/xslt-40/</a></dd><dt>Latest version:</dt><dd><a href="https://qt4cg.org/specifications/xslt-40/">https://qt4cg.org/specifications/xslt-40/</a></dd><dt>Most recent Recommendation of XSL Transformations (XSLT):</dt><dd><a href="https://www.w3.org/TR/xslt-30/">https://www.w3.org/TR/xslt-30/</a></dd><dt>Editor:</dt><dd>Michael Kay, Saxonica <a href="http://www.saxonica.com/">&lt;http://www.saxonica.com/&gt;</a></dd></dl><p>The following associated resources are available: <a href="xslt-40.xml">Specification in XML format</a>, <a href="schema-for-xslt40.xsd">XSD 1.1 Schema for XSLT 4.0 Stylesheets (non-normative)</a>, <a href="schema-for-xslt40.rnc">Relax-NG Schema for XSLT 4.0 Stylesheets (non-normative)</a>, <a href="xml-to-json.xsl">Stylesheet for XML-to-JSON conversion (non-normative)</a></p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2026&nbsp;<a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr></div><div><h2><a id="abstract"></a>Abstract</h2><p>This specification defines the syntax and semantics of XSLT 4.0, a language designed primarily for transforming XML documents into other XML documents, but also offering support for other data formats including JSON, HTML, and CSV.</p><p>XSLT 4.0 is a revised version of the XSLT 3.0 Recommendation <a href="#xslt-30">[XSLT 3.0]</a> published on 8 June 2017. Changes are presented in <a href="#whats-new-in-xslt4"><i>1.2 What’s New in XSLT 4.0?</i></a>. </p><p>XSLT 4.0 is designed to be used in conjunction with XPath 4.0, which is defined in <a href="#xpath-40">[XPath 4.0]</a>. XSLT shares the same data model as XPath 4.0, which is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a>, and it uses the library of functions and operators defined in <a href="#xpath-functions-40">[Functions and Operators 4.0]</a>. XPath 4.0 and the underlying function library introduce a number of enhancements, for example the availability of union and record types. </p><p><em>This document contains hyperlinks to specific sections or definitions within other documents in this family of specifications. These links are indicated visually by a superscript identifying the target specification: for example XP for XPath 4.0, DM for the XDM data model version 4.0, FO for Functions and Operators version 4.0, SG for XSLT Streaming version 4.0.</em></p><p>An optional feature of the XSLT language is support for streamed transformations. The XSLT 4.0 specification has been modularized so that streaming is now described in a separate specification document. This has been done in order to make the specifications more manageable, both for editors and readers: it does not alter the status of streaming as an optional feature, available in some processors and not others.</p></div><div><h2><a id="status"></a>Status of this Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document.</em></p><p>This document is a working draft developed and maintained by a W3C Community Group, the <a href="https://www.w3.org/community/xslt-40/">XQuery and XSLT Extensions Community Group</a> unofficially known as QT4CG (where "QT" denotes Query and Transformation). This draft is work in progress and should not be considered either stable or complete. Standard W3C copyright and patent conditions apply.</p><p>The community group welcomes comments on the specification. Comments are best submitted as issues on the group's <a href="https://github.com/qt4cg/qtspecs/issues">GitHub repository</a>.</p><p>The community group maintains two extensive test suites, one oriented to XQuery and XPath, the other to XSLT. These can be found at <a href="https://github.com/qt4cg/qt4tests">qt4tests</a> and <a href="https://github.com/qt4cg/xslt40-test">xslt40-test</a> respectively. New tests, or suggestions for correcting existing tests, are welcome. The test suites include extensive metadata describing the conditions for applicability of each test case as well as the expected results. They do not include any test drivers for executing the tests: each implementation is expected to provide its own test driver.</p><div class="dedication" id="dedication"><h3>Dedication</h3><p>The publications of this community group <a href="../xquery-40/xpath-40.html#dedication">are dedicated</a> to our co-chair, Michael Sperberg-McQueen&nbsp;(1954–2024).</p></div></div><hr><div class="body"><div class="_diffs div1"><h2><a id="add-func"></a>20 <a href="#add-func" style="text-decoration: none">Additional Functions</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-document">next</a> | <a href="#capturing-accumulators">previous</a>)</p><ol><li><p> Functions that accept a lexical QName as an argument, such as <a href="#func-key"><code>key</code></a>, <a href="#func-function-available"><code>function-available</code></a>, <a href="#func-element-available"><code>element-available</code></a>, <a href="#func-type-available"><code>type-available</code></a>, <a href="#func-system-property"><code>system-property</code></a>, <a href="#func-accumulator-before"><code>accumulator-before</code></a>, and <a href="#func-accumulator-after"><code>accumulator-after</code></a>, now have the option of supplying an <code>xs:QName</code> value instead. [This change was in the editor's draft accepted by the WG as its baseline when it started work.] <i>&nbsp;&nbsp;[&nbsp;&nbsp;1 January 2022]</i></p></li></ol></div><p>This section describes XSLT-specific additions to the XPath function library. Some of these additional functions also make use of information specified by <a title="declaration" class="termref" href="#dt-declaration">declarations</a> in the stylesheet; this section also describes these declarations.</p><div class="_diffs div2"><h3><a id="func-document"></a>20.1 <a href="#func-document" style="text-decoration: none">fn:document</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90"> Changes in 4.0 (</span><a href="#func-key"><span class="deltaxml-new" style="background:#90EE90">next</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><a href="#add-func"><span class="deltaxml-new" style="background:#90EE90">previous</span></a><span class="deltaxml-new" style="background:#90EE90">)</span></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">An options parameter has been added.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/2292"><span class="deltaxml-new" style="background:#90EE90">2292</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Provides access to XML documents identified by a URI.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:document</code>(</td></tr><tr class="arg"><td><code>$uri-sequence</code></td><td><code class="as">as&nbsp;</code><code class="type">item()*</code>,</td><td></td></tr><tr class="arg"><td><span style="display: none;" class="delete_version"><code>$base-node</code></span><span style="display: none;" class="add_version"><code>$options</code></span><span class="modify_version"><code>$<span class="deltaxml-old" style="background:#FF5555">base-node</span><span class="deltaxml-new" style="background:#90EE90">options</span></code></span></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type">node()?</code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type">(map(*)|node())?</code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><span class="deltaxml-new" style="background:#90EE90">(map(*)|</span>node()<span class="deltaxml-new" style="background:#90EE90">)</span>?</code></span></td><td><span style="display: none;" class="delete_version"><code class="assign">:=&nbsp;</code><code>()</code></span><span style="display: none;" class="add_version"><code class="assign">:=&nbsp;</code><code>map{}</code></span><span class="modify_version"><code class="assign">:=&nbsp;</code><code><span class="deltaxml-old" style="background:#FF5555">()</span><span class="deltaxml-new" style="background:#90EE90">map{}</span></code></span></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code>node()*</code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>The one-argument form of this function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-dependent">context-dependent</a><sup><small>FO</small></sup>. It depends on static base URI. </p><p>The two-argument form of this function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p>The <a href="#func-document"><code>document</code></a> function allows access to XML documents identified by a URI.</p><p><span class="deltaxml-old" style="background:#FF5555">The first argument contains a sequence of URI references. The second argument, if present, is a node whose base URI is used to resolve any relative URI references contained in the first argument.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The first argument contains a sequence of URI references. These are resolved as described below.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The second argument, if present, may be either a node, or an options map. Supplying a node is allowed for backwards compatibility: the effect of supplying a node </span><code><span class="deltaxml-new" style="background:#90EE90">$N</span></code><span class="deltaxml-new" style="background:#90EE90"> is the same as supplying the map </span><code><span class="deltaxml-new" style="background:#90EE90">{"base-uri": fn:base-uri($N)}</span></code><span class="deltaxml-new" style="background:#90EE90">. The effect is that the base URI of the node is used to resolve any relative URI references contained in the first argument.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the second argument is supplied as a map, then the </span><a href="https://qt4cg.org/specifications/xpath-functions-40/#option-parameter-conventions"><span class="deltaxml-new" style="background:#90EE90">option parameter conventions</span></a><sup><small><span class="deltaxml-new" style="background:#90EE90">FO</span></small></sup><span class="deltaxml-new" style="background:#90EE90"> apply. The options available are as follows, and apply to each of the documents constructed by the function:</span></p><div class="example"><span style="font-color:red" disallowed="fix-this"><span class="deltaxml-new" style="background:#90EE90">&lt;record&gt;</span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$base-uri</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$trusted</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$dtd-validation</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$stable</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$strip-space</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean?</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$xinclude</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$xsd-validation</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$use-xsi-schema-location</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="arg"><span class="deltaxml-new" style="background:#90EE90">$schema</span></code><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><span class="deltaxml-new" style="background:#90EE90">&lt;/record&gt;</span></span></div><table class="fos-options"><thead><tr><th style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Key</span></th><th style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Value</span></th><th style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Meaning</span></th></tr></thead><tbody><tr><td style="text-align:left; vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">base-uri?</span></code></p></td><td class="fos-thin" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines the base URI used to resolve any relative URI supplied in the first argument. This in turn affects the base URI of the constructed document. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><span class="deltaxml-new" style="background:#90EE90">Where the first argument supplies a node, the base URI property of that node is used to resolve the URI. Where the first argument supplies an atomic value, the static base URI of the function call is used.</span></p></li></ul></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">trusted?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Indicates whether processing the document may cause other external resources to be fetched (including, for example, external entities, an external DTD, or documents referenced using </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:schemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> or XInclude elements). </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">The document may include references to other external resources. </span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">The document must not include references to other external resources unless access to these resources has been explicitly enabled. </span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">dtd-validation?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines whether DTD validation takes place. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">The input is parsed using a validating XML parser. The input must contain a </span><code><span class="deltaxml-new" style="background:#90EE90">DOCTYPE</span></code><span class="deltaxml-new" style="background:#90EE90"> declaration to identify the DTD to be used for validation. The DTD may be internal or external. </span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">DTD validation does not take place. However, if a </span><code><span class="deltaxml-new" style="background:#90EE90">DOCTYPE</span></code><span class="deltaxml-new" style="background:#90EE90"> declaration is present, then it is read, for example to perform entity expansion. </span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">stable?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines whether two calls on the </span><a href="#func-document"><code><span class="deltaxml-new" style="background:#90EE90">document</span></code></a><span class="deltaxml-new" style="background:#90EE90"> function, with the same URI, the same options, and the same context, are guaranteed to return the same document node. The default value is </span><code><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, but this may be overridden by implementation-defined configuration options. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Given the same explicit and implicit arguments, multiple calls return the same document node: that is, the function is </span><a title="" class="termref" href="#"></a><span class="deltaxml-new" style="background:#90EE90">. </span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Multiple calls with the same explicit and implicit arguments may return the same document node or different document nodes at the discretion of the implementation. </span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">strip-space?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines whether whitespace-only text nodes are removed from the resulting document. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean?</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Whitespace stripping is to take place according to the </span><a href="#element-strip-space"><code><span class="deltaxml-new" style="background:#90EE90">xsl:strip-space</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="#element-preserve-space"><code><span class="deltaxml-new" style="background:#90EE90">xsl:preserve-space</span></code></a><span class="deltaxml-new" style="background:#90EE90"> declarations of the containing </span><a title="package" class="termref" href="#dt-package"><span class="deltaxml-new" style="background:#90EE90">package</span></a><span class="deltaxml-new" style="background:#90EE90">: see </span><a href="#strip"><i><span class="deltaxml-new" style="background:#90EE90">4.2.2 Stripping Whitespace from a Source Tree</span></i></a><span class="deltaxml-new" style="background:#90EE90">. </span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">All whitespace-only text nodes are preserved, unless either (a) DTD validation marks them as ignorable, or (b) XSD validation recognizes the containing element as having element-only or empty content. </span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">xinclude?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines whether any </span><code><span class="deltaxml-new" style="background:#90EE90">xi:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements in the input are to be processed using an XInclude processor. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Any </span><code><span class="deltaxml-new" style="background:#90EE90">xi:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements are expanded. If there are </span><code><span class="deltaxml-new" style="background:#90EE90">xi:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements and no XInclude processor is available then a dynamic error is raised. </span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Any </span><code><span class="deltaxml-new" style="background:#90EE90">xi:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements are handled as ordinary elements without expansion. </span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="5"><p><code><span class="deltaxml-new" style="background:#90EE90">xsd-validation?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">Determines whether XSD validation takes place, using the schema definitions present in the static context. The effect of requesting validation is the same as invoking the </span><a href="#func-document"><code><span class="deltaxml-new" style="background:#90EE90">document</span></code></a><span class="deltaxml-new" style="background:#90EE90"> function without validation, and then applying the instruction </span><a href="#element-copy-of"><code><span class="deltaxml-new" style="background:#90EE90">xsl:copy-of</span></code></a><span class="deltaxml-new" style="background:#90EE90"> to the result, with corresponding </span><code><span class="deltaxml-new" style="background:#90EE90">validation</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">type</span></code><span class="deltaxml-new" style="background:#90EE90"> options, using the schema identified in the </span><code><span class="deltaxml-new" style="background:#90EE90">schema</span></code><span class="deltaxml-new" style="background:#90EE90"> option if specified. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">skip</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">strict</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Strict XSD validation takes place</span></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">lax</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Lax XSD validation takes place</span></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">skip</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">No XSD validation takes place</span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">type Q{uri}local</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">XSD validation takes place against the schema-defined type, present in the selected schema, that has the given URI and local name.</span></td></tr><tr><td style="text-align:left; vertical-align:top" rowspan="3"><p><code><span class="deltaxml-new" style="background:#90EE90">use-xsi-schema-location?</span></code></p></td><td class="fos-thick" colspan="2"><span class="deltaxml-new" style="background:#90EE90">When XSD validation takes place, determines whether schema components referenced using </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:schemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:noNamespaceSchemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes within the source document are to be used. The option is ignored if XSD validation does not take place. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></p></li></ul></td></tr><tr><td class="fos-thin"><code><span class="deltaxml-new" style="background:#90EE90">true</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">XSD validation uses the schema components referenced using </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:schemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:noNamespaceSchemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes in addition to the schema components present in the static context; these components must be compatible as described in </span><a href="#xpath-datamodel-40"><span class="deltaxml-new" style="background:#90EE90">[XDM 4.0]</span></a><span class="deltaxml-new" style="background:#90EE90"> section </span><a href="../xpath-datamodel-40/#schema-consistency"><span class="deltaxml-new" style="background:#90EE90">4.1.2 Schema Consistency</span></a><span class="deltaxml-new" style="background:#90EE90">.</span></td></tr><tr><td class="fos-thick"><code><span class="deltaxml-new" style="background:#90EE90">false</span></code></td><td style="text-align:left; vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Any </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:schemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">xsi:noNamespaceSchemaLocation</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes in the document are ignored.</span></td></tr><tr><td style="text-align:left; vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">schema?</span></code></p></td><td class="fos-thin" colspan="2"><span class="deltaxml-new" style="background:#90EE90">When XSD validation takes place, identifies the schema to be used for validation. If supplied, the value must match the </span><code><span class="deltaxml-new" style="background:#90EE90">role</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute of an </span><a href="#element-import-schema"><code><span class="deltaxml-new" style="background:#90EE90">xsl:import-schema</span></code></a><span class="deltaxml-new" style="background:#90EE90"> declaration in the containing </span><a title="package" class="termref" href="#dt-package"><span class="deltaxml-new" style="background:#90EE90">package</span></a><span class="deltaxml-new" style="background:#90EE90">. A zero-length string refers to the schema imported using an </span><a href="#element-import-schema"><code><span class="deltaxml-new" style="background:#90EE90">xsl:import-schema</span></code></a><span class="deltaxml-new" style="background:#90EE90"> declaration with no </span><code><span class="deltaxml-new" style="background:#90EE90">role</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute. </span><ul><li><p><b><span class="deltaxml-new" style="background:#90EE90">Type: </span></b><code><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code></p></li><li><p><b><span class="deltaxml-new" style="background:#90EE90">Default: </span></b><span class="deltaxml-new" style="background:#90EE90">The schema in the static context of the </span><a href="#func-document"><code><span class="deltaxml-new" style="background:#90EE90">fn:document</span></code></a><span class="deltaxml-new" style="background:#90EE90"> function call (determined by the innermost element with an </span><code><span class="deltaxml-new" style="background:#90EE90">[xsl:]schema-role</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute if present).</span></p></li></ul></td></tr></tbody></table><p>A sequence of absolute URI references is obtained as follows.</p><ul><li><p><span style="display: none;" class="delete_version">For an item in <code>$uri-sequence</code> that is an instance of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>, the value is cast to <code>xs:anyURI</code>. If the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference, then it is resolved as follows:</span><span style="display: none;" class="add_version">For an item in <code>$uri-sequence</code> that is an instance of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>, the value is cast to <code>xs:anyURI</code>. If the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference <var>R</var>, then it is resolved as follows:</span><span class="modify_version">For an item in <code>$uri-sequence</code> that is an instance of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>, the value is cast to <code>xs:anyURI</code>. If the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference<span class="deltaxml-new" style="background:#90EE90"> </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var>, then it is resolved as follows:</span></p><ol class="enumar"><li><p><span style="display: none;" class="delete_version">If <code>$base-node</code> is supplied <span>(that is, if the argument is present and non-empty)</span>, then it is resolved against the base URI of <code>$base-node</code>.</span><span style="display: none;" class="add_version">If the second argument <code>$options</code> is an XNode, then <var>R</var> is resolved against the base URI of that node.</span><span class="modify_version">If <span class="deltaxml-new" style="background:#90EE90">the second argument </span><code>$<span class="deltaxml-old" style="background:#FF5555">base-node</span><span class="deltaxml-new" style="background:#90EE90">options</span></code> is <span class="deltaxml-old" style="background:#FF5555">supplied</span><span class="deltaxml-new" style="background:#90EE90">an</span> <span class="deltaxml-old" style="background:#FF5555">(that is, if the argument is present and non-empty)</span><span class="deltaxml-new" style="background:#90EE90">XNode, </span><span class="deltaxml-old" style="background:#FF5555">, </span>then <var><span class="deltaxml-old" style="background:#FF5555">it</span><span class="deltaxml-new" style="background:#90EE90">R</span></var> is resolved against the base URI of <span class="deltaxml-old" style="background:#FF5555">$base-</span><span class="deltaxml-new" style="background:#90EE90">that </span>node.</span></p></li><li class="add_version" style="display: none;"><p>If <code>$options</code> is supplied as a map and includes a value for the <code>base-uri</code> option, then <var>R</var> is resolved against that URI.</p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$options</span></code><span class="deltaxml-new" style="background:#90EE90"> is supplied as a map and includes a value for the </span><code><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option, then </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var><span class="deltaxml-new" style="background:#90EE90"> is resolved against that URI.</span></p></li><li><p><span style="display: none;" class="delete_version">Otherwise it is resolved against the static base URI from the static context of the expression containing the call to the <a href="#func-document"><code>document</code></a> function. In cases where the source code of the stylesheet is available at execution time, this will typically be the location of the relevant stylesheet module.</span><span style="display: none;" class="add_version">Otherwise <var>R</var> is resolved against the static base URI from the static context of the expression containing the call to the <a href="#func-document"><code>document</code></a> function. In cases where the source code of the stylesheet is available at execution time, this will typically be the location of the relevant stylesheet module.</span><span class="modify_version">Otherwise <var><span class="deltaxml-old" style="background:#FF5555">it</span><span class="deltaxml-new" style="background:#90EE90">R</span></var> is resolved against the static base URI from the static context of the expression containing the call to the <a href="#func-document"><code>document</code></a> function. In cases where the source code of the stylesheet is available at execution time, this will typically be the location of the relevant stylesheet module.</span></p></li></ol></li><li><p><span style="display: none;" class="delete_version">For an item in <code>$uri-sequence</code> that is a node, the node is <a title="atomize" class="termref" href="#dt-atomization">atomized</a>. The result <span class="verb">must</span> be a sequence whose items are all instances of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>. Each of these values is cast to <code>xs:anyURI</code>, and if the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference, then it is resolved against the base URI of <code>$base-node</code> if supplied, or against the base URI of the node that contained it otherwise.</span><span style="display: none;" class="add_version">For an item in <code>$uri-sequence</code> that is a node <var>N</var>, the node is <a title="atomize" class="termref" href="#dt-atomization">atomized</a>. The result <span class="verb">must</span> be a sequence whose items are all instances of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>. Each of these values is cast to <code>xs:anyURI</code>, and if the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference <var>R</var>, then it is resolved as follows:</span><span class="modify_version">For an item in <code>$uri-sequence</code> that is a node<span class="deltaxml-new" style="background:#90EE90"> </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var>, the node is <a title="atomize" class="termref" href="#dt-atomization">atomized</a>. The result <span class="verb">must</span> be a sequence whose items are all instances of <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code>. Each of these values is cast to <code>xs:anyURI</code>, and if the resulting URI reference is an absolute URI reference then it is used <em>as is</em>. If it is a relative URI reference<span class="deltaxml-new" style="background:#90EE90"> </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var>, then it is resolved <span class="deltaxml-old" style="background:#FF5555">against the base URI of </span><span class="deltaxml-new" style="background:#90EE90">as follows</span><span class="deltaxml-old" style="background:#FF5555">$base-node</span><span class="deltaxml-new" style="background:#90EE90">:</span><span class="deltaxml-old" style="background:#FF5555"> if supplied, or against the base URI of the node that contained it otherwise.</span></span></p><ol class="enumar"><li><p><span class="deltaxml-new" style="background:#90EE90">If the second argument </span><code><span class="deltaxml-new" style="background:#90EE90">$options</span></code><span class="deltaxml-new" style="background:#90EE90"> is an XNode, then </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var><span class="deltaxml-new" style="background:#90EE90"> is resolved against the base URI of that node.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$options</span></code><span class="deltaxml-new" style="background:#90EE90"> is supplied as a map and includes a value for the </span><code><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option, then </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var><span class="deltaxml-new" style="background:#90EE90"> is resolved against that URI.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Otherwise </span><var><span class="deltaxml-new" style="background:#90EE90">R</span></var><span class="deltaxml-new" style="background:#90EE90"> is resolved against the base URI of </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">.</span></p></li></ol></li><li><p>A relative URI is resolved against a base URI using the rules of the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-resolve-uri"><code>resolve-uri</code></a> function. A dynamic error occurs (see below) if no base URI is available.</p></li><li><p> If <code>$uri-sequence</code> (after atomizing any nodes) contains an item other than an atomic item of type <code>xs:string</code>, <code>xs:anyURI</code>, or <code>xs:untypedAtomic</code> then a type error is raised <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#ERRXPTY0004" title="XPTY0004"><span class="error">[ERR XPTY0004] </span></a><sup><small>XP40</small></sup>. </p></li></ul><p>Each of these absolute URI references is then processed as follows. Any fragment identifier that is present in the URI reference is removed, and the resulting absolute URI is cast to a string and then passed to the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-doc"><code>doc</code></a> function defined in <a href="#xpath-functions-40">[Functions and Operators 4.0]</a>. This returns a document node. If an error occurs during evaluation of the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-doc"><code>doc</code></a> function, the processor <span class="verb">may</span> either raise this error in the normal way, or <span class="verb">may</span> recover by ignoring the failure, in which case the failing URI will not contribute any nodes to the result of the <a href="#func-document"><code>document</code></a> function.</p><p>If the URI reference contained no fragment identifier, then this document node is included in the sequence of nodes returned by the <a href="#func-document"><code>document</code></a> function.</p><p>If the URI reference contained a fragment identifier, then the fragment identifier is interpreted according to the rules for the media type of the resource representation identified by the URI, and is used to select zero or more nodes that are descendant-or-self nodes of the returned document node. As described in <a href="#initiating"><i>2.3 Initiating a Transformation</i></a>, the media type is available as part of the evaluation context for a transformation.</p><p>The sequence of nodes returned by the function is in document order, with no duplicates. This order has no necessary relationship to the order in which URIs were supplied in the <code>$uri-sequence</code> argument.</p></dd><dt class="label">Error Conditions</dt><dd><p><a id="err-XTDE1160"><span class="error">[ERR XTDE1160] </span></a>When a URI reference contains a fragment identifier, it is a <a title="dynamic error" class="termref" href="#dt-dynamic-error">dynamic error</a> if the media type is not one that is recognized by the processor, or if the fragment identifier does not conform to the rules for fragment identifiers for that media type, or if the fragment identifier selects something other than a sequence of nodes (for example, if it selects a range of characters within a text node). </p><p>A processor <span class="verb">may</span> provide an option which, if selected, causes the processor instead of raising this error, to ignore the fragment identifier and return the document node.</p><p>The set of media types recognized by a processor is <a title="implementation-defined" class="termref" href="#dt-implementation-defined">implementation-defined</a>.</p><p><a id="err-XTDE1162"><span class="error">[ERR XTDE1162] </span></a>When a URI reference is a relative reference, it is a <a title="dynamic error" class="termref" href="#dt-dynamic-error">dynamic error</a> if no base URI is available to resolve the relative reference. This can arise for example when the URI is contained in a node that has no base URI (for example a parentless text node), or when the second argument to the function is a node that has no base URI, or when the base URI from the static context is undefined. </p></dd><dt class="label">Notes</dt><dd><div class="note"><p>One effect of these rules is that in an interpreted environment where the source code of the stylesheet is available and its base URI is known, then unless XML entities or <code>xml:base</code> are used, the expression <code>document("")</code> refers to the document node of the containing stylesheet module (the definitive rules are in <a href="#RFC3986">[RFC3986]</a>). The XML resource containing the stylesheet module is then processed exactly as if it were any other XML document, for example there is no special recognition of <a href="#element-text"><code>xsl:text</code></a> elements, and no special treatment of comments and processing instructions.</p><p>The XPath rules for function calling ensure that it is a type error if the supplied value of the second argument is anything other than a single node. If <a title="XPath 1.0 compatibility mode" class="termref" href="#dt-xpath-compat-mode">XPath 1.0 compatibility mode</a> is enabled, then a sequence of nodes may be supplied, and the first node in the sequence will be used.</p></div></dd></dl></div></div></div><div class="back"><div class="_diffs div1"><h2><a id="changes-since-3.0"></a>I <a href="#changes-since-3.0" style="text-decoration: none">Changes since XSLT 3.0</a> (Non-Normative)</h2><div class="_diffs div2"><h3><a id="xslt-changes-since-3.0"></a>I.1 <a href="#xslt-changes-since-3.0" style="text-decoration: none">Changes in this specification</a></h3><ol><li><p>If a section of this specification has been updated since version 3.0, an overview of the changes is provided, along with links to navigate to the next or previous change.</p><p>See <a href="#whats-new-in-xslt4"><b>1.2 What’s New in XSLT 4.0?</b></a></p></li><li><p>Sections with significant changes are marked with a ✭ symbol in the table of contents.</p><p>See <a href="#whats-new-in-xslt4"><b>1.2 What’s New in XSLT 4.0?</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/751 1386">751 1386&nbsp;</a></p><p> The result type of a mode can be declared using an <code>as</code> attribute. The result type of all template rules in this mode must be consistent with this, as must the values returned by any built-in template rules for the mode. </p><p>See <a href="#mode-result-type"><b>6.7.5 Declaring the Result Type of a Mode</b></a></p></li><li><p> The <a href="#element-for-each"><code>xsl:for-each</code></a> and <a href="#element-apply-templates"><code>xsl:apply-templates</code></a> instructions acquire an attribute <code>separator</code> that can be used to insert content between adjacent items. [This change was in the editor's draft adopted as a baseline when the WG commenced work.] </p><p>See <a href="#for-each"><b>7.1 The xsl:for-each instruction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2015 2296">2015 2296&nbsp;</a></p><p> A variable-binding with no <code>as</code> or <code>select</code> attribute no longer attempts to create an implicit document node if the sequence constructor contains certain instructions (such as <a href="#element-map"><code>xsl:map</code></a>, <a href="#element-array"><code>xsl:array</code></a>, <a href="#element-record"><code>xsl:record</code></a>, and <a href="#element-select"><code>xsl:select</code></a>). </p><p>See <a href="#variable-values"><b>9.3 Values of Variables and Parameters</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2200 2236">2200 2236&nbsp;</a></p><p> Stylesheet functions may now be in no namespace, and may be invoked without use of a namespace prefix, provided they are private to a package. </p><p>See <a href="#xsl-function-name"><b>10.3.1 Function Name and Arity</b></a></p></li><li><p> Functions that accept a lexical QName as an argument, such as <a href="#func-key"><code>key</code></a>, <a href="#func-function-available"><code>function-available</code></a>, <a href="#func-element-available"><code>element-available</code></a>, <a href="#func-type-available"><code>type-available</code></a>, <a href="#func-system-property"><code>system-property</code></a>, <a href="#func-accumulator-before"><code>accumulator-before</code></a>, and <a href="#func-accumulator-after"><code>accumulator-after</code></a>, now have the option of supplying an <code>xs:QName</code> value instead. [This change was in the editor's draft accepted by the WG as its baseline when it started work.] </p><p>See <a href="#add-func"><b>20 Additional Functions</b></a></p></li><li><p> Functions that accept a lexical QName as an argument, such as <a href="#func-key"><code>key</code></a>, <a href="#func-function-available"><code>function-available</code></a>, <a href="#func-element-available"><code>element-available</code></a>, <a href="#func-type-available"><code>type-available</code></a>, <a href="#func-system-property"><code>system-property</code></a>, <a href="#func-accumulator-before"><code>accumulator-before</code></a>, and <a href="#func-accumulator-after"><code>accumulator-after</code></a>, now have the option of supplying an <code>xs:QName</code> value instead. [This change was in the editor's draft accepted by the WG as its baseline when it started work.] </p><p>See <a href="#extension"><b>24 Extensibility and Fallback</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-character-map"><b>26.4.1 fn:character-map</b></a></p></li><li><p> The <a href="#element-for-each"><code>xsl:for-each</code></a> and <a href="#element-apply-templates"><code>xsl:apply-templates</code></a> instructions acquire an attribute <code>separator</code> that can be used to insert content between adjacent items. [This change was in the editor's draft adopted as a baseline when the WG commenced work.] </p><p>See <a href="#applying-templates"><b>6.4 Applying Template Rules</b></a></p></li><li><p> It is possible to invoke a named template using an extension instruction, specifically, an element whose name matches the name of the named template. </p><p>See <a href="#invoking-templates-with-extension-instructions"><b>10.1.3 Invoking Named Templates using Extension Instructions</b></a></p><p>See <a href="#extension-instruction"><b>24.3 Extension Instructions</b></a></p></li><li><p> A new attribute <code>xsl:map/@duplicates</code> is available, allowing control over how duplicate keys are handled by the <a href="#element-map"><code>xsl:map</code></a> instruction. </p><p>See <a href="#duplicate-keys"><b>21.1.2 Handling of duplicate keys</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1497 1546">1497 1546&nbsp;</a></p><p> A new serialization parameter <code>json-lines</code> is available to enable output as one JSON value per line. </p><p>See <a href="#creating-result-trees"><b>25.1 Creating Secondary Results</b></a></p><p>See <a href="#id-xsl-output-declaration"><b>26.1 The xsl:output declaration</b></a></p></li><li class="add_version" style="display: none;"><p>An options parameter has been added.</p><p>See <a href="#func-document"><b>20.1 fn:document</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">An options parameter has been added.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-document"><b><span class="deltaxml-new" style="background:#90EE90">20.1 fn:document</span></b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/159">159&nbsp;</a></p><p>Parameters on functions declared using <a href="#element-function"><code>xsl:function</code></a> can now be defined as optional, with a default value supplied.</p><p>See <a href="#default-values-of-parameters"><b>9.2.2 Default Values of Parameters</b></a></p><p>See <a href="#stylesheet-functions"><b>10.3 Stylesheet Functions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/237">237&nbsp;</a></p><p> The <a href="#element-if"><code>xsl:if</code></a> instruction now allows <code>then</code> and <code>else</code> attributes. </p><p>See <a href="#xsl-if"><b>8.1 Conditional Processing with xsl:if</b></a></p><p> In <a href="#element-choose"><code>xsl:choose</code></a>, the <a href="#element-when"><code>xsl:when</code></a> and <code>xsl:otherwise</code> elements can take a <code>select</code> attribute in place of a sequence constructor. </p><p>See <a href="#xsl-choose"><b>8.2 Conditional Processing with xsl:choose</b></a></p><p> A new <a href="#element-switch"><code>xsl:switch</code></a> instruction is introduced. </p><p>See <a href="#xsl-switch"><b>8.3 Conditional Processing with xsl:switch</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/326">326&nbsp;</a></p><p> The higher-order-function feature no longer exists; higher-order functions are now a core part of XSLT, no longer an optional extra. </p><p>See <a href="#conformance"><b>27 Conformance</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/353">353&nbsp;</a></p><p> A new attribute, <code>main-module</code>, is added to the <a href="#element-stylesheet"><code>xsl:stylesheet</code></a> element. The attribute is provided for the benefit of development tools such as syntax-directed editors to provide information about all the components (variables, functions, etc) visible within a stylesheet module. </p><p>See <a href="#stylesheet-element"><b>3.6 Stylesheet Element</b></a></p><p> A new element <a href="#element-note"><code>xsl:note</code></a> is available for documentation and similar purposes: it can appear anywhere in the stylesheet and is ignored by the XSLT processor. </p><p>See <a href="#xsl-note-elements"><b>3.12.2 The xsl:note element</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/401">401&nbsp;</a></p><p> Patterns (especially those used in template rules) can now be defined by reference to item types, so any item type can be used as a match pattern. For example <code>match="~record(longitude, latitude, *)"</code> matches any map that includes the key values <code>"longitude"</code> and <code>"latitude"</code>. </p><p>See <a href="#type-patterns"><b>6.3.2.2 Type Patterns</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/406">406&nbsp;</a></p><p> The new instruction <a href="#element-array"><code>xsl:array</code></a> is introduced to allow construction of arrays. </p><p>See <a href="#array-construction"><b>22.1 Array Construction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/470">470&nbsp;</a></p><p> The <a href="#element-stylesheet"><code>xsl:stylesheet</code></a>, <a href="#element-transform"><code>xsl:transform</code></a>, or <a href="#element-package"><code>xsl:package</code></a> element may have a <code>fixed-namespaces</code> attribute making it easier to have the same namespace declarations in force throughout a stylesheet. </p><p>See <a href="#fixed-namespaces"><b>3.6.1 The fixed-namespaces Attribute</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/489">489&nbsp;</a></p><p> The <a href="#element-matching-substring"><code>xsl:matching-substring</code></a> and <a href="#element-non-matching-substring"><code>xsl:non-matching-substring</code></a> elements within <a href="#element-analyze-string"><code>xsl:analyze-string</code></a> may now take a <code>select</code> attribute in place of a contained sequence constructor. </p><p>See <a href="#analyze-string"><b>17.1 The xsl:analyze-string Instruction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/534">534&nbsp;</a></p><p> A new serialization parameter <code>escape-solidus</code> is provided to control whether the character <code>/</code> is escaped as <code>\/</code> by the JSON serialization method. </p><p>See <a href="#creating-result-trees"><b>25.1 Creating Secondary Results</b></a></p><p>See <a href="#id-xsl-output-declaration"><b>26.1 The xsl:output declaration</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/542">542&nbsp;</a></p><p> A mode (called an enclosing mode) can be defined in which all the relevant template rules are children of the <code>xsl:mode</code> element. This is intended to allow a stylesheet design in which it is easier to determine which rules might apply to a given <a href="#element-apply-templates"><code>xsl:apply-templates</code></a> call. </p><p>See <a href="#enclosing-modes"><b>6.7.6 Enclosing Modes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/599">599&nbsp;</a></p><p> Simplified stylesheets no longer require an <code>xsl:version</code> attribute (which means they might not need a declaration of the XSLT namespace). Unless otherwise specified, a 4.0 simplified stylesheet defaults <code>expand-text</code> to <code>true</code>. </p><p>See <a href="#simplified-stylesheet"><b>3.7 Simplified Stylesheet Modules</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/635">635&nbsp;</a></p><p> The rules concerning the compatibility of schemas imported by different packages have been clarified. It is now explicitly stated that instructions that trigger validation must use the imported schema of the package in which validation is invoked. This differs from the current practice of some XSLT 3.0 processors, which may use (for example) a schema formed from the union of the imported schemas in all packages. </p><p>See <a href="#import-schema"><b>3.14 Importing Schema Components</b></a></p><p>See <a href="#validation"><b>25.4 Validation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/717">717&nbsp;</a></p><p> Capturing accumulators have been added; when streaming with a capturing accumulator, the <a href="#func-accumulator-after"><code>accumulator-after</code></a> has full access to a snapshot of the matched element node. </p><p>See <a href="#capturing-accumulators"><b>19.9 Capturing Accumulators</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/718">718&nbsp;</a></p><p> To allow recursive-descent transformation on a tree of maps and arrays, a new set of built-in templates rules <code>shallow-copy-all</code> is introduced. </p><p>See <a href="#built-in-rule"><b>6.8 Built-in Template Rules</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/740">740&nbsp;</a></p><p> A new attribute <code>xsl:for-each-group/@split-when</code> is available to give applications more complete control over how a sequence is partitioned </p><p>See <a href="#grouping"><b>14 Grouping</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/751">751&nbsp;</a></p><p> The <a href="#element-mode"><code>xsl:mode</code></a> declaration acquires an attribute <code>as="sequence-type"</code> which declares the return type of all template rules in that mode. </p><p>See <a href="#declaring-modes"><b>6.7.1 Declaring Modes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1181">1181&nbsp;</a></p><p> The <code>[xsl:]xpath-default-namespace</code> attribute can be set to the value <code>##any</code>, which causes unprefixed element names to match in any namespace or none. </p><p>See <a href="#unprefixed-qnames"><b>5.1.2 Unprefixed Lexical QNames in Expressions and Patterns</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1250">1250&nbsp;</a></p><p> The strings used in the formatted number to represent a decimal separator, grouping separator, exponent separator, percent sign, per mille sign, or minus sign, are no longer constrained to be single characters. </p><p>See <a href="#defining-decimal-format"><b>5.5 Defining a Decimal Format</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1254">1254&nbsp;</a></p><p> The rules concerning the interpretation of <code>xsi:schemaLocation</code> and <code>xsi:noNamespaceSchemaLocation</code> attributes have been tightened up. </p><p>See <a href="#validation"><b>25.4 Validation</b></a></p><p>See <a href="#validation"><b>25.4 Validation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1306">1306&nbsp;</a></p><p> An <code>as</code> attribute is available on the <a href="#element-sequence"><code>xsl:sequence</code></a> instruction. </p><p>See <a href="#constructing-sequences"><b>10.4.1 The xsl:sequence Instruction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1361">1361&nbsp;</a></p><p> The term <b>atomic value</b> has been replaced by <b>atomic item</b>. </p><p>See <a href="#terminology"><b>2.1 Terminology</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1378">1378&nbsp;</a></p><p> A function call at the outermost level can now be named using any valid <code>EQName</code> (for example <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-doc"><code>fn:doc</code></a>) provided it binds to one of the permitted functions <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-doc"><code>fn:doc</code></a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-id"><code>fn:id</code></a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-element-with-id"><code>fn:element-with-id</code></a>, <a href="#func-key"><code>fn:key</code></a>, or <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-root"><code>fn:root</code></a>. If two functions are called, for example <code>doc('a.xml')/id('abc')</code>, it is no longer necessary to put the second call in parentheses. </p><p>See <a href="#node-patterns"><b>6.3.2.3 GNode Patterns</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1442">1442&nbsp;</a></p><p> Default priorities are added for new forms of <code>ElementTest</code> and <code>AttributeTest</code>, for example <code>element(p:*)</code> and <code>element(a|b)</code>. </p><p>See <a href="#default-priority"><b>6.3.3 Default Priority for Patterns</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1454">1454&nbsp;</a></p><p> Duplicate <a href="#element-include"><code>xsl:include</code></a> declarations within a stylesheet level are now ignored, preventing spurious errors caused by the presence of duplicate named components. </p><p>See <a href="#include"><b>3.10.2 Stylesheet Inclusion</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1505">1505&nbsp;</a></p><p> New variables <code>err:stack-trace</code>, <code>err:additional</code>, and <code>err:map</code> are available within an <a href="#element-catch"><code>xsl:catch</code></a> clause. </p><p>See <a href="#try-catch"><b>8.4 Try/Catch</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1530">1530&nbsp;</a></p><p> The contents of a character map declared using <a href="#element-character-map"><code>xsl:character-map</code></a> are now available dynamically via a new <a href="#func-character-map"><code>character-map</code></a> function. </p><p>See <a href="#character-map-function"><b>26.4 The character-map function</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1544">1544&nbsp;</a></p><p> It is no longer an intrinsic error for a global variable to refer to itself; this is now permitted, for example in cases where the value of the global variable is a recursive inline function. Cases where self-reference would not make sense are covered by the existing rules on circularities: see <a href="#circularity"><i>9.11 Circular Definitions</i></a>. </p><p>See <a href="#global-variables"><b>9.5 Global Variables and Parameters</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1549">1549&nbsp;</a></p><p> The input to the serializer can be defined using the <code>select</code> attribute of <a href="#element-result-document"><code>xsl:result-document</code></a> as an alternative to using a sequence constructor. </p><p>See <a href="#creating-result-trees"><b>25.1 Creating Secondary Results</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1560">1560&nbsp;</a></p><p> The default value for the <code>indent</code> parameter is now defined to be <code>no</code> for all output methods other than <code>html</code> and <code>xhtml</code>. </p><p>See <a href="#id-default-serialization-parameters"><b>26.2 Serialization parameters</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1617">1617&nbsp;</a></p><p> Named item types can be declared using the new <a href="#element-item-type"><code>xsl:item-type</code></a> element. This is designed to avoid repeating lengthy type definitions (for example function types) every time they are used. </p><p>See <a href="#named-item-types"><b>5.4.1 Named Item Types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1622">1622&nbsp;</a></p><p>The rules for equality comparison have changed to bring keys into line with maps.</p><p>See <a href="#func-key"><b>20.2.2 fn:key</b></a></p><p>New in 4.0.</p><p>See <a href="#func-map-for-key"><b>20.2.3 fn:map-for-key</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1674">1674&nbsp;</a></p><p> Composite sort keys are allowed in <a href="#element-sort"><code>xsl:sort</code></a>. </p><p>See <a href="#comparing-sort-keys"><b>13.1.2 Comparing Sort Key Values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1689">1689&nbsp;</a></p><p> Composite merge keys are now allowed. </p><p>See <a href="#merging"><b>15 Merging</b></a></p><p>New in 4.0</p><p>See <a href="#func-current-merge-key-array"><b>15.5.2 fn:current-merge-key-array</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1694">1694&nbsp;</a></p><p> The <a href="#element-map"><code>xsl:map</code></a> instruction allows a <code>select</code> attribute as an alternative to the contained sequence constructor. </p><p>See <a href="#map-instructions"><b>21.1 Map Instructions</b></a></p><p> The <a href="#element-map-entry"><code>xsl:map-entry</code></a> instruction, in common with other instructions, now raises error XTSE3185 (rather than XTSE3280) if both a <code>select</code> attribute and a sequence constructor are present. </p><p>See <a href="#map-instructions"><b>21.1 Map Instructions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1703">1703&nbsp;</a></p><p> Ordered maps are introduced. </p><p>See <a href="#map-instructions"><b>21.1 Map Instructions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1708">1708&nbsp;</a></p><p> Named record types are introduced. </p><p>See <a href="#named-record-types"><b>5.4.2 Named Record Types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1772">1772&nbsp;</a></p><p> The default priority for a template rule using a union pattern has changed. This change may cause incompatible behavior. </p><p>See <a href="#default-priority"><b>6.3.3 Default Priority for Patterns</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1819">1819&nbsp;</a></p><p> Different parts of a stylesheet may now use different imported schemas. </p><p>See <a href="#stylesheets-and-schemas"><b>2.10 Stylesheets and XML Schemas</b></a></p><p> The standard attribute <code>[xsl:]schema-role</code> is introduced, to allow different parts of a stylesheet to use different schemas. </p><p>See <a href="#standard-attributes"><b>3.3 Standard Attributes</b></a></p><p> Different parts of a stylesheet may now use different imported schemas. </p><p>See <a href="#import-schema"><b>3.14 Importing Schema Components</b></a></p><p> A stylesheet can import multiple schemas with different schema role names. </p><p>See <a href="#multiple-schemas"><b>3.14.1 Multiple Schemas</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1856">1856&nbsp;</a></p><p> The rules for <a href="#element-analyze-string"><code>xsl:analyze-string</code></a> have been adjusted to allow for new capabilities in regular expressions, such as zero-width assertions. </p><p>See <a href="#analyze-string"><b>17.1 The xsl:analyze-string Instruction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1858">1858&nbsp;</a></p><p> The <a href="#element-record"><code>xsl:record</code></a> instruction is introduced to make construction of record maps simpler. </p><p>See <a href="#record-instructions"><b>21.1.1 Record Instruction</b></a></p><p> Attribute <code>xsl:record/@xsl:duplicates</code> is added to control duplicate keys handling in the <a href="#element-record"><code>xsl:record</code></a> instruction. </p><p>See <a href="#duplicate-keys"><b>21.1.2 Handling of duplicate keys</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1875">1875&nbsp;</a></p><p> The <a href="#element-apply-imports"><code>xsl:apply-imports</code></a> and <a href="#element-next-match"><code>xsl:next-match</code></a> instructions automatically pass supplied parameters to the overridden template rule. </p><p>See <a href="#apply-imports"><b>6.9 Overriding Template Rules</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1888">1888&nbsp;</a></p><p>A new XSLT element, <code>xsl:package-location</code> is provide to indicate to the processor where the required package is to be found.</p><p>See <a href="#package-locations"><b>3.4.3 Locating Packages</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1929">1929&nbsp;</a></p><p> The <a href="#element-mode"><code>xsl:mode</code></a> declaration acquires an attribute <code>copy-namespaces</code> which determines whether or not the built-in template rule copies unused namespace bindings. </p><p>See <a href="#declaring-modes"><b>6.7.1 Declaring Modes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2006">2006&nbsp;</a></p><p>A new function <code>fn:apply-templates</code> is introduced.</p><p>See <a href="#apply-templates-function"><b>6.7.3 The apply-templates Function</b></a></p><p>New in 4.0</p><p>See <a href="#func-apply-templates"><b>6.7.3.1 fn:apply-templates</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2008">2008&nbsp;</a></p><p> The <a href="#element-select"><code>xsl:select</code></a> instruction is new in 4.0. </p><p>See <a href="#select-instruction"><b>10.4.2 The xsl:select Instruction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2030">2030&nbsp;</a></p><p> In order to reduce duplication between the XSLT and XQuery specifications, description of the validation process has been moved to the <em>Functions and Operators</em> specification. </p><p>See <a href="#validation"><b>25.4 Validation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2123">2123&nbsp;</a></p><p> A new attribute <code>xsl:for-each-group/@merge-when</code> is available to give applications control to create groups based on clustering, overlap, and networks. </p><p>See <a href="#grouping"><b>14 Grouping</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2200">2200&nbsp;</a></p><p>User-defined functions can now have names that are in no namespace. An unprefixed name appearing in a function call is resolved to a no-namespace function with matching local name in preference to a function in the standard <code>fn</code> namespace.</p><p>See <a href="#stylesheet-functions"><b>10.3 Stylesheet Functions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2213">2213&nbsp;</a></p><p> A new attribute <code>trusted=yes|no</code> is added to <a href="#element-evaluate"><code>xsl:evaluate</code></a> to indicate whether the XPath expression to be evaluated is trusted to access external resources. The default value is <code>no</code>, which may cause backwards incompatibility. Dynamic evaluation using <a href="#element-evaluate"><code>xsl:evaluate</code></a> is no longer an optional feature of the XSLT language. </p><p>See <a href="#dynamic-xpath"><b>10.5 Dynamic XPath Evaluation</b></a></p><p> The dynamic evaluation feature no longer exists; processor are now required to support the <a href="#element-evaluate"><code>xsl:evaluate</code></a> instruction. </p><p>See <a href="#conformance"><b>27 Conformance</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2218">2218&nbsp;</a></p><p> Numeric values of type <code>xs:decimal</code> are compared as decimals, without first converting to <code>xs:double</code>. </p><p>See <a href="#comparing-sort-keys"><b>13.1.2 Comparing Sort Key Values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2251">2251&nbsp;</a></p><p> The <a href="#element-text"><code>xsl:text</code></a> instruction can now have a <code>select</code> attribute, and it can take a sequence constructor as its content. The only remaining distinction between the <a href="#element-text"><code>xsl:text</code></a> and <a href="#element-value-of"><code>xsl:value-of</code></a> instructions is that whitespace text node children of <a href="#element-text"><code>xsl:text</code></a> are treated as significant, rather than being stripped during stylesheet preprocessing. </p><p>See <a href="#creating-text-nodes"><b>11.4 Creating Text Nodes</b></a></p><p>The rules for <a href="#element-text"><code>xsl:text</code></a> and <a href="#element-value-of"><code>xsl:value-of</code></a> are integrated, allowing <a href="#element-text"><code>xsl:text</code></a> to be used to construct all text nodes, whether the content is fixed or variable.</p><p>See <a href="#xsl-text"><b>11.4.2 The xsl:text and xsl:value-of instructions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2259">2259&nbsp;</a></p><p> A new serialization parameter <code>canonical</code> is available to give control over serialization of XML, XHTML, and JSON. </p><p>See <a href="#creating-result-trees"><b>25.1 Creating Secondary Results</b></a></p><p>See <a href="#id-xsl-output-declaration"><b>26.1 The xsl:output declaration</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2274">2274&nbsp;</a></p><p></p><p>XSLT-specific components of the dynamic context can now be retained in the captured context of a function item, in the same way as XPath-defined components of the dynamic context.</p><p></p><p>See <a href="#additional-dynamic-context"><b>5.3.4 Additional Dynamic Context Components used by XSLT</b></a></p><p>In XSLT 4.0, the function item <code>current-group#0</code> retains the value of the current group within its captured context.</p><p>See <a href="#func-current-group"><b>14.2.1 fn:current-group</b></a></p><p>In XSLT 4.0, the function item <code>current-grouping-key#0</code> retains the value of the current grouping key within its captured context.</p><p>See <a href="#func-current-grouping-key"><b>14.2.2 fn:current-grouping-key</b></a></p><p>In XSLT 4.0, the function item <code>current-merge-group</code> retains the value of the current merge-key within its captured context.</p><p>See <a href="#func-current-merge-group"><b>15.5.1 fn:current-merge-group</b></a></p><p>In XSLT 4.0, the function item <code>current-merge-key#0</code> retains the value of the current group within its captured context.</p><p>See <a href="#func-current-merge-key"><b>15.5.3 fn:current-merge-key</b></a></p><p>In XSLT 4.0, the function item <code>regex-group#1</code> retains the value of the current captured substrings within its captured context.</p><p>See <a href="#func-regex-group"><b>17.2.2 fn:regex-group</b></a></p><p>In XSLT 4.0, the function item <code>current#0</code> retains the value of the current item within its captured context.</p><p>See <a href="#func-current"><b>20.5.1 fn:current</b></a></p><p>In XSLT 4.0, the function item <code>current-output-uri#0</code> retains the value of the current output URI within its captured context.</p><p>See <a href="#func-current-output-uri"><b>25.3.1 fn:current-output-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2283">2283&nbsp;</a></p><p>The conformance requirements for extension attributes have been relaxed: the requirement to maintain strict conformance to the specification in the presence of extension attributes is now a <span class="verb">should</span> rather than a <span class="verb">must</span>, and extension attributes are allowed to modify the form of serialized output without limitation.</p><p>See <a href="#extension-attributes"><b>24.1 Extension Attributes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2301">2301&nbsp;</a></p><p>The attribute <code>cdata</code> is added to <a href="#element-text"><code>xsl:text</code></a> and <a href="#element-value-of"><code>xsl:value-of</code></a> to request serialization of a text node as a CDATA section.</p><p>See <a href="#xsl-text"><b>11.4.2 The xsl:text and xsl:value-of instructions</b></a></p><p>See <a href="#generating-cdata"><b>11.4.3 Generating CDATA Sections</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2323">2323&nbsp;</a></p><p> The outermost element of a simplified stylesheet need no longer be a literal result element, it can now be any instruction (including <a href="#element-result-document"><code>xsl:result-document</code></a>). This allows a simplified stylesheet to produce JSON output as well as XML or HTML. </p><p>See <a href="#simplified-stylesheet"><b>3.7 Simplified Stylesheet Modules</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2736">2736&nbsp;</a></p><p></p><p>The <code>xsl:mode/@typed</code> attribute has been clarified and expanded to provide better control over the handling of items other than XNodes.</p><p></p><p>See <a href="#xsl-mode-typed"><b>6.7.4 Declaring the Type of Values Processed by a Mode</b></a></p></li></ol></div></div></div><p role="navigation" id="back-to-top"><a href="#title"><abbr title="Back to top">↑</abbr></a></p><script src="js/toc.js"></script><script src="/js/scroll.js"></script></body></html>
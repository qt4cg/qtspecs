<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml" lang="EN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XPath and XQuery Functions and Operators 4.0 </title><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" type="text/css" href="css/w3c-base.css"><link rel="stylesheet" href="css/qtspecs.css"><link rel="stylesheet" href="css/xpath-functions-40.css"><script src="js/fo-datalist.js"></script><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css"></head><body class="toc-inline"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p><p>This draft contains only sections that have differences from the version that it modified.</p></div><div class="head"><p><a href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" height="48" width="72"></a></p><h1><a id="title"></a>XPath and XQuery Functions and Operators 4.0 </h1><h2><a id="w3c-doctype"></a>W3C Editor's Draft 2&nbsp;February&nbsp;2026</h2><dl><dt>This version:</dt><dd><a href="https://qt4cg.org/specifications/xpath-functions-40/">https://qt4cg.org/specifications/xpath-functions-40/</a></dd><dt>Latest version of XPath and XQuery Functions and Operators 4.0:</dt><dd><a href="https://qt4cg.org/specifications/xpath-functions-40/">https://qt4cg.org/specifications/xpath-functions-40/</a></dd><dt>Most recent Recommendation of XPath and XQuery Functions and Operators:</dt><dd><a href="https://www.w3.org/TR/2017/REC-xpath-functions-31-20170321/">https://www.w3.org/TR/2017/REC-xpath-functions-31-20170321/</a></dd><dt>Editor:</dt><dd>Michael Kay, Saxonica <a href="http://www.saxonica.com/">&lt;http://www.saxonica.com/&gt;</a></dd></dl><p>This document is also available in these non-normative formats: <a href="xpath-functions-40.xml">Specification in XML format</a> and&nbsp;<a href="function-catalog.xml">XML function catalog</a>.</p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2000&nbsp;<a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr></div><div><h2><a id="abstract"></a>Abstract</h2><p>This document defines constructor functions, operators, and functions on the datatypes defined in <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a> and the datatypes defined in <a href="#xpath-datamodel-40">[XQuery and XPath Data Model (XDM) 4.0]</a>. It also defines functions and operators on nodes and node sequences as defined in the <a href="#xpath-datamodel-40">[XQuery and XPath Data Model (XDM) 4.0]</a>. These functions and operators are defined for use in <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a> and <a href="#xquery-40">[XQuery 4.0: An XML Query Language]</a> and <a href="#xslt-40">[XSL Transformations (XSLT) Version 4.0]</a> and other related XML standards. The signatures and summaries of functions defined in this document are available at: <a href="http://www.w3.org/2005/xpath-functions/">http://www.w3.org/2005/xpath-functions/</a>.</p><p>A summary of changes since version 3.1 is provided at <a href="#changelog"><b>H Changes since 3.1</b></a>.</p></div><div><h2><a id="status"></a>Status of this Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document.</em></p><p>This document is a working draft developed and maintained by a W3C Community Group, the <a href="https://www.w3.org/community/xslt-40/">XQuery and XSLT Extensions Community Group</a> unofficially known as QT4CG (where "QT" denotes Query and Transformation). This draft is work in progress and should not be considered either stable or complete. Standard W3C copyright and patent conditions apply.</p><p>The community group welcomes comments on the specification. Comments are best submitted as issues on the group's <a href="https://github.com/qt4cg/qtspecs/issues">GitHub repository</a>.</p><p id="at-risk">As the Community Group moves towards publishing dated, stable drafts, some features that the group thinks may likely be removed or substantially changed are marked “at risk” in their changes section. In this draft:</p><ul><li><a href="#func-array-members">array:members</a></li><li><a href="#func-array-of-members">array:of-members</a></li></ul><p>The community group maintains two extensive test suites, one oriented to XQuery and XPath, the other to XSLT. These can be found at <a href="https://github.com/qt4cg/qt4tests">qt4tests</a> and <a href="https://github.com/qt4cg/xslt40-test">xslt40-test</a> respectively. New tests, or suggestions for correcting existing tests, are welcome. The test suites include extensive metadata describing the conditions for applicability of each test case as well as the expected results. They do not include any test drivers for executing the tests: each implementation is expected to provide its own test driver.</p><div class="dedication" id="dedication"><h3>Dedication</h3><p>The publications of this community group <a href="../xquery-40/xpath-40.html#dedication">are dedicated</a> to our co-chair, Michael Sperberg-McQueen&nbsp;(1954–2024).</p></div></div><hr><div class="body"><div class="_diffs div1"><h2><a id="functions-on-functions"></a>13 <a href="#functions-on-functions" style="text-decoration: none">Processing function items</a></h2><p>The functions included in this section operate on function items, that is, values referring to a function.</p><p><span class="termdef"><a id="dt-higher-order"></a>[Definition] Functions that accept functions among their arguments, or that return functions in their result, are described in this specification as <b>higher-order</b> functions.</span></p><div class="note"><p class="prefix"><b>Note:</b></p><p>Some functions such as <a href="#func-parse-json"><code>fn:parse-json</code></a> allow the option of supplying a callback function for example to define exception behavior. Where this is not essential to the use of the function, the function has not been classified as higher-order for this purpose; in applications where function items cannot be created, these particular options will not be available.</p></div><table class="index"><thead><tr><th>Function</th><th>Meaning</th></tr></thead><tbody><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-function-lookup"><code>fn:function-lookup</code></a></td><td>Returns <span>a function item</span> having a given name and arity, if there is one.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-function-name"><code>fn:function-name</code></a></td><td>Returns the name of the function identified by a function item.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-function-arity"><code>fn:function-arity</code></a></td><td>Returns the arity of the function identified by a function item.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-function-identity"><code>fn:function-identity</code></a></td><td>Returns a string representing the identity of a function item.</td></tr><tr><td style="white-space:nowrap; vertical-align:top"><a href="#func-function-annotations"><code>fn:function-annotations</code></a></td><td>Returns the annotations of the function item.</td></tr></tbody></table><div class="_diffs div2"><h3><a id="func-function-identity"></a>13.4 <a href="#func-function-identity" style="text-decoration: none">fn:function-identity</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90"> Changes in 4.0 (</span><a href="#func-function-annotations"><span class="deltaxml-new" style="background:#90EE90">next</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><a href="#func-outermost"><span class="deltaxml-new" style="background:#90EE90">previous</span></a><span class="deltaxml-new" style="background:#90EE90">)</span></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1798"><span class="deltaxml-new" style="background:#90EE90">1798</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1801"><span class="deltaxml-new" style="background:#90EE90">1801</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;5 March 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns a string representing the identity of a function item.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:function-identity</code>(</td></tr><tr class="arg"><td><code>$function</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>fn(*)</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:string</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The <a href="#func-function-identity"><code>fn:function-identity</code></a> function returns a string that represents the identity of <code>$function</code>.</p><p>The returned string has the property that <code>fn:function-identity($f1)</code> and <code>fn:function-identity($f2)</code> are codepoint-equal if and only if <code>$f1</code> and <code>$f2</code> have the same function identity. Apart from this property, the result is <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a>.</p><p>In the case of maps and arrays, the result follows the following rule: If <code>$X</code> and <code>$Y</code> are both maps or arrays then <code>fn:function-identity($X)</code><span class="verb">must not</span> be codepoint-equal to <code>fn:function-identity($Y)</code> unless <code>$X</code> and <code>$Y</code> are indistinguishable, that is unless every operator or function applied to <code>$X</code> returns the same result as for <code>$Y</code>. Even in this case, however, the result of the comparison <code>fn:function-identity($X) eq fn:function-identity($Y)</code> is <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a>.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>This function enables applications to test whether two expressions or variables reference the same function item. This may be useful, for example, to allow caching of function results to avoid repeated evaluation. The results of previous function invocations might be held in a map whose key is the function identity.</p><p>The function identity, by definition, is generated upon the creation of a function item. Specific expressions that create function items have their own rules for the identity of the returned functions: for example, it is guaranteed that evaluation of a function reference to a system function with no captured context (such as <a href="#func-abs"><code>fn:abs#1</code></a>) will always return the same function item.</p><p>It is not meaningful to store or compare the result of calling <a href="#func-function-identity"><code>fn:function-identity</code></a> across different <a title="execution scope" class="termref" href="#execution-scope">execution scopes</a>, because the string used to represent the function identity will generally vary from one execution scope to another.</p><p>The result of an expression such as <code>function-identity(abs#1) eq function-identity(abs(?))</code> may be either <code>true</code> or <code>false</code>, because it is <a title="implementation-dependent" class="termref" href="#implementation-dependent">implementation-dependent</a> whether <code>abs#1</code> and <code>abs(?)</code> return the same function item.</p><p>Similarly, <code>function-identity({ 1:() }) eq function-identity(map:entry(1, ()))</code> may be either <code>true</code> or <code>false</code>.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th>Expression</th><th>Result</th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>function-identity(abs#1) eq function-identity(abs#1)</code></pre></div></td><td style="vertical-align:top"><p><code>true()</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>function-identity(abs#1) eq function-identity(round#1)</code></pre></div></td><td style="vertical-align:top"><p><code>false()</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>function-identity({ 1: 0 }) eq function-identity({ 1: 1 })</code></pre></div></td><td style="vertical-align:top"><p><code>false()</code></p></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>function-identity([ 0 ]) eq function-identity([ 1 ])</code></pre></div></td><td style="vertical-align:top"><p><code>false()</code></p></td></tr></tbody></table></div></dd></dl></div><div class="_diffs div2"><h3><a id="func-function-annotations"></a>13.5 <a href="#func-function-annotations" style="text-decoration: none">fn:function-annotations</a></h3><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#map-ordering">next</a> | <a href="#func-function-identity">previous</a>)</p><ol><li><p><span style="display: none;" class="delete_version">Changes the function to return a sequence of key-value pairs rather than a map.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/36">36</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/710">710</a>&nbsp;17 September 2023]</i></span><span style="display: none;" class="add_version">New in 4.0<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/36">36</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/710">710</a>&nbsp;17 September 2023]</i></span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">Changes the function</span><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span><i><span class="deltaxml-old" style="background:#FF5555"> to return a sequence of key-value pairs rather than a map.</span><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;</span><span class="deltaxml-old" style="background:#FF5555">&nbsp;&nbsp;</span>[Issue <a href="https://github.com/qt4cg/qtspecs/issues/36">36</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/710">710</a>&nbsp;17 September 2023]</i></span></p></li><li><p>Changes the function to return a sequence of key-value pairs rather than a map.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1391">1391</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1393">1393</a>&nbsp;19 August 2024]</i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the annotations of the function item.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:function-annotations</code>(</td></tr><tr class="arg"><td><code>$function</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>fn(*)</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>map(xs:QName, xs:anyAtomicType*)*</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>The <code>fn:function-annotations</code> function returns the annotations of <code>$function</code> as a sequence of <a title="single-entry map" class="termref" href="#dt-single-entry-map">single-entry maps</a>, each associating the name of a function annotation with the value of the annotation. Note that several annotations on a function can share the same name. The order of the annotations is retained.</p><p>The result is a sequence of <a title="single-entry map" class="termref" href="#dt-single-entry-map">single-entry maps</a>, each being an instance of <code>map(xs:QName, xs:anyAtomicType*)</code>. If a function (for example, a built-in function) has no annotations, the result of the function is an empty sequence.</p><p>For each annotation, a map is returned, with a single entry. The key of the map entry is the name of the annotation as an <code>xs:QName</code>. The value of the entry is the value of the annotation as a sequence of atomic items. If the annotation has no values, the associated value is an empty sequence.</p></dd><dt class="label">Notes</dt><dd><div class="note"><p>In the common case where the annotation names are all unique, the result of the function can readily be converted into single map by applying the function <a href="#func-map-merge"><code>map:merge</code></a>.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">function-annotations(true#0)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">()</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">declare %private function local:inc($c) { $c + 1 };
function-annotations(local:inc#1)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">{ #Q{http://www.w3.org/2012/xquery}private : () }</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">let $old := %local:deprecated('0.1', '0.2') fn() {}
let $ann := function-annotations($old)
return map:merge($ann)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">{
  #Q{http://www.w3.org/2005/xquery-local-functions}deprecated :
  ("0.1", "0.2") 
}</pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="_diffs div1"><h2><a id="processing-jnodes"></a>16 <a href="#processing-jnodes" style="text-decoration: none">Processing JNodes</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#func-jtree">next</a> | <a href="#func-array-trunk">previous</a>)</p><ol><li><p> Introduced the concept of JNodes. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/2025">2025</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/2031">2031</a>&nbsp;11 June 2025]</i></p></li></ol></div><p>A <a href="https://qt4cg.org/specifications/xpath-datamodel-40/#dt-JNode">JNode</a><sup><small>DM</small></sup> is a wrapper around a map or array, or around a value that appears within the content of a map or array. JNodes are described at <a href="#xpath-datamodel-40">[XQuery and XPath Data Model (XDM) 4.0]</a> section <a href="../xpath-datamodel-40/#id-JNodes">8.4 JNodes</a>. Wrapping a map or array in a JNode enables the use of path expressions such as <code>$jnode/descendant::title</code>, as described at <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-path-expressions">4.7 Path Expressions</a>.</p><p>In addition to the functions defined in this section, functions that operate on JNodes include:</p><blockquote><p><a href="#func-distinct-ordered-nodes"><code>fn:distinct-ordered-nodes</code></a><br><a href="#func-generate-id"><code>fn:generate-id</code></a><br><a href="#func-has-children"><code>fn:has-children</code></a><br><a href="#func-innermost"><code>fn:innermost</code></a><br><a href="#func-outermost"><code>fn:outermost</code></a><br><a href="#func-path"><code>fn:path</code></a><br><a href="#func-root"><code>fn:root</code></a><br><a href="#func-siblings"><code>fn:siblings</code></a><br><a href="#func-transitive-closure"><code>fn:transitive-closure</code></a></p></blockquote><div class="_diffs div2"><h3><a id="functions-on-jnodes"></a>16.1 <a href="#functions-on-jnodes" style="text-decoration: none">Functions on JNodes</a></h3><div class="_diffs div3"><h4><a id="func-jnode-content"></a>16.1.2 <a href="#func-jnode-content" style="text-decoration: none">fn:jnode-content</a></h4><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90"> Changes in 4.0 (</span><a href="#func-jnode-selector"><span class="deltaxml-new" style="background:#90EE90">next</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><a href="#func-jtree"><span class="deltaxml-new" style="background:#90EE90">previous</span></a><span class="deltaxml-new" style="background:#90EE90">)</span></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/2025"><span class="deltaxml-new" style="background:#90EE90">2025</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/2031"><span class="deltaxml-new" style="background:#90EE90">2031</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;12 June 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns the <b>·content·</b> property of a JNode.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">fn:jnode-content</code>(</td></tr><tr class="arg"><td><code>$input</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>jnode()?</code></code></td><td><code class="assign">:=&nbsp;</code><code>.</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>item()*</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a title="deterministic" class="termref" href="#dt-deterministic">deterministic</a>, <a title="context-independent" class="termref" href="#dt-context-independent">context-independent</a>, and <a title="focus-dependent" class="termref" href="#dt-focus-independent">focus-independent</a>. </p></dd><dt class="label">Rules</dt><dd><p>If the argument is omitted, it defaults to the context value (<code>.</code>).</p><p>If <code>$input</code> is an empty sequence, the function returns an empty sequence.</p><p>Otherwise, the function returns the <b>·content·</b> property of <code>$input</code>.</p></dd><dt class="label">Error Conditions</dt><dd><p>The following errors may be raised when <code>$node</code> is omitted:</p><ul><li><p>If the context value is <a href="https://qt4cg.org/specifications/xpath-datamodel-40/#dt-absent">absent</a><sup><small>DM</small></sup>, type error [<a href="https://www.w3.org/TR/xpath20/#ERRXPDY0002" title="err:XPDY0002">err:XPDY0002</a>]<sup><small>XP</small></sup>.</p></li><li><p>If the context value is not an instance of the sequence type <code>jnode()?</code>, type error [<a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="err:XPTY0004">err:XPTY0004</a>]<sup><small>XP</small></sup>.</p></li></ul></dd><dt class="label">Notes</dt><dd><div class="note"><p>In many cases it is unnecessary to make an explicit call on <code>jnode-content</code>, because the coercion rules will take care of this automatically. For example, in an expression such as <code>$X / descendant::name [matches(., '^J')]</code>, the call on <a href="#func-matches"><code>matches</code></a> is supplied with a JNode as its first argument; atomization ensures that the actual value being passed to the first argument of <a href="#func-matches"><code>matches</code></a> is the atomized value of the <b>·content·</b> property.</p><p>Other examples where the <b>·content·</b> of a JNode is extracted automatically include:</p><ul><li><p>Any context where the required type is an atomic value, for example arithmetic operations, value comparisons and general comparisons, and calls on functions that expect an atomic value.</p></li><li><p>Any context where the required type is a map or array, for example the first argument of functions such as <a href="#func-map-size"><code>map:size</code></a> or <a href="#func-array-size"><code>array:size</code></a>, a free-standing expression within a map constructor such as <code>map{ $jnode }</code>, the constructs <code>for member</code> and <code>for key/value</code>, the left-hand operand of the lookup operator <code>?</code> (or the context value in the case of a unary lookup operator), and the operand of a map/array filter expression <code>$jnode?[predicate]</code>.</p></li></ul><p>Notable places where the <b>·content·</b> is <em>not</em> automatically extracted include:</p><ul><li><p>When computing the effective boolean value. As with XNodes, writing <code>if ($array/child::*[1]) ...</code> tests for the existence of a child, it does not test its value. To test its value, write <code>if (jnode-content($array/child::*[1])) ...</code>, or equivalently <code>if (xs:boolean($array/child::*[1])) ...</code>.</p></li><li><p>When calling functions that accept arbitrary sequences, such as <a href="#func-count"><code>count</code></a> or <a href="#func-deep-equal"><code>deep-equal</code></a>.</p></li></ul><p>It is possible (though probably unwise) to construct a JNode whose <b>·content·</b> property itself contains another JNode. For example, the expression <code>jtree([jtree([]), jtree([])])</code> creates a JNode whose <b>·content·</b> is an array of JNodes, and applying the <code>child</code> axis to this JNode will return a sequence of two JNodes that themselves have further JNodes as their content. The <a href="#func-jnode-content"><code>jnode-content</code></a> returns these contained JNodes, it does not recursively extract their content.</p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">let $array := [1, 3, 4.5, 7, "eight", 10]
return $array / child::type(xs:integer) =!&gt; jnode-content()</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">1, 3, 7, 10</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">let $map := {'Mo': 'Monday', 'Tu': 'Tuesday', 'We': 'Wednesday'}
return $map / child::get(("Mo", "We", "Fr", "Su")) =!&gt; jnode-content()</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">"Monday", "Wednesday"</pre></div></td></tr><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve" class="small">let $array := [[4, 18], [30, 4, 22]]
return $array / descendant::*[. &gt; 25][1] / ancestor-or-self::* =!&gt; jnode-content()</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">[[4, 18], [30, 4, 22]], [30, 4, 22]</pre></div></td></tr></tbody></table></div></dd></dl></div></div></div></div><div class="back"><div class="_diffs div1"><h2><a id="changelog"></a>H <a href="#changelog" style="text-decoration: none">Changes since 3.1</a> (Non-Normative)</h2><div class="_diffs div2"><h3><a id="changes-summary"></a>H.1 <a href="#changes-summary" style="text-decoration: none">Summary of Changes</a></h3><ol><li><p>If a section of this specification has been updated since version 3.1, an overview of the changes is provided, along with links to navigate to the next or previous change.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p>Sections with significant changes are marked with a ✭ symbol in the table of contents. New functions are indicated by ✚.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1504 2329">1504 2329&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-insert-separator"><b>2.1.7 fn:insert-separator</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-replicate"><b>2.1.10 fn:replicate</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-slice"><b>2.1.12 fn:slice</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1120 1150">1120 1150&nbsp;</a></p><p>A callback function can be supplied for comparing individual items.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p></li><li><p>Changed in 4.0 to use transitive equality comparisons for numeric values.</p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/614 987">614 987&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-duplicate-values"><b>2.2.6 fn:duplicate-values</b></a></p></li><li><p>New in 4.0. Originally proposed under the name <code>fn:uniform</code></p><p>See <a href="#func-all-equal"><b>2.4.2 fn:all-equal</b></a></p></li><li><p>New in 4.0. Originally proposed under the name <code>fn:unique</code></p><p>See <a href="#func-all-different"><b>2.4.3 fn:all-different</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-every"><b>2.5.3 fn:every</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-highest"><b>2.5.9 fn:highest</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-index-where"><b>2.5.10 fn:index-where</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-lowest"><b>2.5.11 fn:lowest</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-scan-right"><b>2.5.15 fn:scan-right</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-some"><b>2.5.16 fn:some</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/795 2228">795 2228&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-sort-with"><b>2.5.19 fn:sort-with</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/521 761">521 761&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-transitive-closure"><b>2.5.22 fn:transitive-closure</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-is-NaN"><b>4.4.5 fn:is-NaN</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1260 1275">1260 1275&nbsp;</a></p><p>A third argument has been added, providing control over the rounding mode.</p><p>See <a href="#func-round"><b>4.4.6 fn:round</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1049 1151">1049 1151&nbsp;</a></p><p>Decimal format parameters can now be supplied directly as a map in the third argument, rather than referencing a format defined in the static context.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1205 1230">1205 1230&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-math-e"><b>4.8.2 math:e</b></a></p><p>See <a href="#func-math-cosh"><b>4.8.8 math:cosh</b></a></p><p>See <a href="#func-math-sinh"><b>4.8.15 math:sinh</b></a></p><p>See <a href="#func-math-tanh"><b>4.8.18 math:tanh</b></a></p></li><li><p>The 3.1 specification suggested that every value in the result range should have the same chance of being chosen. This has been corrected to say that the distribution should be arithmetically uniform (because there are as many <code>xs:double</code> values between 0.01 and 0.1 as there are between 0.1 and 1.0).</p><p>See <a href="#func-random-number-generator"><b>4.9.2 fn:random-number-generator</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/261 306 993">261 306 993&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-char"><b>5.4.1 fn:char</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-characters"><b>5.4.2 fn:characters</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/937 995 1190">937 995 1190&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-hash"><b>5.4.13 fn:hash</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/215 415 ">215 415 &nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-uri"><b>7.6.2 fn:parse-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1423 1413">1423 1413&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-build-uri"><b>7.6.3 fn:build-uri</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-in-scope-namespaces"><b>12.2.2 fn:in-scope-namespaces</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1620 1886">1620 1886&nbsp;</a></p><p>Options are added to customize the form of the output.</p><p>See <a href="#func-path"><b>12.2.9 fn:path</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1547 1551">1547 1551&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-siblings"><b>12.2.11 fn:siblings</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/969 1134">969 1134&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/478 515">478 515&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-keys-where"><b>14.4.12 map:keys-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1575 1906">1575 1906&nbsp;</a></p><p> A new function <a href="#func-element-to-map"><code>fn:element-to-map</code></a> is provided for converting XDM trees to maps suitable for serialization as JSON. Unlike the <a href="#func-xml-to-json"><code>fn:xml-to-json</code></a> function retained from 3.1, this can handle arbitrary XML as input. </p><p>See <a href="#xml-to-json-mappings"><b>14.5 Converting elements to maps</b></a></p></li><li><p>New in 4.0</p><p>See <a href="#func-array-empty"><b>15.2.3 array:empty</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/968 1295">968 1295&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-index-of"><b>15.2.13 array:index-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/476 1087">476 1087&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-items"><b>15.2.16 array:items</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/360 476">360 476&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-members"><b>15.2.18 array:members</b></a></p><p>See <a href="#func-array-of-members"><b>15.2.19 array:of-members</b></a></p></li><li><p>Supplying an empty sequence as the value of an optional argument is equivalent to omitting the argument.</p><p>See <a href="#func-array-subarray"><b>15.2.29 array:subarray</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1117 1279">1117 1279&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-unparsed-text-lines"><b>17.1.6 fn:unparsed-text-lines</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/259 956">259 956&nbsp;</a></p><p> A new function is available for processing input data in HTML format. </p><p>See <a href="#html-functions"><b>17.3 Functions on HTML Data</b></a></p><p>New in 4.0</p><p>See <a href="#func-parse-html"><b>17.3.2 fn:parse-html</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/975 1058 1246">975 1058 1246&nbsp;</a></p><p>An option is provided to control how JSON numbers should be formatted.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>Additional options are available, as defined by <a href="#func-parse-json"><code>fn:parse-json</code></a>.</p><p>See <a href="#func-json-doc"><b>17.4.5 fn:json-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834 1066">533 719 834 1066&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-csv-to-arrays"><b>17.5.4 fn:csv-to-arrays</b></a></p><p>See <a href="#func-parse-csv"><b>17.5.7 fn:parse-csv</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834 1066 1605">533 719 834 1066 1605&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-csv-to-xml"><b>17.5.10 fn:csv-to-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/791 1256 1282 1405">791 1256 1282 1405&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-invisible-xml"><b>17.6.1 fn:invisible-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/629 803">629 803&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-message"><b>21.2.2 fn:message</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/533 719 834">533 719 834&nbsp;</a></p><p> New functions are available for processing input data in CSV (comma separated values) format. </p><p>See <a href="#csv-functions"><b>17.5 Functions on CSV Data</b></a></p></li><li><p>Comparison of mixed numeric types (for example <code>xs:double</code> and <code>xs:decimal</code>) now generally converts both values to <code>xs:decimal</code>.</p><p>See <a href="#comp.numeric"><b>4.3 Comparing numeric values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/289 1901">289 1901&nbsp;</a></p><p>A third argument is added, allowing user control of how absent keys should be handled.</p><p>See <a href="#func-map-get"><b>14.4.9 map:get</b></a></p><p>A third argument is added, allowing user control of how index-out-of-bounds conditions should be handled.</p><p>See <a href="#func-array-get"><b>15.2.11 array:get</b></a></p></li><li><p> A new collation URI is defined for Unicode case-insensitive comparison and ordering. </p><p>See <a href="#unicode-case-insensitive-collation"><b>5.3.5 The Unicode case-insensitive collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1727 1740">1727 1740&nbsp;</a></p><p>It is no longer guaranteed that the new key replaces the existing key.</p><p>See <a href="#func-map-put"><b>14.4.14 map:put</b></a></p></li><li><p>The group may remove this function, it is considered <a href="#at-risk">at risk</a>. </p><p>See <a href="#func-array-members"><b>15.2.18 array:members</b></a></p><p>See <a href="#func-array-of-members"><b>15.2.19 array:of-members</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/173">173&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-op"><b>18.4 fn:op</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/203">203&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-build"><b>14.4.1 map:build</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/207">207&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-QName"><b>10.1.2 fn:parse-QName</b></a></p><p>See <a href="#func-expanded-QName"><b>10.2.5 fn:expanded-QName</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/222">222&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-contains-subsequence"><b>2.2.3 fn:contains-subsequence</b></a></p><p>See <a href="#func-ends-with-subsequence"><b>2.2.7 fn:ends-with-subsequence</b></a></p><p>See <a href="#func-starts-with-subsequence"><b>2.2.9 fn:starts-with-subsequence</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/250">250&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-foot"><b>2.1.3 fn:foot</b></a></p><p>See <a href="#func-trunk"><b>2.1.15 fn:trunk</b></a></p><p>See <a href="#func-array-build"><b>15.2.2 array:build</b></a></p><p>See <a href="#func-array-foot"><b>15.2.8 array:foot</b></a></p><p>See <a href="#func-array-trunk"><b>15.2.31 array:trunk</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/258">258&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-index-where"><b>15.2.14 array:index-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/313">313&nbsp;</a></p><p>The second argument can now be a sequence of integers.</p><p>See <a href="#func-remove"><b>2.1.9 fn:remove</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/319">319&nbsp;</a></p><p>New in 4.0. The function replaces the internal <a href="#dt-same-key"><code>op:same-key</code></a> function in 3.1</p><p>See <a href="#func-atomic-equal"><b>2.2.1 fn:atomic-equal</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/326">326&nbsp;</a></p><p>Higher-order functions are no longer an optional feature.</p><p>See <a href="#conformance"><b>1.2 Conformance</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/360">360&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-entries"><b>14.4.4 map:entries</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/419">419&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-items-at"><b>2.1.8 fn:items-at</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/434">434&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-parse-integer"><b>4.5.2 fn:parse-integer</b></a></p><p>The function has been extended to allow output in a radix other than 10, for example in hexadecimal.</p><p>See <a href="#func-format-integer"><b>4.6.1 fn:format-integer</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/477">477&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-slice"><b>15.2.24 array:slice</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/482">482&nbsp;</a></p><p>Deleted an inaccurate statement concerning the behavior of NaN.</p><p>See <a href="#comp.numeric"><b>4.3 Comparing numeric values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/507">507&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-partition"><b>2.5.13 fn:partition</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/546">546&nbsp;</a></p><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-codepoints-to-string"><b>5.2.1 fn:codepoints-to-string</b></a></p><p>It is no longer automatically an error if the resource (after decoding) contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p><p> The rules regarding use of non-XML characters in JSON texts have been relaxed. </p><p>See <a href="#json-character-repertoire"><b>17.4.3 JSON character repertoire</b></a></p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p><p>It is no longer automatically an error if the input contains a codepoint that is not valid in XML. Instead, the codepoint must be a <a title="permitted character" class="termref" href="#dt-permitted-character">permitted character</a>. The set of permitted characters is <a title="implementation-defined" class="termref" href="#implementation-defined">implementation-defined</a>, but it is <span class="verb">recommended</span> that all Unicode characters should be accepted.</p><p>See <a href="#func-json-doc"><b>17.4.5 fn:json-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/609">609&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-split"><b>15.2.28 array:split</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/631">631&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-decode-from-uri"><b>7.1 fn:decode-from-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/662">662&nbsp;</a></p><p> Constructor functions now have a zero-arity form; the first argument defaults to the context item. </p><p>See <a href="#constructor-functions"><b>22 Constructor functions</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/680">680&nbsp;</a></p><p> The case-insensitive collation is now defined normatively within this specification, rather than by reference to the HTML "living specification", which is subject to change. The collation can now be used for ordering comparisons as well as equality comparisons. </p><p>See <a href="#html-ascii-case-insensitive-collation"><b>5.3.6 The HTML ASCII Case-Insensitive Collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/702">702&nbsp;</a></p><p>The function can now take any number of arguments (previously it had to be two or more), and the arguments can be sequences of strings rather than single strings.</p><p>See <a href="#func-concat"><b>5.4.4 fn:concat</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/710">710&nbsp;</a></p><p><span class="deltaxml-old" style="background:#FF5555">Changes the function to return a sequence of key-value pairs rather than a map.</span></p><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p><p>See <a href="#func-function-annotations"><b>13.5 fn:function-annotations</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/727">727&nbsp;</a></p><p>It has been clarified that loading a module has no effect on the static or dynamic context of the caller.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/828">828&nbsp;</a></p><p>The <code>$predicate</code> callback function accepts an optional position argument.</p><p>See <a href="#func-filter"><b>2.5.4 fn:filter</b></a></p><p>The <code>$action</code> callback function accepts an optional position argument.</p><p>See <a href="#func-for-each"><b>2.5.7 fn:for-each</b></a></p><p>See <a href="#func-for-each-pair"><b>2.5.8 fn:for-each-pair</b></a></p><p>The <code>$predicate</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-array-filter"><b>15.2.4 array:filter</b></a></p><p>The <code>$action</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-array-for-each"><b>15.2.9 array:for-each</b></a></p><p>See <a href="#func-array-for-each-pair"><b>15.2.10 array:for-each-pair</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/881">881&nbsp;</a></p><p>The way that <a href="#func-min"><code>fn:min</code></a> and <a href="#func-max"><code>fn:max</code></a> compare numeric values of different types has changed. The most noticeable effect is that when these functions are applied to a sequence of <code>xs:integer</code> or <code>xs:decimal</code> values, the result is an <code>xs:integer</code> or <code>xs:decimal</code>, rather than the result of converting this to an <code>xs:float</code> or <code>xs:double</code>.</p><p>See <a href="#func-max"><b>2.4.5 fn:max</b></a></p><p>See <a href="#func-min"><b>2.4.6 fn:min</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/901">901&nbsp;</a></p><p>The optional third argument can now be supplied as an empty sequence.</p><p>See <a href="#func-subsequence"><b>2.1.13 fn:subsequence</b></a></p><p>The third argument can now be supplied as an empty sequence.</p><p>See <a href="#func-substring"><b>5.4.6 fn:substring</b></a></p><p>The second argument can now be an empty sequence.</p><p>See <a href="#func-tokenize"><b>6.3.3 fn:tokenize</b></a></p><p>The optional second argument can now be supplied as an empty sequence.</p><p>See <a href="#func-resolve-uri"><b>7.5 fn:resolve-uri</b></a></p><p>The 3rd, 4th, and 5th arguments are now optional; previously the function required either 2 or 5 arguments.</p><p>See <a href="#func-format-dateTime"><b>9.8.1 fn:format-dateTime</b></a></p><p>See <a href="#func-format-date"><b>9.8.2 fn:format-date</b></a></p><p>See <a href="#func-format-time"><b>9.8.3 fn:format-time</b></a></p><p>All three arguments are now optional, and each argument can be set to an empty sequence. Previously if <code>$description</code> was supplied, it could not be empty.</p><p>See <a href="#func-error"><b>21.1.1 fn:error</b></a></p><p>The <code>$label</code> argument can now be set to an empty sequence. Previously if <code>$label</code> was supplied, it could not be empty.</p><p>See <a href="#func-trace"><b>21.2.1 fn:trace</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/905">905&nbsp;</a></p><p>The rule that multiple calls on <a href="#func-doc"><code>fn:doc</code></a> supplying the same absolute URI must return the same document node has been clarified; in particular the rule does not apply if the dynamic context for the two calls requires different processing of the documents (such as schema validation or whitespace stripping).</p><p>See <a href="#func-doc"><b>17.1.1 fn:doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/909">909&nbsp;</a></p><p>The function has been expanded in scope to handle comparison of values other than strings.</p><p>See <a href="#func-compare"><b>2.2.2 fn:compare</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/924">924&nbsp;</a></p><p> Rules have been added clarifying that users should not be allowed to change the schema for the <code>fn</code> namespace. </p><p>See <a href="#schemata"><b>D Schemas</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/925">925&nbsp;</a></p><p>The decimal format name can now be supplied as a value of type <code>xs:QName</code>, as an alternative to supplying a lexical QName as an instance of <code>xs:string</code>.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/932">932&nbsp;</a></p><p> The specification now prescribes a minimum precision and range for durations. </p><p>See <a href="#duration-conformance"><b>8.1.2 Limits and precision</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/933">933&nbsp;</a></p><p>When comments and processing instructions are ignored, any text nodes either side of the comment or processing instruction are now merged prior to comparison.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/940">940&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-subsequence-where"><b>2.5.20 fn:subsequence-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/953">953&nbsp;</a></p><p> Constructor functions for named record types have been introduced. </p><p>See <a href="#id-constructors-for-record-tests"><b>22.6 Constructor functions for named record types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/962">962&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-do-until"><b>2.5.2 fn:do-until</b></a></p><p>See <a href="#func-while-do"><b>2.5.23 fn:while-do</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/969">969&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-empty"><b>14.4.3 map:empty</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/984">984&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-seconds"><b>8.4.1 fn:seconds</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/987">987&nbsp;</a></p><p>The order of results is now prescribed; it was previously implementation-dependent.</p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1022">1022&nbsp;</a></p><p> Regular expressions can include comments (starting and ending with <code>#</code>) if the <code>c</code> flag is set. </p><p>See <a href="#regex-syntax"><b>6.1 Regular expression syntax</b></a></p><p>See <a href="#flags"><b>6.2 Flags</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1028">1028&nbsp;</a></p><p>An option is provided to control how the JSON <code>null</code> value should be handled.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1032">1032&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-void"><b>2.1.17 fn:void</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1046">1046&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-take-while"><b>2.5.21 fn:take-while</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1059">1059&nbsp;</a></p><p> Use of an option keyword that is not defined in the specification and is not known to the implementation now results in a dynamic error; previously it was ignored. </p><p>See <a href="#options"><b>1.7 Options</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1068">1068&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-graphemes"><b>5.4.3 fn:graphemes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1072">1072&nbsp;</a></p><p>The return type is now specified more precisely.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1090">1090&nbsp;</a></p><p> When casting from a string to a duration or time or dateTime, it is now specified that when there are more digits in the fractional seconds than the implementation is able to retain, excess digits are truncated. Rounding upwards (which could affect the number of minutes or hours in the value) is not permitted. </p><p>See <a href="#casting-from-strings"><b>23.2 Casting from xs:string and xs:untypedAtomic</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1093">1093&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-collation"><b>5.3.9 fn:collation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1117">1117&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p><p>See <a href="#func-unparsed-text-available"><b>17.1.7 fn:unparsed-text-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1182">1182&nbsp;</a></p><p>The <code>$predicate</code> callback function may return an empty sequence (meaning <code>false</code>).</p><p>See <a href="#func-do-until"><b>2.5.2 fn:do-until</b></a></p><p>See <a href="#func-every"><b>2.5.3 fn:every</b></a></p><p>See <a href="#func-filter"><b>2.5.4 fn:filter</b></a></p><p>See <a href="#func-index-where"><b>2.5.10 fn:index-where</b></a></p><p>See <a href="#func-some"><b>2.5.16 fn:some</b></a></p><p>See <a href="#func-take-while"><b>2.5.21 fn:take-while</b></a></p><p>See <a href="#func-while-do"><b>2.5.23 fn:while-do</b></a></p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-keys-where"><b>14.4.12 map:keys-where</b></a></p><p>See <a href="#func-array-filter"><b>15.2.4 array:filter</b></a></p><p>See <a href="#func-array-index-where"><b>15.2.14 array:index-where</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1191">1191&nbsp;</a></p><p>The <code>$options</code> parameter has been added, absorbing the <code>$collation</code> parameter.</p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p><p>New in 4.0</p><p>See <a href="#func-distinct-ordered-nodes"><b>12.3.1 fn:distinct-ordered-nodes</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1250">1250&nbsp;</a></p><p>For selected properties including <code>percent</code> and <code>exponent-separator</code>, it is now possible to specify a single-character marker to be used in the picture string, together with a multi-character rendition to be used in the formatted output.</p><p>See <a href="#func-format-number"><b>4.7.2 fn:format-number</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1257">1257&nbsp;</a></p><p>The <code>$options</code> parameter has been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p><p>See <a href="#func-parse-xml-fragment"><b>17.2.2 fn:parse-xml-fragment</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1262">1262&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-collation-available"><b>5.3.10 fn:collation-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1265">1265&nbsp;</a></p><p>The constraints on the result of the function have been relaxed.</p><p>See <a href="#func-document-uri"><b>12.1.2 fn:document-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1280">1280&nbsp;</a></p><p>As a result of changes to the coercion rules, the number of supplied arguments can be greater than the number required: extra arguments are ignored.</p><p>See <a href="#func-apply"><b>2.5.1 fn:apply</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1288">1288&nbsp;</a></p><p>Additional error conditions have been defined.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1296">1296&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-scan-left"><b>2.5.14 fn:scan-left</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1333">1333&nbsp;</a></p><p>A new option is provided to allow the content of the loaded module to be supplied as a string.</p><p>See <a href="#func-load-xquery-module"><b>18.2 fn:load-xquery-module</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1353">1353&nbsp;</a></p><p>An option has been added to suppress the escaping of the solidus (forwards slash) character.</p><p>See <a href="#func-xml-to-json"><b>17.4.7 fn:xml-to-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1358">1358&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-unix-dateTime"><b>9.3.2 fn:unix-dateTime</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1361">1361&nbsp;</a></p><p> The term <b>atomic value</b> has been replaced by <b>atomic item</b>. </p><p>See <a href="#terminology"><b>1.9 Terminology</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1393">1393&nbsp;</a></p><p>Changes the function to return a sequence of key-value pairs rather than a map.</p><p>See <a href="#func-function-annotations"><b>13.5 fn:function-annotations</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1409">1409&nbsp;</a></p><p> This section now uses the term <b>primitive type</b> strictly to refer to the 20 atomic types that are not derived by restriction from another atomic type: that is, the 19 primitive atomic types defined in XSD, plus <code>xs:untypedAtomic</code>. The three types <code>xs:integer</code>, <code>xs:dayTimeDuration</code>, and <code>xs:yearMonthDuration</code>, which have custom casting rules but are not strictly-speaking primitive, are now handled in other subsections. </p><p>See <a href="#casting-from-primitive-to-primitive"><b>23.1 Casting from primitive types to primitive types</b></a></p><p> The rules for conversion of dates and times to strings are now defined entirely in terms of XSD 1.1 canonical mappings, since these deliver exactly the same result as the XPath 3.1 rules. </p><p>See <a href="#casting-date-time-to-string"><b>23.1.2.2 Casting date/time values to xs:string</b></a></p><p> The rules for conversion of durations to strings are now defined entirely in terms of XSD 1.1 canonical mappings, since the XSD 1.1 rules deliver exactly the same result as the XPath 3.1 rules. </p><p>See <a href="#casting-duration-to-string"><b>23.1.2.3 Casting xs:duration values to xs:string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1455">1455&nbsp;</a></p><p>Numbers now retain their original lexical form, except for any changes needed to satisfy JSON syntax rules (for example, stripping leading zero digits).</p><p>See <a href="#func-xml-to-json"><b>17.4.7 fn:xml-to-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1473">1473&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-identity"><b>2.1.5 fn:identity</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1481">1481&nbsp;</a></p><p>The function has been extended to handle other Gregorian types such as <code>xs:gYearMonth</code>.</p><p>See <a href="#func-year-from-dateTime"><b>9.5.1 fn:year-from-dateTime</b></a></p><p>See <a href="#func-month-from-dateTime"><b>9.5.2 fn:month-from-dateTime</b></a></p><p>The function has been extended to handle other Gregorian types such as <code>xs:gMonthDay</code>.</p><p>See <a href="#func-day-from-dateTime"><b>9.5.3 fn:day-from-dateTime</b></a></p><p>The function has been extended to handle other types including <code>xs:time</code>.</p><p>See <a href="#func-hours-from-dateTime"><b>9.5.4 fn:hours-from-dateTime</b></a></p><p>See <a href="#func-minutes-from-dateTime"><b>9.5.5 fn:minutes-from-dateTime</b></a></p><p>The function has been extended to handle other types such as <code>xs:gYearMonth</code>.</p><p>See <a href="#func-timezone-from-dateTime"><b>9.5.7 fn:timezone-from-dateTime</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1523">1523&nbsp;</a></p><p> New functions are provided to obtain information about built-in types and types defined in an imported schema. </p><p>See <a href="#functions-on-types"><b>19 Processing types</b></a></p><p>New in 4.0</p><p>See <a href="#func-schema-type"><b>19.1.2 fn:schema-type</b></a></p><p>See <a href="#func-atomic-type-annotation"><b>19.1.4 fn:atomic-type-annotation</b></a></p><p>See <a href="#func-node-type-annotation"><b>19.1.5 fn:node-type-annotation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1545">1545&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-civil-timezone"><b>9.6.4 fn:civil-timezone</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1565">1565&nbsp;</a></p><p>The default for the <code>escape</code> option has been changed to <code>false</code>. The 3.1 specification gave the default value as <code>true</code>, but this appears to have been an error, since it was inconsistent with examples given in the specification and with tests in the test suite.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1570">1570&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-type-of"><b>19.1.3 fn:type-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1587">1587&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-unparsed-binary"><b>17.1.8 fn:unparsed-binary</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1611">1611&nbsp;</a></p><p>The spec has been corrected to note that the function depends on the implicit timezone.</p><p>See <a href="#func-compare"><b>2.2.2 fn:compare</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1671">1671&nbsp;</a></p><p>New in 4.0.</p><p>See <a href="#func-divide-decimals"><b>4.4.3 fn:divide-decimals</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1687">1687&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-map-items"><b>14.4.10 map:items</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1703">1703&nbsp;</a></p><p>Ordered maps are introduced.</p><p>See <a href="#map-ordering"><b>14.1 Ordering of Maps</b></a></p><p>Enhanced to allow for ordered maps.</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-find"><b>14.4.7 map:find</b></a></p><p>See <a href="#func-map-for-each"><b>14.4.8 map:for-each</b></a></p><p>See <a href="#func-map-put"><b>14.4.14 map:put</b></a></p><p>See <a href="#func-map-remove"><b>14.4.15 map:remove</b></a></p><p>The order of entries in maps is retained.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1711">1711&nbsp;</a></p><p>It is explicitly stated that the limits for <code>$precision</code> are implementation-defined.</p><p>See <a href="#func-round"><b>4.4.6 fn:round</b></a></p><p>See <a href="#func-round-half-to-even"><b>4.4.7 fn:round-half-to-even</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1727">1727&nbsp;</a></p><p>For consistency with the new function <a href="#func-map-build"><code>map:build</code></a>, the handling of duplicates may now be controlled by supplying a user-defined callback function as an alternative to the fixed values for the earlier <code>duplicates</code> option.</p><p>See <a href="#func-map-merge"><b>14.4.13 map:merge</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1734">1734&nbsp;</a></p><p>In 3.1, given a mixed input sequence such as (1, 3, 4.2e0), the specification was unclear whether it was permitted to add the first two integer items using integer arithmetic, rather than converting all items to doubles before performing any arithmetic. The 4.0 specification is clear that this is permitted; but since the items can be reordered before being added, this is not required.</p><p>See <a href="#func-avg"><b>2.4.4 fn:avg</b></a></p><p>See <a href="#func-sum"><b>2.4.7 fn:sum</b></a></p></li><li class="add_version" style="display: none;"><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1801">1801&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-function-identity"><b>13.4 fn:function-identity</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1801"><span class="deltaxml-new" style="background:#90EE90">1801&nbsp;</span></a></p><p><span class="deltaxml-new" style="background:#90EE90">New in 4.0</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-function-identity"><b><span class="deltaxml-new" style="background:#90EE90">13.4 fn:function-identity</span></b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1825">1825&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-partial-apply"><b>2.5.12 fn:partial-apply</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1856">1856&nbsp;</a></p><p> Word boundaries can be matched. Lookahead and lookbehind assertions are supported. Assertions (including <code>^</code> and <code>$</code>) can no longer be followed by a quantifier. </p><p>See <a href="#regex-syntax"><b>6.1 Regular expression syntax</b></a></p><p>The output of the function is extended to allow the represention of captured groups found within lookahead assertions.</p><p>See <a href="#func-analyze-string"><b>6.3.4 fn:analyze-string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1879">1879&nbsp;</a></p><p>Additional options to control DTD and XInclude processing have been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1897">1897&nbsp;</a></p><p>The <code>$replacement</code> argument can now be a function that computes the replacement strings.</p><p>See <a href="#func-replace"><b>6.3.2 fn:replace</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1906">1906&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-element-to-map-plan"><b>14.5.10 fn:element-to-map-plan</b></a></p><p>New in 4.0.</p><p>See <a href="#func-element-to-map"><b>14.5.11 fn:element-to-map</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1910">1910&nbsp;</a></p><p>An <code>$options</code> parameter is added. Note that the rules for the <code>$options</code> parameter control aspects of processing that were implementation-defined in earlier versions of this specification. An implementation may provide configuration options designed to retain backwards-compatible behavior when no explicit options are supplied.</p><p>See <a href="#func-doc"><b>17.1.1 fn:doc</b></a></p><p>See <a href="#func-doc-available"><b>17.1.2 fn:doc-available</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1913">1913&nbsp;</a></p><p>It is now permitted for the regular expression to match a zero-length string.</p><p>See <a href="#func-replace"><b>6.3.2 fn:replace</b></a></p><p>See <a href="#func-tokenize"><b>6.3.3 fn:tokenize</b></a></p><p>See <a href="#func-analyze-string"><b>6.3.4 fn:analyze-string</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1933">1933&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-xsd-validator"><b>17.2.5 fn:xsd-validator</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1991">1991&nbsp;</a></p><p> Named record types used in the signatures of built-in functions are now available as standard in the static context. </p><p>See <a href="#id-built-in-named-record-types"><b>C Built-in named record types</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2001">2001&nbsp;</a></p><p>New in 4.0.</p><p>See <a href="#func-sort-by"><b>2.5.18 fn:sort-by</b></a></p><p>See <a href="#func-array-sort-by"><b>15.2.26 array:sort-by</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2013">2013&nbsp;</a></p><p>Support for binary input has been added.</p><p>See <a href="#func-parse-xml"><b>17.2.1 fn:parse-xml</b></a></p><p>See <a href="#func-parse-xml-fragment"><b>17.2.2 fn:parse-xml-fragment</b></a></p><p>New in 4.0</p><p>See <a href="#func-html-doc"><b>17.3.3 fn:html-doc</b></a></p><p>See <a href="#func-csv-doc"><b>17.5.8 fn:csv-doc</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2030">2030&nbsp;</a></p><p> This description of the XSD validation process was previously found (with some duplication) in the XQuery and XSLT specifications; those specifications now reference this description. As a side-effects, the descriptions of the process in XQuery and XSLT are better aligned. </p><p>See <a href="#xsd-validation"><b>17.2.4 XSD validation</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2031">2031&nbsp;</a></p><p> Introduced the concept of JNodes. </p><p>See <a href="#processing-jnodes"><b>16 Processing JNodes</b></a></p><p>New in 4.0</p><p>See <a href="#func-jtree"><b>16.1.1 fn:jtree</b></a></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-jnode-content"><b><span class="deltaxml-new" style="background:#90EE90">16.1.2 fn:jnode-content</span></b></a></p><p>See <a href="#func-jnode-selector"><b>16.1.3 fn:jnode-selector</b></a></p><p>See <a href="#func-jnode-position"><b>16.1.4 fn:jnode-position</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2149">2149&nbsp;</a></p><p>Generalized to work with JNodes as well as XNodes.</p><p>See <a href="#func-has-children"><b>12.2.1 fn:has-children</b></a></p><p>The function is extended to handle JNodes.</p><p>See <a href="#func-path"><b>12.2.9 fn:path</b></a></p><p>Generalized to work with JNodes as well as XNodes.</p><p>See <a href="#func-innermost"><b>12.3.2 fn:innermost</b></a></p><p>See <a href="#func-outermost"><b>12.3.3 fn:outermost</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2168">2168&nbsp;</a></p><p>Atomic items of types <code>xs:hexBinary</code> and <code>xs:base64Binary</code> are now mutually comparable. In rare cases, where an application uses both types and assumes they are distinct, this can represent a backwards incompatibility.</p><p>See <a href="#func-atomic-equal"><b>2.2.1 fn:atomic-equal</b></a></p><p>See <a href="#func-deep-equal"><b>2.2.4 fn:deep-equal</b></a></p><p>See <a href="#func-distinct-values"><b>2.2.5 fn:distinct-values</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2223">2223&nbsp;</a></p><p>An error may now be raised if the base URI is not a valid LEIRI reference.</p><p>See <a href="#func-base-uri"><b>12.1.1 fn:base-uri</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2224">2224&nbsp;</a></p><p>The <code>$action</code> callback function now accepts an optional position argument.</p><p>See <a href="#func-map-filter"><b>14.4.6 map:filter</b></a></p><p>See <a href="#func-map-for-each"><b>14.4.8 map:for-each</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2228">2228&nbsp;</a></p><p>New in 4.0</p><p>See <a href="#func-array-sort-with"><b>15.2.27 array:sort-with</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2249">2249&nbsp;</a></p><p>The specification now describes in more detail how to determine the effective encoding value.</p><p>See <a href="#func-unparsed-text"><b>17.1.5 fn:unparsed-text</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2256">2256&nbsp;</a></p><p>In the interests of consistency, the <a href="#func-index-of"><code>index-of</code></a> function now defines equality to mean <a title="contextually equal" class="termref" href="#dt-contextually-equal">contextually equal</a>. This has the implication that <code>NaN</code> is now considered equal to <code>NaN</code>.</p><p>See <a href="#func-index-of"><b>2.2.8 fn:index-of</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2259">2259&nbsp;</a></p><p>A new parameter <code>canonical</code> is available to give control over serialization of XML, XHTML, and JSON.</p><p>See <a href="#func-serialize"><b>17.2.3 fn:serialize</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2286">2286&nbsp;</a></p><p>The type of <code>$value</code> has been generalized to <code>xs:anyAtomicType?</code>.</p><p>See <a href="#func-string-length"><b>5.4.7 fn:string-length</b></a></p><p>See <a href="#func-normalize-space"><b>5.4.8 fn:normalize-space</b></a></p></li><li><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/2387">2387&nbsp;</a></p><p>It is now recommended that out-of-range <code>xs:double</code> values should translate to positive or negative infinity.</p><p>See <a href="#func-parse-json"><b>17.4.4 fn:parse-json</b></a></p></li></ol></div></div></div><script src="js/toc.js"></script><script src="/js/scroll.js"></script></body></html>
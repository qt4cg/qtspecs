<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XSLT and XQuery Serialization 4.0 </title><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" type="text/css" href="css/w3c-base.css"><link rel="stylesheet" href="css/qtspecs.css"><link rel="stylesheet" href="css/xslt-xquery-serialization-40.css"><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css"></head><body class="toc-inline"><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p><p>This draft contains only sections that have differences from the version that it modified.</p></div><div class="head"><p><a href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" height="48" width="72"></a></p><h1><a id="title"></a>XSLT and XQuery Serialization 4.0 </h1><h2><a id="w3c-doctype"></a>W3C Editor's Draft <span class="deltaxml-old" style="background:#FF5555">30&nbsp;January</span><span class="deltaxml-new" style="background:#90EE90">2&nbsp;February</span>&nbsp;2026</h2><dl><dt>This version:</dt><dd><a href="https://www.w3.org/TR/2000/REC-xslt-xquery-serialization-40-20000101/">https://www.w3.org/TR/2000/REC-xslt-xquery-serialization-40-20000101/</a></dd><dt>Latest version of XSLT and XQuery Serialization 4.0:</dt><dd><a href="https://www.w3.org/TR/xslt-xquery-serialization-40/">https://www.w3.org/TR/xslt-xquery-serialization-40/</a></dd><dt>Most recent version of XSLT and XQuery Serialization 4:</dt><dd><a href="https://www.w3.org/TR/xslt-xquery-serialization-4/">https://www.w3.org/TR/xslt-xquery-serialization-4/</a></dd><dt>Most recent version of XSLT and XQuery Serialization:</dt><dd><a href="https://www.w3.org/TR/xslt-xquery-serialization/">https://www.w3.org/TR/xslt-xquery-serialization/</a></dd><dt>Most recent Recommendation of XSLT and XQuery Serialization:</dt><dd><a href="https://www.w3.org/TR/xslt-xquery-serialization-31/">https://www.w3.org/TR/xslt-xquery-serialization-31/</a></dd><dt>Editor:</dt><dd>Michael Kay, Saxonica <a href="http://www.saxonica.com/">&lt;http://www.saxonica.com/&gt;</a></dd></dl><p>This document is also available in these non-normative formats: <a href="https://www.w3.org/TR/2000/REC-xslt-xquery-serialization-40-20000101/xslt-xquery-serialization-40.xml">XML</a>.</p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2000&nbsp;<a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr></div><div><h2><a id="abstract"></a>Abstract</h2><p>This document defines methods of serializing an instance of the data model defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> into a sequence of octets, conforming to a variety of formats including XML, HTML, and JSON. Serialization is designed to be a component that can be used either on its own, or invoked from languages such as <a href="#xslt-40">[XSLT 4.0]</a>, <a href="#xpath-40">[XPath 4.0]</a> or <a href="#xquery-40">[XQuery 4.0]</a>.</p></div><div><h2><a id="status"></a>Status of this Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document.</em></p><p>This document is a working draft developed and maintained by a W3C Community Group, the <a href="https://www.w3.org/community/xslt-40/">XQuery and XSLT Extensions Community Group</a> unofficially known as QT4CG (where "QT" denotes Query and Transformation). This draft is work in progress and should not be considered either stable or complete. Standard W3C copyright and patent conditions apply.</p><p>The community group welcomes comments on the specification. Comments are best submitted as issues on the group's <a href="https://github.com/qt4cg/qtspecs/issues">GitHub repository</a>.</p><p>The community group maintains two extensive test suites, one oriented to XQuery and XPath, the other to XSLT. These can be found at <a href="https://github.com/qt4cg/qt4tests">qt4tests</a> and <a href="https://github.com/qt4cg/xslt40-test">xslt40-test</a> respectively. New tests, or suggestions for correcting existing tests, are welcome. The test suites include extensive metadata describing the conditions for applicability of each test case as well as the expected results. They do not include any test drivers for executing the tests: each implementation is expected to provide its own test driver.</p><div class="dedication" id="dedication"><h3>Dedication</h3><p>The publications of this community group <a href="../xquery-40/xpath-40.html#dedication">are dedicated</a> to our co-chair, Michael Sperberg-McQueen&nbsp;(1954–2024).</p></div></div><hr><div class="body"><div class="_diffs div1"><h2><a id="intro"></a>1 <a href="#intro" style="text-decoration: none">Introduction</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#terminology">next</a>)</p><ol><li><p>If a section of this specification has been updated since version 3.1, an overview of the changes is provided, along with links to navigate to the next or previous change.</p></li><li><p>Sections with significant changes are marked with a ✭ symbol in the table of contents.</p></li></ol></div><p>This document defines methods of serializing the W3C XQuery and XPath Data Model 4.0 (<a href="#xpath-datamodel-40">[XDM 4.0]</a>), that is, methods of representing instances of the data model as strings or octet sequences. This is the data model used by <a href="#xpath-40">[XPath 4.0]</a>, <a href="#xslt-40">[XSLT 4.0]</a>, and <a href="#xquery-40">[XQuery 4.0]</a>, and any other specifications that reference it.</p><p>In this document, examples and material labeled as “Note” are provided for explanatory purposes and are not normative. </p><p>Serialization is the process of converting an instance of the <a href="#xpath-datamodel-40">[XDM 4.0]</a> into a sequence of octets.</p><p>[<a id="dt-input-value" title="input value">Definition</a>: The XDM value supplied as input to the serializer is referred to as the <b>input value</b>.] Some serialization methods apply only to certain types of input value.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>Where serialization is used to process the result of an XQuery evaluation or an XSLT transformation, the <a title="input value" class="termref" href="#dt-input-value">input value</a> of the serializer corresponds to the output from XQuery or XSLT.</p></div><p>[<a id="dt-input-tree" title="input tree">Definition</a>: In general the output of the serializer will represent the items actually present in the input value, together with other items that are reachable from these, for example (in the case of nodes) their descendants. The complete set of items that are represented in the output of the serializer is referred to (without loss of generality) as the <b>input tree</b>.]</p><div class="_diffs div2"><h3><a id="terminology"></a>1.1 <a href="#terminology" style="text-decoration: none">Terminology</a></h3><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#serparam">next</a> | <a href="#intro">previous</a>)</p><ol><li><p> The term <b>atomic value</b> has been replaced by <b>atomic item</b>. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1337">1337</a>&nbsp;&nbsp;2 August 2024]</i></p></li></ol></div><p>In this specification, where they are rendered in small capitals, the words <span class="verb">must</span>, <span class="verb">must not</span>, <span class="verb">should</span>, <span class="verb">should not</span>, <span class="verb">may</span>, <span class="verb">required</span>, and <span class="verb">recommended</span> are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p><p>[<a id="serializer" title="serializer">Definition</a>: As is indicated in <a href="#conformance"><b>12 Conformance</b></a>, conformance criteria for serialization are determined by other specifications that refer to this specification. A <b>serializer</b> is software that implements some or all of the requirements of this specification in accordance with such conformance criteria.] A serializer is not <span class="verb">required</span> to directly provide a programming interface that permits a user to set serialization parameters or to provide an input sequence for serialization. In this document, material labeled as "Note" and examples are provided for explanatory purposes and are not normative. </p><p>Certain aspects of serialization are described in this specification as <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> or <a title="implementation-dependent" class="termref" href="#impdep">implementation-dependent</a>.</p><p> [<a id="impdef" title="implementation-defined">Definition</a>: <b>Implementation-defined</b> indicates an aspect that <span class="verb">may</span> differ between <a title="serializer" class="termref" href="#serializer">serializers</a>, but whose actual behavior <span class="verb">must</span> be specified either by another specification that sets conformance criteria for serialization (see <a href="#conformance"><b>12 Conformance</b></a>) or in documentation that accompanies the <a title="serializer" class="termref" href="#serializer">serializer</a>.]</p><p> [<a id="impdep" title="implementation-dependent">Definition</a>: <b>Implementation-dependent</b> indicates an aspect that <span class="verb">may</span> differ between <a title="serializer" class="termref" href="#serializer">serializers</a>, and whose actual behavior is not <span class="verb">required</span> to be specified either by another specification that sets conformance criteria for serialization (see <a href="#conformance"><b>12 Conformance</b></a>) or in documentation that accompanies the <a title="serializer" class="termref" href="#serializer">serializer</a>.]</p><p> [<a id="serial-err" title="serialization error">Definition</a>: In some instances, the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> cannot be successfully converted into a sequence of octets given the set of serialization parameter (<a href="#serparam"><b>3 Serialization Parameters</b></a>) values specified. A <b>serialization error</b> is said to occur in such an instance.] In some cases, a <a title="serializer" class="termref" href="#serializer">serializer</a> is <span class="verb">required</span> to <b>raise</b> such an error. What it means to raise a serialization error is determined by the relevant conformance criteria (<a href="#conformance"><b>12 Conformance</b></a>) to which the <a title="serializer" class="termref" href="#serializer">serializer</a> conforms. In other cases, there is an <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> choice between raising a serialization error and performing a recovery action. Such a recovery action will allow a <a title="serializer" class="termref" href="#serializer">serializer</a> to produce a sequence of octets that might not fully reflect the usual requirements of the parameter settings that are in effect. </p><p> [<a id="caseless-compare" title="without regard to case">Definition</a>: Where this specification indicates that two strings are to be compared <b>without regard to case</b>, the <a title="serializer" class="termref" href="#serializer">serializer</a><span class="verb">must</span> translate any characters in the range <span class="unicode-codepoint">U+0041</span> (<span class="unicode-name">LATIN CAPITAL LETTER A</span>, <code>A</code>) through <span class="unicode-codepoint">U+005A</span> (<span class="unicode-name">LATIN CAPITAL LETTER Z</span>, <code>Z</code>) inclusive, to the corresponding lower-case letters in the range <span class="unicode-codepoint">U+0061</span> (<span class="unicode-name">LATIN SMALL LETTER A</span>, <code>a</code>) through <span class="unicode-codepoint">U+007A</span> (<span class="unicode-name">LATIN SMALL LETTER Z</span>, <code>z</code>) only for the purposes of making the comparison. The comparison succeeds if the two strings are the same length and the code point of each character in the first string is equal to the code point of the character in the corresponding position in the second string.] </p><p>Many terms used in this document are defined in the XPath specification <a href="#xpath-40">[XPath 4.0]</a> or the Data Model specification <a href="#xpath-datamodel-40">[XDM 4.0]</a>. Particular attention is drawn to the following:</p><ul><li><p>[<a id="dt-atomization" title="atomize">Definition</a>: The term <b>atomization</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-atomization">2.6.3 Atomization</a>.]</p></li><li><p>[<a id="dt-node" title="node">Definition</a>: The term <b>node</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. There are seven kinds of <a title="node" class="termref" href="#dt-node">nodes</a> in the data model: document, element, attribute, text, namespace, processing instruction, and comment.]</p></li><li><p>[<a id="dt-sequence" title="sequence">Definition</a>: The term <b>sequence</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. A <a title="sequence" class="termref" href="#dt-sequence">sequence</a> is an ordered collection of zero or more items.]</p></li><li><p>[<a id="dt-function-item" title="function item">Definition</a>: The term <b>function item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#function-items">8.1 Function Items</a>.]</p></li><li><p>[<a id="dt-map-item" title="map item">Definition</a>: The term <b>map item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#map-items">8.2 Map Items</a>.]</p></li><li><p>[<a id="dt-array-item" title="array item">Definition</a>: The term <b>array item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#array-items">8.3 Array Items</a>.]</p></li><li><p>[<a id="dt-string" title="string">Definition</a>: The term <b>string</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.]</p></li><li><p>[<a id="dt-character" title="character">Definition</a>: The term <b>character</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.]</p></li><li><p>[<a id="dt-codepoint" title="codepoint">Definition</a>: The term <b>codepoint</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.]</p></li><li><p>[<a id="dt-string-value" title="string value">Definition</a>: The term <b>string value</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#dm-string-value">7.6.12 string-value Accessor</a>. Every <a title="node" class="termref" href="#dt-node">node</a> has a <a title="string value" class="termref" href="#dt-string-value">string value</a>. For example, the <a title="string value" class="termref" href="#dt-string-value">string value</a> of an element is the concatenation of the <a title="string value" class="termref" href="#dt-string-value">string values</a> of all its descendant text <a title="node" class="termref" href="#dt-node">nodes</a>.]</p></li><li><p>[<a id="dt-expanded-qname" title="expanded QName">Definition</a>: The term <b>expanded QName</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded QName</a> consists of an optional namespace URI and a local name. An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded QName</a> also retains its original namespace prefix (if any), to facilitate casting the expanded QName into a string.]</p></li><li><p><span style="display: none;" class="delete_version">[<a id="null-namespace-URI" title="null namespace URI">Definition</a>: An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is an empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b>].</span><span style="display: none;" class="add_version">[<a id="null-namespace-URI" title="null namespace URI">Definition</a>: An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is the empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b>].</span><span class="modify_version">[<a id="null-namespace-URI" title="null namespace URI">Definition</a>: An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b>].</span></p></li><li><p>[<a id="non-null-namespace-URI" title="non-null namespace URI">Definition</a>: An element or attribute that does not have a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a>, is referred to as having a <b>non-null namespace URI</b>].</p></li><li><p> [<a id="whitespace-char" title="whitespace character">Definition</a>: A space character, TAB character, CR character or NL character is referred to as a <b>whitespace character</b>.]</p></li></ul><p>Where this specification indicates that an XSLT instruction is evaluated, the behavior is as specified by <a href="#xslt-40">[XSLT 4.0]</a>. Where it indicates that an XQuery expression is evaluated, the behavior is as specified by <a href="#xquery-40">[XQuery 4.0]</a>.</p></div></div><div class="_diffs div1"><h2><a id="serparam"></a>3 <a href="#serparam" style="text-decoration: none">Serialization Parameters</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#xhtml-output">next</a> | <a href="#terminology">previous</a>)</p><ol><li><p> Added the <code>escape-solidus</code> parameter for JSON serialization. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/530">530</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/534">534</a>&nbsp;6 June 2023]</i></p></li><li><p> Added the <code>json-lines</code> parameter for JSON serialization. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1471">1471</a>&nbsp;&nbsp;15 October 2024]</i></p></li><li><p> Added the <code>canonical</code> parameter for XML, XHTML, and JSON serialization. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/938">938</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/TODO">TODO</a>&nbsp;20 October 2025]</i></p></li></ol></div><p>There are a number of parameters that influence how serialization is performed. <a title="host language" class="termref" href="#host-language">Host languages</a><span class="verb">may</span> allow users to specify any or all of these parameters, but they are not <span class="verb">required</span> to be able to do so. However, the <a title="host language" class="termref" href="#host-language">host language</a> specification <span class="verb">must</span> specify how the values of all applicable parameters are to be determined. </p><p>Host languages may also define alternative representations of the values of serialization parameters. For example, both XSLT and XQuery allow the boolean values <code>true</code> and <code>false</code> to be written as <code>1</code>/<code>0</code> or <code>yes</code>/<code>no</code>. The <code>$options</code> map passed to the <code>fn:serialize</code> function, by contrast, requires an <code>xs:boolean</code> value.</p><p>It is a <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0016" title="err:SEPM0016">err:SEPM0016</a>] if a parameter value is invalid for the given parameter. It is the responsibility of the <a title="host language" class="termref" href="#host-language">host language</a> to specify how invalid values should be handled at the level of that language.</p><p>The following serialization parameters are defined:</p><table style="border:1px solid" class="medium no-code-break"><caption>Serialization parameters</caption><thead><tr><th style="text-align:left">Serialization parameter name</th><th style="text-align:left">Permitted values for parameter</th></tr></thead><tbody><tr><td style="vertical-align:top"><code>allow-duplicate-names</code></td><td>A boolean value, <code>true</code> or <code>false</code>. This parameter indicates whether a map item serialized as a JSON object using the JSON output method is allowed to contain duplicate member names. If the value <code>false</code> is specified, a serialization error [<a href="#ERRSERE0022" title="err:SERE0022">err:SERE0022</a>] may be raised under certain conditions.</td></tr><tr><td style="vertical-align:top"><code>byte-order-mark</code></td><td>A boolean value, <code>true</code> or <code>false</code>. This parameter indicates whether the serialized sequence of octets is to be preceded by a Byte Order Mark (See Section 5.1 of <a href="#UNICODE-ENCODING">[Unicode Encoding]</a>). The actual octet order used is <a title="implementation-dependent" class="termref" href="#impdep">implementation-dependent</a>. If the encoding defines no Byte Order Mark, or if the Byte Order Mark is prohibited for the specific encoding or implementation environment, then this parameter is ignored.</td></tr><tr><td style="vertical-align:top"><code>canonical</code></td><td>A boolean value, <code>true</code> or <code>false</code>.</td></tr><tr><td style="vertical-align:top"><code>cdata-section-elements</code></td><td>A list of expanded QNames, possibly empty.</td></tr><tr><td style="vertical-align:top"><code>doctype-public</code></td><td>A string of <a href="https://www.w3.org/TR/REC-xml/#NT-PubidChar">PubidChar</a><sup><small>XML</small></sup> characters. This parameter <span class="verb">may</span> be absent.</td></tr><tr><td style="vertical-align:top"><code>doctype-system</code></td><td>A string of Unicode characters that does not include both the characters <span class="unicode-codepoint">U+0027</span> (<span class="unicode-name">APOSTROPHE</span>, <code>'</code>) and <span class="unicode-codepoint">U+0022</span> (<span class="unicode-name">QUOTATION MARK</span>, <code>"</code>) . This parameter <span class="verb">may</span> be absent.</td></tr><tr><td style="vertical-align:top"><code>encoding</code></td><td>A string of Unicode characters in the range <span class="unicode-codepoint">U+0021</span> (<span class="unicode-name">EXCLAMATION MARK</span>, <code>!</code>) through <span class="unicode-codepoint">U+007E</span> (<span class="unicode-name">TILDE</span>, <code>~</code>) (that is, printable ASCII characters); the value <span class="verb">should</span> be a charset registered with the Internet Assigned Numbers Authority <a href="#IANA">[IANA]</a>, <a href="#RFC2978">[RFC2978]</a> or begin with the characters <code>x-</code> or <code>X-</code>.</td></tr><tr><td style="vertical-align:top"><code>escape-solidus</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>escape-uri-attributes</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>html-version</code></td><td>A decimal value. This parameter <span class="verb">may</span> be absent.</td></tr><tr><td style="vertical-align:top"><code>include-content-type</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>indent</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>item-separator</code></td><td>A string of Unicode characters. This parameter <span class="verb">may</span> be absent.</td></tr><tr><td style="vertical-align:top"><code>json-lines</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>json-node-output-method</code></td><td>An expanded QName with a <a title="non-null namespace URI" class="termref" href="#non-null-namespace-URI">non-null namespace URI</a>, or with a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a> and a local name equal to one of <code>xml</code>, <code>xhtml</code>, <code>html</code> or <code>text</code>. If the namespace URI is non-null, the parameter specifies an <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> output method.</td></tr><tr><td style="vertical-align:top"><code>media-type</code></td><td>A string of Unicode characters specifying the media type (MIME content type) <a href="#RFC2046">[RFC2046]</a>; the charset parameter of the media type <span class="verb">must not</span> be specified explicitly in the value of the <code>media-type</code> parameter. If the destination of the serialized output is annotated with a media type, this parameter <span class="verb">may</span> be used to provide such an annotation. For example, it <span class="verb">may</span> be used to set the media type in an HTTP header.</td></tr><tr><td style="vertical-align:top"><code>method</code></td><td>An expanded QName with a <a title="non-null namespace URI" class="termref" href="#non-null-namespace-URI">non-null namespace URI</a>, or with a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a> and a local name that <span class="verb">must</span> be equal to one of <code>xml</code>, <code>xhtml</code>, <code>html</code>, <code>text</code>, <code>json</code>, or <code>adaptive</code>, in which case, the output method specified <span class="verb">must</span> be used for serializing. If the namespace URI is non-null, the parameter specifies an <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> output method; its behavior is not specified by this document.</td></tr><tr><td style="vertical-align:top"><code>normalization-form</code></td><td>One of the enumerated values <code>NFC</code>, <code>NFD</code>, <code>NFKC</code>, <code>NFKD</code>, <code>fully-normalized</code> or <code>none</code>, or an <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> value of type <code>NMTOKEN</code>.</td></tr><tr><td style="vertical-align:top"><code>omit-xml-declaration</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>standalone</code></td><td>Either a boolean value, <code>true</code> or <code>false</code>, or the value or <code>omit</code>.</td></tr><tr><td style="vertical-align:top"><code>suppress-indentation</code></td><td>A list of expanded QNames, possibly empty.</td></tr><tr><td style="vertical-align:top"><code>undeclare-prefixes</code></td><td>A boolean value, <code>true</code> or <code>false</code>. </td></tr><tr><td style="vertical-align:top"><code>use-character-maps</code></td><td>A list of pairs, possibly empty, with each pair consisting of a single Unicode character and a string of Unicode characters.</td></tr><tr><td style="vertical-align:top"><code>version</code></td><td>A string of Unicode characters. This parameter <span class="verb">may</span> be absent.</td></tr></tbody></table><p>In those cases where they have no important effect on the content of the serialized result, details of the output methods defined by this specification are left unspecified and are regarded as <a title="implementation-dependent" class="termref" href="#impdep">implementation-dependent</a>. Whether a <a title="serializer" class="termref" href="#serializer">serializer</a> uses apostrophes or quotation marks to delimit attribute values in the XML output method is an example of such a detail.</p><p>The detailed semantics of each parameter will be described separately for each output method for which it is applicable. If the semantics of a parameter are not described for an output method, then it is not applicable to that output method.</p><p>Implementations <span class="verb">may</span> define additional serialization parameters, and <span class="verb">may</span> allow users to do so. For this purpose, the name of a serialization parameter is considered to be a QName; the parameters listed above are QNames whose <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> has a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a>, while any additional serialization parameters that are either <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> or defined by the <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">must</span> have names that are namespace-qualified. Any such additional serialization parameters <span class="verb">must not</span> be in the namespace <code>https://www.w3.org/2010/xslt-xquery-serialization</code>. A <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">may</span> specify the means by which an implementation can define such an additional serialization parameter, and implementations <span class="verb">may</span> provide mechanisms by which users can define such an additional serialization parameter. If the serialization method is one of the six methods <code>xml</code>, <code>html</code>, <code>xhtml</code>, <code>text</code>, <code>json</code>, or <code>adaptive</code> then the additional serialization parameters <span class="verb">may</span> affect the output of the <a title="serializer" class="termref" href="#serializer">serializer</a> to the extent (but only to the extent) that this specification leaves the output <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> or <a title="implementation-dependent" class="termref" href="#impdep">implementation-dependent</a>. For example, such parameters might control whether namespace declarations on an element are written before or after the attributes of the element, or they might define the number of space or tab characters to be inserted when the <code>indent</code> parameter is set to <code>true</code>; but they could not instruct the <a title="serializer" class="termref" href="#serializer">serializer</a> to suppress the error that occurs when the HTML output method encounters characters that are not permitted (see error [<a href="#ERRSERE0014" title="err:SERE0014">err:SERE0014</a>]).</p><div class="_diffs div2"><h3><a id="serparams-in-xdm-instance"></a>3.1 <a href="#serparams-in-xdm-instance" style="text-decoration: none">Setting Serialization Parameters by Means of a Parameter Document</a></h3><p><span style="display: none;" class="delete_version">A <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">may</span> provide, by reference to this section, a mechanism by which the settings of serialization parameters are supplied in the form of an <span><code>output:serialization-parameters</code> element node.</span></span><span style="display: none;" class="add_version">A <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">may</span> provide, by reference to this section, a mechanism by which the settings of serialization parameters are supplied in the form of an <code>output:serialization-parameters</code> element node.</span><span class="modify_version">A <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">may</span> provide, by reference to this section, a mechanism by which the settings of serialization parameters are supplied in the form of an <code>output:serialization-parameters</code> element node.</span></p><div class="note"><p class="prefix"><b><span class="deltaxml-new" style="background:#90EE90">Note:</span></b></p><p><span class="deltaxml-new" style="background:#90EE90">The namespace prefix </span><code><span class="deltaxml-new" style="background:#90EE90">output</span></code><span class="deltaxml-new" style="background:#90EE90"> is assumed to be bound to the namespace URI </span><code><span class="deltaxml-new" style="background:#90EE90">http://www.w3.org/2010/xslt-xquery-serialization</span></code><span class="deltaxml-new" style="background:#90EE90">. The document may use any namespace prefix or none.</span></p></div><p>[<a id="dt-parameter-document" title="parameter document">Definition</a>: An <code>output:serialization-parameters</code> element node used to hold the settings of serialization parameters is referred to as a <b>parameter document</b>].</p><div class="note"><p class="prefix"><b>Note:</b></p><p>The use of the word <b>document</b> does not imply that the <code>output:serialization-parameters</code> element must be the outermost element of an XDM document, although this will often be the case.</p></div><p>The <span><a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span><span class="verb">must</span> be processed as if by the procedure described below.</p><p>With the exception of the <code>use-character-maps</code> parameter, the setting of each serialization parameter defined in this specification is equal to the result of evaluating the XQuery expression</p><div class="exampleInner"><pre xml:space="preserve">document { . } 
   /output:serialization-parameters
   /(validate lax { 
      output:*[local-name() eq $param-name] 
   })
   /data(@value)</pre></div><p> or equivalently the XSLT instructions </p><div class="exampleInner"><pre xml:space="preserve">&lt;xsl:sequence&gt;
  &lt;xsl:variable name="validated-instance"&gt;
    &lt;xsl:document validation="lax"&gt;
      &lt;xsl:sequence select="
        self::output:serialization-parameters
        /output:*
       [local-name() eq $param-name]"/&gt;
    &lt;/xsl:document&gt;
  &lt;/xsl:variable&gt;
  &lt;xsl:sequence select="$validated-instance
                        /data(@value)"/&gt;
&lt;/xsl:sequence&gt;</pre></div><p>with the <span><a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span> as the <span>context value</span>, the <code>param-name</code> variable <span>bound to</span> a value of type <code>xs:string</code> equal to the local part of the name of the particular serialization parameter, and the other components of the dynamic context and static context as specified in the subsequent tables. If in any case evaluating this expression would yield an error, <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0017" title="err:SEPM0017">err:SEPM0017</a>] results.</p><p>If the result of evaluating this expression for a particular serialization parameter is the empty sequence, then</p><ol class="enumar"><li><p>If the parameter is either <code>cdata-section-elements</code> or <code>suppress-indentation</code>, and the result of evaluating the XQuery expression</p><div class="exampleInner"><pre xml:space="preserve">document { . }
/output:serialization-parameters
/(validate lax {  
   output:*[local-name() eq $param-name]
})</pre></div><p> or equivalently the XSLT instructions </p><div class="exampleInner"><pre xml:space="preserve">&lt;xsl:sequence&gt;
  &lt;xsl:variable name="validated-instance"&gt;
    &lt;xsl:document select="." validation="lax"&gt;
      &lt;xsl:sequence select="
        self::output:serialization-parameters
        /output:*
       [local-name() eq $param-name]"/&gt;
    &lt;/xsl:document&gt;
  &lt;/xsl:variable&gt;
  &lt;xsl:sequence select="$validated-instance"/&gt;
&lt;/xsl:sequence&gt;</pre></div><p>with the same settings of the static context and dynamic context is not <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, the setting of the parameter is the empty list;</p></li><li><p>otherwise, the setting of the parameter is absent.</p></li></ol><p>The components of the static context used in evaluating the XQuery expressions or XSLT instructions are as defined in the following table.</p><table style="border:1px solid" class="medium no-code-break"><caption>Settings of static context components used in extracting serialization parameter settings from a parameter document</caption><thead><tr><th>Static Context Component</th><th>XQuery or XSLT</th><th>Setting</th></tr></thead><tbody><tr><td>XPath 1.0 compatibility mode</td><td>Both</td><td>false</td></tr><tr><td rowspan="2">Statically known namespaces</td><td>XQuery</td><td>The pair (output,http://www.w3.org/2010/xslt-xquery-serialization) </td></tr><tr><td>XSLT</td><td>The pairs (output,http://www.w3.org/2010/xslt-xquery-serialization), (xsl,http://www.w3.org/1999/XSL/Transform) </td></tr><tr><td>Default element/type namespace</td><td>Both</td><td>"none"</td></tr><tr><td>Default function namespace</td><td>Both</td><td>http://www.w3.org/2005/xpath-functions</td></tr><tr><td>In-scope schema types, In-scope element declarations, Substitution groups, In-scope attribute declarations</td><td>Both</td><td>As defined by the schema for serialization parameters (<a href="#serparams-schema"><b>B Schema for Serialization Parameters</b></a>) and any additional <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> in-scope schema components </td></tr><tr><td>In-scope variables</td><td>Both</td><td>{param-name}</td></tr><tr><td><span>Context value</span> static type</td><td>Both</td><td><code>node()</code></td></tr><tr><td>Statically known function signatures</td><td>Both</td><td>{<code>fn:data($arg as item()*) as xs:anyAtomicType*</code>}, {<code>fn:local-name($arg as node()?) as xs:string</code>}</td></tr><tr><td>Statically known collations</td><td>Both</td><td> { (http://www.w3.org/2005/xpath-functions/collation/codepoint, The Unicode codepoint collation ) } </td></tr><tr><td>Default collation</td><td>Both</td><td>The Unicode codepoint collation</td></tr><tr><td>Construction mode</td><td>XQuery</td><td>strip</td></tr><tr><td>Ordering mode</td><td>XQuery</td><td>ordered</td></tr><tr><td>Default order for empty sequences</td><td>XQuery</td><td>least</td></tr><tr><td>Boundary space policy</td><td>XQuery</td><td>strip</td></tr><tr><td>Copy-namespaces mode</td><td>XQuery</td><td>(preserve,inherit)</td></tr><tr><td>Base URI</td><td>Both</td><td>Absent</td></tr><tr><td>Statically known documents</td><td>Both</td><td>None</td></tr><tr><td>Statically known collections</td><td>Both</td><td>None</td></tr><tr><td>Statically known default collection type</td><td>Both</td><td><code>node()*</code></td></tr><tr><td>Statically known decimal formats</td><td>Both</td><td>None</td></tr><tr><td>Set of named keys</td><td>XSLT</td><td>{}</td></tr><tr><td>Values of system properties</td><td>XSLT</td><td>None</td></tr><tr><td>Set of available instructions</td><td>XSLT</td><td>The set of all instructions defined by <a href="#xslt-40">[XSLT 4.0]</a></td></tr></tbody></table><p>The remaining components of the dynamic context used in evaluating the XQuery expressions or XSLT instructions in the preceding table are as defined in the following table.</p><table style="border:1px solid" class="medium no-code-break"><caption>Settings of dynamic context components used in extracting serialization parameter settings from a parameter document</caption><thead><tr><th>Dynamic Context Component</th><th>XQuery or XSLT</th><th>Setting</th></tr></thead><tbody><tr><td>Context position</td><td>Both</td><td>1</td></tr><tr><td>Context size</td><td>Both</td><td>1</td></tr><tr><td>Variable values</td><td>Both</td><td>The <code>param-name</code> variable has a value of type <code>xs:string</code> equal to the local part of the name of the serialization parameter under consideration</td></tr><tr><td>Function implementations</td><td>Both</td><td>The implementation of <code>fn:data</code></td></tr><tr><td>Current dateTime</td><td>Both</td><td>Absent</td></tr><tr><td>Implicit timezone</td><td>Both</td><td>Absent</td></tr><tr><td>Available documents</td><td>Both</td><td>None</td></tr><tr><td>Available collections</td><td>Both</td><td>None</td></tr><tr><td>Default collection</td><td>Both</td><td>None</td></tr><tr><td>Current template rule</td><td>XSLT</td><td>Absent</td></tr><tr><td>Current mode</td><td>XSLT</td><td>The default mode</td></tr><tr><td>Current group</td><td>XSLT</td><td>Absent</td></tr><tr><td>Current grouping key</td><td>XSLT</td><td>Absent</td></tr><tr><td>Current captured substrings</td><td>XSLT</td><td>The empty sequence</td></tr><tr><td>Output state</td><td>XSLT</td><td>Temporary output state</td></tr></tbody></table><p>In the case of the <code>use-character-maps</code> parameter, the XQuery expression</p><div class="exampleInner"><pre xml:space="preserve">document { . }
/output:serialization-parameters
/ ( validate lax { output:use-character-maps } )
/output:character-map[@character eq $char]
/string(@map-string)</pre></div><p> or equivalently the XSLT instructions </p><div class="exampleInner"><pre xml:space="preserve">&lt;xsl:sequence&gt;
  &lt;xsl:variable name="validated-instance"&gt;
    &lt;xsl:document validation="lax"&gt;
      &lt;xsl:sequence select="
        self::output:serialization-parameters
         /output:use-character-maps"/&gt;
    &lt;/xsl:document&gt;
  &lt;/xsl:variable&gt;
  &lt;xsl:sequence select="$validated-instance                          
                        /output:character-map
                        [@character eq $char]
                        /string(@map-string)"/&gt;
&lt;/xsl:sequence&gt;</pre></div><p><span style="display: none;" class="delete_version">is evaluated for each Unicode character that is permitted in an XML document. The dynamic context and static context used to evaluate the expression are as defined above, except that the component <code>In-scope variables</code> is the set {<code>char</code>} and the value of the variable "<code>char</code>" is a value of type <code>xs:string</code> of length one whose value is the Unicode character under consideration. If the result of evaluating the expression is not an empty sequence, the pair consisting of the Unicode character and the result of evaluating the expression is part of the list of pairs in the value of the <code>use-character-maps</code> parameter. It is a <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0018" title="err:SEPM0018">err:SEPM0018</a>] if the result of evaluating this expression for any character is a sequence of length greater than one.</span><span style="display: none;" class="add_version">is evaluated for each Unicode character that is permitted in an XML document. The dynamic context and static context used to evaluate the expression are as defined above, except that the component <code>In-scope variables</code> is the set {<code>char</code>} and the value of the variable "<code>char</code>" is a value of type <code>xs:string</code> of length one whose value is the Unicode character under consideration. If the result of evaluating the expression is not the empty sequence, the pair consisting of the Unicode character and the result of evaluating the expression is part of the list of pairs in the value of the <code>use-character-maps</code> parameter. It is a <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0018" title="err:SEPM0018">err:SEPM0018</a>] if the result of evaluating this expression for any character is a sequence of length greater than one.</span><span class="modify_version">is evaluated for each Unicode character that is permitted in an XML document. The dynamic context and static context used to evaluate the expression are as defined above, except that the component <code>In-scope variables</code> is the set {<code>char</code>} and the value of the variable "<code>char</code>" is a value of type <code>xs:string</code> of length one whose value is the Unicode character under consideration. If the result of evaluating the expression is not <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, the pair consisting of the Unicode character and the result of evaluating the expression is part of the list of pairs in the value of the <code>use-character-maps</code> parameter. It is a <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0018" title="err:SEPM0018">err:SEPM0018</a>] if the result of evaluating this expression for any character is a sequence of length greater than one.</span></p><p>Using the same settings of the components of the dynamic context and static context, <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSEPM0019" title="err:SEPM0019">err:SEPM0019</a>] results if the result of evaluating the following XQuery expression is not true </p><div class="exampleInner"><pre xml:space="preserve">(document { . })/output:serialization-parameters
   /(count(distinct-values(*/node-name(.))) eq (count(*)))</pre></div><p> or equivalently if the result of evaluating the following XSLT instructions is not true. </p><div class="exampleInner"><pre xml:space="preserve">&lt;xsl:sequence&gt;
  &lt;xsl:variable name="doc"&gt;
    &lt;xsl:document&gt;
      &lt;xsl:sequence select="."/&gt;
    &lt;/xsl:document&gt;
  &lt;/xsl:variable&gt;
  &lt;xsl:sequence
    select="$doc/output:serialization-parameters
                /(count(distinct-values(
                    */node-name(.))) 
                eq (count(*)))"/&gt;
&lt;/xsl:sequence&gt;</pre></div><p>The result of evaluating either will be false if the <span><a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span> supplies a value for any particular serialization parameter more than once, or will be the empty sequence if the <span><a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span><span> is not an element node whose local name is <code>serialization-parameters</code> and whose namespace URI is <code>http://www.w3.org/2010/xslt-xquery-serialization</code>.</span></p><div class="note"><p class="prefix"><b>Note:</b></p><p>A <a title="serializer" class="termref" href="#serializer">serializer</a> or implementation of a <a title="host language" class="termref" href="#host-language">host language</a> does not need to be accompanied by an XQuery processor nor by a general-purpose schema validator in order to meet the requirements of this section. It merely needs to be capable of extracting values from an XDM instance that conforms to the schema for serialization parameters, while checking that the constraints implied by the schema and additional constraints implied by the XQuery validate expression or explicitly stated in this section are satisfied.</p></div><p>The <a title="host language" class="termref" href="#host-language">host language</a><span class="verb">may</span> provide additional mechanisms for overriding the values of any serialization parameters specified through the mechanism defined in this section, as well as additional mechanisms for specifying the values of any serialization parameters whose values are absent after applying the mechanism defined in this section.</p><p>If the <span><a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span> contains elements or attributes that are in a namespace other than <code>http://www.w3.org/2010/xslt-xquery-serialization</code>, the implementation <span class="verb">may</span> interpret them to specify the values of <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> serialization parameters in an <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> manner.</p><div class="example"><p>The following XML document, if <span>parsed as a <a title="parameter document" class="termref" href="#dt-parameter-document">parameter document</a></span> and processed using the mechanism described in this section, would specify the settings of the <code>method</code>, <code>version</code> and <code>indent</code> serialization parameters with the values <code>xml</code>, <code>1.0</code> and <code>true</code>, respectively. </p><div class="exampleInner"><pre xml:space="preserve">&lt;output:serialization-parameters 
    xmlns:output 
    = "http://www.w3.org/2010/xslt-xquery-serialization"&gt;
  &lt;output:method value="xml"/&gt;
  &lt;output:version value="1.0"/&gt;
  &lt;output:indent value="yes"/&gt;
&lt;/output:serialization-parameters&gt;</pre></div><p>The following document would specify the value of the <code>cdata-section-elements</code> serialization parameter with value equal to the pair of expanded QNames (<code>http://example.org/book/chapter</code>,<code>heading</code>) and (<code>http://example.org/book</code>,<code>footnote</code>)</p><div class="exampleInner"><pre xml:space="preserve">&lt;output:serialization-parameters
    xmlns:output
    = "http://www.w3.org/2010/xslt-xquery-serialization"
    xmlns:book="http://example.org/book"
    xmlns="http://example.org/book/chapter"&gt;
  &lt;output:cdata-section-elements value="heading book:footnote"/&gt;
&lt;/output:serialization-parameters&gt;</pre></div><p>The following document would specify the value of the <code>method</code> serialization parameter with the value <code>html</code>.</p><p>Notice that in this example, the default namespace declaration in scope has no effect on the interpretation of the setting of the <code>method</code> parameter.</p><div class="exampleInner"><pre xml:space="preserve">&lt;output:serialization-parameters
    xmlns:output
    = "http://www.w3.org/2010/xslt-xquery-serialization"
    xmlns="http://example.org/ext"&gt;
  &lt;output:method value="html"/&gt;
&lt;/output:serialization-parameters&gt;</pre></div><p>The following document would specify the value of the <code>method</code> serialization parameter with value equal to the expanded QName (<code>http://example.org/ext</code>, <code>jsp</code>), and the <code>use-character-maps</code> parameter with value equal to the list of pairs, <code>(«, &lt;%), (», %&gt;)</code>.</p><div class="exampleInner"><pre xml:space="preserve">&lt;output:serialization-parameters
    xmlns:output
    = "http://www.w3.org/2010/xslt-xquery-serialization"
    xmlns:ext="http://example.org/ext"&gt;
  &lt;output:method value="ext:jsp"/&gt;
  &lt;output:use-character-maps&gt;
    &lt;output:character-map character="&amp;#xAB;" map-string="&amp;lt;%"/&gt;
    &lt;output:character-map character="&amp;#xBB;" map-string="%&amp;gt;"/&gt;
  &lt;/output:use-character-maps&gt;
&lt;/output:serialization-parameters&gt;</pre></div></div></div></div><div class="_diffs div1"><h2><a id="html-output"></a>7 <a href="#html-output" style="text-decoration: none">HTML Output Method</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#HTML_COMMENTS_AND_PIS">next</a> | <a href="#xhtml-output">previous</a>)</p><ol><li><p>In the HTML and XHTML output methods, the rules for adding and replacing <code>meta</code> elements have been revised to take account of the new HTML5 syntax, for example <code>&lt;meta charset="UTF-8"&gt;</code>.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/318">318</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/342">342</a>&nbsp;14 February 2023]</i></p></li><li><p>The default HTML version is now 5. This may result in changes to the serialized output in cases where no explicit HTML version is requested.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1889">1889</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1977">1977</a>&nbsp;2 May 2025]</i></p></li></ol></div><p>The HTML output method serializes the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> as HTML.</p><div class="example"><p>For example, the following XSL stylesheet generates html output,</p><div class="exampleInner"><pre xml:space="preserve">&lt;xsl:stylesheet version="2.0" 
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
&lt;xsl:output method="html" version="4.0"/&gt;
&lt;xsl:template match="/"&gt;
  &lt;html&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/html&gt;
&lt;/xsl:template&gt;
...
&lt;/xsl:stylesheet&gt;</pre></div></div><p>In the example, the <code>version</code> attribute of the <code>xsl:output</code> element indicates the version of the HTML Recommendation <a href="#html401">[HTML]</a> to which the serialized result is to conform.</p><p>[<a id="req-html-ver" title="requested HTML version">Definition</a>: The <b>requested HTML version</b> is the value of the <code>html-version</code> serialization parameter if present; otherwise the value of the <code>version</code> serialization parameter if present; otherwise <code>5.0</code>.]</p><p>This document provides the normative definition of serialization for the HTML output method if the <a title="requested HTML version" class="termref" href="#req-html-ver">requested HTML version</a> has the lexical form of a value of type decimal whose value is 1.0 or greater, but no greater than 5.0. For any other requested HTML version, the behavior is <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a>. In that case the <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a> behavior <span class="verb">may</span> supersede all other requirements of this recommendation.</p><p>An implementation is required to behave as specified in this document when the requested version is <code>5.0</code>. If the requested version is greater than or equal to <code>1</code> but less than <code>5.0</code>, then the processor <span class="verb">may</span> behave as if the requested version were <code>5.0</code>.</p><p>It is entirely the responsibility of the supplier of the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> to ensure that it conforms to the relevant HTML specification. It is not an error if the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is invalid HTML. Equally, it is entirely under the control of the supplier of the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> whether the output conforms to HTML. If the result tree is valid HTML, the <a title="serializer" class="termref" href="#serializer">serializer</a><span class="verb">must</span> serialize the result in a way that conforms with the <a title="requested HTML version" class="termref" href="#req-html-ver">requested HTML version</a>.</p><div class="_diffs div2"><h3><a id="HTML_COMMENTS_AND_PIS"></a>7.4 <a href="#HTML_COMMENTS_AND_PIS" style="text-decoration: none">Writing Comments and Processing Instructions</a></h3><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#json-output">next</a> | <a href="#html-output">previous</a>)</p><ol><li><p>The way processing instructions are handled when generating HTML5 has changed, reflecting the fact that HTML5 no longer recognizes processing instructions.<i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/2344">2344</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/2372">2372</a>&nbsp;20 January 2026]</i></p></li></ol></div><p>Comment nodes are written as HTML comments, using the syntax <code>&lt;!--comment--&gt;</code>.</p><p><a title="prior to HTML5" class="termref" href="#id-prior-to-html5">Prior to HTML5</a>, the HTML output method <span class="verb">must</span> terminate processing instructions with <code>&gt;</code> rather than <code>?&gt;</code>. It is a <a title="serialization error" class="termref" href="#serial-err">serialization error</a> [<a href="#ERRSERE0015" title="err:SERE0015">err:SERE0015</a>] to use the HTML output method when <code>&gt;</code> appears within a processing instruction in <a title="input tree" class="termref" href="#dt-input-tree">input tree</a>.</p><p><span style="display: none;" class="delete_version"><a title="with HTML5" class="termref" href="#id-with-html5">With HTML5</a>, a processing instruction <span class="verb">must</span> be written as an HTML comment, in the form <code>&lt;!--?<var>target</var><var>data</var>?--&gt;</code>. Here <var>target</var> is the name of the processing instruction, and <var>data</var> is its string value; they are separated by a single space. If the string value of the processing instruction contains two adjacent hyphens, they <span class="verb">must</span> be separated in the output by a single space. The space separator is omitted if the string value of the processing instruction is zero-length. For example, the processing instruction <code>&lt;?xml-stylesheet type="text/xsl" href="render.xsl"?&gt;</code> is serialized as <code>&lt;--?xml-stylesheet type="text/xsl" href="render.xsl"?--&gt;</code></span><span style="display: none;" class="add_version"><a title="with HTML5" class="termref" href="#id-with-html5">With HTML5</a>, a processing instruction <span class="verb">must</span> be written as an HTML comment, in the form <code>&lt;!--?<var>target</var><var>data</var>?--&gt;</code>. Here <var>target</var> is the name of the processing instruction, and <var>data</var> is its string value; they are separated by a single space, but this omitted in the case where <var>data</var> is zero-length. If either the name or the string value of the processing instruction contains two adjacent hyphens, they <span class="verb">must</span> be separated in the output by a single space. For example, the processing instruction <code>&lt;?xml-stylesheet type="text/xsl" href="render.xsl"?&gt;</code> is serialized as <code>&lt;--?xml-stylesheet type="text/xsl" href="render.xsl"?--&gt;</code></span><span class="modify_version"><a title="with HTML5" class="termref" href="#id-with-html5">With HTML5</a>, a processing instruction <span class="verb">must</span> be written as an HTML comment, in the form <code>&lt;!--?<var>target</var><var>data</var>?--&gt;</code>. Here <var>target</var> is the name of the processing instruction, and <var>data</var> is its string value; they are separated by a single space<span class="deltaxml-new" style="background:#90EE90">, but this omitted in the case where </span><var><span class="deltaxml-new" style="background:#90EE90">data</span></var><span class="deltaxml-new" style="background:#90EE90"> is zero-length</span>. If <span class="deltaxml-old" style="background:#FF5555">the</span><span class="deltaxml-new" style="background:#90EE90">either the name or the</span> string value of the processing instruction contains two adjacent hyphens, they <span class="verb">must</span> be separated in the output by a single space. <span class="deltaxml-old" style="background:#FF5555">The space separator is omitted if the string value of the processing instruction is zero-length. </span>For example, the processing instruction <code>&lt;?xml-stylesheet type="text/xsl" href="render.xsl"?&gt;</code> is serialized as <code>&lt;--?xml-stylesheet type="text/xsl" href="render.xsl"?--&gt;</code></span></p></div></div><div class="_diffs div1"><h2><a id="json-output"></a>9 <a href="#json-output" style="text-decoration: none">JSON Output Method</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#adaptive-output">next</a> | <a href="#HTML_COMMENTS_AND_PIS">previous</a>)</p><ol><li><p> Added the <code>escape-solidus</code> parameter for JSON serialization. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/530">530</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/534">534</a>&nbsp;6 June 2023]</i></p></li><li><p> Added the <code>json-lines</code> parameter for JSON serialization. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1471">1471</a>&nbsp;&nbsp;15 October 2024]</i></p></li><li><p> The serialization of maps retains the order of entries. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1651">1651</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1703">1703</a>&nbsp;14 January 2025]</i></p></li><li><p> A JNode is replaced by its <code>·content·</code> property. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/2025">2025</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/2031">2031</a>&nbsp;29 May 2025]</i></p></li><li><p> JSON canonicalization is supported by the <code>·canonical·</code> property. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/938">938</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/TODO">TODO</a>&nbsp;20 October 2025]</i></p></li><li><p> The JSON output method now produces fallback representation of NaN and infinity, rather than reporting an error for such values. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/641">641</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/2387">2387</a>&nbsp;16 January 2026]</i></p></li></ol></div><p>The JSON output method serializes the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> using the JSON syntax defined in <a href="#rfc7159">[RFC 7159]</a>, or (if the <code>json-lines</code> parameter is set to true) the <b>json-lines</b> syntax defined at <a href="#JSON-LINES">[JSON Lines]</a>. Sequence normalization is not performed for this output method. The effect of the <code>json-lines</code> parameter is explained at <a href="#id-json-lines"><b>9.2 JSON Lines</b></a>.</p><p>If <code>json-lines</code> is set to <code>false</code>, then:</p><ul><li><p><span style="display: none;" class="delete_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is an empty sequence, it is serialized as the string <code>null</code>.</span><span style="display: none;" class="add_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is the empty sequence, it is serialized as the string <code>null</code>.</span><span class="modify_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, it is serialized as the string <code>null</code>.</span></p></li><li><p>If the input value is a single item, it is serialized as described below.</p></li><li><p>If the input value is a sequence containing two or more items, a serialization error results [<a href="#ERRSERE0023" title="err:SERE0023">err:SERE0023</a>]. </p></li></ul><div class="_diffs div2"><h3><a id="serializing-json-items"></a>9.1 <a href="#serializing-json-items" style="text-decoration: none">Serializing Items</a></h3><p>An individual item is serialized as follows:</p><ul><li><p>A JNode is serialized by serializing its <code>·content·</code> property.</p></li><li><p>An <a title="array item" class="termref" href="#dt-array-item">array item</a> in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is serialized to a JSON array by outputting the serialized JSON value of each member within the array separated by delimiters according to the JSON array syntax, i.e. <code>[member, member, ...]</code>. Each member in the array is to be serialized by recursively applying the rules in this section. </p></li><li><p>A <a title="map item" class="termref" href="#dt-map-item">map item</a> in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is serialized to a JSON object by outputting, for each key/value pair, the <a title="string value" class="termref" href="#dt-string-value">string value</a> of the key <a title="to a JSON string" class="termref" href="#to-a-json-string">to a JSON string</a>, followed by the serialized JSON value of the entry, separated by delimiters according to the JSON object syntax, i.e. <code>{key:value, key:value, ...}</code>. The key/value pairs in the serialized output retain the <a href="https://qt4cg.org/specifications/xpath-datamodel-40/#dt-entry-order">entry order</a><sup><small>DM</small></sup> of entries in the map, unless <code>canonical</code> is <code>true</code>, in which case map entries <span class="verb">must</span> be sorted according to the rules of <a href="#RFC8785">[RFC8785]</a>. </p><div class="note"><p class="prefix"><b>Note:</b></p><p>These rules require sorting according to the UTF-16 representation of the string, which is not the same (in the presence of surrogate pairs) as sorting using the XPath codepoint collation.</p></div><p>If any two keys of the map item have the same <a title="string value" class="termref" href="#dt-string-value">string value</a>, serialization error [<a href="#ERRSERE0022" title="err:SERE0022">err:SERE0022</a>] is raised, unless the <code>allow-duplicate-names</code> parameter is <code>true</code> and the <code>canonical</code> parameter is <code>false</code>. </p></li><li><p> A node in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is serialized <a title="to a JSON string" class="termref" href="#to-a-json-string">to a JSON string</a> by outputting the result of serializing the node using the method specified by the <code>json-node-output-method</code> parameter. If the value of the <code>canonical</code> parameter is <code>false</code>, the node is serialized with the serialization parameter <code>omit-xml-declaration</code> set to <code>true</code> and with no other serialization parameters set, otherwise (<code>canonical</code> is <code>true</code>) all parameters are inherited by the sub-serialization process. </p></li><li><p>An <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic value</a><sup><small>XP</small></sup> of type <code>xs:numeric</code> is serialized to a JSON number.</p><p>If the <code>canonical</code> parameter is <code>true</code>, then the value is cast to type <code>xs:double</code> and the result is serialized according to the rules of <a href="#RFC8785">[RFC8785]</a> (and by extension <a href="#RFC7493">[RFC7493]</a>).</p><p>If the <code>canonical</code> parameter is <code>false</code> then:</p><ul><li><p>A value of type <code>xs:decimal</code> (including <code>xs:integer</code>) is output in the format that results from casting the value to <code>xs:string</code>.</p></li><li><p>A value of type <code>xs:float</code> is first cast to type <code>xs:double</code>, and then output in the same way as an <code>xs:double</code>.</p></li><li><p>Implementations <span class="verb">may</span> serialize an <code>xs:double</code> value using any lexical representation of a JSON number defined in <a href="#rfc7159">[RFC 7159]</a>, but it is <span class="verb">recommended</span> to use the same representation as when the <code>canonical</code> parameter is <code>true</code>.</p></li><li><p>The value <code>NaN</code> is serialized as the JSON token <code>null</code>.</p></li><li><p>The values positive and negative infinity are serialized as <code>1e9999</code> and <code>-1e9999</code> respectively.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>These values are permitted by the JSON grammar, but some JSON parsers may reject them. For interoperability, they should be avoided.</p></div></li></ul></li><li><p>An <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic item</a><sup><small>XP</small></sup> of type <code>xs:boolean</code> is serialized to the JSON token <code>true</code> or <code>false</code>.</p></li><li><p>An <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic item</a><sup><small>XP</small></sup> of type <code>xs:QName</code> in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> whose namespace part is <code>"http://www.w3.org/2005/xpath-functions"</code> and whose local part is <code>"null"</code> is serialized to the JSON token <code>null</code>.</p><div class="note"><p class="prefix"><b>Note:</b></p><p><span style="display: none;" class="delete_version">This rule is introduced in 4.0, along with an option in the <code>fn:parse-json</code> function to allow a user-defined representation of the JSON value <code>null</code>. While the default representation of <code>null</code> as an empty sequence is usable in many circumstances, an explicit representation of <code>null</code> as a recognizable item can make some operations on JSON-derived values easier.</span><span style="display: none;" class="add_version">This rule is introduced in 4.0, along with an option in the <code>fn:parse-json</code> function to allow a user-defined representation of the JSON value <code>null</code>. While the default representation of <code>null</code> as the empty sequence is usable in many circumstances, an explicit representation of <code>null</code> as a recognizable item can make some operations on JSON-derived values easier.</span><span class="modify_version">This rule is introduced in 4.0, along with an option in the <code>fn:parse-json</code> function to allow a user-defined representation of the JSON value <code>null</code>. While the default representation of <code>null</code> as <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence is usable in many circumstances, an explicit representation of <code>null</code> as a recognizable item can make some operations on JSON-derived values easier.</span></p></div></li><li><p>Any other <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic value</a><sup><small>XP</small></sup> in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is serialized <a title="to a JSON string" class="termref" href="#to-a-json-string">to a JSON string</a> by outputting the result of applying the <code>fn:string</code> function to the item.</p></li><li><p>An empty sequence in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is serialized to the JSON token <code>null</code>.</p></li><li><p>A sequence of length greater than one in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> will result in a serialization error [<a href="#ERRSERE0023" title="err:SERE0023">err:SERE0023</a>]. </p></li><li><p> Any item in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> of a type not specified in the above list will result in a serialization error [<a href="#ERRSERE0021" title="err:SERE0021">err:SERE0021</a>].</p></li></ul><p> [<a id="to-a-json-string" title="to a JSON string">Definition</a>: Whenever a value is serialized <b>to a JSON string</b>, the following procedure is applied to the supplied string:]</p><ol class="enumar"><li><p>If the <code>canonical</code> parameter is <code>true</code>, then the string is output as specified in <a href="#RFC8785">[RFC8785]</a>. The string is first normalized if requested using the <code>normalization-form</code> parameter. The serialization parameters <code>escape-solidus</code> and <code>use-character-maps</code> are ignored.</p><div class="note"><p class="prefix"><b>Note:</b></p><p>The escaping rules are restated here for convenience:</p><ul><li><p>If the Unicode value falls within the traditional ASCII control character range (<span class="unicode-codepoint">U+0000</span> (<span class="unicode-name">NULL</span>) through <span class="unicode-codepoint">U+001F</span> (<span class="unicode-name">IS1</span>) ), it <span class="verb">must</span> be serialized using lowercase hexadecimal Unicode notation (<code>\uhhhh</code>) unless it is in the set of predefined JSON control characters <span class="unicode-codepoint">U+0008</span> (<span class="unicode-name">BACKSPACE</span>) , <span class="unicode-codepoint">U+0009</span> (<span class="unicode-name">TAB</span>) , <span class="unicode-codepoint">U+000A</span> (<span class="unicode-name">NEWLINE</span>) , <span class="unicode-codepoint">U+000C</span> (<span class="unicode-name">FORM FEED</span>) , or <span class="unicode-codepoint">U+000D</span> (<span class="unicode-name">CARRIAGE RETURN</span>) , which <span class="verb">must</span> be serialized as <code>\b</code>, <code>\t</code>, <code>\n</code>, <code>\f</code>, and <code>\r</code>, respectively.</p></li><li><p>If the Unicode value is outside of the ASCII control character range, it <span class="verb">must</span> be serialized “as is” unless it is equivalent to <span class="unicode-codepoint">U+005C</span> (<span class="unicode-name">REVERSE SOLIDUS, BACKSLASH</span>, <code>\</code>) or <span class="unicode-codepoint">U+0022</span> (<span class="unicode-name">QUOTATION MARK</span>, <code>"</code>) , which <span class="verb">must</span> be serialized as <code>\\</code> and <code>\"</code>, respectively.</p></li></ul><p>Note that the C1 control characters (codepoints 127-159) are not included in this list.</p></div><div class="note"><p class="prefix"><b>Note:</b></p><p>In canonical JSON, property values within an object are sorted based on their UTF16 representation. This corresponds to the default sort order in languages such as Javascript, Java, and C#, but in the presence of codepoints above 65535, it is not the same as the order produced by Unicode codepoint collation.</p></div></li><li><p>Otherwise (when <code>canonical</code> is <code>false</code>):</p><ol class="enumla"><li><p>Any character in the string for which character mapping is defined (see <a href="#character-maps"><b>11 Character Maps</b></a>) is substituted by the replacement string defined in the character map.</p></li><li><p> Any other character in the input string (but not a character produced by character mapping) is a candidate for <a title="Unicode Normalization" class="termref" href="#unicode-normalization">Unicode Normalization</a> if requested by the <code>normalization-form</code> parameter, and JSON escaping. JSON escaping replaces the characters <span class="unicode-codepoint">U+005C</span> (<span class="unicode-name">REVERSE SOLIDUS, BACKSLASH</span>, <code>\</code>) , <span class="unicode-codepoint">U+0008</span> (<span class="unicode-name">BACKSPACE</span>) , <span class="unicode-codepoint">U+000C</span> (<span class="unicode-name">FORM FEED</span>) , <span class="unicode-codepoint">U+000A</span> (<span class="unicode-name">NEWLINE</span>) , <span class="unicode-codepoint">U+000D</span> (<span class="unicode-name">CARRIAGE RETURN</span>) , <span class="unicode-codepoint">U+0009</span> (<span class="unicode-name">TAB</span>) , or <span class="unicode-codepoint">U+005C</span> (<span class="unicode-name">REVERSE SOLIDUS, BACKSLASH</span>, <code>\</code>) by the corresponding JSON escape sequences <code>\"</code>, <code>\b</code>, <code>\f</code>, <code>\n</code>, <code>\r</code>, <code>\t</code>, or <code>\\</code> respectively, and any other codepoint in the range 1-31 or 127-159 by an escape in the form <code>\uHHHH</code> where <code>HHHH</code> is the hexadecimal representation of the codepoint value. <span>Escaping further replaces the solidus character (<code>/</code>) by the escape sequence <code>\/</code> if the <code>escape-solidus</code> parameter is set to <code>true</code>, but not if it is set to <code>false</code>.</span> Escaping is also applied to any characters that cannot be represented in the selected encoding. </p></li></ol></li><li><p>The resulting string is enclosed in double quotation marks.</p></li></ol><p> Finally, encoding, as controlled by the <code>encoding</code> parameter, converts the character stream produced by the preceding rules into an octet stream. The <code>encoding</code> parameter is ignored if <code>canonical</code> is <code>true</code>. </p></div><div class="_diffs div2"><h3><a id="id-json-lines"></a>9.2 <a href="#id-json-lines" style="text-decoration: none">JSON Lines</a></h3><p>When the <code>json-lines</code> parameter is set to <code>true</code>, the serialized output is written in <b>json-lines</b> format, as defined in <a href="#JSON-LINES">[JSON Lines]</a>.</p><p>If <code>json-lines</code> is set to <code>true</code>, then each item in the <a title="input value" class="termref" href="#dt-input-value">input value</a> is serialized indepedently as a JSON text, and the resulting serializations are then concatenated using a single <span class="unicode-codepoint">U+000A</span> (<span class="unicode-name">NEWLINE</span>) character as a separator. </p><p>If <code>json-lines</code> and <code>indent</code> are both set to true, then the serialization of each individual item may include added <span class="unicode-codepoint">U+0020</span> (<span class="unicode-name">SPACE</span>) and <span class="unicode-codepoint">U+0009</span> (<span class="unicode-name">TAB</span>) characters for formatting purposes, but it must not include <span class="unicode-codepoint">U+000A</span> (<span class="unicode-name">NEWLINE</span>) or <span class="unicode-codepoint">U+000D</span> (<span class="unicode-name">CARRIAGE RETURN</span>) characters.</p><p>The <b>json-lines</b> specification allows <span class="unicode-codepoint">U+000D</span> (<span class="unicode-name">CARRIAGE RETURN</span>) characters to appear, and does not treat them as significant; however, they are likely to cause practical problems. For example processing such input using the XPath expression <code>unparsed-text-lines($uri) ! parse-json()</code> would fail. The serializer <span class="verb">must not</span> output any <span class="unicode-codepoint">U+000D</span> (<span class="unicode-name">CARRIAGE RETURN</span>) characters, either at the end of a line or elsewhere.</p><p>The <b>json-lines</b> specification allows a terminating <span class="unicode-codepoint">U+000A</span> (<span class="unicode-name">NEWLINE</span>) character after the last line. In the interests of interoperability, however, the serializer <span class="verb">must not</span> output such a terminator.</p><p><span style="display: none;" class="delete_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is an empty sequence, then it is serialized as a zero-length string (rather than as the string <code>null</code>).</span><span style="display: none;" class="add_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is the empty sequence, then it is serialized as a zero-length string (rather than as the string <code>null</code>).</span><span class="modify_version">If the <a title="input value" class="termref" href="#dt-input-value">input value</a> is <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, then it is serialized as a zero-length string (rather than as the string <code>null</code>).</span></p><p>The <code>item-separator</code> parameter has no effect.</p></div></div><div class="_diffs div1"><h2><a id="adaptive-output"></a>10 <a href="#adaptive-output" style="text-decoration: none">Adaptive Output Method</a></h2><div class="changes"><p class="changesHeading"> Changes in 4.0 (<a href="#ADAPTIVE_PARAMS">next</a> | <a href="#json-output">previous</a>)</p><ol><li><p> The serialization of maps retains the order of entries. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/1651">1651</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/1703">1703</a>&nbsp;14 January 2025]</i></p></li><li><p> The output of QNames reflects the new syntax for QName literals. <i>&nbsp;&nbsp;[Issue <a href="https://github.com/qt4cg/qtspecs/issues/2059">2059</a>&nbsp;PR <a href="https://github.com/qt4cg/qtspecs/pull/TODO">TODO</a>&nbsp;23 June 2025]</i></p></li><li><p> A JNode is represented as <code>jnode(<var>K</var>: <var>V</var>)</code> where <var>K</var> is its <code>·selector·</code> property and <var>V</var> is its <code>·content·</code> property. <i>&nbsp;&nbsp;[Issues <a href="https://github.com/qt4cg/qtspecs/issues/2087">2087</a>&nbsp;<a href="https://github.com/qt4cg/qtspecs/issues/2186">2186</a>&nbsp;PRs <a href="https://github.com/qt4cg/qtspecs/pull/2114">2114</a>&nbsp;<a href="https://github.com/qt4cg/qtspecs/pull/2226">2226</a>&nbsp;22 June 2025]</i></p></li></ol></div><p>The Adaptive output method serializes the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> into a human readable form for the purposes of debugging query results. The intention of this is to allow any <a title="input value" class="termref" href="#dt-input-value">input value</a> to be serialized without raising a serialization error. Sequence normalization is not performed for this output method. </p><p>Each item in the supplied sequence is serialized individually as follows, with an occurrence of the chosen <code>item-separator</code> between successive items.</p><ul><li><p>A JNode is serialized as follows:</p><ul><li><p>If the <code>·selector·</code> property is absent (that is, for a parentless JNode), in the format <code>jtree(<var>V</var>)</code> where <var>V</var> is the adaptive serialization of the value of its <code>·content·</code> property.</p><p>For example, the JNode selected by the expression <code>jtree({ "a": [4, 5] })</code> is serialized as <code>jtree({"a":[4,5]})</code>.</p></li><li><p>If the <code>·selector·</code> property is present, then in the format <code>jnode(<var>K</var>: <var>V</var>)</code> where <var>K</var> is the adaptive serialization of the value of its <code>·selector·</code> property and <var>V</var> is the adaptive serialization of the value of its <code>·content·</code> property.</p><p>For example, the JNode selected by the expression <code>jtree({ "a": [4, 5] })/a</code> is serialized as <code>jnode("a":[4,5])</code>.</p></li></ul></li><li><p>A document, element, text, comment, or processing instruction node is serialized using the XML output method described in <a href="#xml-output"><b>5 XML Output Method</b></a>.</p></li><li><p>An attribute or namespace <a title="node" class="termref" href="#dt-node">node</a> is serialized as if it had a containing element node. For example an attribute node might be serialized as the string <code>xsi:type="xs:integer"</code>; a namespace node might be serialized as <code>xmlns:sns="http://example.com/sample-namespace"</code>. </p><div class="note"><p class="prefix"><b>Note:</b></p><p>This may result in output of QNames containing prefixes whose binding is not displayed.</p></div></li><li><p>An <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic item</a><sup><small>XP</small></sup> is serialized as follows:</p><ul><li><p>An instance of <code>xs:boolean</code> is serialized as <code>true()</code> or <code>false()</code>. </p></li><li><p>An instance of <code>xs:string</code>, <code>xs:untypedAtomic</code> or <code>xs:anyURI</code> is serialized by enclosing the value in double quotation marks and doubling any quotes within the value; or optionally by enclosing the value in apostrophes and doubling any apostrophes within the value. The resulting value is then serialized using the Text output method described in <a href="#text-output"><b>8 Text Output Method</b></a>. </p><div class="note"><p class="prefix"><b>Note:</b></p><p>The Text output method will apply character expansion and encoding rules to this string as specified by the serialization parameters.</p></div></li><li><p>An instance of <code>xs:integer</code> or <code>xs:decimal</code> is serialized by converting the value to a string using the <code>fn:string</code> function.</p></li><li><p>An instance of <code>xs:double</code> is serialized by applying the function <code>format-number(?, '0.0##########################e0')</code> using the following default decimal format properties:</p><table class="medium no-code-break"><caption>Decimal format</caption><thead><tr><th style="text-align:left">Property name</th><th style="text-align:left">Property value</th></tr></thead><tbody><tr><td><code>decimal-separator</code></td><td><span class="unicode-codepoint">U+002E</span> (<span class="unicode-name">FULL STOP, PERIOD</span>, <code>.</code>) </td></tr><tr><td><code>exponent-separator</code></td><td><span class="unicode-codepoint">U+0065</span> (<span class="unicode-name">LATIN SMALL LETTER E</span>, <code>e</code>) </td></tr><tr><td><code>grouping-separator</code></td><td><span class="unicode-codepoint">U+002C</span> (<span class="unicode-name">COMMA</span>, <code>,</code>) </td></tr><tr><td><code>zero-digit</code></td><td><span class="unicode-codepoint">U+0030</span> (<span class="unicode-name">DIGIT ZERO</span>, <code>0</code>) </td></tr><tr><td><code>digit</code></td><td><span class="unicode-codepoint">U+0023</span> (<span class="unicode-name">NUMBER SIGN</span>, <code>#</code>) </td></tr><tr><td><code>infinity</code></td><td>The string "INF"</td></tr><tr><td><code>NaN</code></td><td>The string "NaN"</td></tr><tr><td><code>minus-sign</code></td><td><span class="unicode-codepoint">U+002D</span> (<span class="unicode-name">HYPHEN-MINUS</span>, <code>-</code>) </td></tr></tbody></table></li><li><p>An instance of <code>xs:NOTATION</code> is serialized as a URI-qualified name (that is, in the form <code>Q{uri}local</code>).</p></li><li><p>An instance of <code>xs:QName</code> is serialized with a <code>#</code> character, followed by:</p><ul><li><p>the local name if the name is in no namespace, or</p></li><li><p>the URI-qualified name otherwise (<code>Q{uri}local</code>).</p></li></ul></li><li><p>An atomic item of any other type is serialized using the syntax of a constructor function: <code>xs:TYPE("VAL")</code> where <code>TYPE</code> is the name of the primitive type, and <code>VAL</code> is the result of applying the <code>fn:string()</code> function. For example, <code>xs:date("2015-07-17")</code>. The resulting string is then serialized using the Text output method described in <a href="#text-output"><b>8 Text Output Method</b></a>.</p></li></ul></li><li><p> An <a title="array item" class="termref" href="#dt-array-item">array item</a> is serialized using the syntax of a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#SquareArrayConstructor">SquareArrayConstructor</a><sup><small>XP</small></sup>, that is as <code>[member, member, ... ]</code>. The members, which in general are sequences, are serialized in the form <code>(item, item, ...)</code> where the items are serialized by applying these rules recursively. The items are separated by commas (not by the <code>item-separator</code> character). The enclosing parentheses are optional if the sequence has length one. </p><div class="note"><p class="prefix"><b>Note:</b></p><p>The serializer should avoid outputting the parentheses if it is able to determine the length of the sequence before serializing the first item; but it is allowed to output parentheses around a singleton if this avoids buffering data in memory.</p></div></li><li><p> A <a title="map item" class="termref" href="#dt-map-item">map item</a> is serialized using the syntax of a <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#doc-xpath40-MapConstructor">MapConstructor</a> without the optional <code>map</code> keyword, that is in the format <code>{key:value, key:value, ...}</code>. The key/value pairs in the serialized output retain the <a href="https://qt4cg.org/specifications/xpath-datamodel-40/#dt-entry-order">entry order</a><sup><small>DM</small></sup> of entries in the map. The key is serialized by applying the rules for serializing an atomic item. The values are serialized in the same way as the members of an array (see above). </p></li><li><p>A <a title="function item" class="termref" href="#dt-function-item">function item</a> is serialized to the representation <code>name#A</code> where <var>fn:name</var> is a representation of the function name and <var>A</var> is the arity. If the function name is in one of the namespaces <code>http://www.w3.org/2005/xpath-functions</code>, <code>http://www.w3.org/2005/xpath-functions/math</code>, <code>http://www.w3.org/2005/xpath-functions/map</code>, <code>http://www.w3.org/2005/xpath-functions/array</code> or <code>http://www.w3.org/2001/XMLSchema</code>, then the name is output as a lexical QName using the conventional prefix <code>fn</code>, <code>math</code>, <code>map</code>, <code>array</code>, or <code>xs</code> as appropriate; if it is in any other namespace or in no namespace, then the name is output as a URI-qualified name (that is, <code>Q{uri}local</code>). If the function is anonymous, <var>name</var> is replaced by the string <code>(anonymous-function)</code>. </p><div class="note"><p class="prefix"><b>Note:</b></p><p> The following examples illustrate this rule:</p><ul><li><p><span style="display: none;" class="delete_version"><code>fn:exists#1</code> is serialized as <code>function fn:exists#1</code></span><span style="display: none;" class="add_version"><code>fn:exists#1</code> is serialized as <code>fn:exists#1</code></span><span class="modify_version"><code>fn:exists#1</code> is serialized as <code><span class="deltaxml-old" style="background:#FF5555">function </span>fn:exists#1</code></span></p></li><li><p><code>Q{http://www.w3.org/2005/xpath-functions}exists#1</code> is serialized as <code>fn:exists#1</code></p></li><li><p><code>function($a) { $a }</code> is serialized as <code>(anonymous-function)#1</code></p></li><li><p><code>math:pi#0</code> is serialized as <code>math:pi#0</code></p></li></ul></div></li></ul><p>Character maps are applied (a) when nodes are serialized using the XML output method, and (b) to any value represented as a string enclosed in quotation marks.</p><p>Optionally, in all the above constructs, characters whose visual representation is ambiguous (for example tab or non-breaking-space) may be represented in the form of an XML numeric character reference (for example <code>&amp;#x9;</code> or <code>&amp;#xa0;</code>)</p><div class="note"><p class="prefix"><b>Note:</b></p><p> In many cases the serialization of an item conforms to the syntax of an XQuery expression whose result is that item. There are exceptions, however. For example, the syntax will not be valid XQuery in the case of free-standing attribute or namespace nodes, or QName values, or anonymous functions; and where it is valid XQuery, the result of evaluating the expression will not necessarily be identical to the original: for example, the distinction between strings and untypedAtomic items is lost. </p></div><p> If any value cannot be output because doing so would cause a serialization error, the behavior is <a title="implementation-defined" class="termref" href="#impdef">implementation-defined</a>. </p><p> If the output is sent to a destination that allows hyperlinks to be included in the generated text, then the serializer <span class="verb">may</span> include <a title="implementation-dependent" class="termref" href="#impdep">implementation-dependent</a> hyperlinks to provide additional information for example:</p><ul><li><p> to allow the type of <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-atomic-item">atomic items</a><sup><small>XP</small></sup> to be ascertained. </p></li><li><p> to allow the namespace binding of prefixes to be ascertained. </p></li><li><p> to provide further information about the cause of error indicators. </p></li></ul></div></div><div class="back"><div class="_diffs div1"><h2><a id="id-glossary"></a>E <a href="#id-glossary" style="text-decoration: none">Glossary</a> (Non-Normative)</h2><dl><dt><a href="#dt-array-item">array item</a></dt><dd><p>The term <b>array item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#array-items">8.3 Array Items</a>.</p></dd><dt><a href="#dt-atomization">atomize</a></dt><dd><p>The term <b>atomization</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-atomization">2.6.3 Atomization</a>.</p></dd><dt><a href="#dt-character">character</a></dt><dd><p>The term <b>character</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.</p></dd><dt><a href="#dt-codepoint">codepoint</a></dt><dd><p>The term <b>codepoint</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.</p></dd><dt><a href="#content">content</a></dt><dd><p>The term <b>content</b> has the same meaning as the term <a href="https://www.w3.org/TR/REC-xml/#dt-content">Content</a><sup><small>XML</small></sup> defined in <a href="https://www.w3.org/TR/REC-xml/#sec-starttags"> 3.1 Start-Tags, End-Tags, and Empty-Element Tags</a><sup><small>XML</small></sup> of <a href="#xml">[XML10]</a>.</p></dd><dt><a href="#XHTMLEMPTY">EMPTY</a></dt><dd><p>The following XHTML elements have an <b>EMPTY</b> content model: <code>area</code>, <code>base</code>, <code>br</code>, <code>col</code>, <code>embed</code>, <code>hr</code>, <code>img</code>, <code>input</code>, <code>link</code>, <code>meta</code>, <code>basefont</code>, <code>frame</code>, <code>isindex</code>, and <code>param</code>.</p></dd><dt><a href="#dt-expanded-qname">expanded QName</a></dt><dd><p>The term <b>expanded QName</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded QName</a> consists of an optional namespace URI and a local name. An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded QName</a> also retains its original namespace prefix (if any), to facilitate casting the expanded QName into a string.</p></dd><dt><a href="#XHTMLEXPECTEDEMPTY">expected-empty</a></dt><dd><p>An element node is <b>expected to be empty</b> if it is <a title="recognized as an HTML element" class="termref" href="#recognized-as-HTML">recognized as an HTML element</a> and:</p><ul><li><p><a title="with HTML5" class="termref" href="#id-with-html5">With HTML5</a>, the element is a <a title="void" class="termref" href="#XHTMLVOID">void</a> element.</p></li><li><p><a title="prior to HTML5" class="termref" href="#id-prior-to-html5">Prior to HTML5</a>, the content model is <a title="EMPTY" class="termref" href="#XHTMLEMPTY">EMPTY</a>.</p></li></ul></dd><dt><a href="#dt-function-item">function item</a></dt><dd><p>The term <b>function item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#function-items">8.1 Function Items</a>.</p></dd><dt><a href="#host-language">host language</a></dt><dd><p> A <b>host language</b> is another specification that includes, by reference, this specification and all of its requirements. A host language might be a programming language such as <a href="#xslt-40">[XSLT 4.0]</a> or <a href="#xquery-40">[XQuery 4.0]</a>, or it might be an application programming interface (API) intended to be used by programs written in some other high-level programming language. The use of the term <em>language</em> is not intended to preclude the possibility that this specification might be referenced outside the context of a programming language specification.</p></dd><dt><a href="#immediate-content">immediate content</a></dt><dd><p> The <b>immediate content</b> of an element is the part of the <a title="content" class="termref" href="#content">content</a> of the element that is not also in the <a title="content" class="termref" href="#content">content</a> of a child element of that element.</p></dd><dt><a href="#impdef">implementation-defined</a></dt><dd><p><b>Implementation-defined</b> indicates an aspect that <span class="verb">may</span> differ between <a title="serializer" class="termref" href="#serializer">serializers</a>, but whose actual behavior <span class="verb">must</span> be specified either by another specification that sets conformance criteria for serialization (see <a href="#conformance"><b>12 Conformance</b></a>) or in documentation that accompanies the <a title="serializer" class="termref" href="#serializer">serializer</a>.</p></dd><dt><a href="#impdep">implementation-dependent</a></dt><dd><p><b>Implementation-dependent</b> indicates an aspect that <span class="verb">may</span> differ between <a title="serializer" class="termref" href="#serializer">serializers</a>, and whose actual behavior is not <span class="verb">required</span> to be specified either by another specification that sets conformance criteria for serialization (see <a href="#conformance"><b>12 Conformance</b></a>) or in documentation that accompanies the <a title="serializer" class="termref" href="#serializer">serializer</a>.</p></dd><dt><a href="#dt-input-tree">input tree</a></dt><dd><p>In general the output of the serializer will represent the items actually present in the input value, together with other items that are reachable from these, for example (in the case of nodes) their descendants. The complete set of items that are represented in the output of the serializer is referred to (without loss of generality) as the <b>input tree</b>.</p></dd><dt><a href="#dt-input-value">input value</a></dt><dd><p>The XDM value supplied as input to the serializer is referred to as the <b>input value</b>.</p></dd><dt><a href="#dt-map-item">map item</a></dt><dd><p>The term <b>map item</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#map-items">8.2 Map Items</a>.</p></dd><dt><a href="#mathml-namespace">MathML namespace</a></dt><dd><p>the <b>MathML namespace</b> namespace, <code>https://www.w3.org/1998/Math/MathML</code>.</p></dd><dt><a href="#dt-node">node</a></dt><dd><p>The term <b>node</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. There are seven kinds of <a title="node" class="termref" href="#dt-node">nodes</a> in the data model: document, element, attribute, text, namespace, processing instruction, and comment.</p></dd><dt><a href="#non-null-namespace-URI">non-null namespace URI</a></dt><dd><p>An element or attribute that does not have a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a>, is referred to as having a <b>non-null namespace URI</b></p></dd><dt><a href="#null-namespace-URI">null namespace URI</a></dt><dd><p><span style="display: none;" class="delete_version"> An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is an empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b></span><span style="display: none;" class="add_version"> An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is the empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b></span><span class="modify_version"> An <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a> whose namespace part is <span class="deltaxml-old" style="background:#FF5555">an</span><span class="deltaxml-new" style="background:#90EE90">the</span> empty sequence, or an element or attribute whose name expands to such an <a title="expanded QName" class="termref" href="#dt-expanded-qname">expanded-QName</a>, is referred to as having a <b>null namespace URI</b></span></p></dd><dt><a href="#output-namespace">Output declaration namespace</a></dt><dd><p>the <b>Output declaration namespace</b>, <code>https://www.w3.org/2010/xslt-xquery-serialization</code></p></dd><dt><a href="#dt-parameter-document">parameter document</a></dt><dd><p>An <code>output:serialization-parameters</code> element node used to hold the settings of serialization parameters is referred to as a <b>parameter document</b></p></dd><dt><a href="#PREFIXNORMALIZATION">prefix normalization</a></dt><dd><p>During <b>prefix normalization</b>, any element node in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> that is in one of the <a title="XHTML namespace" class="termref" href="#xhtml-namespace">XHTML namespace</a>, the <a title="SVG namespace" class="termref" href="#svg-namespace">SVG namespace</a> or the <a title="MathML namespace" class="termref" href="#mathml-namespace">MathML namespace</a> has its name replaced by the local part of its name. Such an element node is given a default namespace node whose value is the element’s namespace URI. Any namespace node for any of those three namespaces that was previously present on any element node in the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> is also removed, unless the prefix that that namespace node declared is used as the prefix on the name of an attribute on that element or an ancestor of that element.</p></dd><dt><a href="#id-prior-to-html5">prior to HTML5</a></dt><dd><p>The term <b>prior to HTML5</b> is used in this specification to qualify rules that apply only when the effective version of the <code>html-version</code> serialization parameter is less than <code>5.0</code>.</p></dd><dt><a href="#recognized-as-HTML">recognized as an HTML element</a></dt><dd><p>An element node is <b>recognized as an HTML element</b> by the XHTML output method if either of the following conditions is true:</p><ul><li><p>the element node is in the <a title="XHTML namespace" class="termref" href="#xhtml-namespace">XHTML namespace</a>; or</p></li><li><p><a title="with HTML5" class="termref" href="#id-with-html5">With HTML5</a>: the element has a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a> and the local part of the name is equal to the name of an element defined by HTML5 <a href="#html5">[HTML5]</a>, making the comparison <a title="without regard to case" class="termref" href="#caseless-compare">without regard to case</a>.</p></li></ul></dd><dt><a href="#reconstructed-tree">reconstructed tree</a></dt><dd><p>A <b>reconstructed tree</b> may be constructed by parsing the XML document and converting it into an document node as specified in <a href="#xpath-datamodel-40">[XDM 4.0]</a>.</p></dd><dt><a href="#req-html-ver">requested HTML version</a></dt><dd><p>The <b>requested HTML version</b> is the value of the <code>html-version</code> serialization parameter if present; otherwise the value of the <code>version</code> serialization parameter if present; otherwise <code>5.0</code>.</p></dd><dt><a href="#result-tree">result tree</a></dt><dd><p>The result of the <a title="sequence normalization" class="termref" href="#sequence-normalization">sequence normalization</a> process is a <b>result tree</b>.</p></dd><dt><a href="#dt-sequence">sequence</a></dt><dd><p>The term <b>sequence</b> is defined in <a href="#xpath-40">[XPath 4.0]</a> section <a href="../xquery-40/xpath-40.html#id-basics">2 Basics</a>. A <a title="sequence" class="termref" href="#dt-sequence">sequence</a> is an ordered collection of zero or more items.</p></dd><dt><a href="#sequence-normalization">sequence normalization</a></dt><dd><p>The purpose of <b>sequence normalization</b> is to create a sequence that can be serialized as a well-formed XML document or external general parsed entity, that also reflects the content of the input sequence to the extent possible.</p></dd><dt><a href="#serial-err">serialization error</a></dt><dd><p>In some instances, the <a title="input tree" class="termref" href="#dt-input-tree">input tree</a> cannot be successfully converted into a sequence of octets given the set of serialization parameter (<a href="#serparam"><b>3 Serialization Parameters</b></a>) values specified. A <b>serialization error</b> is said to occur in such an instance.</p></dd><dt><a href="#serialize-as-HTML">serialized as an HTML element</a></dt><dd><p>An element node is <b>serialized as an HTML element</b> if</p><ul><li><p>the expanded QName of the element has a <a title="null namespace URI" class="termref" href="#null-namespace-URI">null namespace URI</a>, or </p></li><li><p>the <a title="requested HTML version" class="termref" href="#req-html-ver">requested HTML version</a> is <code>5.0</code> or greater, and the element node is in the <a title="XHTML namespace" class="termref" href="#xhtml-namespace">XHTML namespace</a>.</p></li></ul></dd><dt><a href="#serializer">serializer</a></dt><dd><p>As is indicated in <a href="#conformance"><b>12 Conformance</b></a>, conformance criteria for serialization are determined by other specifications that refer to this specification. A <b>serializer</b> is software that implements some or all of the requirements of this specification in accordance with such conformance criteria.</p></dd><dt><a href="#dt-string">string</a></dt><dd><p>The term <b>string</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#xml-and-xsd-versions">4.1.5 XML and XSD Versions</a>.</p></dd><dt><a href="#dt-string-value">string value</a></dt><dd><p>The term <b>string value</b> is defined in <a href="#xpath-datamodel-40">[XDM 4.0]</a> section <a href="../xpath-datamodel-40/#dm-string-value">7.6.12 string-value Accessor</a>. Every <a title="node" class="termref" href="#dt-node">node</a> has a <a title="string value" class="termref" href="#dt-string-value">string value</a>. For example, the <a title="string value" class="termref" href="#dt-string-value">string value</a> of an element is the concatenation of the <a title="string value" class="termref" href="#dt-string-value">string values</a> of all its descendant text <a title="node" class="termref" href="#dt-node">nodes</a>.</p></dd><dt><a href="#svg-namespace">SVG namespace</a></dt><dd><p>the <b>SVG namespace</b>, <code>https://www.w3.org/2000/svg</code></p></dd><dt><a href="#to-a-json-string">to a JSON string</a></dt><dd><p>Whenever a value is serialized <b>to a JSON string</b>, the following procedure is applied to the supplied string:</p></dd><dt><a href="#unicode-normalization">Unicode Normalization</a></dt><dd><p><b>Unicode Normalization</b> is the process of removing alternative representations of equivalent sequences from textual data, to convert the data into a form that can be binary-compared for equivalence, as specified in <a href="#UNICODE-NORMALIZATION-FORM">[UAX #15: Unicode Normalization Forms]</a>. For specific recommendations for character normalization on the World Wide Web, see <a href="#charmod-norm">[Character Model for the World Wide Web 1.0: Normalization]</a>.</p></dd><dt><a href="#uri-attribute-values">URI attribute values</a></dt><dd><p> The values of attributes listed in <a href="#list-of-uri-attributes"><b>D List of URI Attributes</b></a> are <b>URI attribute values</b>. Attributes are not considered to be URI attributes simply because they are namespace declaration attributes or have the type annotation <code>xs:anyURI</code>.</p></dd><dt><a href="#uri-escaping">URI Escaping</a></dt><dd><p><b>URI escaping</b> consists of the following three steps applied in sequence to the content of <a title="URI attribute values" class="termref" href="#uri-attribute-values">URI attribute values</a>:</p></dd><dt><a href="#XHTMLVOID">void</a></dt><dd><p>The <b>void</b> elements of HTML5 are <code>area</code>, <code>base</code>, <code>br</code>, <code>col</code>, <code>embed</code>, <code>hr</code>, <code>img</code>, <code>input</code>, <code>keygen</code>, <code>link</code>, <code>meta</code>, <code>param</code>, <code>source</code>, <code>track</code> and <code>wbr</code>.</p></dd><dt><a href="#whitespace-char">whitespace character</a></dt><dd><p>A space character, TAB character, CR character or NL character is referred to as a <b>whitespace character</b>.</p></dd><dt><a href="#id-with-html5">with HTML5</a></dt><dd><p>The term <b>with HTML5</b> is used in this specification to qualify rules that apply only when the effective version of the <code>html-version</code> serialization parameter is <code>5.0</code>.</p></dd><dt><a href="#caseless-compare">without regard to case</a></dt><dd><p> Where this specification indicates that two strings are to be compared <b>without regard to case</b>, the <a title="serializer" class="termref" href="#serializer">serializer</a><span class="verb">must</span> translate any characters in the range <span class="unicode-codepoint">U+0041</span> (<span class="unicode-name">LATIN CAPITAL LETTER A</span>, <code>A</code>) through <span class="unicode-codepoint">U+005A</span> (<span class="unicode-name">LATIN CAPITAL LETTER Z</span>, <code>Z</code>) inclusive, to the corresponding lower-case letters in the range <span class="unicode-codepoint">U+0061</span> (<span class="unicode-name">LATIN SMALL LETTER A</span>, <code>a</code>) through <span class="unicode-codepoint">U+007A</span> (<span class="unicode-name">LATIN SMALL LETTER Z</span>, <code>z</code>) only for the purposes of making the comparison. The comparison succeeds if the two strings are the same length and the code point of each character in the first string is equal to the code point of the character in the corresponding position in the second string.</p></dd><dt><a href="#xhtml-namespace">XHTML namespace</a></dt><dd><p>the <b>XHTML namespace</b> namespace, <code>https://www.w3.org/1999/xhtml</code></p></dd><dt><a href="#XML-ISLAND">XML Island</a></dt><dd><p>The portion of the serialized document representing the result of serializing an element that is not to be <a title="serialized as an HTML element" class="termref" href="#serialize-as-HTML">serialized as an HTML element</a> is known as an <b>XML Island.</b></p></dd><dt><a href="#xml-namespace">XML namespace</a></dt><dd><p>the <b>XML namespace</b>, <code>https://www.w3.org/XML/1998/namespace</code></p></dd></dl></div></div><script src="js/toc.js"></script><script src="/js/scroll.js"></script></body></html>